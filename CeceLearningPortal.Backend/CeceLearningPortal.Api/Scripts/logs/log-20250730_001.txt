2025-07-30 13:41:53.754 +08:00 [INF] Checking database connection...
2025-07-30 13:41:54.359 +08:00 [INF] Database connection successful.
2025-07-30 13:41:54.359 +08:00 [INF] Attempting to apply migrations...
2025-07-30 13:41:54.445 +08:00 [INF] Executed DbCommand (11ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-07-30 13:41:54.676 +08:00 [WRN] Migration failed. This might be due to pending model changes. Continuing anyway...
System.InvalidOperationException: An error was generated for warning 'Microsoft.EntityFrameworkCore.Migrations.PendingModelChangesWarning': The model for context 'ApplicationDbContext' has pending changes. Add a new migration before updating the database. See https://aka.ms/efcore-docs-pending-changes. This exception can be suppressed or logged by passing event ID 'RelationalEventId.PendingModelChangesWarning' to the 'ConfigureWarnings' method in 'DbContext.OnConfiguring' or 'AddDbContext'.
   at Microsoft.EntityFrameworkCore.Diagnostics.EventDefinition`1.Log[TLoggerCategory](IDiagnosticsLogger`1 logger, TParam arg)
   at Microsoft.EntityFrameworkCore.Diagnostics.RelationalLoggerExtensions.PendingModelChangesWarning(IDiagnosticsLogger`1 diagnostics, Type contextType)
   at Microsoft.EntityFrameworkCore.Migrations.Internal.Migrator.ValidateMigrations(Boolean useTransaction, String targetMigration)
   at Microsoft.EntityFrameworkCore.Migrations.Internal.Migrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Program.cs:line 222
2025-07-30 13:41:54.687 +08:00 [INF] Starting data seeding...
2025-07-30 13:41:54.701 +08:00 [INF] User profile is available. Using 'C:\Users\User\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-07-30 13:41:54.816 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Courses" AS c)
2025-07-30 13:41:54.819 +08:00 [INF] Database already contains data. Skipping seed.
2025-07-30 13:41:54.819 +08:00 [INF] Data seeding completed.
2025-07-30 13:41:54.858 +08:00 [ERR] Hosting failed to start
System.IO.IOException: Failed to bind to address http://127.0.0.1:5295: address already in use.
 ---> Microsoft.AspNetCore.Connections.AddressInUseException: Only one usage of each socket address (protocol/network address/port) is normally permitted.
 ---> System.Net.Sockets.SocketException (10048): Only one usage of each socket address (protocol/network address/port) is normally permitted.
   at System.Net.Sockets.Socket.UpdateStatusAfterSocketErrorAndThrowException(SocketError error, Boolean disconnectOnFailure, String callerName)
   at System.Net.Sockets.Socket.DoBind(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Bind(EndPoint localEP)
   at Microsoft.AspNetCore.Server.Kestrel.Transport.Sockets.SocketTransportOptions.CreateDefaultBoundListenSocket(EndPoint endpoint)
   at Microsoft.AspNetCore.Server.Kestrel.Transport.Sockets.SocketConnectionListener.Bind()
   --- End of inner exception stack trace ---
   at Microsoft.AspNetCore.Server.Kestrel.Transport.Sockets.SocketConnectionListener.Bind()
   at Microsoft.AspNetCore.Server.Kestrel.Transport.Sockets.SocketTransportFactory.BindAsync(EndPoint endpoint, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Infrastructure.TransportManager.BindAsync(EndPoint endPoint, ConnectionDelegate connectionDelegate, EndpointConfig endpointConfig, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Core.KestrelServerImpl.<>c__DisplayClass28_0`1.<<StartAsync>g__OnBind|0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.AddressBinder.BindEndpointAsync(ListenOptions endpoint, AddressBindContext context, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.AddressBinder.BindEndpointAsync(ListenOptions endpoint, AddressBindContext context, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Core.LocalhostListenOptions.BindAsync(AddressBindContext context, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.AddressBinder.AddressesStrategy.BindAsync(AddressBindContext context, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Core.KestrelServerImpl.BindAsync(CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Core.KestrelServerImpl.StartAsync[TContext](IHttpApplication`1 application, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Hosting.GenericWebHostService.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.Internal.Host.<StartAsync>b__14_1(IHostedService service, CancellationToken token)
   at Microsoft.Extensions.Hosting.Internal.Host.ForeachService[T](IEnumerable`1 services, CancellationToken token, Boolean concurrent, Boolean abortOnFirstException, List`1 exceptions, Func`3 operation)
2025-07-30 13:41:54.864 +08:00 [FTL] Application start-up failed
System.IO.IOException: Failed to bind to address http://127.0.0.1:5295: address already in use.
 ---> Microsoft.AspNetCore.Connections.AddressInUseException: Only one usage of each socket address (protocol/network address/port) is normally permitted.
 ---> System.Net.Sockets.SocketException (10048): Only one usage of each socket address (protocol/network address/port) is normally permitted.
   at System.Net.Sockets.Socket.UpdateStatusAfterSocketErrorAndThrowException(SocketError error, Boolean disconnectOnFailure, String callerName)
   at System.Net.Sockets.Socket.DoBind(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Bind(EndPoint localEP)
   at Microsoft.AspNetCore.Server.Kestrel.Transport.Sockets.SocketTransportOptions.CreateDefaultBoundListenSocket(EndPoint endpoint)
   at Microsoft.AspNetCore.Server.Kestrel.Transport.Sockets.SocketConnectionListener.Bind()
   --- End of inner exception stack trace ---
   at Microsoft.AspNetCore.Server.Kestrel.Transport.Sockets.SocketConnectionListener.Bind()
   at Microsoft.AspNetCore.Server.Kestrel.Transport.Sockets.SocketTransportFactory.BindAsync(EndPoint endpoint, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Infrastructure.TransportManager.BindAsync(EndPoint endPoint, ConnectionDelegate connectionDelegate, EndpointConfig endpointConfig, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Core.KestrelServerImpl.<>c__DisplayClass28_0`1.<<StartAsync>g__OnBind|0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.AddressBinder.BindEndpointAsync(ListenOptions endpoint, AddressBindContext context, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.AddressBinder.BindEndpointAsync(ListenOptions endpoint, AddressBindContext context, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Core.LocalhostListenOptions.BindAsync(AddressBindContext context, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.AddressBinder.AddressesStrategy.BindAsync(AddressBindContext context, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Core.KestrelServerImpl.BindAsync(CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Core.KestrelServerImpl.StartAsync[TContext](IHttpApplication`1 application, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Hosting.GenericWebHostService.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.Internal.Host.<StartAsync>b__14_1(IHostedService service, CancellationToken token)
   at Microsoft.Extensions.Hosting.Internal.Host.ForeachService[T](IEnumerable`1 services, CancellationToken token, Boolean concurrent, Boolean abortOnFirstException, List`1 exceptions, Func`3 operation)
   at Microsoft.Extensions.Hosting.Internal.Host.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.RunAsync(IHost host, CancellationToken token)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.RunAsync(IHost host, CancellationToken token)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.Run(IHost host)
   at Program.<Main>$(String[] args) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Program.cs:line 249
2025-07-30 13:44:52.279 +08:00 [INF] Checking database connection...
2025-07-30 13:44:52.856 +08:00 [INF] Database connection successful.
2025-07-30 13:44:52.857 +08:00 [INF] Attempting to apply migrations...
2025-07-30 13:44:53.036 +08:00 [INF] Executed DbCommand (11ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-07-30 13:44:53.261 +08:00 [WRN] Migration failed. This might be due to pending model changes. Continuing anyway...
System.InvalidOperationException: An error was generated for warning 'Microsoft.EntityFrameworkCore.Migrations.PendingModelChangesWarning': The model for context 'ApplicationDbContext' has pending changes. Add a new migration before updating the database. See https://aka.ms/efcore-docs-pending-changes. This exception can be suppressed or logged by passing event ID 'RelationalEventId.PendingModelChangesWarning' to the 'ConfigureWarnings' method in 'DbContext.OnConfiguring' or 'AddDbContext'.
   at Microsoft.EntityFrameworkCore.Diagnostics.EventDefinition`1.Log[TLoggerCategory](IDiagnosticsLogger`1 logger, TParam arg)
   at Microsoft.EntityFrameworkCore.Diagnostics.RelationalLoggerExtensions.PendingModelChangesWarning(IDiagnosticsLogger`1 diagnostics, Type contextType)
   at Microsoft.EntityFrameworkCore.Migrations.Internal.Migrator.ValidateMigrations(Boolean useTransaction, String targetMigration)
   at Microsoft.EntityFrameworkCore.Migrations.Internal.Migrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Program.cs:line 222
2025-07-30 13:44:53.271 +08:00 [INF] Starting data seeding...
2025-07-30 13:44:53.284 +08:00 [INF] User profile is available. Using 'C:\Users\User\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-07-30 13:44:53.397 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Courses" AS c)
2025-07-30 13:44:53.400 +08:00 [INF] Database already contains data. Skipping seed.
2025-07-30 13:44:53.400 +08:00 [INF] Data seeding completed.
2025-07-30 13:44:53.436 +08:00 [INF] Now listening on: http://localhost:5295
2025-07-30 13:44:53.436 +08:00 [INF] Application started. Press Ctrl+C to shut down.
2025-07-30 13:44:53.437 +08:00 [INF] Hosting environment: Development
2025-07-30 13:44:53.437 +08:00 [INF] Content root path: D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api
2025-07-30 13:45:08.942 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/platform - null null
2025-07-30 13:45:08.942 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/courses - null null
2025-07-30 13:45:08.944 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/platform - null null
2025-07-30 13:45:08.944 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/courses - null null
2025-07-30 13:45:08.985 +08:00 [WRN] Failed to determine the https port for redirect.
2025-07-30 13:45:08.986 +08:00 [INF] CORS policy execution successful.
2025-07-30 13:45:08.986 +08:00 [INF] CORS policy execution successful.
2025-07-30 13:45:08.986 +08:00 [INF] CORS policy execution successful.
2025-07-30 13:45:08.986 +08:00 [INF] CORS policy execution successful.
2025-07-30 13:45:08.991 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/platform - 204 null null 50.2933ms
2025-07-30 13:45:08.991 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/platform - 204 null null 46.6454ms
2025-07-30 13:45:08.991 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/courses - 204 null null 50.2776ms
2025-07-30 13:45:08.991 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/courses - 204 null null 46.6452ms
2025-07-30 13:45:08.997 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses - application/json null
2025-07-30 13:45:08.999 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/platform - application/json null
2025-07-30 13:45:09.004 +08:00 [INF] CORS policy execution successful.
2025-07-30 13:45:09.004 +08:00 [INF] CORS policy execution successful.
2025-07-30 13:45:09.133 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-30 13:45:09.135 +08:00 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-07-30 13:45:09.137 +08:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-07-30 13:45:09.138 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/platform - 401 0 null 139.0216ms
2025-07-30 13:45:09.141 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/platform - application/json null
2025-07-30 13:45:09.142 +08:00 [INF] CORS policy execution successful.
2025-07-30 13:45:09.145 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-30 13:45:09.180 +08:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '7/28/2025 5:58:43 PM', Current time (UTC): '7/30/2025 5:45:09 AM'.
   at Microsoft.IdentityModel.Tokens.ValidatorUtilities.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2025-07-30 13:45:09.183 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '7/28/2025 5:58:43 PM', Current time (UTC): '7/30/2025 5:45:09 AM'.
2025-07-30 13:45:09.184 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '7/28/2025 5:58:43 PM', Current time (UTC): '7/30/2025 5:45:09 AM'.
2025-07-30 13:45:09.276 +08:00 [INF] Executed DbCommand (13ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 13:45:09.278 +08:00 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-07-30 13:45:09.280 +08:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-07-30 13:45:09.281 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/platform - 401 0 null 140.6446ms
2025-07-30 13:45:09.301 +08:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2025-07-30 13:45:09.334 +08:00 [ERR] Failed executing DbCommand (3ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."IsPublished", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."PublishedAt", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."IsFlagged", r."Rating", r."Status", r."StudentId", e."Id", e."AverageQuizScore", e."CertificateIssued", e."CertificateUrl", e."CompletedAt", e."CompletedLessons", e."CourseId", e."EnrolledAt", e."LastAccessedDate", e."ProgressPercentage", e."QuizCount", e."StudentId", e."TotalTimeSpent"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."IsPublished", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."PublishedAt", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-30 13:45:09.356 +08:00 [ERR] An exception occurred while iterating over the results of a query for context type 'CeceLearningPortal.Api.Data.ApplicationDbContext'.
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 1526
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 1526
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 1526
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 1526
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 13:45:09.361 +08:00 [ERR] Error retrieving courses
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 1526
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at CeceLearningPortal.Api.Services.CourseService.GetAllCoursesAsync(CourseFilterDto filter) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Services\CourseService.cs:line 95
   at CeceLearningPortal.Api.Controllers.CoursesController.GetCourses(CourseFilterDto filter) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Controllers\CoursesController.cs:line 26
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 1526
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 13:45:09.369 +08:00 [INF] Executing ObjectResult, writing value of type '<>f__AnonymousType0`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 13:45:09.379 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses - application/json null
2025-07-30 13:45:09.380 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 232.6795ms
2025-07-30 13:45:09.380 +08:00 [INF] CORS policy execution successful.
2025-07-30 13:45:09.381 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-30 13:45:09.382 +08:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '7/28/2025 5:58:43 PM', Current time (UTC): '7/30/2025 5:45:09 AM'.
   at Microsoft.IdentityModel.Tokens.ValidatorUtilities.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2025-07-30 13:45:09.383 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '7/28/2025 5:58:43 PM', Current time (UTC): '7/30/2025 5:45:09 AM'.
2025-07-30 13:45:09.384 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses - 500 null application/json; charset=utf-8 386.8689ms
2025-07-30 13:45:09.384 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '7/28/2025 5:58:43 PM', Current time (UTC): '7/30/2025 5:45:09 AM'.
2025-07-30 13:45:09.390 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 13:45:09.391 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-30 13:45:09.392 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-30 13:45:09.394 +08:00 [ERR] Failed executing DbCommand (0ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."IsPublished", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."PublishedAt", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."IsFlagged", r."Rating", r."Status", r."StudentId", e."Id", e."AverageQuizScore", e."CertificateIssued", e."CertificateUrl", e."CompletedAt", e."CompletedLessons", e."CourseId", e."EnrolledAt", e."LastAccessedDate", e."ProgressPercentage", e."QuizCount", e."StudentId", e."TotalTimeSpent"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."IsPublished", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."PublishedAt", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-30 13:45:09.397 +08:00 [ERR] An exception occurred while iterating over the results of a query for context type 'CeceLearningPortal.Api.Data.ApplicationDbContext'.
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 1526
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 1526
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 1526
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 1526
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 13:45:09.414 +08:00 [ERR] Error retrieving courses
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 1526
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at CeceLearningPortal.Api.Services.CourseService.GetAllCoursesAsync(CourseFilterDto filter) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Services\CourseService.cs:line 95
   at CeceLearningPortal.Api.Controllers.CoursesController.GetCourses(CourseFilterDto filter) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Controllers\CoursesController.cs:line 26
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 1526
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 13:45:09.419 +08:00 [INF] Executing ObjectResult, writing value of type '<>f__AnonymousType0`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 13:45:09.420 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 27.6659ms
2025-07-30 13:45:09.421 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-30 13:45:09.421 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses - 500 null application/json; charset=utf-8 42.1423ms
2025-07-30 13:45:14.265 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/platform - null null
2025-07-30 13:45:14.267 +08:00 [INF] CORS policy execution successful.
2025-07-30 13:45:14.268 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/platform - 204 null null 2.2682ms
2025-07-30 13:45:14.269 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/platform - application/json null
2025-07-30 13:45:14.270 +08:00 [INF] CORS policy execution successful.
2025-07-30 13:45:14.271 +08:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '7/28/2025 5:58:43 PM', Current time (UTC): '7/30/2025 5:45:14 AM'.
   at Microsoft.IdentityModel.Tokens.ValidatorUtilities.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2025-07-30 13:45:14.273 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '7/28/2025 5:58:43 PM', Current time (UTC): '7/30/2025 5:45:14 AM'.
2025-07-30 13:45:14.273 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '7/28/2025 5:58:43 PM', Current time (UTC): '7/30/2025 5:45:14 AM'.
2025-07-30 13:45:14.276 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 13:45:14.278 +08:00 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-07-30 13:45:14.279 +08:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-07-30 13:45:14.280 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/platform - 401 0 null 10.3215ms
2025-07-30 13:45:15.712 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/subscriptions - null null
2025-07-30 13:45:15.714 +08:00 [INF] CORS policy execution successful.
2025-07-30 13:45:15.714 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/subscriptions - 204 null null 1.9647ms
2025-07-30 13:45:15.716 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/subscriptions - application/json null
2025-07-30 13:45:15.718 +08:00 [INF] CORS policy execution successful.
2025-07-30 13:45:15.719 +08:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '7/28/2025 5:58:43 PM', Current time (UTC): '7/30/2025 5:45:15 AM'.
   at Microsoft.IdentityModel.Tokens.ValidatorUtilities.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2025-07-30 13:45:15.720 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '7/28/2025 5:58:43 PM', Current time (UTC): '7/30/2025 5:45:15 AM'.
2025-07-30 13:45:15.721 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '7/28/2025 5:58:43 PM', Current time (UTC): '7/30/2025 5:45:15 AM'.
2025-07-30 13:45:15.723 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 13:45:15.724 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/subscriptions - 404 0 null 8.1019ms
2025-07-30 13:45:15.726 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5295/api/admin/subscriptions, Response status code: 404
2025-07-30 13:45:18.602 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/courses - null null
2025-07-30 13:45:18.604 +08:00 [INF] CORS policy execution successful.
2025-07-30 13:45:18.604 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/courses - 204 null null 2.0497ms
2025-07-30 13:45:18.606 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses - application/json null
2025-07-30 13:45:18.607 +08:00 [INF] CORS policy execution successful.
2025-07-30 13:45:18.607 +08:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '7/28/2025 5:58:43 PM', Current time (UTC): '7/30/2025 5:45:18 AM'.
   at Microsoft.IdentityModel.Tokens.ValidatorUtilities.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2025-07-30 13:45:18.608 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '7/28/2025 5:58:43 PM', Current time (UTC): '7/30/2025 5:45:18 AM'.
2025-07-30 13:45:18.609 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '7/28/2025 5:58:43 PM', Current time (UTC): '7/30/2025 5:45:18 AM'.
2025-07-30 13:45:18.611 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 13:45:18.612 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-30 13:45:18.613 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-30 13:45:18.615 +08:00 [ERR] Failed executing DbCommand (0ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."IsPublished", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."PublishedAt", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."IsFlagged", r."Rating", r."Status", r."StudentId", e."Id", e."AverageQuizScore", e."CertificateIssued", e."CertificateUrl", e."CompletedAt", e."CompletedLessons", e."CourseId", e."EnrolledAt", e."LastAccessedDate", e."ProgressPercentage", e."QuizCount", e."StudentId", e."TotalTimeSpent"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."IsPublished", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."PublishedAt", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-30 13:45:18.618 +08:00 [ERR] An exception occurred while iterating over the results of a query for context type 'CeceLearningPortal.Api.Data.ApplicationDbContext'.
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 1526
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 1526
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 1526
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 1526
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 13:45:18.622 +08:00 [ERR] Error retrieving courses
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 1526
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at CeceLearningPortal.Api.Services.CourseService.GetAllCoursesAsync(CourseFilterDto filter) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Services\CourseService.cs:line 95
   at CeceLearningPortal.Api.Controllers.CoursesController.GetCourses(CourseFilterDto filter) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Controllers\CoursesController.cs:line 26
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 1526
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 13:45:18.626 +08:00 [INF] Executing ObjectResult, writing value of type '<>f__AnonymousType0`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 13:45:18.627 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 13.3153ms
2025-07-30 13:45:18.627 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-30 13:45:18.628 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses - 500 null application/json; charset=utf-8 22.2595ms
2025-07-30 13:45:20.786 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users - null null
2025-07-30 13:45:20.786 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/subscription-plans - null null
2025-07-30 13:45:20.789 +08:00 [INF] CORS policy execution successful.
2025-07-30 13:45:20.790 +08:00 [INF] CORS policy execution successful.
2025-07-30 13:45:20.790 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users - 204 null null 3.8642ms
2025-07-30 13:45:20.791 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/subscription-plans - 204 null null 4.1417ms
2025-07-30 13:45:20.793 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/subscription-plans - application/json null
2025-07-30 13:45:20.794 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users - application/json null
2025-07-30 13:45:20.795 +08:00 [INF] CORS policy execution successful.
2025-07-30 13:45:20.796 +08:00 [INF] CORS policy execution successful.
2025-07-30 13:45:20.796 +08:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '7/28/2025 5:58:43 PM', Current time (UTC): '7/30/2025 5:45:20 AM'.
   at Microsoft.IdentityModel.Tokens.ValidatorUtilities.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2025-07-30 13:45:20.797 +08:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '7/28/2025 5:58:43 PM', Current time (UTC): '7/30/2025 5:45:20 AM'.
   at Microsoft.IdentityModel.Tokens.ValidatorUtilities.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2025-07-30 13:45:20.798 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '7/28/2025 5:58:43 PM', Current time (UTC): '7/30/2025 5:45:20 AM'.
2025-07-30 13:45:20.799 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '7/28/2025 5:58:43 PM', Current time (UTC): '7/30/2025 5:45:20 AM'.
2025-07-30 13:45:20.800 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '7/28/2025 5:58:43 PM', Current time (UTC): '7/30/2025 5:45:20 AM'.
2025-07-30 13:45:20.800 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '7/28/2025 5:58:43 PM', Current time (UTC): '7/30/2025 5:45:20 AM'.
2025-07-30 13:45:20.802 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 13:45:20.804 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-07-30 13:45:20.804 +08:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-07-30 13:45:20.805 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/subscription-plans - 401 0 null 12.0639ms
2025-07-30 13:45:20.845 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 13:45:20.846 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-07-30 13:45:20.846 +08:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-07-30 13:45:20.847 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users - 401 0 null 53.1204ms
2025-07-30 13:45:22.947 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses - application/json null
2025-07-30 13:45:22.948 +08:00 [INF] CORS policy execution successful.
2025-07-30 13:45:22.949 +08:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '7/28/2025 5:58:43 PM', Current time (UTC): '7/30/2025 5:45:22 AM'.
   at Microsoft.IdentityModel.Tokens.ValidatorUtilities.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2025-07-30 13:45:22.950 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '7/28/2025 5:58:43 PM', Current time (UTC): '7/30/2025 5:45:22 AM'.
2025-07-30 13:45:22.951 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '7/28/2025 5:58:43 PM', Current time (UTC): '7/30/2025 5:45:22 AM'.
2025-07-30 13:45:22.952 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 13:45:22.954 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-30 13:45:22.954 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-30 13:45:22.956 +08:00 [ERR] Failed executing DbCommand (1ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."IsPublished", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."PublishedAt", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."IsFlagged", r."Rating", r."Status", r."StudentId", e."Id", e."AverageQuizScore", e."CertificateIssued", e."CertificateUrl", e."CompletedAt", e."CompletedLessons", e."CourseId", e."EnrolledAt", e."LastAccessedDate", e."ProgressPercentage", e."QuizCount", e."StudentId", e."TotalTimeSpent"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."IsPublished", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."PublishedAt", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-30 13:45:22.958 +08:00 [ERR] An exception occurred while iterating over the results of a query for context type 'CeceLearningPortal.Api.Data.ApplicationDbContext'.
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 1526
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 1526
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 1526
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 1526
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 13:45:22.962 +08:00 [ERR] Error retrieving courses
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 1526
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at CeceLearningPortal.Api.Services.CourseService.GetAllCoursesAsync(CourseFilterDto filter) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Services\CourseService.cs:line 95
   at CeceLearningPortal.Api.Controllers.CoursesController.GetCourses(CourseFilterDto filter) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Controllers\CoursesController.cs:line 26
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 1526
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 13:45:22.966 +08:00 [INF] Executing ObjectResult, writing value of type '<>f__AnonymousType0`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 13:45:22.967 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 12.2284ms
2025-07-30 13:45:22.968 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-30 13:45:22.969 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses - 500 null application/json; charset=utf-8 21.8024ms
2025-07-30 13:45:24.412 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/subscription-plans - application/json null
2025-07-30 13:45:24.412 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users - application/json null
2025-07-30 13:45:24.413 +08:00 [INF] CORS policy execution successful.
2025-07-30 13:45:24.414 +08:00 [INF] CORS policy execution successful.
2025-07-30 13:45:24.415 +08:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '7/28/2025 5:58:43 PM', Current time (UTC): '7/30/2025 5:45:24 AM'.
   at Microsoft.IdentityModel.Tokens.ValidatorUtilities.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2025-07-30 13:45:24.415 +08:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '7/28/2025 5:58:43 PM', Current time (UTC): '7/30/2025 5:45:24 AM'.
   at Microsoft.IdentityModel.Tokens.ValidatorUtilities.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2025-07-30 13:45:24.416 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '7/28/2025 5:58:43 PM', Current time (UTC): '7/30/2025 5:45:24 AM'.
2025-07-30 13:45:24.417 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '7/28/2025 5:58:43 PM', Current time (UTC): '7/30/2025 5:45:24 AM'.
2025-07-30 13:45:24.417 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '7/28/2025 5:58:43 PM', Current time (UTC): '7/30/2025 5:45:24 AM'.
2025-07-30 13:45:24.418 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '7/28/2025 5:58:43 PM', Current time (UTC): '7/30/2025 5:45:24 AM'.
2025-07-30 13:45:24.420 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 13:45:24.420 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 13:45:24.421 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-07-30 13:45:24.421 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-07-30 13:45:24.422 +08:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-07-30 13:45:24.422 +08:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-07-30 13:45:24.423 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/subscription-plans - 401 0 null 10.7443ms
2025-07-30 13:45:24.423 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users - 401 0 null 11.2178ms
2025-07-30 13:45:25.521 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/courses - null null
2025-07-30 13:45:25.522 +08:00 [INF] CORS policy execution successful.
2025-07-30 13:45:25.523 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/courses - 204 null null 1.7138ms
2025-07-30 13:45:25.524 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses - application/json null
2025-07-30 13:45:25.525 +08:00 [INF] CORS policy execution successful.
2025-07-30 13:45:25.525 +08:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '7/28/2025 5:58:43 PM', Current time (UTC): '7/30/2025 5:45:25 AM'.
   at Microsoft.IdentityModel.Tokens.ValidatorUtilities.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2025-07-30 13:45:25.527 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '7/28/2025 5:58:43 PM', Current time (UTC): '7/30/2025 5:45:25 AM'.
2025-07-30 13:45:25.527 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '7/28/2025 5:58:43 PM', Current time (UTC): '7/30/2025 5:45:25 AM'.
2025-07-30 13:45:25.529 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 13:45:25.530 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-30 13:45:25.530 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-30 13:45:25.532 +08:00 [ERR] Failed executing DbCommand (0ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."IsPublished", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."PublishedAt", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."IsFlagged", r."Rating", r."Status", r."StudentId", e."Id", e."AverageQuizScore", e."CertificateIssued", e."CertificateUrl", e."CompletedAt", e."CompletedLessons", e."CourseId", e."EnrolledAt", e."LastAccessedDate", e."ProgressPercentage", e."QuizCount", e."StudentId", e."TotalTimeSpent"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."IsPublished", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."PublishedAt", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-30 13:45:25.535 +08:00 [ERR] An exception occurred while iterating over the results of a query for context type 'CeceLearningPortal.Api.Data.ApplicationDbContext'.
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 1526
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 1526
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 1526
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 1526
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 13:45:25.539 +08:00 [ERR] Error retrieving courses
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 1526
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at CeceLearningPortal.Api.Services.CourseService.GetAllCoursesAsync(CourseFilterDto filter) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Services\CourseService.cs:line 95
   at CeceLearningPortal.Api.Controllers.CoursesController.GetCourses(CourseFilterDto filter) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Controllers\CoursesController.cs:line 26
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 1526
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 13:45:25.543 +08:00 [INF] Executing ObjectResult, writing value of type '<>f__AnonymousType0`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 13:45:25.544 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 12.9283ms
2025-07-30 13:45:25.545 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-30 13:45:25.545 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses - 500 null application/json; charset=utf-8 21.254ms
2025-07-30 13:45:28.579 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/subscription-plans - null null
2025-07-30 13:45:28.580 +08:00 [INF] CORS policy execution successful.
2025-07-30 13:45:28.581 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/subscription-plans - 204 null null 1.7543ms
2025-07-30 13:45:28.582 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/subscription-plans - application/json null
2025-07-30 13:45:28.584 +08:00 [INF] CORS policy execution successful.
2025-07-30 13:45:28.584 +08:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '7/28/2025 5:58:43 PM', Current time (UTC): '7/30/2025 5:45:28 AM'.
   at Microsoft.IdentityModel.Tokens.ValidatorUtilities.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2025-07-30 13:45:28.585 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '7/28/2025 5:58:43 PM', Current time (UTC): '7/30/2025 5:45:28 AM'.
2025-07-30 13:45:28.586 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '7/28/2025 5:58:43 PM', Current time (UTC): '7/30/2025 5:45:28 AM'.
2025-07-30 13:45:28.588 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 13:45:28.589 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-07-30 13:45:28.589 +08:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-07-30 13:45:28.589 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/subscription-plans - 401 0 null 7.2021ms
2025-07-30 13:45:31.238 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/subscriptions - null null
2025-07-30 13:45:31.239 +08:00 [INF] CORS policy execution successful.
2025-07-30 13:45:31.239 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/subscriptions - 204 null null 1.6106ms
2025-07-30 13:45:31.241 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/subscriptions - application/json null
2025-07-30 13:45:31.242 +08:00 [INF] CORS policy execution successful.
2025-07-30 13:45:31.242 +08:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '7/28/2025 5:58:43 PM', Current time (UTC): '7/30/2025 5:45:31 AM'.
   at Microsoft.IdentityModel.Tokens.ValidatorUtilities.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2025-07-30 13:45:31.244 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '7/28/2025 5:58:43 PM', Current time (UTC): '7/30/2025 5:45:31 AM'.
2025-07-30 13:45:31.244 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '7/28/2025 5:58:43 PM', Current time (UTC): '7/30/2025 5:45:31 AM'.
2025-07-30 13:45:31.246 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 13:45:31.247 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/subscriptions - 404 0 null 5.8404ms
2025-07-30 13:45:31.248 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5295/api/admin/subscriptions, Response status code: 404
2025-07-30 13:45:34.836 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/courses - null null
2025-07-30 13:45:34.837 +08:00 [INF] CORS policy execution successful.
2025-07-30 13:45:34.838 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/courses - 204 null null 1.7448ms
2025-07-30 13:45:34.839 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses - application/json null
2025-07-30 13:45:34.840 +08:00 [INF] CORS policy execution successful.
2025-07-30 13:45:34.841 +08:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '7/28/2025 5:58:43 PM', Current time (UTC): '7/30/2025 5:45:34 AM'.
   at Microsoft.IdentityModel.Tokens.ValidatorUtilities.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2025-07-30 13:45:34.842 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '7/28/2025 5:58:43 PM', Current time (UTC): '7/30/2025 5:45:34 AM'.
2025-07-30 13:45:34.843 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '7/28/2025 5:58:43 PM', Current time (UTC): '7/30/2025 5:45:34 AM'.
2025-07-30 13:45:34.844 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 13:45:34.845 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-30 13:45:34.846 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-30 13:45:34.848 +08:00 [ERR] Failed executing DbCommand (0ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."IsPublished", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."PublishedAt", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."IsFlagged", r."Rating", r."Status", r."StudentId", e."Id", e."AverageQuizScore", e."CertificateIssued", e."CertificateUrl", e."CompletedAt", e."CompletedLessons", e."CourseId", e."EnrolledAt", e."LastAccessedDate", e."ProgressPercentage", e."QuizCount", e."StudentId", e."TotalTimeSpent"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."IsPublished", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."PublishedAt", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-30 13:45:34.850 +08:00 [ERR] An exception occurred while iterating over the results of a query for context type 'CeceLearningPortal.Api.Data.ApplicationDbContext'.
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 1526
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 1526
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 1526
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 1526
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 13:45:34.854 +08:00 [ERR] Error retrieving courses
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 1526
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at CeceLearningPortal.Api.Services.CourseService.GetAllCoursesAsync(CourseFilterDto filter) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Services\CourseService.cs:line 95
   at CeceLearningPortal.Api.Controllers.CoursesController.GetCourses(CourseFilterDto filter) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Controllers\CoursesController.cs:line 26
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 1526
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 13:45:34.858 +08:00 [INF] Executing ObjectResult, writing value of type '<>f__AnonymousType0`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 13:45:34.858 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 11.9785ms
2025-07-30 13:45:34.859 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-30 13:45:34.860 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses - 500 null application/json; charset=utf-8 20.2005ms
2025-07-30 13:45:38.835 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/auth/logout - null null
2025-07-30 13:45:38.836 +08:00 [INF] CORS policy execution successful.
2025-07-30 13:45:38.836 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/auth/logout - 204 null null 1.6892ms
2025-07-30 13:45:38.838 +08:00 [INF] Request starting HTTP/1.1 POST http://localhost:5295/api/auth/logout - application/json 0
2025-07-30 13:45:38.839 +08:00 [INF] CORS policy execution successful.
2025-07-30 13:45:38.840 +08:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '7/28/2025 5:58:43 PM', Current time (UTC): '7/30/2025 5:45:38 AM'.
   at Microsoft.IdentityModel.Tokens.ValidatorUtilities.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2025-07-30 13:45:38.841 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '7/28/2025 5:58:43 PM', Current time (UTC): '7/30/2025 5:45:38 AM'.
2025-07-30 13:45:38.842 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '7/28/2025 5:58:43 PM', Current time (UTC): '7/30/2025 5:45:38 AM'.
2025-07-30 13:45:38.843 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 13:45:38.844 +08:00 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
2025-07-30 13:45:38.845 +08:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-07-30 13:45:38.845 +08:00 [INF] Request finished HTTP/1.1 POST http://localhost:5295/api/auth/logout - 401 0 null 7.5357ms
2025-07-30 13:45:41.253 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/auth/login - null null
2025-07-30 13:45:41.255 +08:00 [INF] CORS policy execution successful.
2025-07-30 13:45:41.255 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/auth/login - 204 null null 1.7389ms
2025-07-30 13:45:41.257 +08:00 [INF] Request starting HTTP/1.1 POST http://localhost:5295/api/auth/login - application/json 51
2025-07-30 13:45:41.258 +08:00 [INF] CORS policy execution successful.
2025-07-30 13:45:41.259 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AuthController.Login (CeceLearningPortal.Api)'
2025-07-30 13:45:41.262 +08:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(CeceLearningPortal.Api.DTOs.LoginDto) on controller CeceLearningPortal.Api.Controllers.AuthController (CeceLearningPortal.Api).
2025-07-30 13:45:41.432 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[@__normalizedEmail_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."NormalizedEmail" = @__normalizedEmail_0
LIMIT 2
2025-07-30 13:45:41.626 +08:00 [INF] Executed DbCommand (8ms) [Parameters=[@p1='?', @p2='?', @p0='?' (DbType = DateTime), @p3='?' (DbType = DateTime), @p4='?', @p5='?' (DbType = DateTime), @p6='?', @p7='?' (DbType = DateTime), @p8='?', @p9='?', @p10='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE "AspNetUsers" SET "LastLoginAt" = @p0
WHERE "Id" = @p1 AND "ConcurrencyStamp" = @p2;
INSERT INTO "RefreshTokens" ("CreatedAt", "CreatedByIp", "ExpiresAt", "ReplacedByToken", "RevokedAt", "RevokedByIp", "Token", "UserId")
VALUES (@p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10)
RETURNING "Id";
2025-07-30 13:45:41.642 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.AuthResponseDto'.
2025-07-30 13:45:41.647 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AuthController.Login (CeceLearningPortal.Api) in 384.3553ms
2025-07-30 13:45:41.648 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AuthController.Login (CeceLearningPortal.Api)'
2025-07-30 13:45:41.648 +08:00 [INF] Request finished HTTP/1.1 POST http://localhost:5295/api/auth/login - 200 null application/json; charset=utf-8 391.2463ms
2025-07-30 13:45:41.664 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/courses - null null
2025-07-30 13:45:41.664 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/platform - null null
2025-07-30 13:45:41.665 +08:00 [INF] CORS policy execution successful.
2025-07-30 13:45:41.666 +08:00 [INF] CORS policy execution successful.
2025-07-30 13:45:41.667 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/courses - 204 null null 3.1024ms
2025-07-30 13:45:41.667 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/platform - 204 null null 3.2998ms
2025-07-30 13:45:41.669 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses - application/json null
2025-07-30 13:45:41.670 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/platform - application/json null
2025-07-30 13:45:41.671 +08:00 [INF] CORS policy execution successful.
2025-07-30 13:45:41.672 +08:00 [INF] CORS policy execution successful.
2025-07-30 13:45:41.679 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 13:45:41.679 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 13:45:41.680 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-07-30 13:45:41.681 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-30 13:45:41.682 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-30 13:45:41.683 +08:00 [INF] Route matched with {action = "GetPlatformAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPlatformAnalytics() on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-30 13:45:41.684 +08:00 [ERR] Failed executing DbCommand (1ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."IsPublished", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."PublishedAt", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."IsFlagged", r."Rating", r."Status", r."StudentId", e."Id", e."AverageQuizScore", e."CertificateIssued", e."CertificateUrl", e."CompletedAt", e."CompletedLessons", e."CourseId", e."EnrolledAt", e."LastAccessedDate", e."ProgressPercentage", e."QuizCount", e."StudentId", e."TotalTimeSpent"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."IsPublished", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."PublishedAt", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-30 13:45:41.686 +08:00 [ERR] An exception occurred while iterating over the results of a query for context type 'CeceLearningPortal.Api.Data.ApplicationDbContext'.
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 1526
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 1526
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 1526
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 1526
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 13:45:41.691 +08:00 [ERR] Error retrieving courses
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 1526
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at CeceLearningPortal.Api.Services.CourseService.GetAllCoursesAsync(CourseFilterDto filter) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Services\CourseService.cs:line 95
   at CeceLearningPortal.Api.Controllers.CoursesController.GetCourses(CourseFilterDto filter) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Controllers\CoursesController.cs:line 26
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 1526
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 13:45:41.695 +08:00 [INF] Executing ObjectResult, writing value of type '<>f__AnonymousType0`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 13:45:41.695 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
2025-07-30 13:45:41.696 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 13.3889ms
2025-07-30 13:45:41.697 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-30 13:45:41.698 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses - 500 null application/json; charset=utf-8 28.8744ms
2025-07-30 13:45:41.700 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
2025-07-30 13:45:41.711 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."Status" = 'Completed'
2025-07-30 13:45:41.720 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
2025-07-30 13:45:41.746 +08:00 [INF] Executed DbCommand (5ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id" AS "instructorId", a."FullName" AS "instructorName", (
    SELECT count(*)::int
    FROM "Courses" AS c0
    WHERE c0."InstructorId" = a."Id") AS "totalCourses", (
    SELECT count(*)::int
    FROM "Enrollments" AS e
    INNER JOIN "Courses" AS c1 ON e."CourseId" = c1."Id"
    WHERE c1."InstructorId" = a."Id") AS "totalStudents", (
    SELECT COALESCE(sum(p0."Amount"), 0.0)
    FROM "Payments" AS p0
    LEFT JOIN "Courses" AS c2 ON p0."CourseId" = c2."Id"
    WHERE c2."InstructorId" = a."Id" AND p0."Status" = 'Completed') AS "totalRevenue", COALESCE((
    SELECT avg(r."Rating"::double precision)
    FROM "Reviews" AS r
    INNER JOIN "Courses" AS c3 ON r."CourseId" = c3."Id"
    WHERE c3."InstructorId" = a."Id"), 0.0) AS "averageRating"
FROM "AspNetUsers" AS a
WHERE a."Role" = 'Instructor'
ORDER BY (
    SELECT COALESCE(sum(p."Amount"), 0.0)
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
    WHERE c."InstructorId" = a."Id" AND p."Status" = 'Completed') DESC
LIMIT @__p_0
2025-07-30 13:45:41.766 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT c."Category" AS category, count(*)::int AS "courseCount", COALESCE(sum((
    SELECT count(*)::int
    FROM "Enrollments" AS e
    WHERE c."Id" = e."CourseId")), 0)::int AS "enrollmentCount", (
    SELECT COALESCE(sum(p."Amount"), 0.0)
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c0 ON p."CourseId" = c0."Id"
    WHERE c0."Category" = c."Category" AND p."Status" = 'Completed') AS revenue
FROM "Courses" AS c
GROUP BY c."Category"
ORDER BY COALESCE(sum((
    SELECT count(*)::int
    FROM "Enrollments" AS e
    WHERE c."Id" = e."CourseId")), 0)::int DESC
2025-07-30 13:45:41.775 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT p0."Year", p0."Month", COALESCE(sum(p0."Amount"), 0.0) AS "Revenue", count(*)::int AS "TransactionCount"
FROM (
    SELECT p."Amount", date_part('year', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "Payments" AS p
    WHERE p."Status" = 'Completed' AND p."CreatedAt" >= @__sixMonthsAgo_0
) AS p0
GROUP BY p0."Year", p0."Month"
2025-07-30 13:45:41.782 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT a0."Year", a0."Month", count(*)::int AS "NewUsers"
FROM (
    SELECT date_part('year', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "AspNetUsers" AS a
    WHERE a."CreatedAt" >= @__sixMonthsAgo_0
) AS a0
GROUP BY a0."Year", a0."Month"
2025-07-30 13:45:41.790 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Subscriptions" AS s
WHERE s."Status" = 'Active'
2025-07-30 13:45:41.796 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s."PlanName" AS plan, count(*)::int AS count, COALESCE(sum(s."Price"), 0.0) AS "monthlyRevenue"
FROM "Subscriptions" AS s
WHERE s."Status" = 'Active'
GROUP BY s."PlanName"
2025-07-30 13:45:41.798 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType9`6[[<>f__AnonymousType10`5[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 13:45:41.809 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api) in 124.7395ms
2025-07-30 13:45:41.810 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-07-30 13:45:41.810 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/platform - 200 null application/json; charset=utf-8 139.9096ms
2025-07-30 13:45:43.944 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/platform - application/json null
2025-07-30 13:45:43.945 +08:00 [INF] CORS policy execution successful.
2025-07-30 13:45:43.947 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 13:45:43.948 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-07-30 13:45:43.948 +08:00 [INF] Route matched with {action = "GetPlatformAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPlatformAnalytics() on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-30 13:45:43.950 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
2025-07-30 13:45:43.951 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
2025-07-30 13:45:43.953 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."Status" = 'Completed'
2025-07-30 13:45:43.954 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
2025-07-30 13:45:43.957 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id" AS "instructorId", a."FullName" AS "instructorName", (
    SELECT count(*)::int
    FROM "Courses" AS c0
    WHERE c0."InstructorId" = a."Id") AS "totalCourses", (
    SELECT count(*)::int
    FROM "Enrollments" AS e
    INNER JOIN "Courses" AS c1 ON e."CourseId" = c1."Id"
    WHERE c1."InstructorId" = a."Id") AS "totalStudents", (
    SELECT COALESCE(sum(p0."Amount"), 0.0)
    FROM "Payments" AS p0
    LEFT JOIN "Courses" AS c2 ON p0."CourseId" = c2."Id"
    WHERE c2."InstructorId" = a."Id" AND p0."Status" = 'Completed') AS "totalRevenue", COALESCE((
    SELECT avg(r."Rating"::double precision)
    FROM "Reviews" AS r
    INNER JOIN "Courses" AS c3 ON r."CourseId" = c3."Id"
    WHERE c3."InstructorId" = a."Id"), 0.0) AS "averageRating"
FROM "AspNetUsers" AS a
WHERE a."Role" = 'Instructor'
ORDER BY (
    SELECT COALESCE(sum(p."Amount"), 0.0)
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
    WHERE c."InstructorId" = a."Id" AND p."Status" = 'Completed') DESC
LIMIT @__p_0
2025-07-30 13:45:43.960 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT c."Category" AS category, count(*)::int AS "courseCount", COALESCE(sum((
    SELECT count(*)::int
    FROM "Enrollments" AS e
    WHERE c."Id" = e."CourseId")), 0)::int AS "enrollmentCount", (
    SELECT COALESCE(sum(p."Amount"), 0.0)
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c0 ON p."CourseId" = c0."Id"
    WHERE c0."Category" = c."Category" AND p."Status" = 'Completed') AS revenue
FROM "Courses" AS c
GROUP BY c."Category"
ORDER BY COALESCE(sum((
    SELECT count(*)::int
    FROM "Enrollments" AS e
    WHERE c."Id" = e."CourseId")), 0)::int DESC
2025-07-30 13:45:43.961 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT p0."Year", p0."Month", COALESCE(sum(p0."Amount"), 0.0) AS "Revenue", count(*)::int AS "TransactionCount"
FROM (
    SELECT p."Amount", date_part('year', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "Payments" AS p
    WHERE p."Status" = 'Completed' AND p."CreatedAt" >= @__sixMonthsAgo_0
) AS p0
GROUP BY p0."Year", p0."Month"
2025-07-30 13:45:43.962 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT a0."Year", a0."Month", count(*)::int AS "NewUsers"
FROM (
    SELECT date_part('year', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "AspNetUsers" AS a
    WHERE a."CreatedAt" >= @__sixMonthsAgo_0
) AS a0
GROUP BY a0."Year", a0."Month"
2025-07-30 13:45:43.964 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Subscriptions" AS s
WHERE s."Status" = 'Active'
2025-07-30 13:45:43.965 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s."PlanName" AS plan, count(*)::int AS count, COALESCE(sum(s."Price"), 0.0) AS "monthlyRevenue"
FROM "Subscriptions" AS s
WHERE s."Status" = 'Active'
GROUP BY s."PlanName"
2025-07-30 13:45:43.966 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType9`6[[<>f__AnonymousType10`5[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 13:45:43.967 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api) in 17.592ms
2025-07-30 13:45:43.968 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-07-30 13:45:43.968 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/platform - 200 null application/json; charset=utf-8 24.5845ms
2025-07-30 13:45:45.638 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users - null null
2025-07-30 13:45:45.638 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/subscription-plans - null null
2025-07-30 13:45:45.640 +08:00 [INF] CORS policy execution successful.
2025-07-30 13:45:45.641 +08:00 [INF] CORS policy execution successful.
2025-07-30 13:45:45.642 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users - 204 null null 3.5093ms
2025-07-30 13:45:45.642 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/subscription-plans - 204 null null 3.6343ms
2025-07-30 13:45:45.643 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/subscription-plans - application/json null
2025-07-30 13:45:45.645 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users - application/json null
2025-07-30 13:45:45.646 +08:00 [INF] CORS policy execution successful.
2025-07-30 13:45:45.647 +08:00 [INF] CORS policy execution successful.
2025-07-30 13:45:45.648 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 13:45:45.648 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 13:45:45.649 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetSubscriptionPlans (CeceLearningPortal.Api)'
2025-07-30 13:45:45.650 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUsers (CeceLearningPortal.Api)'
2025-07-30 13:45:45.652 +08:00 [INF] Route matched with {action = "GetSubscriptionPlans", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetSubscriptionPlans() on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 13:45:45.654 +08:00 [INF] Route matched with {action = "GetUsers", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUsers(CeceLearningPortal.Api.DTOs.UserManagementFilterDto) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 13:45:45.664 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
2025-07-30 13:45:45.670 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."UserName", a."Email", a."FullName", a."Role", a."Status", a."CreatedAt", a."LastLoginAt", a."EmailConfirmed"
FROM "AspNetUsers" AS a
ORDER BY a."CreatedAt" DESC
LIMIT @__p_1 OFFSET @__p_0
2025-07-30 13:45:45.671 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[CeceLearningPortal.Api.DTOs.UserManagementDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-30 13:45:45.675 +08:00 [INF] Executed DbCommand (10ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."CreatedAt", s."Description", s."DisplayOrder", s."Features", s."HasAnalytics", s."HasPrioritySupport", s."HasUnlimitedAccess", s."IsActive", s."IsRecommended", s."MaxCourseAccess", s."MaxCoursesCanCreate", s."MaxStudentsPerCourse", s."MonthlyPrice", s."Name", s."PlanType", s."TransactionFeePercentage", s."UpdatedAt", s."YearlyPrice", s0."Id", s0."BillingCycle", s0."CreatedAt", s0."EndDate", s0."NextBillingDate", s0."PlanName", s0."Price", s0."StartDate", s0."Status", s0."StripeSubscriptionId", s0."SubscriptionPlanId", s0."UpdatedAt", s0."UserId"
FROM "SubscriptionPlans" AS s
LEFT JOIN "Subscriptions" AS s0 ON s."Id" = s0."SubscriptionPlanId"
ORDER BY s."Id"
2025-07-30 13:45:45.676 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[CeceLearningPortal.Api.DTOs.SubscriptionPlanDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-30 13:45:45.682 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUsers (CeceLearningPortal.Api) in 26.8177ms
2025-07-30 13:45:45.682 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetSubscriptionPlans (CeceLearningPortal.Api) in 29.1652ms
2025-07-30 13:45:45.683 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUsers (CeceLearningPortal.Api)'
2025-07-30 13:45:45.683 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetSubscriptionPlans (CeceLearningPortal.Api)'
2025-07-30 13:45:45.684 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users - 200 null application/json; charset=utf-8 39.402ms
2025-07-30 13:45:45.684 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/subscription-plans - 200 null application/json; charset=utf-8 40.9896ms
2025-07-30 13:45:45.686 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/e090c598-224f-4b4c-870a-3c3ef6303e0a/subscription - null null
2025-07-30 13:45:45.686 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/801dc698-62a8-49c3-b578-b7c1b05049a4/subscription - null null
2025-07-30 13:45:45.686 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/f9f0e64e-3771-4aa9-8470-21e709677e44/subscription - null null
2025-07-30 13:45:45.686 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/28b8e854-738a-4e69-835c-71299a8f9b21/subscription - null null
2025-07-30 13:45:45.687 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/efead752-f0b3-48ab-93b8-7ba31e7574ba/subscription - null null
2025-07-30 13:45:45.688 +08:00 [INF] CORS policy execution successful.
2025-07-30 13:45:45.690 +08:00 [INF] CORS policy execution successful.
2025-07-30 13:45:45.690 +08:00 [INF] CORS policy execution successful.
2025-07-30 13:45:45.691 +08:00 [INF] CORS policy execution successful.
2025-07-30 13:45:45.692 +08:00 [INF] CORS policy execution successful.
2025-07-30 13:45:45.692 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/e090c598-224f-4b4c-870a-3c3ef6303e0a/subscription - 204 null null 6.3715ms
2025-07-30 13:45:45.693 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/801dc698-62a8-49c3-b578-b7c1b05049a4/subscription - 204 null null 6.8452ms
2025-07-30 13:45:45.693 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/f9f0e64e-3771-4aa9-8470-21e709677e44/subscription - 204 null null 6.578ms
2025-07-30 13:45:45.693 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/28b8e854-738a-4e69-835c-71299a8f9b21/subscription - 204 null null 6.8581ms
2025-07-30 13:45:45.694 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/efead752-f0b3-48ab-93b8-7ba31e7574ba/subscription - 204 null null 6.6402ms
2025-07-30 13:45:45.695 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/28b8e854-738a-4e69-835c-71299a8f9b21/subscription - application/json null
2025-07-30 13:45:45.696 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/e090c598-224f-4b4c-870a-3c3ef6303e0a/subscription - application/json null
2025-07-30 13:45:45.697 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/801dc698-62a8-49c3-b578-b7c1b05049a4/subscription - application/json null
2025-07-30 13:45:45.698 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/f9f0e64e-3771-4aa9-8470-21e709677e44/subscription - application/json null
2025-07-30 13:45:45.700 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/efead752-f0b3-48ab-93b8-7ba31e7574ba/subscription - application/json null
2025-07-30 13:45:45.701 +08:00 [INF] CORS policy execution successful.
2025-07-30 13:45:45.702 +08:00 [INF] CORS policy execution successful.
2025-07-30 13:45:45.703 +08:00 [INF] CORS policy execution successful.
2025-07-30 13:45:45.704 +08:00 [INF] CORS policy execution successful.
2025-07-30 13:45:45.705 +08:00 [INF] CORS policy execution successful.
2025-07-30 13:45:45.706 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 13:45:45.706 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 13:45:45.708 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 13:45:45.709 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 13:45:45.711 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 13:45:45.711 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 13:45:45.723 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 13:45:45.724 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 13:45:45.725 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType72`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 13:45:45.727 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType72`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 13:45:45.728 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 16.3047ms
2025-07-30 13:45:45.728 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 15.4736ms
2025-07-30 13:45:45.729 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 13:45:45.730 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 13:45:45.731 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/28b8e854-738a-4e69-835c-71299a8f9b21/subscription - 200 null application/json; charset=utf-8 35.4991ms
2025-07-30 13:45:45.731 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/e090c598-224f-4b4c-870a-3c3ef6303e0a/subscription - 200 null application/json; charset=utf-8 34.9193ms
2025-07-30 13:45:45.754 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 13:45:45.755 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 13:45:45.756 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 13:45:45.758 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 13:45:45.759 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType72`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 13:45:45.760 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 3.0645ms
2025-07-30 13:45:45.760 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 13:45:45.760 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 13:45:45.761 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/f9f0e64e-3771-4aa9-8470-21e709677e44/subscription - 200 null application/json; charset=utf-8 62.4178ms
2025-07-30 13:45:45.762 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 13:45:45.763 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 13:45:45.764 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 13:45:45.765 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 13:45:45.766 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 13:45:45.766 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 13:45:45.768 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType72`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 13:45:45.769 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 3.2313ms
2025-07-30 13:45:45.769 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 13:45:45.769 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 13:45:45.770 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/efead752-f0b3-48ab-93b8-7ba31e7574ba/subscription - 200 null application/json; charset=utf-8 69.796ms
2025-07-30 13:45:45.771 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType72`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 13:45:45.772 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 5.6736ms
2025-07-30 13:45:45.773 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 13:45:45.774 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/801dc698-62a8-49c3-b578-b7c1b05049a4/subscription - 200 null application/json; charset=utf-8 76.1798ms
2025-07-30 13:46:18.675 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/courses - null null
2025-07-30 13:46:18.676 +08:00 [INF] CORS policy execution successful.
2025-07-30 13:46:18.677 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/courses - 204 null null 1.7827ms
2025-07-30 13:46:18.678 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses - application/json null
2025-07-30 13:46:18.679 +08:00 [INF] CORS policy execution successful.
2025-07-30 13:46:18.681 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 13:46:18.682 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-30 13:46:18.682 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-30 13:46:18.685 +08:00 [ERR] Failed executing DbCommand (1ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."IsPublished", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."PublishedAt", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."IsFlagged", r."Rating", r."Status", r."StudentId", e."Id", e."AverageQuizScore", e."CertificateIssued", e."CertificateUrl", e."CompletedAt", e."CompletedLessons", e."CourseId", e."EnrolledAt", e."LastAccessedDate", e."ProgressPercentage", e."QuizCount", e."StudentId", e."TotalTimeSpent"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."IsPublished", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."PublishedAt", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-30 13:46:18.687 +08:00 [ERR] An exception occurred while iterating over the results of a query for context type 'CeceLearningPortal.Api.Data.ApplicationDbContext'.
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 1526
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 1526
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 1526
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 1526
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 13:46:18.691 +08:00 [ERR] Error retrieving courses
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 1526
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at CeceLearningPortal.Api.Services.CourseService.GetAllCoursesAsync(CourseFilterDto filter) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Services\CourseService.cs:line 95
   at CeceLearningPortal.Api.Controllers.CoursesController.GetCourses(CourseFilterDto filter) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Controllers\CoursesController.cs:line 26
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 1526
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 13:46:18.695 +08:00 [INF] Executing ObjectResult, writing value of type '<>f__AnonymousType0`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 13:46:18.696 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 12.3429ms
2025-07-30 13:46:18.696 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-30 13:46:18.697 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses - 500 null application/json; charset=utf-8 18.4091ms
2025-07-30 13:46:21.788 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses - application/json null
2025-07-30 13:46:21.790 +08:00 [INF] CORS policy execution successful.
2025-07-30 13:46:21.792 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 13:46:21.793 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-30 13:46:21.793 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-30 13:46:21.795 +08:00 [ERR] Failed executing DbCommand (1ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."IsPublished", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."PublishedAt", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."IsFlagged", r."Rating", r."Status", r."StudentId", e."Id", e."AverageQuizScore", e."CertificateIssued", e."CertificateUrl", e."CompletedAt", e."CompletedLessons", e."CourseId", e."EnrolledAt", e."LastAccessedDate", e."ProgressPercentage", e."QuizCount", e."StudentId", e."TotalTimeSpent"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."IsPublished", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."PublishedAt", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-30 13:46:21.798 +08:00 [ERR] An exception occurred while iterating over the results of a query for context type 'CeceLearningPortal.Api.Data.ApplicationDbContext'.
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 1526
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 1526
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 1526
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 1526
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 13:46:21.802 +08:00 [ERR] Error retrieving courses
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 1526
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at CeceLearningPortal.Api.Services.CourseService.GetAllCoursesAsync(CourseFilterDto filter) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Services\CourseService.cs:line 95
   at CeceLearningPortal.Api.Controllers.CoursesController.GetCourses(CourseFilterDto filter) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Controllers\CoursesController.cs:line 26
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 1526
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 13:46:21.806 +08:00 [INF] Executing ObjectResult, writing value of type '<>f__AnonymousType0`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 13:46:21.807 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 12.4012ms
2025-07-30 13:46:21.807 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-30 13:46:21.808 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses - 500 null application/json; charset=utf-8 19.7418ms
2025-07-30 13:46:50.896 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/subscriptions - null null
2025-07-30 13:46:50.897 +08:00 [INF] CORS policy execution successful.
2025-07-30 13:46:50.898 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/subscriptions - 204 null null 1.595ms
2025-07-30 13:46:50.899 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/subscriptions - application/json null
2025-07-30 13:46:50.900 +08:00 [INF] CORS policy execution successful.
2025-07-30 13:46:50.902 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 13:46:50.903 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/subscriptions - 404 0 null 3.6952ms
2025-07-30 13:46:50.904 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5295/api/admin/subscriptions, Response status code: 404
2025-07-30 13:46:58.261 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/subscription-plans - null null
2025-07-30 13:46:58.263 +08:00 [INF] CORS policy execution successful.
2025-07-30 13:46:58.263 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/subscription-plans - 204 null null 1.771ms
2025-07-30 13:46:58.265 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/subscription-plans - application/json null
2025-07-30 13:46:58.266 +08:00 [INF] CORS policy execution successful.
2025-07-30 13:46:58.267 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 13:46:58.269 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetSubscriptionPlans (CeceLearningPortal.Api)'
2025-07-30 13:46:58.269 +08:00 [INF] Route matched with {action = "GetSubscriptionPlans", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetSubscriptionPlans() on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 13:46:58.272 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."CreatedAt", s."Description", s."DisplayOrder", s."Features", s."HasAnalytics", s."HasPrioritySupport", s."HasUnlimitedAccess", s."IsActive", s."IsRecommended", s."MaxCourseAccess", s."MaxCoursesCanCreate", s."MaxStudentsPerCourse", s."MonthlyPrice", s."Name", s."PlanType", s."TransactionFeePercentage", s."UpdatedAt", s."YearlyPrice", s0."Id", s0."BillingCycle", s0."CreatedAt", s0."EndDate", s0."NextBillingDate", s0."PlanName", s0."Price", s0."StartDate", s0."Status", s0."StripeSubscriptionId", s0."SubscriptionPlanId", s0."UpdatedAt", s0."UserId"
FROM "SubscriptionPlans" AS s
LEFT JOIN "Subscriptions" AS s0 ON s."Id" = s0."SubscriptionPlanId"
ORDER BY s."Id"
2025-07-30 13:46:58.274 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[CeceLearningPortal.Api.DTOs.SubscriptionPlanDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-30 13:46:58.274 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetSubscriptionPlans (CeceLearningPortal.Api) in 4.0996ms
2025-07-30 13:46:58.275 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetSubscriptionPlans (CeceLearningPortal.Api)'
2025-07-30 13:46:58.275 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/subscription-plans - 200 null application/json; charset=utf-8 10.684ms
2025-07-30 13:47:19.480 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/subscriptions - null null
2025-07-30 13:47:19.482 +08:00 [INF] CORS policy execution successful.
2025-07-30 13:47:19.482 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/subscriptions - 204 null null 1.6475ms
2025-07-30 13:47:19.484 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/subscriptions - application/json null
2025-07-30 13:47:19.485 +08:00 [INF] CORS policy execution successful.
2025-07-30 13:47:19.487 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 13:47:19.488 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/subscriptions - 404 0 null 3.8363ms
2025-07-30 13:47:19.489 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5295/api/admin/subscriptions, Response status code: 404
2025-07-30 13:47:22.296 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users - null null
2025-07-30 13:47:22.297 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/subscription-plans - null null
2025-07-30 13:47:22.298 +08:00 [INF] CORS policy execution successful.
2025-07-30 13:47:22.299 +08:00 [INF] CORS policy execution successful.
2025-07-30 13:47:22.299 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users - 204 null null 2.6234ms
2025-07-30 13:47:22.299 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/subscription-plans - 204 null null 2.5456ms
2025-07-30 13:47:22.301 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/subscription-plans - application/json null
2025-07-30 13:47:22.302 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users - application/json null
2025-07-30 13:47:22.303 +08:00 [INF] CORS policy execution successful.
2025-07-30 13:47:22.304 +08:00 [INF] CORS policy execution successful.
2025-07-30 13:47:22.305 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 13:47:22.305 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 13:47:22.306 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetSubscriptionPlans (CeceLearningPortal.Api)'
2025-07-30 13:47:22.307 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUsers (CeceLearningPortal.Api)'
2025-07-30 13:47:22.307 +08:00 [INF] Route matched with {action = "GetSubscriptionPlans", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetSubscriptionPlans() on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 13:47:22.308 +08:00 [INF] Route matched with {action = "GetUsers", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUsers(CeceLearningPortal.Api.DTOs.UserManagementFilterDto) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 13:47:22.310 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."CreatedAt", s."Description", s."DisplayOrder", s."Features", s."HasAnalytics", s."HasPrioritySupport", s."HasUnlimitedAccess", s."IsActive", s."IsRecommended", s."MaxCourseAccess", s."MaxCoursesCanCreate", s."MaxStudentsPerCourse", s."MonthlyPrice", s."Name", s."PlanType", s."TransactionFeePercentage", s."UpdatedAt", s."YearlyPrice", s0."Id", s0."BillingCycle", s0."CreatedAt", s0."EndDate", s0."NextBillingDate", s0."PlanName", s0."Price", s0."StartDate", s0."Status", s0."StripeSubscriptionId", s0."SubscriptionPlanId", s0."UpdatedAt", s0."UserId"
FROM "SubscriptionPlans" AS s
LEFT JOIN "Subscriptions" AS s0 ON s."Id" = s0."SubscriptionPlanId"
ORDER BY s."Id"
2025-07-30 13:47:22.311 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[CeceLearningPortal.Api.DTOs.SubscriptionPlanDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-30 13:47:22.311 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
2025-07-30 13:47:22.311 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetSubscriptionPlans (CeceLearningPortal.Api) in 2.7244ms
2025-07-30 13:47:22.313 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetSubscriptionPlans (CeceLearningPortal.Api)'
2025-07-30 13:47:22.313 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/subscription-plans - 200 null application/json; charset=utf-8 12.374ms
2025-07-30 13:47:22.314 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."UserName", a."Email", a."FullName", a."Role", a."Status", a."CreatedAt", a."LastLoginAt", a."EmailConfirmed"
FROM "AspNetUsers" AS a
ORDER BY a."CreatedAt" DESC
LIMIT @__p_1 OFFSET @__p_0
2025-07-30 13:47:22.315 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[CeceLearningPortal.Api.DTOs.UserManagementDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-30 13:47:22.316 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUsers (CeceLearningPortal.Api) in 6.6018ms
2025-07-30 13:47:22.316 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUsers (CeceLearningPortal.Api)'
2025-07-30 13:47:22.317 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users - 200 null application/json; charset=utf-8 14.9927ms
2025-07-30 13:47:22.318 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/e090c598-224f-4b4c-870a-3c3ef6303e0a/subscription - null null
2025-07-30 13:47:22.319 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/801dc698-62a8-49c3-b578-b7c1b05049a4/subscription - null null
2025-07-30 13:47:22.319 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/efead752-f0b3-48ab-93b8-7ba31e7574ba/subscription - null null
2025-07-30 13:47:22.319 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/28b8e854-738a-4e69-835c-71299a8f9b21/subscription - null null
2025-07-30 13:47:22.319 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/f9f0e64e-3771-4aa9-8470-21e709677e44/subscription - null null
2025-07-30 13:47:22.320 +08:00 [INF] CORS policy execution successful.
2025-07-30 13:47:22.321 +08:00 [INF] CORS policy execution successful.
2025-07-30 13:47:22.322 +08:00 [INF] CORS policy execution successful.
2025-07-30 13:47:22.323 +08:00 [INF] CORS policy execution successful.
2025-07-30 13:47:22.324 +08:00 [INF] CORS policy execution successful.
2025-07-30 13:47:22.324 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/e090c598-224f-4b4c-870a-3c3ef6303e0a/subscription - 204 null null 5.8193ms
2025-07-30 13:47:22.324 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/801dc698-62a8-49c3-b578-b7c1b05049a4/subscription - 204 null null 5.4611ms
2025-07-30 13:47:22.325 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/efead752-f0b3-48ab-93b8-7ba31e7574ba/subscription - 204 null null 5.7064ms
2025-07-30 13:47:22.325 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/28b8e854-738a-4e69-835c-71299a8f9b21/subscription - 204 null null 5.7574ms
2025-07-30 13:47:22.325 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/f9f0e64e-3771-4aa9-8470-21e709677e44/subscription - 204 null null 6.0711ms
2025-07-30 13:47:22.327 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/f9f0e64e-3771-4aa9-8470-21e709677e44/subscription - application/json null
2025-07-30 13:47:22.328 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/28b8e854-738a-4e69-835c-71299a8f9b21/subscription - application/json null
2025-07-30 13:47:22.329 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/efead752-f0b3-48ab-93b8-7ba31e7574ba/subscription - application/json null
2025-07-30 13:47:22.330 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/801dc698-62a8-49c3-b578-b7c1b05049a4/subscription - application/json null
2025-07-30 13:47:22.331 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/e090c598-224f-4b4c-870a-3c3ef6303e0a/subscription - application/json null
2025-07-30 13:47:22.332 +08:00 [INF] CORS policy execution successful.
2025-07-30 13:47:22.333 +08:00 [INF] CORS policy execution successful.
2025-07-30 13:47:22.333 +08:00 [INF] CORS policy execution successful.
2025-07-30 13:47:22.335 +08:00 [INF] CORS policy execution successful.
2025-07-30 13:47:22.336 +08:00 [INF] CORS policy execution successful.
2025-07-30 13:47:22.337 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 13:47:22.337 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 13:47:22.337 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 13:47:22.338 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 13:47:22.338 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 13:47:22.338 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 13:47:22.339 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 13:47:22.340 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 13:47:22.341 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 13:47:22.342 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 13:47:22.342 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 13:47:22.342 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 13:47:22.343 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 13:47:22.343 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 13:47:22.343 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 13:47:22.345 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 13:47:22.345 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 13:47:22.346 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 13:47:22.347 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 13:47:22.348 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType72`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 13:47:22.348 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 13:47:22.349 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType72`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 13:47:22.350 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType72`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 13:47:22.351 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType72`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 13:47:22.352 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 7.9635ms
2025-07-30 13:47:22.353 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType72`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 13:47:22.354 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 9.0802ms
2025-07-30 13:47:22.355 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 8.9521ms
2025-07-30 13:47:22.355 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 8.8359ms
2025-07-30 13:47:22.356 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 13:47:22.356 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 9.2287ms
2025-07-30 13:47:22.357 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 13:47:22.357 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 13:47:22.358 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 13:47:22.358 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/28b8e854-738a-4e69-835c-71299a8f9b21/subscription - 200 null application/json; charset=utf-8 30.6432ms
2025-07-30 13:47:22.359 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 13:47:22.359 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/f9f0e64e-3771-4aa9-8470-21e709677e44/subscription - 200 null application/json; charset=utf-8 32.7684ms
2025-07-30 13:47:22.360 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/efead752-f0b3-48ab-93b8-7ba31e7574ba/subscription - 200 null application/json; charset=utf-8 30.9313ms
2025-07-30 13:47:22.360 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/801dc698-62a8-49c3-b578-b7c1b05049a4/subscription - 200 null application/json; charset=utf-8 30.3415ms
2025-07-30 13:47:22.362 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/e090c598-224f-4b4c-870a-3c3ef6303e0a/subscription - 200 null application/json; charset=utf-8 30.9162ms
2025-07-30 13:47:34.736 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users - null null
2025-07-30 13:47:34.737 +08:00 [INF] CORS policy execution successful.
2025-07-30 13:47:34.738 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users - 204 null null 1.5212ms
2025-07-30 13:47:34.739 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users - application/json null
2025-07-30 13:47:34.740 +08:00 [INF] CORS policy execution successful.
2025-07-30 13:47:34.741 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 13:47:34.742 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUsers (CeceLearningPortal.Api)'
2025-07-30 13:47:34.743 +08:00 [INF] Route matched with {action = "GetUsers", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUsers(CeceLearningPortal.Api.DTOs.UserManagementFilterDto) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 13:47:34.745 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
2025-07-30 13:47:34.746 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."UserName", a."Email", a."FullName", a."Role", a."Status", a."CreatedAt", a."LastLoginAt", a."EmailConfirmed"
FROM "AspNetUsers" AS a
ORDER BY a."CreatedAt" DESC
LIMIT @__p_1 OFFSET @__p_0
2025-07-30 13:47:34.747 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[CeceLearningPortal.Api.DTOs.UserManagementDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-30 13:47:34.747 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUsers (CeceLearningPortal.Api) in 3.6849ms
2025-07-30 13:47:34.748 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUsers (CeceLearningPortal.Api)'
2025-07-30 13:47:34.749 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users - 200 null application/json; charset=utf-8 9.58ms
2025-07-30 13:47:34.750 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/efead752-f0b3-48ab-93b8-7ba31e7574ba/subscription - null null
2025-07-30 13:47:34.750 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/e090c598-224f-4b4c-870a-3c3ef6303e0a/subscription - null null
2025-07-30 13:47:34.750 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/801dc698-62a8-49c3-b578-b7c1b05049a4/subscription - null null
2025-07-30 13:47:34.750 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/28b8e854-738a-4e69-835c-71299a8f9b21/subscription - null null
2025-07-30 13:47:34.750 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/f9f0e64e-3771-4aa9-8470-21e709677e44/subscription - null null
2025-07-30 13:47:34.751 +08:00 [INF] CORS policy execution successful.
2025-07-30 13:47:34.752 +08:00 [INF] CORS policy execution successful.
2025-07-30 13:47:34.753 +08:00 [INF] CORS policy execution successful.
2025-07-30 13:47:34.754 +08:00 [INF] CORS policy execution successful.
2025-07-30 13:47:34.755 +08:00 [INF] CORS policy execution successful.
2025-07-30 13:47:34.755 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/efead752-f0b3-48ab-93b8-7ba31e7574ba/subscription - 204 null null 5.4776ms
2025-07-30 13:47:34.756 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/e090c598-224f-4b4c-870a-3c3ef6303e0a/subscription - 204 null null 5.9619ms
2025-07-30 13:47:34.756 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/801dc698-62a8-49c3-b578-b7c1b05049a4/subscription - 204 null null 6.5711ms
2025-07-30 13:47:34.757 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/28b8e854-738a-4e69-835c-71299a8f9b21/subscription - 204 null null 6.8936ms
2025-07-30 13:47:34.757 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/f9f0e64e-3771-4aa9-8470-21e709677e44/subscription - 204 null null 7.2326ms
2025-07-30 13:47:34.759 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/f9f0e64e-3771-4aa9-8470-21e709677e44/subscription - application/json null
2025-07-30 13:47:34.760 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/efead752-f0b3-48ab-93b8-7ba31e7574ba/subscription - application/json null
2025-07-30 13:47:34.761 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/e090c598-224f-4b4c-870a-3c3ef6303e0a/subscription - application/json null
2025-07-30 13:47:34.762 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/28b8e854-738a-4e69-835c-71299a8f9b21/subscription - application/json null
2025-07-30 13:47:34.763 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/801dc698-62a8-49c3-b578-b7c1b05049a4/subscription - application/json null
2025-07-30 13:47:34.764 +08:00 [INF] CORS policy execution successful.
2025-07-30 13:47:34.765 +08:00 [INF] CORS policy execution successful.
2025-07-30 13:47:34.766 +08:00 [INF] CORS policy execution successful.
2025-07-30 13:47:34.767 +08:00 [INF] CORS policy execution successful.
2025-07-30 13:47:34.770 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 13:47:34.770 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 13:47:34.768 +08:00 [INF] CORS policy execution successful.
2025-07-30 13:47:34.770 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 13:47:34.770 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 13:47:34.771 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 13:47:34.772 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 13:47:34.772 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 13:47:34.773 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 13:47:34.774 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 13:47:34.774 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 13:47:34.775 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 13:47:34.775 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 13:47:34.776 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 13:47:34.776 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 13:47:34.778 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 13:47:34.778 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 13:47:34.778 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 13:47:34.779 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 13:47:34.780 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 13:47:34.781 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType72`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 13:47:34.782 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 13:47:34.783 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType72`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 13:47:34.784 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType72`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 13:47:34.785 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType72`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 13:47:34.785 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 8.2094ms
2025-07-30 13:47:34.786 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType72`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 13:47:34.787 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 9.21ms
2025-07-30 13:47:34.788 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 8.6713ms
2025-07-30 13:47:34.788 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 8.5328ms
2025-07-30 13:47:34.789 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 13:47:34.789 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 7.8324ms
2025-07-30 13:47:34.790 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 13:47:34.790 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 13:47:34.791 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 13:47:34.791 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/f9f0e64e-3771-4aa9-8470-21e709677e44/subscription - 200 null application/json; charset=utf-8 32.5918ms
2025-07-30 13:47:34.792 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 13:47:34.792 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/efead752-f0b3-48ab-93b8-7ba31e7574ba/subscription - 200 null application/json; charset=utf-8 32.2827ms
2025-07-30 13:47:34.793 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/e090c598-224f-4b4c-870a-3c3ef6303e0a/subscription - 200 null application/json; charset=utf-8 31.5788ms
2025-07-30 13:47:34.793 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/28b8e854-738a-4e69-835c-71299a8f9b21/subscription - 200 null application/json; charset=utf-8 30.8959ms
2025-07-30 13:47:34.795 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/801dc698-62a8-49c3-b578-b7c1b05049a4/subscription - 200 null application/json; charset=utf-8 31.4155ms
2025-07-30 13:47:39.282 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/platform - null null
2025-07-30 13:47:39.283 +08:00 [INF] CORS policy execution successful.
2025-07-30 13:47:39.284 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/platform - 204 null null 1.9564ms
2025-07-30 13:47:39.285 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/platform - application/json null
2025-07-30 13:47:39.286 +08:00 [INF] CORS policy execution successful.
2025-07-30 13:47:39.288 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 13:47:39.290 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-07-30 13:47:39.291 +08:00 [INF] Route matched with {action = "GetPlatformAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPlatformAnalytics() on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-30 13:47:39.293 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
2025-07-30 13:47:39.295 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
2025-07-30 13:47:39.297 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."Status" = 'Completed'
2025-07-30 13:47:39.298 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
2025-07-30 13:47:39.305 +08:00 [INF] Executed DbCommand (5ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id" AS "instructorId", a."FullName" AS "instructorName", (
    SELECT count(*)::int
    FROM "Courses" AS c0
    WHERE c0."InstructorId" = a."Id") AS "totalCourses", (
    SELECT count(*)::int
    FROM "Enrollments" AS e
    INNER JOIN "Courses" AS c1 ON e."CourseId" = c1."Id"
    WHERE c1."InstructorId" = a."Id") AS "totalStudents", (
    SELECT COALESCE(sum(p0."Amount"), 0.0)
    FROM "Payments" AS p0
    LEFT JOIN "Courses" AS c2 ON p0."CourseId" = c2."Id"
    WHERE c2."InstructorId" = a."Id" AND p0."Status" = 'Completed') AS "totalRevenue", COALESCE((
    SELECT avg(r."Rating"::double precision)
    FROM "Reviews" AS r
    INNER JOIN "Courses" AS c3 ON r."CourseId" = c3."Id"
    WHERE c3."InstructorId" = a."Id"), 0.0) AS "averageRating"
FROM "AspNetUsers" AS a
WHERE a."Role" = 'Instructor'
ORDER BY (
    SELECT COALESCE(sum(p."Amount"), 0.0)
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
    WHERE c."InstructorId" = a."Id" AND p."Status" = 'Completed') DESC
LIMIT @__p_0
2025-07-30 13:47:39.311 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT c."Category" AS category, count(*)::int AS "courseCount", COALESCE(sum((
    SELECT count(*)::int
    FROM "Enrollments" AS e
    WHERE c."Id" = e."CourseId")), 0)::int AS "enrollmentCount", (
    SELECT COALESCE(sum(p."Amount"), 0.0)
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c0 ON p."CourseId" = c0."Id"
    WHERE c0."Category" = c."Category" AND p."Status" = 'Completed') AS revenue
FROM "Courses" AS c
GROUP BY c."Category"
ORDER BY COALESCE(sum((
    SELECT count(*)::int
    FROM "Enrollments" AS e
    WHERE c."Id" = e."CourseId")), 0)::int DESC
2025-07-30 13:47:39.315 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT p0."Year", p0."Month", COALESCE(sum(p0."Amount"), 0.0) AS "Revenue", count(*)::int AS "TransactionCount"
FROM (
    SELECT p."Amount", date_part('year', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "Payments" AS p
    WHERE p."Status" = 'Completed' AND p."CreatedAt" >= @__sixMonthsAgo_0
) AS p0
GROUP BY p0."Year", p0."Month"
2025-07-30 13:47:39.318 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT a0."Year", a0."Month", count(*)::int AS "NewUsers"
FROM (
    SELECT date_part('year', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "AspNetUsers" AS a
    WHERE a."CreatedAt" >= @__sixMonthsAgo_0
) AS a0
GROUP BY a0."Year", a0."Month"
2025-07-30 13:47:39.320 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Subscriptions" AS s
WHERE s."Status" = 'Active'
2025-07-30 13:47:39.322 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s."PlanName" AS plan, count(*)::int AS count, COALESCE(sum(s."Price"), 0.0) AS "monthlyRevenue"
FROM "Subscriptions" AS s
WHERE s."Status" = 'Active'
GROUP BY s."PlanName"
2025-07-30 13:47:39.323 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType9`6[[<>f__AnonymousType10`5[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 13:47:39.325 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api) in 33.0123ms
2025-07-30 13:47:39.326 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-07-30 13:47:39.326 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/platform - 200 null application/json; charset=utf-8 40.9215ms
2025-07-30 13:47:41.509 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/auth/login - null null
2025-07-30 13:47:41.511 +08:00 [INF] CORS policy execution successful.
2025-07-30 13:47:41.512 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/auth/login - 204 null null 2.1512ms
2025-07-30 13:47:41.513 +08:00 [INF] Request starting HTTP/1.1 POST http://localhost:5295/api/auth/login - application/json 51
2025-07-30 13:47:41.514 +08:00 [INF] CORS policy execution successful.
2025-07-30 13:47:41.515 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 13:47:41.516 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AuthController.Login (CeceLearningPortal.Api)'
2025-07-30 13:47:41.517 +08:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(CeceLearningPortal.Api.DTOs.LoginDto) on controller CeceLearningPortal.Api.Controllers.AuthController (CeceLearningPortal.Api).
2025-07-30 13:47:41.520 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__normalizedEmail_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."NormalizedEmail" = @__normalizedEmail_0
LIMIT 2
2025-07-30 13:47:41.568 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@p1='?', @p2='?', @p0='?' (DbType = DateTime), @p3='?' (DbType = DateTime), @p4='?', @p5='?' (DbType = DateTime), @p6='?', @p7='?' (DbType = DateTime), @p8='?', @p9='?', @p10='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE "AspNetUsers" SET "LastLoginAt" = @p0
WHERE "Id" = @p1 AND "ConcurrencyStamp" = @p2;
INSERT INTO "RefreshTokens" ("CreatedAt", "CreatedByIp", "ExpiresAt", "ReplacedByToken", "RevokedAt", "RevokedByIp", "Token", "UserId")
VALUES (@p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10)
RETURNING "Id";
2025-07-30 13:47:41.570 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.AuthResponseDto'.
2025-07-30 13:47:41.571 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AuthController.Login (CeceLearningPortal.Api) in 53.0826ms
2025-07-30 13:47:41.571 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AuthController.Login (CeceLearningPortal.Api)'
2025-07-30 13:47:41.572 +08:00 [INF] Request finished HTTP/1.1 POST http://localhost:5295/api/auth/login - 200 null application/json; charset=utf-8 58.9288ms
2025-07-30 13:47:41.590 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/courses - null null
2025-07-30 13:47:41.591 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/platform - application/json null
2025-07-30 13:47:41.592 +08:00 [INF] CORS policy execution successful.
2025-07-30 13:47:41.593 +08:00 [INF] CORS policy execution successful.
2025-07-30 13:47:41.593 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/courses - 204 null null 2.6403ms
2025-07-30 13:47:41.595 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 13:47:41.595 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses - application/json null
2025-07-30 13:47:41.596 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-07-30 13:47:41.597 +08:00 [INF] CORS policy execution successful.
2025-07-30 13:47:41.598 +08:00 [INF] Route matched with {action = "GetPlatformAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPlatformAnalytics() on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-30 13:47:41.599 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 13:47:41.599 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
2025-07-30 13:47:41.600 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-30 13:47:41.601 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
2025-07-30 13:47:41.601 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-30 13:47:41.602 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."Status" = 'Completed'
2025-07-30 13:47:41.604 +08:00 [ERR] Failed executing DbCommand (0ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."IsPublished", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."PublishedAt", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."IsFlagged", r."Rating", r."Status", r."StudentId", e."Id", e."AverageQuizScore", e."CertificateIssued", e."CertificateUrl", e."CompletedAt", e."CompletedLessons", e."CourseId", e."EnrolledAt", e."LastAccessedDate", e."ProgressPercentage", e."QuizCount", e."StudentId", e."TotalTimeSpent"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."IsPublished", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."PublishedAt", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-30 13:47:41.604 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
2025-07-30 13:47:41.606 +08:00 [ERR] An exception occurred while iterating over the results of a query for context type 'CeceLearningPortal.Api.Data.ApplicationDbContext'.
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 1526
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 1526
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 1526
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 1526
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 13:47:41.609 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id" AS "instructorId", a."FullName" AS "instructorName", (
    SELECT count(*)::int
    FROM "Courses" AS c0
    WHERE c0."InstructorId" = a."Id") AS "totalCourses", (
    SELECT count(*)::int
    FROM "Enrollments" AS e
    INNER JOIN "Courses" AS c1 ON e."CourseId" = c1."Id"
    WHERE c1."InstructorId" = a."Id") AS "totalStudents", (
    SELECT COALESCE(sum(p0."Amount"), 0.0)
    FROM "Payments" AS p0
    LEFT JOIN "Courses" AS c2 ON p0."CourseId" = c2."Id"
    WHERE c2."InstructorId" = a."Id" AND p0."Status" = 'Completed') AS "totalRevenue", COALESCE((
    SELECT avg(r."Rating"::double precision)
    FROM "Reviews" AS r
    INNER JOIN "Courses" AS c3 ON r."CourseId" = c3."Id"
    WHERE c3."InstructorId" = a."Id"), 0.0) AS "averageRating"
FROM "AspNetUsers" AS a
WHERE a."Role" = 'Instructor'
ORDER BY (
    SELECT COALESCE(sum(p."Amount"), 0.0)
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
    WHERE c."InstructorId" = a."Id" AND p."Status" = 'Completed') DESC
LIMIT @__p_0
2025-07-30 13:47:41.611 +08:00 [ERR] Error retrieving courses
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 1526
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at CeceLearningPortal.Api.Services.CourseService.GetAllCoursesAsync(CourseFilterDto filter) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Services\CourseService.cs:line 95
   at CeceLearningPortal.Api.Controllers.CoursesController.GetCourses(CourseFilterDto filter) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Controllers\CoursesController.cs:line 26
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 1526
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 13:47:41.614 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT c."Category" AS category, count(*)::int AS "courseCount", COALESCE(sum((
    SELECT count(*)::int
    FROM "Enrollments" AS e
    WHERE c."Id" = e."CourseId")), 0)::int AS "enrollmentCount", (
    SELECT COALESCE(sum(p."Amount"), 0.0)
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c0 ON p."CourseId" = c0."Id"
    WHERE c0."Category" = c."Category" AND p."Status" = 'Completed') AS revenue
FROM "Courses" AS c
GROUP BY c."Category"
ORDER BY COALESCE(sum((
    SELECT count(*)::int
    FROM "Enrollments" AS e
    WHERE c."Id" = e."CourseId")), 0)::int DESC
2025-07-30 13:47:41.616 +08:00 [INF] Executing ObjectResult, writing value of type '<>f__AnonymousType0`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 13:47:41.617 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT p0."Year", p0."Month", COALESCE(sum(p0."Amount"), 0.0) AS "Revenue", count(*)::int AS "TransactionCount"
FROM (
    SELECT p."Amount", date_part('year', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "Payments" AS p
    WHERE p."Status" = 'Completed' AND p."CreatedAt" >= @__sixMonthsAgo_0
) AS p0
GROUP BY p0."Year", p0."Month"
2025-07-30 13:47:41.617 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 14.429ms
2025-07-30 13:47:41.619 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT a0."Year", a0."Month", count(*)::int AS "NewUsers"
FROM (
    SELECT date_part('year', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "AspNetUsers" AS a
    WHERE a."CreatedAt" >= @__sixMonthsAgo_0
) AS a0
GROUP BY a0."Year", a0."Month"
2025-07-30 13:47:41.619 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-30 13:47:41.621 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Subscriptions" AS s
WHERE s."Status" = 'Active'
2025-07-30 13:47:41.621 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses - 500 null application/json; charset=utf-8 25.6328ms
2025-07-30 13:47:41.622 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s."PlanName" AS plan, count(*)::int AS count, COALESCE(sum(s."Price"), 0.0) AS "monthlyRevenue"
FROM "Subscriptions" AS s
WHERE s."Status" = 'Active'
GROUP BY s."PlanName"
2025-07-30 13:47:41.624 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType9`6[[<>f__AnonymousType10`5[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 13:47:41.625 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api) in 26.2269ms
2025-07-30 13:47:41.626 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-07-30 13:47:41.626 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/platform - 200 null application/json; charset=utf-8 35.2896ms
2025-07-30 13:47:43.747 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/platform - application/json null
2025-07-30 13:47:43.749 +08:00 [INF] CORS policy execution successful.
2025-07-30 13:47:43.750 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 13:47:43.751 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-07-30 13:47:43.752 +08:00 [INF] Route matched with {action = "GetPlatformAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPlatformAnalytics() on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-30 13:47:43.753 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
2025-07-30 13:47:43.754 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
2025-07-30 13:47:43.756 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."Status" = 'Completed'
2025-07-30 13:47:43.757 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
2025-07-30 13:47:43.761 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id" AS "instructorId", a."FullName" AS "instructorName", (
    SELECT count(*)::int
    FROM "Courses" AS c0
    WHERE c0."InstructorId" = a."Id") AS "totalCourses", (
    SELECT count(*)::int
    FROM "Enrollments" AS e
    INNER JOIN "Courses" AS c1 ON e."CourseId" = c1."Id"
    WHERE c1."InstructorId" = a."Id") AS "totalStudents", (
    SELECT COALESCE(sum(p0."Amount"), 0.0)
    FROM "Payments" AS p0
    LEFT JOIN "Courses" AS c2 ON p0."CourseId" = c2."Id"
    WHERE c2."InstructorId" = a."Id" AND p0."Status" = 'Completed') AS "totalRevenue", COALESCE((
    SELECT avg(r."Rating"::double precision)
    FROM "Reviews" AS r
    INNER JOIN "Courses" AS c3 ON r."CourseId" = c3."Id"
    WHERE c3."InstructorId" = a."Id"), 0.0) AS "averageRating"
FROM "AspNetUsers" AS a
WHERE a."Role" = 'Instructor'
ORDER BY (
    SELECT COALESCE(sum(p."Amount"), 0.0)
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
    WHERE c."InstructorId" = a."Id" AND p."Status" = 'Completed') DESC
LIMIT @__p_0
2025-07-30 13:47:43.763 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT c."Category" AS category, count(*)::int AS "courseCount", COALESCE(sum((
    SELECT count(*)::int
    FROM "Enrollments" AS e
    WHERE c."Id" = e."CourseId")), 0)::int AS "enrollmentCount", (
    SELECT COALESCE(sum(p."Amount"), 0.0)
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c0 ON p."CourseId" = c0."Id"
    WHERE c0."Category" = c."Category" AND p."Status" = 'Completed') AS revenue
FROM "Courses" AS c
GROUP BY c."Category"
ORDER BY COALESCE(sum((
    SELECT count(*)::int
    FROM "Enrollments" AS e
    WHERE c."Id" = e."CourseId")), 0)::int DESC
2025-07-30 13:47:43.764 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT p0."Year", p0."Month", COALESCE(sum(p0."Amount"), 0.0) AS "Revenue", count(*)::int AS "TransactionCount"
FROM (
    SELECT p."Amount", date_part('year', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "Payments" AS p
    WHERE p."Status" = 'Completed' AND p."CreatedAt" >= @__sixMonthsAgo_0
) AS p0
GROUP BY p0."Year", p0."Month"
2025-07-30 13:47:43.766 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT a0."Year", a0."Month", count(*)::int AS "NewUsers"
FROM (
    SELECT date_part('year', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "AspNetUsers" AS a
    WHERE a."CreatedAt" >= @__sixMonthsAgo_0
) AS a0
GROUP BY a0."Year", a0."Month"
2025-07-30 13:47:43.767 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Subscriptions" AS s
WHERE s."Status" = 'Active'
2025-07-30 13:47:43.769 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s."PlanName" AS plan, count(*)::int AS count, COALESCE(sum(s."Price"), 0.0) AS "monthlyRevenue"
FROM "Subscriptions" AS s
WHERE s."Status" = 'Active'
GROUP BY s."PlanName"
2025-07-30 13:47:43.770 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType9`6[[<>f__AnonymousType10`5[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 13:47:43.771 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api) in 17.8474ms
2025-07-30 13:47:43.771 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-07-30 13:47:43.772 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/platform - 200 null application/json; charset=utf-8 24.2136ms
2025-07-30 13:47:46.948 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/subscriptions - null null
2025-07-30 13:47:46.949 +08:00 [INF] CORS policy execution successful.
2025-07-30 13:47:46.950 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/subscriptions - 204 null null 2.3297ms
2025-07-30 13:47:46.952 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/subscriptions - application/json null
2025-07-30 13:47:46.953 +08:00 [INF] CORS policy execution successful.
2025-07-30 13:47:46.955 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 13:47:46.956 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/subscriptions - 404 0 null 4.2517ms
2025-07-30 13:47:46.957 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5295/api/admin/subscriptions, Response status code: 404
2025-07-30 13:47:48.514 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users - null null
2025-07-30 13:47:48.514 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/subscription-plans - null null
2025-07-30 13:47:48.515 +08:00 [INF] CORS policy execution successful.
2025-07-30 13:47:48.517 +08:00 [INF] CORS policy execution successful.
2025-07-30 13:47:48.517 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users - 204 null null 2.9042ms
2025-07-30 13:47:48.517 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/subscription-plans - 204 null null 3.0537ms
2025-07-30 13:47:48.519 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/subscription-plans - application/json null
2025-07-30 13:47:48.520 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users - application/json null
2025-07-30 13:47:48.522 +08:00 [INF] CORS policy execution successful.
2025-07-30 13:47:48.523 +08:00 [INF] CORS policy execution successful.
2025-07-30 13:47:48.524 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 13:47:48.525 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 13:47:48.526 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetSubscriptionPlans (CeceLearningPortal.Api)'
2025-07-30 13:47:48.526 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUsers (CeceLearningPortal.Api)'
2025-07-30 13:47:48.527 +08:00 [INF] Route matched with {action = "GetSubscriptionPlans", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetSubscriptionPlans() on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 13:47:48.527 +08:00 [INF] Route matched with {action = "GetUsers", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUsers(CeceLearningPortal.Api.DTOs.UserManagementFilterDto) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 13:47:48.529 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."CreatedAt", s."Description", s."DisplayOrder", s."Features", s."HasAnalytics", s."HasPrioritySupport", s."HasUnlimitedAccess", s."IsActive", s."IsRecommended", s."MaxCourseAccess", s."MaxCoursesCanCreate", s."MaxStudentsPerCourse", s."MonthlyPrice", s."Name", s."PlanType", s."TransactionFeePercentage", s."UpdatedAt", s."YearlyPrice", s0."Id", s0."BillingCycle", s0."CreatedAt", s0."EndDate", s0."NextBillingDate", s0."PlanName", s0."Price", s0."StartDate", s0."Status", s0."StripeSubscriptionId", s0."SubscriptionPlanId", s0."UpdatedAt", s0."UserId"
FROM "SubscriptionPlans" AS s
LEFT JOIN "Subscriptions" AS s0 ON s."Id" = s0."SubscriptionPlanId"
ORDER BY s."Id"
2025-07-30 13:47:48.530 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
2025-07-30 13:47:48.530 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[CeceLearningPortal.Api.DTOs.SubscriptionPlanDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-30 13:47:48.532 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."UserName", a."Email", a."FullName", a."Role", a."Status", a."CreatedAt", a."LastLoginAt", a."EmailConfirmed"
FROM "AspNetUsers" AS a
ORDER BY a."CreatedAt" DESC
LIMIT @__p_1 OFFSET @__p_0
2025-07-30 13:47:48.532 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetSubscriptionPlans (CeceLearningPortal.Api) in 3.8622ms
2025-07-30 13:47:48.533 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[CeceLearningPortal.Api.DTOs.UserManagementDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-30 13:47:48.533 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetSubscriptionPlans (CeceLearningPortal.Api)'
2025-07-30 13:47:48.534 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUsers (CeceLearningPortal.Api) in 5.0252ms
2025-07-30 13:47:48.535 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/subscription-plans - 200 null application/json; charset=utf-8 16.0136ms
2025-07-30 13:47:48.536 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUsers (CeceLearningPortal.Api)'
2025-07-30 13:47:48.538 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users - 200 null application/json; charset=utf-8 17.6406ms
2025-07-30 13:47:48.539 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/e090c598-224f-4b4c-870a-3c3ef6303e0a/subscription - null null
2025-07-30 13:47:48.539 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/801dc698-62a8-49c3-b578-b7c1b05049a4/subscription - null null
2025-07-30 13:47:48.539 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/efead752-f0b3-48ab-93b8-7ba31e7574ba/subscription - null null
2025-07-30 13:47:48.540 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/28b8e854-738a-4e69-835c-71299a8f9b21/subscription - null null
2025-07-30 13:47:48.540 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/f9f0e64e-3771-4aa9-8470-21e709677e44/subscription - null null
2025-07-30 13:47:48.540 +08:00 [INF] CORS policy execution successful.
2025-07-30 13:47:48.541 +08:00 [INF] CORS policy execution successful.
2025-07-30 13:47:48.542 +08:00 [INF] CORS policy execution successful.
2025-07-30 13:47:48.543 +08:00 [INF] CORS policy execution successful.
2025-07-30 13:47:48.544 +08:00 [INF] CORS policy execution successful.
2025-07-30 13:47:48.545 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/e090c598-224f-4b4c-870a-3c3ef6303e0a/subscription - 204 null null 5.4385ms
2025-07-30 13:47:48.545 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/801dc698-62a8-49c3-b578-b7c1b05049a4/subscription - 204 null null 5.7563ms
2025-07-30 13:47:48.545 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/efead752-f0b3-48ab-93b8-7ba31e7574ba/subscription - 204 null null 6.1281ms
2025-07-30 13:47:48.546 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/28b8e854-738a-4e69-835c-71299a8f9b21/subscription - 204 null null 6.3433ms
2025-07-30 13:47:48.546 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/f9f0e64e-3771-4aa9-8470-21e709677e44/subscription - 204 null null 6.651ms
2025-07-30 13:47:48.548 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/f9f0e64e-3771-4aa9-8470-21e709677e44/subscription - application/json null
2025-07-30 13:47:48.549 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/e090c598-224f-4b4c-870a-3c3ef6303e0a/subscription - application/json null
2025-07-30 13:47:48.550 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/28b8e854-738a-4e69-835c-71299a8f9b21/subscription - application/json null
2025-07-30 13:47:48.551 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/efead752-f0b3-48ab-93b8-7ba31e7574ba/subscription - application/json null
2025-07-30 13:47:48.553 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/801dc698-62a8-49c3-b578-b7c1b05049a4/subscription - application/json null
2025-07-30 13:47:48.554 +08:00 [INF] CORS policy execution successful.
2025-07-30 13:47:48.555 +08:00 [INF] CORS policy execution successful.
2025-07-30 13:47:48.556 +08:00 [INF] CORS policy execution successful.
2025-07-30 13:47:48.557 +08:00 [INF] CORS policy execution successful.
2025-07-30 13:47:48.558 +08:00 [INF] CORS policy execution successful.
2025-07-30 13:47:48.559 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 13:47:48.559 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 13:47:48.559 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 13:47:48.560 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 13:47:48.560 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 13:47:48.560 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 13:47:48.561 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 13:47:48.562 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 13:47:48.563 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 13:47:48.564 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 13:47:48.564 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 13:47:48.565 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 13:47:48.565 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 13:47:48.566 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 13:47:48.566 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 13:47:48.568 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 13:47:48.568 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 13:47:48.569 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 13:47:48.570 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 13:47:48.571 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 13:47:48.572 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType72`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 13:47:48.573 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType72`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 13:47:48.574 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType72`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 13:47:48.575 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType72`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 13:47:48.576 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType72`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 13:47:48.576 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 9.3721ms
2025-07-30 13:47:48.577 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 9.1951ms
2025-07-30 13:47:48.578 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 8.8784ms
2025-07-30 13:47:48.578 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 8.5036ms
2025-07-30 13:47:48.579 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 8.3007ms
2025-07-30 13:47:48.579 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 13:47:48.580 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 13:47:48.580 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 13:47:48.581 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 13:47:48.582 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 13:47:48.582 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/f9f0e64e-3771-4aa9-8470-21e709677e44/subscription - 200 null application/json; charset=utf-8 34.3304ms
2025-07-30 13:47:48.582 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/e090c598-224f-4b4c-870a-3c3ef6303e0a/subscription - 200 null application/json; charset=utf-8 33.6921ms
2025-07-30 13:47:48.583 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/28b8e854-738a-4e69-835c-71299a8f9b21/subscription - 200 null application/json; charset=utf-8 32.8999ms
2025-07-30 13:47:48.583 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/efead752-f0b3-48ab-93b8-7ba31e7574ba/subscription - 200 null application/json; charset=utf-8 31.9536ms
2025-07-30 13:47:48.584 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/801dc698-62a8-49c3-b578-b7c1b05049a4/subscription - 200 null application/json; charset=utf-8 31.0955ms
2025-07-30 13:49:12.099 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/auth/logout - null null
2025-07-30 13:49:12.100 +08:00 [INF] CORS policy execution successful.
2025-07-30 13:49:12.100 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/auth/logout - 204 null null 1.7232ms
2025-07-30 13:49:12.102 +08:00 [INF] Request starting HTTP/1.1 POST http://localhost:5295/api/auth/logout - application/json 0
2025-07-30 13:49:12.103 +08:00 [INF] CORS policy execution successful.
2025-07-30 13:49:12.105 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 13:49:12.106 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AuthController.Logout (CeceLearningPortal.Api)'
2025-07-30 13:49:12.108 +08:00 [INF] Route matched with {action = "Logout", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Logout() on controller CeceLearningPortal.Api.Controllers.AuthController (CeceLearningPortal.Api).
2025-07-30 13:49:12.123 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a0."Id", a0."AccessFailedCount", a0."Avatar", a0."ConcurrencyStamp", a0."CreatedAt", a0."Email", a0."EmailConfirmed", a0."FullName", a0."LastLoginAt", a0."LockoutEnabled", a0."LockoutEnd", a0."NormalizedEmail", a0."NormalizedUserName", a0."NotificationPreferences", a0."PasswordHash", a0."PhoneNumber", a0."PhoneNumberConfirmed", a0."RefreshToken", a0."RefreshTokenExpiryTime", a0."Role", a0."SecurityStamp", a0."Status", a0."TwoFactorEnabled", a0."UserName", r."Id", r."CreatedAt", r."CreatedByIp", r."ExpiresAt", r."ReplacedByToken", r."RevokedAt", r."RevokedByIp", r."Token", r."UserId"
FROM (
    SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM "AspNetUsers" AS a
    WHERE a."Id" = @__userId_0
    LIMIT 1
) AS a0
LEFT JOIN "RefreshTokens" AS r ON a0."Id" = r."UserId"
ORDER BY a0."Id"
2025-07-30 13:49:12.132 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@p1='?' (DbType = Int32), @p0='?' (DbType = DateTime), @p3='?' (DbType = Int32), @p2='?' (DbType = DateTime), @p5='?' (DbType = Int32), @p4='?' (DbType = DateTime), @p7='?' (DbType = Int32), @p6='?' (DbType = DateTime), @p9='?' (DbType = Int32), @p8='?' (DbType = DateTime), @p11='?' (DbType = Int32), @p10='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
UPDATE "RefreshTokens" SET "RevokedAt" = @p0
WHERE "Id" = @p1;
UPDATE "RefreshTokens" SET "RevokedAt" = @p2
WHERE "Id" = @p3;
UPDATE "RefreshTokens" SET "RevokedAt" = @p4
WHERE "Id" = @p5;
UPDATE "RefreshTokens" SET "RevokedAt" = @p6
WHERE "Id" = @p7;
UPDATE "RefreshTokens" SET "RevokedAt" = @p8
WHERE "Id" = @p9;
UPDATE "RefreshTokens" SET "RevokedAt" = @p10
WHERE "Id" = @p11;
2025-07-30 13:49:12.133 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType0`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 13:49:12.134 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AuthController.Logout (CeceLearningPortal.Api) in 25.5088ms
2025-07-30 13:49:12.135 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AuthController.Logout (CeceLearningPortal.Api)'
2025-07-30 13:49:12.135 +08:00 [INF] Request finished HTTP/1.1 POST http://localhost:5295/api/auth/logout - 200 null application/json; charset=utf-8 33.2272ms
2025-07-30 13:49:14.212 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/auth/login - null null
2025-07-30 13:49:14.213 +08:00 [INF] CORS policy execution successful.
2025-07-30 13:49:14.214 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/auth/login - 204 null null 2.0332ms
2025-07-30 13:49:14.215 +08:00 [INF] Request starting HTTP/1.1 POST http://localhost:5295/api/auth/login - application/json 61
2025-07-30 13:49:14.216 +08:00 [INF] CORS policy execution successful.
2025-07-30 13:49:14.217 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AuthController.Login (CeceLearningPortal.Api)'
2025-07-30 13:49:14.217 +08:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(CeceLearningPortal.Api.DTOs.LoginDto) on controller CeceLearningPortal.Api.Controllers.AuthController (CeceLearningPortal.Api).
2025-07-30 13:49:14.219 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__normalizedEmail_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."NormalizedEmail" = @__normalizedEmail_0
LIMIT 2
2025-07-30 13:49:14.266 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@p1='?', @p2='?', @p0='?' (DbType = DateTime), @p3='?' (DbType = DateTime), @p4='?', @p5='?' (DbType = DateTime), @p6='?', @p7='?' (DbType = DateTime), @p8='?', @p9='?', @p10='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE "AspNetUsers" SET "LastLoginAt" = @p0
WHERE "Id" = @p1 AND "ConcurrencyStamp" = @p2;
INSERT INTO "RefreshTokens" ("CreatedAt", "CreatedByIp", "ExpiresAt", "ReplacedByToken", "RevokedAt", "RevokedByIp", "Token", "UserId")
VALUES (@p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10)
RETURNING "Id";
2025-07-30 13:49:14.268 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.AuthResponseDto'.
2025-07-30 13:49:14.268 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AuthController.Login (CeceLearningPortal.Api) in 50.197ms
2025-07-30 13:49:14.269 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AuthController.Login (CeceLearningPortal.Api)'
2025-07-30 13:49:14.269 +08:00 [INF] Request finished HTTP/1.1 POST http://localhost:5295/api/auth/login - 200 null application/json; charset=utf-8 54.0176ms
2025-07-30 13:49:14.284 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/platform - null null
2025-07-30 13:49:14.284 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/courses - null null
2025-07-30 13:49:14.285 +08:00 [INF] CORS policy execution successful.
2025-07-30 13:49:14.287 +08:00 [INF] CORS policy execution successful.
2025-07-30 13:49:14.287 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/platform - 204 null null 3.6463ms
2025-07-30 13:49:14.288 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/courses - 204 null null 3.6862ms
2025-07-30 13:49:14.289 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/platform - application/json null
2025-07-30 13:49:14.291 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses - application/json null
2025-07-30 13:49:14.292 +08:00 [INF] CORS policy execution successful.
2025-07-30 13:49:14.294 +08:00 [INF] CORS policy execution successful.
2025-07-30 13:49:14.295 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 13:49:14.295 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 13:49:14.297 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-07-30 13:49:14.298 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-30 13:49:14.299 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-30 13:49:14.299 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-07-30 13:49:14.300 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/platform - 403 0 null 10.8086ms
2025-07-30 13:49:14.301 +08:00 [ERR] Failed executing DbCommand (1ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."IsPublished", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."PublishedAt", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."IsFlagged", r."Rating", r."Status", r."StudentId", e."Id", e."AverageQuizScore", e."CertificateIssued", e."CertificateUrl", e."CompletedAt", e."CompletedLessons", e."CourseId", e."EnrolledAt", e."LastAccessedDate", e."ProgressPercentage", e."QuizCount", e."StudentId", e."TotalTimeSpent"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."IsPublished", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."PublishedAt", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-30 13:49:14.304 +08:00 [ERR] An exception occurred while iterating over the results of a query for context type 'CeceLearningPortal.Api.Data.ApplicationDbContext'.
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 1526
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 1526
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 1526
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 1526
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 13:49:14.318 +08:00 [ERR] Error retrieving courses
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 1526
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at CeceLearningPortal.Api.Services.CourseService.GetAllCoursesAsync(CourseFilterDto filter) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Services\CourseService.cs:line 95
   at CeceLearningPortal.Api.Controllers.CoursesController.GetCourses(CourseFilterDto filter) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Controllers\CoursesController.cs:line 26
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 1526
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 13:49:14.324 +08:00 [INF] Executing ObjectResult, writing value of type '<>f__AnonymousType0`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 13:49:14.324 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 24.6653ms
2025-07-30 13:49:14.325 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-30 13:49:14.325 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses - 500 null application/json; charset=utf-8 34.4547ms
2025-07-30 13:49:14.327 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/users/f9f0e64e-3771-4aa9-8470-21e709677e44/instructor-stats - null null
2025-07-30 13:49:14.328 +08:00 [INF] CORS policy execution successful.
2025-07-30 13:49:14.328 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/users/f9f0e64e-3771-4aa9-8470-21e709677e44/instructor-stats - 204 null null 1.3617ms
2025-07-30 13:49:14.330 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/users/f9f0e64e-3771-4aa9-8470-21e709677e44/instructor-stats - application/json null
2025-07-30 13:49:14.331 +08:00 [INF] CORS policy execution successful.
2025-07-30 13:49:14.333 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 13:49:14.334 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/users/f9f0e64e-3771-4aa9-8470-21e709677e44/instructor-stats - 404 0 null 4.0289ms
2025-07-30 13:49:14.335 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5295/api/users/f9f0e64e-3771-4aa9-8470-21e709677e44/instructor-stats, Response status code: 404
2025-07-30 13:49:14.336 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - null null
2025-07-30 13:49:14.337 +08:00 [INF] CORS policy execution successful.
2025-07-30 13:49:14.338 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - 204 null null 1.7433ms
2025-07-30 13:49:14.339 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - application/json null
2025-07-30 13:49:14.340 +08:00 [INF] CORS policy execution successful.
2025-07-30 13:49:14.343 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 13:49:14.344 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-30 13:49:14.344 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-30 13:49:14.346 +08:00 [ERR] Failed executing DbCommand (0ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."IsPublished", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."PublishedAt", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."IsFlagged", r."Rating", r."Status", r."StudentId", e."Id", e."AverageQuizScore", e."CertificateIssued", e."CertificateUrl", e."CompletedAt", e."CompletedLessons", e."CourseId", e."EnrolledAt", e."LastAccessedDate", e."ProgressPercentage", e."QuizCount", e."StudentId", e."TotalTimeSpent"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."IsPublished", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."PublishedAt", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-30 13:49:14.348 +08:00 [ERR] An exception occurred while iterating over the results of a query for context type 'CeceLearningPortal.Api.Data.ApplicationDbContext'.
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 1526
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 1526
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 1526
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 1526
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 13:49:14.352 +08:00 [ERR] Error retrieving courses
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 1526
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at CeceLearningPortal.Api.Services.CourseService.GetAllCoursesAsync(CourseFilterDto filter) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Services\CourseService.cs:line 95
   at CeceLearningPortal.Api.Controllers.CoursesController.GetCourses(CourseFilterDto filter) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Controllers\CoursesController.cs:line 26
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 1526
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 13:49:14.356 +08:00 [INF] Executing ObjectResult, writing value of type '<>f__AnonymousType0`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 13:49:14.357 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 11.9235ms
2025-07-30 13:49:14.358 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-30 13:49:14.358 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - 500 null application/json; charset=utf-8 19.0375ms
2025-07-30 13:49:16.654 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users - null null
2025-07-30 13:49:16.655 +08:00 [INF] CORS policy execution successful.
2025-07-30 13:49:16.655 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users - 204 null null 1.6394ms
2025-07-30 13:49:16.657 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users - application/json null
2025-07-30 13:49:16.658 +08:00 [INF] CORS policy execution successful.
2025-07-30 13:49:16.659 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 13:49:16.660 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-07-30 13:49:16.661 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-07-30 13:49:16.661 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users - 403 0 null 4.6251ms
2025-07-30 13:49:16.663 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses - application/json null
2025-07-30 13:49:16.664 +08:00 [INF] CORS policy execution successful.
2025-07-30 13:49:16.665 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 13:49:16.666 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-30 13:49:16.666 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-30 13:49:16.668 +08:00 [ERR] Failed executing DbCommand (1ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."IsPublished", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."PublishedAt", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."IsFlagged", r."Rating", r."Status", r."StudentId", e."Id", e."AverageQuizScore", e."CertificateIssued", e."CertificateUrl", e."CompletedAt", e."CompletedLessons", e."CourseId", e."EnrolledAt", e."LastAccessedDate", e."ProgressPercentage", e."QuizCount", e."StudentId", e."TotalTimeSpent"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."IsPublished", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."PublishedAt", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-30 13:49:16.670 +08:00 [ERR] An exception occurred while iterating over the results of a query for context type 'CeceLearningPortal.Api.Data.ApplicationDbContext'.
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 1526
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 1526
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 1526
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 1526
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 13:49:16.674 +08:00 [ERR] Error retrieving courses
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 1526
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at CeceLearningPortal.Api.Services.CourseService.GetAllCoursesAsync(CourseFilterDto filter) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Services\CourseService.cs:line 95
   at CeceLearningPortal.Api.Controllers.CoursesController.GetCourses(CourseFilterDto filter) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Controllers\CoursesController.cs:line 26
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 1526
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 13:49:16.678 +08:00 [INF] Executing ObjectResult, writing value of type '<>f__AnonymousType0`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 13:49:16.678 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 11.5024ms
2025-07-30 13:49:16.679 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-30 13:49:16.680 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses - 500 null application/json; charset=utf-8 16.7734ms
2025-07-30 13:49:16.681 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/platform - application/json null
2025-07-30 13:49:16.682 +08:00 [INF] CORS policy execution successful.
2025-07-30 13:49:16.683 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 13:49:16.684 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-07-30 13:49:16.685 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-07-30 13:49:16.685 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/platform - 403 0 null 4.028ms
2025-07-30 13:49:16.686 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/revenue/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - null null
2025-07-30 13:49:16.687 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - null null
2025-07-30 13:49:16.688 +08:00 [INF] CORS policy execution successful.
2025-07-30 13:49:16.689 +08:00 [INF] CORS policy execution successful.
2025-07-30 13:49:16.689 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/revenue/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - 204 null null 2.5288ms
2025-07-30 13:49:16.689 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - 204 null null 2.6604ms
2025-07-30 13:49:16.691 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - application/json null
2025-07-30 13:49:16.692 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/revenue/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - application/json null
2025-07-30 13:49:16.693 +08:00 [INF] CORS policy execution successful.
2025-07-30 13:49:16.694 +08:00 [INF] CORS policy execution successful.
2025-07-30 13:49:16.695 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 13:49:16.695 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 13:49:16.696 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-30 13:49:16.697 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-07-30 13:49:16.699 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-30 13:49:16.699 +08:00 [INF] Route matched with {action = "GetInstructorRevenue", controller = "Revenue"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorRevenue(System.String) on controller CeceLearningPortal.Api.Controllers.RevenueController (CeceLearningPortal.Api).
2025-07-30 13:49:16.706 +08:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2025-07-30 13:49:16.718 +08:00 [ERR] Failed executing DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."IsPublished", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."PublishedAt", c."Status", c."Thumbnail", c."Title", c."UpdatedAt", s."Id", s."AverageQuizScore", s."CertificateIssued", s."CertificateUrl", s."CompletedAt", s."CompletedLessons", s."CourseId", s."EnrolledAt", s."LastAccessedDate", s."ProgressPercentage", s."QuizCount", s."StudentId", s."TotalTimeSpent", s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."IsFlagged", r."Rating", r."Status", r."StudentId"
FROM "Courses" AS c
LEFT JOIN (
    SELECT e."Id", e."AverageQuizScore", e."CertificateIssued", e."CertificateUrl", e."CompletedAt", e."CompletedLessons", e."CourseId", e."EnrolledAt", e."LastAccessedDate", e."ProgressPercentage", e."QuizCount", e."StudentId", e."TotalTimeSpent", a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM "Enrollments" AS e
    INNER JOIN "AspNetUsers" AS a ON e."StudentId" = a."Id"
) AS s ON c."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c."Id" = r."CourseId"
WHERE c."InstructorId" = @__instructorId_0
ORDER BY c."Id", s."Id", s."Id0"
2025-07-30 13:49:16.719 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."Id" = @__p_0
LIMIT 1
2025-07-30 13:49:16.720 +08:00 [ERR] An exception occurred while iterating over the results of a query for context type 'CeceLearningPortal.Api.Data.ApplicationDbContext'.
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 160
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 160
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 160
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 160
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 13:49:16.724 +08:00 [ERR] Failed executing DbCommand (0ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."IsPublished", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."PublishedAt", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
FROM "Courses" AS c
WHERE c."InstructorId" = @__instructorId_0
2025-07-30 13:49:16.725 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 25.0069ms
2025-07-30 13:49:16.726 +08:00 [ERR] An exception occurred while iterating over the results of a query for context type 'CeceLearningPortal.Api.Data.ApplicationDbContext'.
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 160
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 160
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 160
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 160
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 13:49:16.726 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-30 13:49:16.730 +08:00 [ERR] Error calculating instructor revenue for f9f0e64e-3771-4aa9-8470-21e709677e44
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 160
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at CeceLearningPortal.Api.Services.RevenueCalculationService.CalculateInstructorRevenueAsync(String instructorId) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Services\RevenueCalculationService.cs:line 25
   at CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue(String instructorId) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Controllers\RevenueController.cs:line 25
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 160
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 13:49:16.730 +08:00 [ERR] An unhandled exception has occurred while executing the request.
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 160
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics(String instructorId) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Controllers\AnalyticsController.cs:line 36
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at CeceLearningPortal.Api.Middleware.TokenBlacklistMiddleware.InvokeAsync(HttpContext context) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Middleware\TokenBlacklistMiddleware.cs:line 51
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 160
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 13:49:16.734 +08:00 [INF] Executing ObjectResult, writing value of type '<>f__AnonymousType0`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 13:49:16.740 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api) in 39.7848ms
2025-07-30 13:49:16.741 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-07-30 13:49:16.741 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/revenue/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - 500 null application/json; charset=utf-8 49.6333ms
2025-07-30 13:49:16.742 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - 500 null text/plain; charset=utf-8 51.7667ms
2025-07-30 13:49:18.684 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - application/json null
2025-07-30 13:49:18.685 +08:00 [INF] CORS policy execution successful.
2025-07-30 13:49:18.687 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 13:49:18.688 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-30 13:49:18.688 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-30 13:49:18.690 +08:00 [ERR] Failed executing DbCommand (0ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."IsPublished", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."PublishedAt", c."Status", c."Thumbnail", c."Title", c."UpdatedAt", s."Id", s."AverageQuizScore", s."CertificateIssued", s."CertificateUrl", s."CompletedAt", s."CompletedLessons", s."CourseId", s."EnrolledAt", s."LastAccessedDate", s."ProgressPercentage", s."QuizCount", s."StudentId", s."TotalTimeSpent", s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."IsFlagged", r."Rating", r."Status", r."StudentId"
FROM "Courses" AS c
LEFT JOIN (
    SELECT e."Id", e."AverageQuizScore", e."CertificateIssued", e."CertificateUrl", e."CompletedAt", e."CompletedLessons", e."CourseId", e."EnrolledAt", e."LastAccessedDate", e."ProgressPercentage", e."QuizCount", e."StudentId", e."TotalTimeSpent", a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM "Enrollments" AS e
    INNER JOIN "AspNetUsers" AS a ON e."StudentId" = a."Id"
) AS s ON c."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c."Id" = r."CourseId"
WHERE c."InstructorId" = @__instructorId_0
ORDER BY c."Id", s."Id", s."Id0"
2025-07-30 13:49:18.692 +08:00 [ERR] An exception occurred while iterating over the results of a query for context type 'CeceLearningPortal.Api.Data.ApplicationDbContext'.
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 160
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 160
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 160
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 160
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 13:49:18.696 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 6.75ms
2025-07-30 13:49:18.697 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-30 13:49:18.697 +08:00 [ERR] An unhandled exception has occurred while executing the request.
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 160
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics(String instructorId) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Controllers\AnalyticsController.cs:line 36
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at CeceLearningPortal.Api.Middleware.TokenBlacklistMiddleware.InvokeAsync(HttpContext context) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Middleware\TokenBlacklistMiddleware.cs:line 51
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 160
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 13:49:18.704 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - 500 null text/plain; charset=utf-8 20.4091ms
2025-07-30 13:49:23.116 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/revenue/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - null null
2025-07-30 13:49:23.117 +08:00 [INF] CORS policy execution successful.
2025-07-30 13:49:23.118 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/revenue/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - 204 null null 1.5991ms
2025-07-30 13:49:23.119 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/revenue/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - application/json null
2025-07-30 13:49:23.121 +08:00 [INF] CORS policy execution successful.
2025-07-30 13:49:23.122 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 13:49:23.123 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-07-30 13:49:23.124 +08:00 [INF] Route matched with {action = "GetInstructorRevenue", controller = "Revenue"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorRevenue(System.String) on controller CeceLearningPortal.Api.Controllers.RevenueController (CeceLearningPortal.Api).
2025-07-30 13:49:23.126 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."Id" = @__p_0
LIMIT 1
2025-07-30 13:49:23.127 +08:00 [ERR] Failed executing DbCommand (0ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."IsPublished", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."PublishedAt", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
FROM "Courses" AS c
WHERE c."InstructorId" = @__instructorId_0
2025-07-30 13:49:23.128 +08:00 [ERR] An exception occurred while iterating over the results of a query for context type 'CeceLearningPortal.Api.Data.ApplicationDbContext'.
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 160
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 160
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 160
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 160
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 13:49:23.132 +08:00 [ERR] Error calculating instructor revenue for f9f0e64e-3771-4aa9-8470-21e709677e44
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 160
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at CeceLearningPortal.Api.Services.RevenueCalculationService.CalculateInstructorRevenueAsync(String instructorId) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Services\RevenueCalculationService.cs:line 25
   at CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue(String instructorId) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Controllers\RevenueController.cs:line 25
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 160
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 13:49:23.137 +08:00 [INF] Executing ObjectResult, writing value of type '<>f__AnonymousType0`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 13:49:23.137 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api) in 13.0733ms
2025-07-30 13:49:23.138 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-07-30 13:49:23.139 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/revenue/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - 500 null application/json; charset=utf-8 19.3195ms
2025-07-30 13:49:23.140 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - null null
2025-07-30 13:49:23.141 +08:00 [INF] CORS policy execution successful.
2025-07-30 13:49:23.142 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - 204 null null 1.4226ms
2025-07-30 13:49:23.143 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - application/json null
2025-07-30 13:49:23.144 +08:00 [INF] CORS policy execution successful.
2025-07-30 13:49:23.145 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 13:49:23.146 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-30 13:49:23.147 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-30 13:49:23.148 +08:00 [ERR] Failed executing DbCommand (0ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."IsPublished", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."PublishedAt", c."Status", c."Thumbnail", c."Title", c."UpdatedAt", s."Id", s."AverageQuizScore", s."CertificateIssued", s."CertificateUrl", s."CompletedAt", s."CompletedLessons", s."CourseId", s."EnrolledAt", s."LastAccessedDate", s."ProgressPercentage", s."QuizCount", s."StudentId", s."TotalTimeSpent", s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."IsFlagged", r."Rating", r."Status", r."StudentId"
FROM "Courses" AS c
LEFT JOIN (
    SELECT e."Id", e."AverageQuizScore", e."CertificateIssued", e."CertificateUrl", e."CompletedAt", e."CompletedLessons", e."CourseId", e."EnrolledAt", e."LastAccessedDate", e."ProgressPercentage", e."QuizCount", e."StudentId", e."TotalTimeSpent", a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM "Enrollments" AS e
    INNER JOIN "AspNetUsers" AS a ON e."StudentId" = a."Id"
) AS s ON c."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c."Id" = r."CourseId"
WHERE c."InstructorId" = @__instructorId_0
ORDER BY c."Id", s."Id", s."Id0"
2025-07-30 13:49:23.150 +08:00 [ERR] An exception occurred while iterating over the results of a query for context type 'CeceLearningPortal.Api.Data.ApplicationDbContext'.
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 160
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 160
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 160
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 160
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 13:49:23.155 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 7.188ms
2025-07-30 13:49:23.155 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-30 13:49:23.156 +08:00 [ERR] An unhandled exception has occurred while executing the request.
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 160
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics(String instructorId) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Controllers\AnalyticsController.cs:line 36
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at CeceLearningPortal.Api.Middleware.TokenBlacklistMiddleware.InvokeAsync(HttpContext context) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Middleware\TokenBlacklistMiddleware.cs:line 51
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 160
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 13:49:23.163 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - 500 null text/plain; charset=utf-8 20.1529ms
2025-07-30 13:49:50.001 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/auth/logout - null null
2025-07-30 13:49:50.002 +08:00 [INF] CORS policy execution successful.
2025-07-30 13:49:50.002 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/auth/logout - 204 null null 1.5921ms
2025-07-30 13:49:50.004 +08:00 [INF] Request starting HTTP/1.1 POST http://localhost:5295/api/auth/logout - application/json 0
2025-07-30 13:49:50.005 +08:00 [INF] CORS policy execution successful.
2025-07-30 13:49:50.007 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 13:49:50.008 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AuthController.Logout (CeceLearningPortal.Api)'
2025-07-30 13:49:50.009 +08:00 [INF] Route matched with {action = "Logout", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Logout() on controller CeceLearningPortal.Api.Controllers.AuthController (CeceLearningPortal.Api).
2025-07-30 13:49:50.012 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a0."Id", a0."AccessFailedCount", a0."Avatar", a0."ConcurrencyStamp", a0."CreatedAt", a0."Email", a0."EmailConfirmed", a0."FullName", a0."LastLoginAt", a0."LockoutEnabled", a0."LockoutEnd", a0."NormalizedEmail", a0."NormalizedUserName", a0."NotificationPreferences", a0."PasswordHash", a0."PhoneNumber", a0."PhoneNumberConfirmed", a0."RefreshToken", a0."RefreshTokenExpiryTime", a0."Role", a0."SecurityStamp", a0."Status", a0."TwoFactorEnabled", a0."UserName", r."Id", r."CreatedAt", r."CreatedByIp", r."ExpiresAt", r."ReplacedByToken", r."RevokedAt", r."RevokedByIp", r."Token", r."UserId"
FROM (
    SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM "AspNetUsers" AS a
    WHERE a."Id" = @__userId_0
    LIMIT 1
) AS a0
LEFT JOIN "RefreshTokens" AS r ON a0."Id" = r."UserId"
ORDER BY a0."Id"
2025-07-30 13:49:50.021 +08:00 [INF] Executed DbCommand (7ms) [Parameters=[@p1='?' (DbType = Int32), @p0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
UPDATE "RefreshTokens" SET "RevokedAt" = @p0
WHERE "Id" = @p1;
2025-07-30 13:49:50.022 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType0`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 13:49:50.023 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AuthController.Logout (CeceLearningPortal.Api) in 13.2353ms
2025-07-30 13:49:50.024 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AuthController.Logout (CeceLearningPortal.Api)'
2025-07-30 13:49:50.024 +08:00 [INF] Request finished HTTP/1.1 POST http://localhost:5295/api/auth/logout - 200 null application/json; charset=utf-8 20.3367ms
2025-07-30 13:49:50.046 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users - null null
2025-07-30 13:49:50.047 +08:00 [INF] CORS policy execution successful.
2025-07-30 13:49:50.048 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users - 204 null null 2.2754ms
2025-07-30 13:49:50.051 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users - application/json null
2025-07-30 13:49:50.052 +08:00 [INF] CORS policy execution successful.
2025-07-30 13:49:50.053 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-07-30 13:49:50.055 +08:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-07-30 13:49:50.055 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users - 401 0 null 4.8271ms
2025-07-30 13:49:50.067 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/courses - null null
2025-07-30 13:49:50.069 +08:00 [INF] CORS policy execution successful.
2025-07-30 13:49:50.069 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/courses - 204 null null 2.1611ms
2025-07-30 13:49:50.072 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses - application/json null
2025-07-30 13:49:50.073 +08:00 [INF] CORS policy execution successful.
2025-07-30 13:49:50.074 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-30 13:49:50.074 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-30 13:49:50.077 +08:00 [ERR] Failed executing DbCommand (1ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."IsPublished", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."PublishedAt", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."IsFlagged", r."Rating", r."Status", r."StudentId", e."Id", e."AverageQuizScore", e."CertificateIssued", e."CertificateUrl", e."CompletedAt", e."CompletedLessons", e."CourseId", e."EnrolledAt", e."LastAccessedDate", e."ProgressPercentage", e."QuizCount", e."StudentId", e."TotalTimeSpent"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."IsPublished", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."PublishedAt", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-30 13:49:50.079 +08:00 [ERR] An exception occurred while iterating over the results of a query for context type 'CeceLearningPortal.Api.Data.ApplicationDbContext'.
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 1526
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 1526
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 1526
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 1526
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 13:49:50.083 +08:00 [ERR] Error retrieving courses
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 1526
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at CeceLearningPortal.Api.Services.CourseService.GetAllCoursesAsync(CourseFilterDto filter) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Services\CourseService.cs:line 95
   at CeceLearningPortal.Api.Controllers.CoursesController.GetCourses(CourseFilterDto filter) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Controllers\CoursesController.cs:line 26
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 1526
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 13:49:50.088 +08:00 [INF] Executing ObjectResult, writing value of type '<>f__AnonymousType0`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 13:49:50.088 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 12.8218ms
2025-07-30 13:49:50.089 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-30 13:49:50.089 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses - 500 null application/json; charset=utf-8 17.9146ms
2025-07-30 13:49:50.091 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/platform - null null
2025-07-30 13:49:50.092 +08:00 [INF] CORS policy execution successful.
2025-07-30 13:49:50.093 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/platform - 204 null null 1.5583ms
2025-07-30 13:49:50.094 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/platform - application/json null
2025-07-30 13:49:50.095 +08:00 [INF] CORS policy execution successful.
2025-07-30 13:49:50.096 +08:00 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-07-30 13:49:50.096 +08:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-07-30 13:49:50.097 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/platform - 401 0 null 2.5428ms
2025-07-30 13:49:51.865 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/auth/login - null null
2025-07-30 13:49:51.866 +08:00 [INF] CORS policy execution successful.
2025-07-30 13:49:51.866 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/auth/login - 204 null null 1.4294ms
2025-07-30 13:49:51.868 +08:00 [INF] Request starting HTTP/1.1 POST http://localhost:5295/api/auth/login - application/json 55
2025-07-30 13:49:51.868 +08:00 [INF] CORS policy execution successful.
2025-07-30 13:49:51.869 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AuthController.Login (CeceLearningPortal.Api)'
2025-07-30 13:49:51.869 +08:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(CeceLearningPortal.Api.DTOs.LoginDto) on controller CeceLearningPortal.Api.Controllers.AuthController (CeceLearningPortal.Api).
2025-07-30 13:49:51.872 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__normalizedEmail_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."NormalizedEmail" = @__normalizedEmail_0
LIMIT 2
2025-07-30 13:49:51.918 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@p1='?', @p2='?', @p0='?' (DbType = DateTime), @p3='?' (DbType = DateTime), @p4='?', @p5='?' (DbType = DateTime), @p6='?', @p7='?' (DbType = DateTime), @p8='?', @p9='?', @p10='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE "AspNetUsers" SET "LastLoginAt" = @p0
WHERE "Id" = @p1 AND "ConcurrencyStamp" = @p2;
INSERT INTO "RefreshTokens" ("CreatedAt", "CreatedByIp", "ExpiresAt", "ReplacedByToken", "RevokedAt", "RevokedByIp", "Token", "UserId")
VALUES (@p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10)
RETURNING "Id";
2025-07-30 13:49:51.920 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.AuthResponseDto'.
2025-07-30 13:49:51.921 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AuthController.Login (CeceLearningPortal.Api) in 50.7753ms
2025-07-30 13:49:51.922 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AuthController.Login (CeceLearningPortal.Api)'
2025-07-30 13:49:51.922 +08:00 [INF] Request finished HTTP/1.1 POST http://localhost:5295/api/auth/login - 200 null application/json; charset=utf-8 54.8201ms
2025-07-30 13:49:51.934 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/courses - null null
2025-07-30 13:49:51.934 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/platform - null null
2025-07-30 13:49:51.935 +08:00 [INF] CORS policy execution successful.
2025-07-30 13:49:51.936 +08:00 [INF] CORS policy execution successful.
2025-07-30 13:49:51.936 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/courses - 204 null null 2.6628ms
2025-07-30 13:49:51.937 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/platform - 204 null null 2.4456ms
2025-07-30 13:49:51.942 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/platform - application/json null
2025-07-30 13:49:51.942 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses - application/json null
2025-07-30 13:49:51.943 +08:00 [INF] CORS policy execution successful.
2025-07-30 13:49:51.944 +08:00 [INF] CORS policy execution successful.
2025-07-30 13:49:51.946 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 13:49:51.946 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 13:49:51.947 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-07-30 13:49:51.948 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-30 13:49:51.948 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-07-30 13:49:51.949 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-30 13:49:51.949 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/platform - 403 0 null 7.6816ms
2025-07-30 13:49:51.951 +08:00 [ERR] Failed executing DbCommand (0ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."IsPublished", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."PublishedAt", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."IsFlagged", r."Rating", r."Status", r."StudentId", e."Id", e."AverageQuizScore", e."CertificateIssued", e."CertificateUrl", e."CompletedAt", e."CompletedLessons", e."CourseId", e."EnrolledAt", e."LastAccessedDate", e."ProgressPercentage", e."QuizCount", e."StudentId", e."TotalTimeSpent"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."IsPublished", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."PublishedAt", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-30 13:49:51.953 +08:00 [ERR] An exception occurred while iterating over the results of a query for context type 'CeceLearningPortal.Api.Data.ApplicationDbContext'.
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 1526
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 1526
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 1526
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 1526
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 13:49:51.958 +08:00 [ERR] Error retrieving courses
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 1526
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at CeceLearningPortal.Api.Services.CourseService.GetAllCoursesAsync(CourseFilterDto filter) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Services\CourseService.cs:line 95
   at CeceLearningPortal.Api.Controllers.CoursesController.GetCourses(CourseFilterDto filter) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Controllers\CoursesController.cs:line 26
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 1526
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 13:49:51.962 +08:00 [INF] Executing ObjectResult, writing value of type '<>f__AnonymousType0`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 13:49:51.963 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 12.5266ms
2025-07-30 13:49:51.963 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-30 13:49:51.964 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses - 500 null application/json; charset=utf-8 21.7441ms
2025-07-30 13:49:54.254 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users - null null
2025-07-30 13:49:54.256 +08:00 [INF] CORS policy execution successful.
2025-07-30 13:49:54.256 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users - 204 null null 2.199ms
2025-07-30 13:49:54.258 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users - application/json null
2025-07-30 13:49:54.259 +08:00 [INF] CORS policy execution successful.
2025-07-30 13:49:54.307 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 13:49:54.308 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-07-30 13:49:54.309 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-07-30 13:49:54.309 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users - 403 0 null 51.1364ms
2025-07-30 13:49:54.311 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses - application/json null
2025-07-30 13:49:54.312 +08:00 [INF] CORS policy execution successful.
2025-07-30 13:49:54.313 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 13:49:54.314 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-30 13:49:54.315 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-30 13:49:54.317 +08:00 [ERR] Failed executing DbCommand (1ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."IsPublished", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."PublishedAt", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."IsFlagged", r."Rating", r."Status", r."StudentId", e."Id", e."AverageQuizScore", e."CertificateIssued", e."CertificateUrl", e."CompletedAt", e."CompletedLessons", e."CourseId", e."EnrolledAt", e."LastAccessedDate", e."ProgressPercentage", e."QuizCount", e."StudentId", e."TotalTimeSpent"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."IsPublished", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."PublishedAt", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-30 13:49:54.320 +08:00 [ERR] An exception occurred while iterating over the results of a query for context type 'CeceLearningPortal.Api.Data.ApplicationDbContext'.
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 1526
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 1526
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 1526
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 1526
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 13:49:54.324 +08:00 [ERR] Error retrieving courses
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 1526
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at CeceLearningPortal.Api.Services.CourseService.GetAllCoursesAsync(CourseFilterDto filter) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Services\CourseService.cs:line 95
   at CeceLearningPortal.Api.Controllers.CoursesController.GetCourses(CourseFilterDto filter) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Controllers\CoursesController.cs:line 26
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 1526
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 13:49:54.329 +08:00 [INF] Executing ObjectResult, writing value of type '<>f__AnonymousType0`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 13:49:54.330 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 14.0736ms
2025-07-30 13:49:54.330 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-30 13:49:54.331 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses - 500 null application/json; charset=utf-8 20.3979ms
2025-07-30 13:49:54.333 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/platform - application/json null
2025-07-30 13:49:54.334 +08:00 [INF] CORS policy execution successful.
2025-07-30 13:49:54.335 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 13:49:54.337 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-07-30 13:49:54.337 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-07-30 13:49:54.338 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/platform - 403 0 null 5.3911ms
2025-07-30 13:49:54.341 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/students/stats - null null
2025-07-30 13:49:54.342 +08:00 [INF] CORS policy execution successful.
2025-07-30 13:49:54.343 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/students/stats - 204 null null 1.7083ms
2025-07-30 13:49:54.344 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/students/stats - application/json null
2025-07-30 13:49:54.346 +08:00 [INF] CORS policy execution successful.
2025-07-30 13:49:54.347 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 13:49:54.348 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.StudentsController.GetStudentStats (CeceLearningPortal.Api)'
2025-07-30 13:49:54.350 +08:00 [INF] Route matched with {action = "GetStudentStats", controller = "Students"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetStudentStats() on controller CeceLearningPortal.Api.Controllers.StudentsController (CeceLearningPortal.Api).
2025-07-30 13:49:54.360 +08:00 [ERR] Failed executing DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT e."Id", e."AverageQuizScore", e."CertificateIssued", e."CertificateUrl", e."CompletedAt", e."CompletedLessons", e."CourseId", e."EnrolledAt", e."LastAccessedDate", e."ProgressPercentage", e."QuizCount", e."StudentId", e."TotalTimeSpent", c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."IsPublished", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."PublishedAt", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
FROM "Enrollments" AS e
INNER JOIN "Courses" AS c ON e."CourseId" = c."Id"
WHERE e."StudentId" = @__userId_0
2025-07-30 13:49:54.362 +08:00 [ERR] An exception occurred while iterating over the results of a query for context type 'CeceLearningPortal.Api.Data.ApplicationDbContext'.
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 398
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 398
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 398
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 398
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 13:49:54.367 +08:00 [ERR] Error retrieving student stats
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 398
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at CeceLearningPortal.Api.Controllers.StudentsController.GetStudentStats() in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Controllers\StudentsController.cs:line 77
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 398
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 13:49:54.372 +08:00 [INF] Executing ObjectResult, writing value of type '<>f__AnonymousType0`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 13:49:54.373 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.StudentsController.GetStudentStats (CeceLearningPortal.Api) in 21.5461ms
2025-07-30 13:49:54.374 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.StudentsController.GetStudentStats (CeceLearningPortal.Api)'
2025-07-30 13:49:54.374 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/students/stats - 500 null application/json; charset=utf-8 30.0598ms
2025-07-30 13:49:54.376 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/students/courses - null null
2025-07-30 13:49:54.377 +08:00 [INF] CORS policy execution successful.
2025-07-30 13:49:54.377 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/students/courses - 204 null null 1.5358ms
2025-07-30 13:49:54.379 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/students/courses - application/json null
2025-07-30 13:49:54.380 +08:00 [INF] CORS policy execution successful.
2025-07-30 13:49:54.382 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 13:49:54.383 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.StudentsController.GetEnrolledCourses (CeceLearningPortal.Api)'
2025-07-30 13:49:54.385 +08:00 [INF] Route matched with {action = "GetEnrolledCourses", controller = "Students"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetEnrolledCourses() on controller CeceLearningPortal.Api.Controllers.StudentsController (CeceLearningPortal.Api).
2025-07-30 13:49:54.393 +08:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2025-07-30 13:49:54.409 +08:00 [ERR] Failed executing DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT e."Id", e."AverageQuizScore", e."CertificateIssued", e."CertificateUrl", e."CompletedAt", e."CompletedLessons", e."CourseId", e."EnrolledAt", e."LastAccessedDate", e."ProgressPercentage", e."QuizCount", e."StudentId", e."TotalTimeSpent", c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."IsPublished", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."PublishedAt", c."Status", c."Thumbnail", c."Title", c."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl"
FROM "Enrollments" AS e
INNER JOIN "Courses" AS c ON e."CourseId" = c."Id"
INNER JOIN "AspNetUsers" AS a ON c."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c0."Id", c0."CourseId", c0."CreatedAt", c0."Description", c0."Order", c0."Title", c0."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c0
    LEFT JOIN "Lessons" AS l ON c0."Id" = l."ModuleId"
) AS s ON c."Id" = s."CourseId"
WHERE e."StudentId" = @__userId_0
ORDER BY COALESCE(e."LastAccessedDate", e."EnrolledAt") DESC, e."Id", c."Id", a."Id", s."Id"
2025-07-30 13:49:54.411 +08:00 [ERR] An exception occurred while iterating over the results of a query for context type 'CeceLearningPortal.Api.Data.ApplicationDbContext'.
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 398
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 398
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 398
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 398
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 13:49:54.417 +08:00 [ERR] Error retrieving enrolled courses
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 398
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at CeceLearningPortal.Api.Controllers.StudentsController.GetEnrolledCourses() in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Controllers\StudentsController.cs:line 32
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 398
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 13:49:54.422 +08:00 [INF] Executing ObjectResult, writing value of type '<>f__AnonymousType0`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 13:49:54.423 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.StudentsController.GetEnrolledCourses (CeceLearningPortal.Api) in 36.6623ms
2025-07-30 13:49:54.424 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.StudentsController.GetEnrolledCourses (CeceLearningPortal.Api)'
2025-07-30 13:49:54.424 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/students/courses - 500 null application/json; charset=utf-8 45.8232ms
2025-07-30 13:49:54.426 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/subscriptions/current - null null
2025-07-30 13:49:54.427 +08:00 [INF] CORS policy execution successful.
2025-07-30 13:49:54.428 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/subscriptions/current - 204 null null 1.6737ms
2025-07-30 13:49:54.429 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/subscriptions/current - application/json null
2025-07-30 13:49:54.430 +08:00 [INF] CORS policy execution successful.
2025-07-30 13:49:54.432 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 13:49:54.433 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/subscriptions/current - 404 0 null 3.8501ms
2025-07-30 13:49:54.435 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5295/api/subscriptions/current, Response status code: 404
2025-07-30 13:50:13.036 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/courses - null null
2025-07-30 13:50:13.036 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/platform - null null
2025-07-30 13:50:13.038 +08:00 [INF] CORS policy execution successful.
2025-07-30 13:50:13.039 +08:00 [INF] CORS policy execution successful.
2025-07-30 13:50:13.040 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/courses - 204 null null 3.4568ms
2025-07-30 13:50:13.040 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/platform - 204 null null 3.6599ms
2025-07-30 13:50:13.041 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses - application/json null
2025-07-30 13:50:13.043 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/platform - application/json null
2025-07-30 13:50:13.044 +08:00 [INF] CORS policy execution successful.
2025-07-30 13:50:13.045 +08:00 [INF] CORS policy execution successful.
2025-07-30 13:50:13.046 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 13:50:13.047 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-30 13:50:13.048 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-30 13:50:13.049 +08:00 [ERR] Failed executing DbCommand (0ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."IsPublished", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."PublishedAt", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."IsFlagged", r."Rating", r."Status", r."StudentId", e."Id", e."AverageQuizScore", e."CertificateIssued", e."CertificateUrl", e."CompletedAt", e."CompletedLessons", e."CourseId", e."EnrolledAt", e."LastAccessedDate", e."ProgressPercentage", e."QuizCount", e."StudentId", e."TotalTimeSpent"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."IsPublished", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."PublishedAt", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-30 13:50:13.052 +08:00 [ERR] An exception occurred while iterating over the results of a query for context type 'CeceLearningPortal.Api.Data.ApplicationDbContext'.
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 1526
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 1526
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 1526
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 1526
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 13:50:13.058 +08:00 [ERR] Error retrieving courses
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 1526
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at CeceLearningPortal.Api.Services.CourseService.GetAllCoursesAsync(CourseFilterDto filter) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Services\CourseService.cs:line 95
   at CeceLearningPortal.Api.Controllers.CoursesController.GetCourses(CourseFilterDto filter) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Controllers\CoursesController.cs:line 26
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 1526
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 13:50:13.063 +08:00 [INF] Executing ObjectResult, writing value of type '<>f__AnonymousType0`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 13:50:13.064 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 15.1221ms
2025-07-30 13:50:13.065 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-30 13:50:13.066 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses - 500 null application/json; charset=utf-8 24.1914ms
2025-07-30 13:50:13.201 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 13:50:13.202 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-07-30 13:50:13.203 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-07-30 13:50:13.203 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/platform - 403 0 null 160.4756ms
2025-07-30 13:56:27.321 +08:00 [INF] Checking database connection...
2025-07-30 13:56:27.913 +08:00 [INF] Database connection successful.
2025-07-30 13:56:27.914 +08:00 [INF] Attempting to apply migrations...
2025-07-30 13:56:27.997 +08:00 [INF] Executed DbCommand (11ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-07-30 13:56:28.233 +08:00 [WRN] Migration failed. This might be due to pending model changes. Continuing anyway...
System.InvalidOperationException: An error was generated for warning 'Microsoft.EntityFrameworkCore.Migrations.PendingModelChangesWarning': The model for context 'ApplicationDbContext' has pending changes. Add a new migration before updating the database. See https://aka.ms/efcore-docs-pending-changes. This exception can be suppressed or logged by passing event ID 'RelationalEventId.PendingModelChangesWarning' to the 'ConfigureWarnings' method in 'DbContext.OnConfiguring' or 'AddDbContext'.
   at Microsoft.EntityFrameworkCore.Diagnostics.EventDefinition`1.Log[TLoggerCategory](IDiagnosticsLogger`1 logger, TParam arg)
   at Microsoft.EntityFrameworkCore.Diagnostics.RelationalLoggerExtensions.PendingModelChangesWarning(IDiagnosticsLogger`1 diagnostics, Type contextType)
   at Microsoft.EntityFrameworkCore.Migrations.Internal.Migrator.ValidateMigrations(Boolean useTransaction, String targetMigration)
   at Microsoft.EntityFrameworkCore.Migrations.Internal.Migrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Program.cs:line 222
2025-07-30 13:56:28.243 +08:00 [INF] Starting data seeding...
2025-07-30 13:56:28.257 +08:00 [INF] User profile is available. Using 'C:\Users\User\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-07-30 13:56:28.373 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Courses" AS c)
2025-07-30 13:56:28.376 +08:00 [INF] Database already contains data. Skipping seed.
2025-07-30 13:56:28.377 +08:00 [INF] Data seeding completed.
2025-07-30 13:56:28.413 +08:00 [INF] Now listening on: http://localhost:5295
2025-07-30 13:56:28.413 +08:00 [INF] Application started. Press Ctrl+C to shut down.
2025-07-30 13:56:28.414 +08:00 [INF] Hosting environment: Development
2025-07-30 13:56:28.414 +08:00 [INF] Content root path: D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api
2025-07-30 13:56:31.513 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/auth/login - null null
2025-07-30 13:56:31.546 +08:00 [WRN] Failed to determine the https port for redirect.
2025-07-30 13:56:31.547 +08:00 [INF] CORS policy execution successful.
2025-07-30 13:56:31.551 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/auth/login - 204 null null 38.1755ms
2025-07-30 13:56:31.555 +08:00 [INF] Request starting HTTP/1.1 POST http://localhost:5295/api/auth/login - application/json 51
2025-07-30 13:56:31.559 +08:00 [INF] CORS policy execution successful.
2025-07-30 13:56:31.580 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AuthController.Login (CeceLearningPortal.Api)'
2025-07-30 13:56:31.588 +08:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(CeceLearningPortal.Api.DTOs.LoginDto) on controller CeceLearningPortal.Api.Controllers.AuthController (CeceLearningPortal.Api).
2025-07-30 13:56:31.674 +08:00 [INF] Executed DbCommand (5ms) [Parameters=[@__normalizedEmail_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."NormalizedEmail" = @__normalizedEmail_0
LIMIT 2
2025-07-30 13:56:31.881 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@p1='?', @p2='?', @p0='?' (DbType = DateTime), @p3='?' (DbType = DateTime), @p4='?', @p5='?' (DbType = DateTime), @p6='?', @p7='?' (DbType = DateTime), @p8='?', @p9='?', @p10='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE "AspNetUsers" SET "LastLoginAt" = @p0
WHERE "Id" = @p1 AND "ConcurrencyStamp" = @p2;
INSERT INTO "RefreshTokens" ("CreatedAt", "CreatedByIp", "ExpiresAt", "ReplacedByToken", "RevokedAt", "RevokedByIp", "Token", "UserId")
VALUES (@p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10)
RETURNING "Id";
2025-07-30 13:56:31.900 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.AuthResponseDto'.
2025-07-30 13:56:31.908 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AuthController.Login (CeceLearningPortal.Api) in 317.2269ms
2025-07-30 13:56:31.909 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AuthController.Login (CeceLearningPortal.Api)'
2025-07-30 13:56:31.912 +08:00 [INF] Request finished HTTP/1.1 POST http://localhost:5295/api/auth/login - 200 null application/json; charset=utf-8 356.5486ms
2025-07-30 13:56:31.923 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/courses - null null
2025-07-30 13:56:31.924 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/platform - null null
2025-07-30 13:56:31.925 +08:00 [INF] CORS policy execution successful.
2025-07-30 13:56:31.926 +08:00 [INF] CORS policy execution successful.
2025-07-30 13:56:31.926 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/courses - 204 null null 3.0192ms
2025-07-30 13:56:31.927 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/platform - 204 null null 2.7378ms
2025-07-30 13:56:31.929 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/platform - application/json null
2025-07-30 13:56:31.930 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses - application/json null
2025-07-30 13:56:31.934 +08:00 [INF] CORS policy execution successful.
2025-07-30 13:56:31.934 +08:00 [INF] CORS policy execution successful.
2025-07-30 13:56:32.000 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 13:56:32.002 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-30 13:56:32.007 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-30 13:56:32.042 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 13:56:32.046 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-07-30 13:56:32.049 +08:00 [INF] Route matched with {action = "GetPlatformAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPlatformAnalytics() on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-30 13:56:32.062 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
2025-07-30 13:56:32.083 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
2025-07-30 13:56:32.089 +08:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2025-07-30 13:56:32.093 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."Status" = 'Completed'
2025-07-30 13:56:32.100 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
2025-07-30 13:56:32.119 +08:00 [ERR] Failed executing DbCommand (3ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."IsPublished", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."PublishedAt", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."IsFlagged", r."Rating", r."Status", r."StudentId", e."Id", e."AverageQuizScore", e."CertificateIssued", e."CertificateUrl", e."CompletedAt", e."CompletedLessons", e."CourseId", e."EnrolledAt", e."LastAccessedDate", e."ProgressPercentage", e."QuizCount", e."StudentId", e."TotalTimeSpent"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."IsPublished", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."PublishedAt", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-30 13:56:32.125 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id" AS "instructorId", a."FullName" AS "instructorName", (
    SELECT count(*)::int
    FROM "Courses" AS c0
    WHERE c0."InstructorId" = a."Id") AS "totalCourses", (
    SELECT count(*)::int
    FROM "Enrollments" AS e
    INNER JOIN "Courses" AS c1 ON e."CourseId" = c1."Id"
    WHERE c1."InstructorId" = a."Id") AS "totalStudents", (
    SELECT COALESCE(sum(p0."Amount"), 0.0)
    FROM "Payments" AS p0
    LEFT JOIN "Courses" AS c2 ON p0."CourseId" = c2."Id"
    WHERE c2."InstructorId" = a."Id" AND p0."Status" = 'Completed') AS "totalRevenue", COALESCE((
    SELECT avg(r."Rating"::double precision)
    FROM "Reviews" AS r
    INNER JOIN "Courses" AS c3 ON r."CourseId" = c3."Id"
    WHERE c3."InstructorId" = a."Id"), 0.0) AS "averageRating"
FROM "AspNetUsers" AS a
WHERE a."Role" = 'Instructor'
ORDER BY (
    SELECT COALESCE(sum(p."Amount"), 0.0)
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
    WHERE c."InstructorId" = a."Id" AND p."Status" = 'Completed') DESC
LIMIT @__p_0
2025-07-30 13:56:32.125 +08:00 [ERR] An exception occurred while iterating over the results of a query for context type 'CeceLearningPortal.Api.Data.ApplicationDbContext'.
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 1526
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 1526
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 1526
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 1526
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 13:56:32.132 +08:00 [ERR] Error retrieving courses
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 1526
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at CeceLearningPortal.Api.Services.CourseService.GetAllCoursesAsync(CourseFilterDto filter) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Services\CourseService.cs:line 95
   at CeceLearningPortal.Api.Controllers.CoursesController.GetCourses(CourseFilterDto filter) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Controllers\CoursesController.cs:line 26
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 1526
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 13:56:32.137 +08:00 [INF] Executing ObjectResult, writing value of type '<>f__AnonymousType0`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 13:56:32.140 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 131.7077ms
2025-07-30 13:56:32.141 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-30 13:56:32.141 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses - 500 null application/json; charset=utf-8 211ms
2025-07-30 13:56:32.147 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT c."Category" AS category, count(*)::int AS "courseCount", COALESCE(sum((
    SELECT count(*)::int
    FROM "Enrollments" AS e
    WHERE c."Id" = e."CourseId")), 0)::int AS "enrollmentCount", (
    SELECT COALESCE(sum(p."Amount"), 0.0)
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c0 ON p."CourseId" = c0."Id"
    WHERE c0."Category" = c."Category" AND p."Status" = 'Completed') AS revenue
FROM "Courses" AS c
GROUP BY c."Category"
ORDER BY COALESCE(sum((
    SELECT count(*)::int
    FROM "Enrollments" AS e
    WHERE c."Id" = e."CourseId")), 0)::int DESC
2025-07-30 13:56:32.156 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT p0."Year", p0."Month", COALESCE(sum(p0."Amount"), 0.0) AS "Revenue", count(*)::int AS "TransactionCount"
FROM (
    SELECT p."Amount", date_part('year', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "Payments" AS p
    WHERE p."Status" = 'Completed' AND p."CreatedAt" >= @__sixMonthsAgo_0
) AS p0
GROUP BY p0."Year", p0."Month"
2025-07-30 13:56:32.163 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT a0."Year", a0."Month", count(*)::int AS "NewUsers"
FROM (
    SELECT date_part('year', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "AspNetUsers" AS a
    WHERE a."CreatedAt" >= @__sixMonthsAgo_0
) AS a0
GROUP BY a0."Year", a0."Month"
2025-07-30 13:56:32.170 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Subscriptions" AS s
WHERE s."Status" = 'Active'
2025-07-30 13:56:32.177 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s."PlanName" AS plan, count(*)::int AS count, COALESCE(sum(s."Price"), 0.0) AS "monthlyRevenue"
FROM "Subscriptions" AS s
WHERE s."Status" = 'Active'
GROUP BY s."PlanName"
2025-07-30 13:56:32.179 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType20`6[[<>f__AnonymousType21`5[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 13:56:32.189 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api) in 139.5216ms
2025-07-30 13:56:32.190 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-07-30 13:56:32.191 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/platform - 200 null application/json; charset=utf-8 262.0529ms
2025-07-30 13:56:34.405 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/platform - application/json null
2025-07-30 13:56:34.406 +08:00 [INF] CORS policy execution successful.
2025-07-30 13:56:34.410 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 13:56:34.413 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-07-30 13:56:34.414 +08:00 [INF] Route matched with {action = "GetPlatformAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPlatformAnalytics() on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-30 13:56:34.416 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
2025-07-30 13:56:34.418 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
2025-07-30 13:56:34.419 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."Status" = 'Completed'
2025-07-30 13:56:34.420 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
2025-07-30 13:56:34.424 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id" AS "instructorId", a."FullName" AS "instructorName", (
    SELECT count(*)::int
    FROM "Courses" AS c0
    WHERE c0."InstructorId" = a."Id") AS "totalCourses", (
    SELECT count(*)::int
    FROM "Enrollments" AS e
    INNER JOIN "Courses" AS c1 ON e."CourseId" = c1."Id"
    WHERE c1."InstructorId" = a."Id") AS "totalStudents", (
    SELECT COALESCE(sum(p0."Amount"), 0.0)
    FROM "Payments" AS p0
    LEFT JOIN "Courses" AS c2 ON p0."CourseId" = c2."Id"
    WHERE c2."InstructorId" = a."Id" AND p0."Status" = 'Completed') AS "totalRevenue", COALESCE((
    SELECT avg(r."Rating"::double precision)
    FROM "Reviews" AS r
    INNER JOIN "Courses" AS c3 ON r."CourseId" = c3."Id"
    WHERE c3."InstructorId" = a."Id"), 0.0) AS "averageRating"
FROM "AspNetUsers" AS a
WHERE a."Role" = 'Instructor'
ORDER BY (
    SELECT COALESCE(sum(p."Amount"), 0.0)
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
    WHERE c."InstructorId" = a."Id" AND p."Status" = 'Completed') DESC
LIMIT @__p_0
2025-07-30 13:56:34.427 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT c."Category" AS category, count(*)::int AS "courseCount", COALESCE(sum((
    SELECT count(*)::int
    FROM "Enrollments" AS e
    WHERE c."Id" = e."CourseId")), 0)::int AS "enrollmentCount", (
    SELECT COALESCE(sum(p."Amount"), 0.0)
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c0 ON p."CourseId" = c0."Id"
    WHERE c0."Category" = c."Category" AND p."Status" = 'Completed') AS revenue
FROM "Courses" AS c
GROUP BY c."Category"
ORDER BY COALESCE(sum((
    SELECT count(*)::int
    FROM "Enrollments" AS e
    WHERE c."Id" = e."CourseId")), 0)::int DESC
2025-07-30 13:56:34.429 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT p0."Year", p0."Month", COALESCE(sum(p0."Amount"), 0.0) AS "Revenue", count(*)::int AS "TransactionCount"
FROM (
    SELECT p."Amount", date_part('year', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "Payments" AS p
    WHERE p."Status" = 'Completed' AND p."CreatedAt" >= @__sixMonthsAgo_0
) AS p0
GROUP BY p0."Year", p0."Month"
2025-07-30 13:56:34.431 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT a0."Year", a0."Month", count(*)::int AS "NewUsers"
FROM (
    SELECT date_part('year', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "AspNetUsers" AS a
    WHERE a."CreatedAt" >= @__sixMonthsAgo_0
) AS a0
GROUP BY a0."Year", a0."Month"
2025-07-30 13:56:34.432 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Subscriptions" AS s
WHERE s."Status" = 'Active'
2025-07-30 13:56:34.433 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s."PlanName" AS plan, count(*)::int AS count, COALESCE(sum(s."Price"), 0.0) AS "monthlyRevenue"
FROM "Subscriptions" AS s
WHERE s."Status" = 'Active'
GROUP BY s."PlanName"
2025-07-30 13:56:34.434 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType20`6[[<>f__AnonymousType21`5[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 13:56:34.436 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api) in 20.844ms
2025-07-30 13:56:34.436 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-07-30 13:56:34.437 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/platform - 200 null application/json; charset=utf-8 32.3209ms
2025-07-30 13:56:34.438 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/course-completions - null null
2025-07-30 13:56:34.439 +08:00 [INF] CORS policy execution successful.
2025-07-30 13:56:34.440 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/course-completions - 204 null null 1.6428ms
2025-07-30 13:56:34.441 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/course-completions - application/json null
2025-07-30 13:56:34.445 +08:00 [INF] CORS policy execution successful.
2025-07-30 13:56:34.448 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 13:56:34.450 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetCourseCompletions (CeceLearningPortal.Api)'
2025-07-30 13:56:34.453 +08:00 [INF] Route matched with {action = "GetCourseCompletions", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourseCompletions(Int32) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 13:56:34.481 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT e0."Id", a."FullName", a."Avatar", a."Email", c."Title", e0."CourseId"::text, e0."CompletedAt", COALESCE(e0."AverageQuizScore", 0.0), e0."CertificateIssued", e0."CertificateUrl"
FROM (
    SELECT e."Id", e."AverageQuizScore", e."CertificateIssued", e."CertificateUrl", e."CompletedAt", e."CourseId", e."StudentId"
    FROM "Enrollments" AS e
    WHERE e."CompletedAt" IS NOT NULL
    ORDER BY e."CompletedAt" DESC
    LIMIT @__p_0
) AS e0
INNER JOIN "AspNetUsers" AS a ON e0."StudentId" = a."Id"
INNER JOIN "Courses" AS c ON e0."CourseId" = c."Id"
ORDER BY e0."CompletedAt" DESC
2025-07-30 13:56:34.483 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType9`10[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-30 13:56:34.486 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetCourseCompletions (CeceLearningPortal.Api) in 32.1598ms
2025-07-30 13:56:34.487 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetCourseCompletions (CeceLearningPortal.Api)'
2025-07-30 13:56:34.488 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/course-completions - 200 null application/json; charset=utf-8 46.2951ms
2025-07-30 13:56:36.154 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users - null null
2025-07-30 13:56:36.154 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/subscription-plans - null null
2025-07-30 13:56:36.156 +08:00 [INF] CORS policy execution successful.
2025-07-30 13:56:36.156 +08:00 [INF] CORS policy execution successful.
2025-07-30 13:56:36.157 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users - 204 null null 2.7927ms
2025-07-30 13:56:36.157 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/subscription-plans - 204 null null 2.8941ms
2025-07-30 13:56:36.159 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/subscription-plans - application/json null
2025-07-30 13:56:36.160 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users - application/json null
2025-07-30 13:56:36.161 +08:00 [INF] CORS policy execution successful.
2025-07-30 13:56:36.162 +08:00 [INF] CORS policy execution successful.
2025-07-30 13:56:36.164 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 13:56:36.164 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 13:56:36.165 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetSubscriptionPlans (CeceLearningPortal.Api)'
2025-07-30 13:56:36.166 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUsers (CeceLearningPortal.Api)'
2025-07-30 13:56:36.168 +08:00 [INF] Route matched with {action = "GetSubscriptionPlans", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetSubscriptionPlans() on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 13:56:36.170 +08:00 [INF] Route matched with {action = "GetUsers", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUsers(CeceLearningPortal.Api.DTOs.UserManagementFilterDto) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 13:56:36.177 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
2025-07-30 13:56:36.184 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."UserName", a."Email", a."FullName", a."Role", a."Status", a."CreatedAt", a."LastLoginAt", a."EmailConfirmed"
FROM "AspNetUsers" AS a
ORDER BY a."CreatedAt" DESC
LIMIT @__p_1 OFFSET @__p_0
2025-07-30 13:56:36.185 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[CeceLearningPortal.Api.DTOs.UserManagementDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-30 13:56:36.186 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."CreatedAt", s."Description", s."DisplayOrder", s."Features", s."HasAnalytics", s."HasPrioritySupport", s."HasUnlimitedAccess", s."IsActive", s."IsRecommended", s."MaxCourseAccess", s."MaxCoursesCanCreate", s."MaxStudentsPerCourse", s."MonthlyPrice", s."Name", s."PlanType", s."TransactionFeePercentage", s."UpdatedAt", s."YearlyPrice", s0."Id", s0."BillingCycle", s0."CreatedAt", s0."EndDate", s0."NextBillingDate", s0."PlanName", s0."Price", s0."StartDate", s0."Status", s0."StripeSubscriptionId", s0."SubscriptionPlanId", s0."UpdatedAt", s0."UserId"
FROM "SubscriptionPlans" AS s
LEFT JOIN "Subscriptions" AS s0 ON s."Id" = s0."SubscriptionPlanId"
ORDER BY s."Id"
2025-07-30 13:56:36.187 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[CeceLearningPortal.Api.DTOs.SubscriptionPlanDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-30 13:56:36.196 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUsers (CeceLearningPortal.Api) in 25.061ms
2025-07-30 13:56:36.197 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetSubscriptionPlans (CeceLearningPortal.Api) in 27.7137ms
2025-07-30 13:56:36.197 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUsers (CeceLearningPortal.Api)'
2025-07-30 13:56:36.198 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetSubscriptionPlans (CeceLearningPortal.Api)'
2025-07-30 13:56:36.198 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users - 200 null application/json; charset=utf-8 38.1859ms
2025-07-30 13:56:36.199 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/subscription-plans - 200 null application/json; charset=utf-8 39.7995ms
2025-07-30 13:56:36.200 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/e090c598-224f-4b4c-870a-3c3ef6303e0a/subscription - null null
2025-07-30 13:56:36.201 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/801dc698-62a8-49c3-b578-b7c1b05049a4/subscription - null null
2025-07-30 13:56:36.201 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/28b8e854-738a-4e69-835c-71299a8f9b21/subscription - null null
2025-07-30 13:56:36.201 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/f9f0e64e-3771-4aa9-8470-21e709677e44/subscription - null null
2025-07-30 13:56:36.201 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/efead752-f0b3-48ab-93b8-7ba31e7574ba/subscription - null null
2025-07-30 13:56:36.202 +08:00 [INF] CORS policy execution successful.
2025-07-30 13:56:36.204 +08:00 [INF] CORS policy execution successful.
2025-07-30 13:56:36.204 +08:00 [INF] CORS policy execution successful.
2025-07-30 13:56:36.205 +08:00 [INF] CORS policy execution successful.
2025-07-30 13:56:36.206 +08:00 [INF] CORS policy execution successful.
2025-07-30 13:56:36.206 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/e090c598-224f-4b4c-870a-3c3ef6303e0a/subscription - 204 null null 6.2692ms
2025-07-30 13:56:36.207 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/801dc698-62a8-49c3-b578-b7c1b05049a4/subscription - 204 null null 6.2365ms
2025-07-30 13:56:36.207 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/28b8e854-738a-4e69-835c-71299a8f9b21/subscription - 204 null null 6.3081ms
2025-07-30 13:56:36.208 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/f9f0e64e-3771-4aa9-8470-21e709677e44/subscription - 204 null null 6.4912ms
2025-07-30 13:56:36.208 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/efead752-f0b3-48ab-93b8-7ba31e7574ba/subscription - 204 null null 6.8569ms
2025-07-30 13:56:36.210 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/efead752-f0b3-48ab-93b8-7ba31e7574ba/subscription - application/json null
2025-07-30 13:56:36.211 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/28b8e854-738a-4e69-835c-71299a8f9b21/subscription - application/json null
2025-07-30 13:56:36.212 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/e090c598-224f-4b4c-870a-3c3ef6303e0a/subscription - application/json null
2025-07-30 13:56:36.214 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/801dc698-62a8-49c3-b578-b7c1b05049a4/subscription - application/json null
2025-07-30 13:56:36.215 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/f9f0e64e-3771-4aa9-8470-21e709677e44/subscription - application/json null
2025-07-30 13:56:36.216 +08:00 [INF] CORS policy execution successful.
2025-07-30 13:56:36.217 +08:00 [INF] CORS policy execution successful.
2025-07-30 13:56:36.218 +08:00 [INF] CORS policy execution successful.
2025-07-30 13:56:36.219 +08:00 [INF] CORS policy execution successful.
2025-07-30 13:56:36.220 +08:00 [INF] CORS policy execution successful.
2025-07-30 13:56:36.221 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 13:56:36.221 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 13:56:36.223 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 13:56:36.224 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 13:56:36.226 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 13:56:36.226 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 13:56:36.239 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 13:56:36.239 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 13:56:36.241 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType83`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 13:56:36.242 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType83`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 13:56:36.244 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 17.3947ms
2025-07-30 13:56:36.244 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 16.4135ms
2025-07-30 13:56:36.245 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 13:56:36.246 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 13:56:36.246 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/28b8e854-738a-4e69-835c-71299a8f9b21/subscription - 200 null application/json; charset=utf-8 35.4703ms
2025-07-30 13:56:36.247 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/efead752-f0b3-48ab-93b8-7ba31e7574ba/subscription - 200 null application/json; charset=utf-8 37.4593ms
2025-07-30 13:56:36.267 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 13:56:36.268 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 13:56:36.269 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 13:56:36.271 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 13:56:36.272 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 13:56:36.272 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType83`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 13:56:36.273 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 13:56:36.274 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 4.079ms
2025-07-30 13:56:36.274 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 13:56:36.275 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 13:56:36.276 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/e090c598-224f-4b4c-870a-3c3ef6303e0a/subscription - 200 null application/json; charset=utf-8 63.757ms
2025-07-30 13:56:36.277 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 13:56:36.277 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 13:56:36.279 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType83`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 13:56:36.280 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 13:56:36.281 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 4.8433ms
2025-07-30 13:56:36.281 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 13:56:36.282 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 13:56:36.283 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/801dc698-62a8-49c3-b578-b7c1b05049a4/subscription - 200 null application/json; charset=utf-8 69.349ms
2025-07-30 13:56:36.285 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 13:56:36.286 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType83`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 13:56:36.287 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 4.5603ms
2025-07-30 13:56:36.288 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 13:56:36.288 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/f9f0e64e-3771-4aa9-8470-21e709677e44/subscription - 200 null application/json; charset=utf-8 73.2245ms
2025-07-30 13:56:37.244 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/courses - null null
2025-07-30 13:56:37.245 +08:00 [INF] CORS policy execution successful.
2025-07-30 13:56:37.246 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/courses - 204 null null 2.2039ms
2025-07-30 13:56:37.247 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses - application/json null
2025-07-30 13:56:37.248 +08:00 [INF] CORS policy execution successful.
2025-07-30 13:56:37.250 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 13:56:37.251 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-30 13:56:37.252 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-30 13:56:37.254 +08:00 [ERR] Failed executing DbCommand (1ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."IsPublished", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."PublishedAt", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."IsFlagged", r."Rating", r."Status", r."StudentId", e."Id", e."AverageQuizScore", e."CertificateIssued", e."CertificateUrl", e."CompletedAt", e."CompletedLessons", e."CourseId", e."EnrolledAt", e."LastAccessedDate", e."ProgressPercentage", e."QuizCount", e."StudentId", e."TotalTimeSpent"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."IsPublished", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."PublishedAt", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-30 13:56:37.257 +08:00 [ERR] An exception occurred while iterating over the results of a query for context type 'CeceLearningPortal.Api.Data.ApplicationDbContext'.
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 1526
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 1526
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 1526
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 1526
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 13:56:37.261 +08:00 [ERR] Error retrieving courses
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 1526
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at CeceLearningPortal.Api.Services.CourseService.GetAllCoursesAsync(CourseFilterDto filter) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Services\CourseService.cs:line 95
   at CeceLearningPortal.Api.Controllers.CoursesController.GetCourses(CourseFilterDto filter) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Controllers\CoursesController.cs:line 26
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 1526
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 13:56:37.266 +08:00 [INF] Executing ObjectResult, writing value of type '<>f__AnonymousType0`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 13:56:37.267 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 14.3103ms
2025-07-30 13:56:37.268 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-30 13:56:37.268 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses - 500 null application/json; charset=utf-8 20.8976ms
2025-07-30 13:56:46.286 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/courses - null null
2025-07-30 13:56:46.287 +08:00 [INF] CORS policy execution successful.
2025-07-30 13:56:46.288 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/courses - 204 null null 1.7995ms
2025-07-30 13:56:46.289 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses - application/json null
2025-07-30 13:56:46.290 +08:00 [INF] CORS policy execution successful.
2025-07-30 13:56:46.292 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 13:56:46.293 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-30 13:56:46.294 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-30 13:56:46.297 +08:00 [ERR] Failed executing DbCommand (1ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."IsPublished", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."PublishedAt", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."IsFlagged", r."Rating", r."Status", r."StudentId", e."Id", e."AverageQuizScore", e."CertificateIssued", e."CertificateUrl", e."CompletedAt", e."CompletedLessons", e."CourseId", e."EnrolledAt", e."LastAccessedDate", e."ProgressPercentage", e."QuizCount", e."StudentId", e."TotalTimeSpent"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."IsPublished", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."PublishedAt", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-30 13:56:46.299 +08:00 [ERR] An exception occurred while iterating over the results of a query for context type 'CeceLearningPortal.Api.Data.ApplicationDbContext'.
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 1526
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 1526
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 1526
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 1526
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 13:56:46.303 +08:00 [ERR] Error retrieving courses
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 1526
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at CeceLearningPortal.Api.Services.CourseService.GetAllCoursesAsync(CourseFilterDto filter) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Services\CourseService.cs:line 95
   at CeceLearningPortal.Api.Controllers.CoursesController.GetCourses(CourseFilterDto filter) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Controllers\CoursesController.cs:line 26
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 1526
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 13:56:46.307 +08:00 [INF] Executing ObjectResult, writing value of type '<>f__AnonymousType0`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 13:56:46.308 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 13.0761ms
2025-07-30 13:56:46.309 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-30 13:56:46.309 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses - 500 null application/json; charset=utf-8 19.771ms
2025-07-30 13:56:48.054 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/subscriptions - null null
2025-07-30 13:56:48.055 +08:00 [INF] CORS policy execution successful.
2025-07-30 13:56:48.056 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/subscriptions - 204 null null 1.8443ms
2025-07-30 13:56:48.057 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/subscriptions - application/json null
2025-07-30 13:56:48.058 +08:00 [INF] CORS policy execution successful.
2025-07-30 13:56:48.059 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 13:56:48.060 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/subscriptions - 404 0 null 3.582ms
2025-07-30 13:56:48.062 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5295/api/admin/subscriptions, Response status code: 404
2025-07-30 13:56:49.120 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/subscription-plans - null null
2025-07-30 13:56:49.122 +08:00 [INF] CORS policy execution successful.
2025-07-30 13:56:49.122 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/subscription-plans - 204 null null 1.6177ms
2025-07-30 13:56:49.124 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/subscription-plans - application/json null
2025-07-30 13:56:49.124 +08:00 [INF] CORS policy execution successful.
2025-07-30 13:56:49.126 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 13:56:49.127 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetSubscriptionPlans (CeceLearningPortal.Api)'
2025-07-30 13:56:49.127 +08:00 [INF] Route matched with {action = "GetSubscriptionPlans", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetSubscriptionPlans() on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 13:56:49.131 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."CreatedAt", s."Description", s."DisplayOrder", s."Features", s."HasAnalytics", s."HasPrioritySupport", s."HasUnlimitedAccess", s."IsActive", s."IsRecommended", s."MaxCourseAccess", s."MaxCoursesCanCreate", s."MaxStudentsPerCourse", s."MonthlyPrice", s."Name", s."PlanType", s."TransactionFeePercentage", s."UpdatedAt", s."YearlyPrice", s0."Id", s0."BillingCycle", s0."CreatedAt", s0."EndDate", s0."NextBillingDate", s0."PlanName", s0."Price", s0."StartDate", s0."Status", s0."StripeSubscriptionId", s0."SubscriptionPlanId", s0."UpdatedAt", s0."UserId"
FROM "SubscriptionPlans" AS s
LEFT JOIN "Subscriptions" AS s0 ON s."Id" = s0."SubscriptionPlanId"
ORDER BY s."Id"
2025-07-30 13:56:49.132 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[CeceLearningPortal.Api.DTOs.SubscriptionPlanDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-30 13:56:49.132 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetSubscriptionPlans (CeceLearningPortal.Api) in 4.1157ms
2025-07-30 13:56:49.133 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetSubscriptionPlans (CeceLearningPortal.Api)'
2025-07-30 13:56:49.134 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/subscription-plans - 200 null application/json; charset=utf-8 10.2299ms
2025-07-30 13:56:50.013 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/subscriptions - application/json null
2025-07-30 13:56:50.014 +08:00 [INF] CORS policy execution successful.
2025-07-30 13:56:50.016 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 13:56:50.017 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/subscriptions - 404 0 null 4.234ms
2025-07-30 13:56:50.018 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5295/api/admin/subscriptions, Response status code: 404
2025-07-30 13:56:51.083 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses - application/json null
2025-07-30 13:56:51.084 +08:00 [INF] CORS policy execution successful.
2025-07-30 13:56:51.086 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 13:56:51.087 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-30 13:56:51.088 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-30 13:56:51.090 +08:00 [ERR] Failed executing DbCommand (1ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."IsPublished", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."PublishedAt", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."IsFlagged", r."Rating", r."Status", r."StudentId", e."Id", e."AverageQuizScore", e."CertificateIssued", e."CertificateUrl", e."CompletedAt", e."CompletedLessons", e."CourseId", e."EnrolledAt", e."LastAccessedDate", e."ProgressPercentage", e."QuizCount", e."StudentId", e."TotalTimeSpent"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."IsPublished", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."PublishedAt", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-30 13:56:51.092 +08:00 [ERR] An exception occurred while iterating over the results of a query for context type 'CeceLearningPortal.Api.Data.ApplicationDbContext'.
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 1526
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 1526
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 1526
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 1526
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 13:56:51.097 +08:00 [ERR] Error retrieving courses
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 1526
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at CeceLearningPortal.Api.Services.CourseService.GetAllCoursesAsync(CourseFilterDto filter) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Services\CourseService.cs:line 95
   at CeceLearningPortal.Api.Controllers.CoursesController.GetCourses(CourseFilterDto filter) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Controllers\CoursesController.cs:line 26
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 1526
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 13:56:51.101 +08:00 [INF] Executing ObjectResult, writing value of type '<>f__AnonymousType0`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 13:56:51.102 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 13.2208ms
2025-07-30 13:56:51.102 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-30 13:56:51.103 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses - 500 null application/json; charset=utf-8 20.1804ms
2025-07-30 16:01:27.030 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users - null null
2025-07-30 16:01:27.030 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/subscription-plans - null null
2025-07-30 16:01:27.031 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:01:27.033 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:01:27.033 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users - 204 null null 3.5639ms
2025-07-30 16:01:27.033 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/subscription-plans - 204 null null 3.9238ms
2025-07-30 16:01:27.035 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/subscription-plans - application/json null
2025-07-30 16:01:27.036 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users - application/json null
2025-07-30 16:01:27.037 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:01:27.039 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:01:27.041 +08:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '7/30/2025 6:56:31 AM', Current time (UTC): '7/30/2025 8:01:27 AM'.
   at Microsoft.IdentityModel.Tokens.ValidatorUtilities.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2025-07-30 16:01:27.041 +08:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '7/30/2025 6:56:31 AM', Current time (UTC): '7/30/2025 8:01:27 AM'.
   at Microsoft.IdentityModel.Tokens.ValidatorUtilities.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2025-07-30 16:01:27.043 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '7/30/2025 6:56:31 AM', Current time (UTC): '7/30/2025 8:01:27 AM'.
2025-07-30 16:01:27.044 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '7/30/2025 6:56:31 AM', Current time (UTC): '7/30/2025 8:01:27 AM'.
2025-07-30 16:01:27.044 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '7/30/2025 6:56:31 AM', Current time (UTC): '7/30/2025 8:01:27 AM'.
2025-07-30 16:01:27.045 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '7/30/2025 6:56:31 AM', Current time (UTC): '7/30/2025 8:01:27 AM'.
2025-07-30 16:01:27.092 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 16:01:27.095 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-07-30 16:01:27.096 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 16:01:27.097 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-07-30 16:01:27.097 +08:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-07-30 16:01:27.098 +08:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-07-30 16:01:27.098 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users - 401 0 null 61.7604ms
2025-07-30 16:01:27.098 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/subscription-plans - 401 0 null 63.1625ms
2025-07-30 16:01:27.628 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/courses - null null
2025-07-30 16:01:27.630 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:01:27.630 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/courses - 204 null null 2.0592ms
2025-07-30 16:01:27.632 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses - application/json null
2025-07-30 16:01:27.633 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:01:27.633 +08:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '7/30/2025 6:56:31 AM', Current time (UTC): '7/30/2025 8:01:27 AM'.
   at Microsoft.IdentityModel.Tokens.ValidatorUtilities.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2025-07-30 16:01:27.635 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '7/30/2025 6:56:31 AM', Current time (UTC): '7/30/2025 8:01:27 AM'.
2025-07-30 16:01:27.635 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '7/30/2025 6:56:31 AM', Current time (UTC): '7/30/2025 8:01:27 AM'.
2025-07-30 16:01:27.636 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 16:01:27.638 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-30 16:01:27.638 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-30 16:01:27.641 +08:00 [ERR] Failed executing DbCommand (1ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."IsPublished", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."PublishedAt", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."IsFlagged", r."Rating", r."Status", r."StudentId", e."Id", e."AverageQuizScore", e."CertificateIssued", e."CertificateUrl", e."CompletedAt", e."CompletedLessons", e."CourseId", e."EnrolledAt", e."LastAccessedDate", e."ProgressPercentage", e."QuizCount", e."StudentId", e."TotalTimeSpent"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."IsPublished", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."PublishedAt", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-30 16:01:27.643 +08:00 [ERR] An exception occurred while iterating over the results of a query for context type 'CeceLearningPortal.Api.Data.ApplicationDbContext'.
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 1526
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 1526
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 1526
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 1526
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 16:01:27.647 +08:00 [ERR] Error retrieving courses
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 1526
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at CeceLearningPortal.Api.Services.CourseService.GetAllCoursesAsync(CourseFilterDto filter) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Services\CourseService.cs:line 95
   at CeceLearningPortal.Api.Controllers.CoursesController.GetCourses(CourseFilterDto filter) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Controllers\CoursesController.cs:line 26
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 1526
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 16:01:27.651 +08:00 [INF] Executing ObjectResult, writing value of type '<>f__AnonymousType0`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 16:01:27.652 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 12.9814ms
2025-07-30 16:01:27.653 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-30 16:01:27.653 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses - 500 null application/json; charset=utf-8 21.4863ms
2025-07-30 16:01:30.278 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/subscriptions - null null
2025-07-30 16:01:30.280 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:01:30.280 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/subscriptions - 204 null null 1.7311ms
2025-07-30 16:01:30.281 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/subscriptions - application/json null
2025-07-30 16:01:30.282 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:01:30.283 +08:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '7/30/2025 6:56:31 AM', Current time (UTC): '7/30/2025 8:01:30 AM'.
   at Microsoft.IdentityModel.Tokens.ValidatorUtilities.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2025-07-30 16:01:30.284 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '7/30/2025 6:56:31 AM', Current time (UTC): '7/30/2025 8:01:30 AM'.
2025-07-30 16:01:30.285 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '7/30/2025 6:56:31 AM', Current time (UTC): '7/30/2025 8:01:30 AM'.
2025-07-30 16:01:30.286 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 16:01:30.287 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/subscriptions - 404 0 null 5.7258ms
2025-07-30 16:01:30.288 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5295/api/admin/subscriptions, Response status code: 404
2025-07-30 16:01:37.814 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/subscription-plans - null null
2025-07-30 16:01:37.816 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:01:37.816 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/subscription-plans - 204 null null 1.7109ms
2025-07-30 16:01:37.818 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/subscription-plans - application/json null
2025-07-30 16:01:37.819 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:01:37.819 +08:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '7/30/2025 6:56:31 AM', Current time (UTC): '7/30/2025 8:01:37 AM'.
   at Microsoft.IdentityModel.Tokens.ValidatorUtilities.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2025-07-30 16:01:37.820 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '7/30/2025 6:56:31 AM', Current time (UTC): '7/30/2025 8:01:37 AM'.
2025-07-30 16:01:37.821 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '7/30/2025 6:56:31 AM', Current time (UTC): '7/30/2025 8:01:37 AM'.
2025-07-30 16:01:37.822 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 16:01:37.823 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-07-30 16:01:37.824 +08:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-07-30 16:01:37.824 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/subscription-plans - 401 0 null 6.8197ms
2025-07-30 16:01:39.129 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/policies - null null
2025-07-30 16:01:39.131 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:01:39.131 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/policies - 204 null null 1.8438ms
2025-07-30 16:01:39.132 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/policies - application/json null
2025-07-30 16:01:39.133 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:01:39.134 +08:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '7/30/2025 6:56:31 AM', Current time (UTC): '7/30/2025 8:01:39 AM'.
   at Microsoft.IdentityModel.Tokens.ValidatorUtilities.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2025-07-30 16:01:39.135 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '7/30/2025 6:56:31 AM', Current time (UTC): '7/30/2025 8:01:39 AM'.
2025-07-30 16:01:39.136 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '7/30/2025 6:56:31 AM', Current time (UTC): '7/30/2025 8:01:39 AM'.
2025-07-30 16:01:39.137 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 16:01:39.139 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-07-30 16:01:39.139 +08:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-07-30 16:01:39.139 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/policies - 401 0 null 7.0024ms
2025-07-30 16:01:42.415 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/tasks - null null
2025-07-30 16:01:42.417 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:01:42.417 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/tasks - 204 null null 1.8055ms
2025-07-30 16:01:42.419 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/tasks - application/json null
2025-07-30 16:01:42.420 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:01:42.420 +08:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '7/30/2025 6:56:31 AM', Current time (UTC): '7/30/2025 8:01:42 AM'.
   at Microsoft.IdentityModel.Tokens.ValidatorUtilities.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2025-07-30 16:01:42.421 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '7/30/2025 6:56:31 AM', Current time (UTC): '7/30/2025 8:01:42 AM'.
2025-07-30 16:01:42.422 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '7/30/2025 6:56:31 AM', Current time (UTC): '7/30/2025 8:01:42 AM'.
2025-07-30 16:01:42.424 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 16:01:42.425 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-07-30 16:01:42.425 +08:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-07-30 16:01:42.426 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/tasks - 401 0 null 7.1511ms
2025-07-30 16:01:43.295 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/policies - application/json null
2025-07-30 16:01:43.296 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:01:43.297 +08:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '7/30/2025 6:56:31 AM', Current time (UTC): '7/30/2025 8:01:43 AM'.
   at Microsoft.IdentityModel.Tokens.ValidatorUtilities.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2025-07-30 16:01:43.299 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '7/30/2025 6:56:31 AM', Current time (UTC): '7/30/2025 8:01:43 AM'.
2025-07-30 16:01:43.299 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '7/30/2025 6:56:31 AM', Current time (UTC): '7/30/2025 8:01:43 AM'.
2025-07-30 16:01:43.301 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 16:01:43.302 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-07-30 16:01:43.303 +08:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-07-30 16:01:43.304 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/policies - 401 0 null 8.7292ms
2025-07-30 16:01:46.142 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/tasks - application/json null
2025-07-30 16:01:46.143 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:01:46.144 +08:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '7/30/2025 6:56:31 AM', Current time (UTC): '7/30/2025 8:01:46 AM'.
   at Microsoft.IdentityModel.Tokens.ValidatorUtilities.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2025-07-30 16:01:46.145 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '7/30/2025 6:56:31 AM', Current time (UTC): '7/30/2025 8:01:46 AM'.
2025-07-30 16:01:46.146 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '7/30/2025 6:56:31 AM', Current time (UTC): '7/30/2025 8:01:46 AM'.
2025-07-30 16:01:46.147 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 16:01:46.148 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-07-30 16:01:46.149 +08:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-07-30 16:01:46.149 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/tasks - 401 0 null 7.4865ms
2025-07-30 16:01:48.422 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/onboarding-progress - null null
2025-07-30 16:01:48.424 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:01:48.424 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/onboarding-progress - 204 null null 2.487ms
2025-07-30 16:01:48.426 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/onboarding-progress - application/json null
2025-07-30 16:01:48.428 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:01:48.429 +08:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '7/30/2025 6:56:31 AM', Current time (UTC): '7/30/2025 8:01:48 AM'.
   at Microsoft.IdentityModel.Tokens.ValidatorUtilities.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2025-07-30 16:01:48.430 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '7/30/2025 6:56:31 AM', Current time (UTC): '7/30/2025 8:01:48 AM'.
2025-07-30 16:01:48.431 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '7/30/2025 6:56:31 AM', Current time (UTC): '7/30/2025 8:01:48 AM'.
2025-07-30 16:01:48.433 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 16:01:48.434 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-07-30 16:01:48.435 +08:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-07-30 16:01:48.436 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/onboarding-progress - 401 0 null 9.4715ms
2025-07-30 16:01:51.812 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/team-members - null null
2025-07-30 16:01:51.813 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:01:51.814 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/team-members - 204 null null 1.8728ms
2025-07-30 16:01:51.815 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/team-members - application/json null
2025-07-30 16:01:51.816 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:01:51.817 +08:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '7/30/2025 6:56:31 AM', Current time (UTC): '7/30/2025 8:01:51 AM'.
   at Microsoft.IdentityModel.Tokens.ValidatorUtilities.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2025-07-30 16:01:51.818 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '7/30/2025 6:56:31 AM', Current time (UTC): '7/30/2025 8:01:51 AM'.
2025-07-30 16:01:51.818 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '7/30/2025 6:56:31 AM', Current time (UTC): '7/30/2025 8:01:51 AM'.
2025-07-30 16:01:51.820 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 16:01:51.821 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-07-30 16:01:51.821 +08:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-07-30 16:01:51.822 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/team-members - 401 0 null 6.641ms
2025-07-30 16:09:10.151 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/subscription-plans - null null
2025-07-30 16:09:10.151 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users - null null
2025-07-30 16:09:10.153 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:09:10.155 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:09:10.155 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/subscription-plans - 204 null null 3.4518ms
2025-07-30 16:09:10.155 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users - 204 null null 3.7808ms
2025-07-30 16:09:10.157 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users - application/json null
2025-07-30 16:09:10.158 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/subscription-plans - application/json null
2025-07-30 16:09:10.159 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:09:10.160 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:09:10.161 +08:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '7/30/2025 6:56:31 AM', Current time (UTC): '7/30/2025 8:09:10 AM'.
   at Microsoft.IdentityModel.Tokens.ValidatorUtilities.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2025-07-30 16:09:10.161 +08:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '7/30/2025 6:56:31 AM', Current time (UTC): '7/30/2025 8:09:10 AM'.
   at Microsoft.IdentityModel.Tokens.ValidatorUtilities.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2025-07-30 16:09:10.162 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '7/30/2025 6:56:31 AM', Current time (UTC): '7/30/2025 8:09:10 AM'.
2025-07-30 16:09:10.163 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '7/30/2025 6:56:31 AM', Current time (UTC): '7/30/2025 8:09:10 AM'.
2025-07-30 16:09:10.163 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '7/30/2025 6:56:31 AM', Current time (UTC): '7/30/2025 8:09:10 AM'.
2025-07-30 16:09:10.164 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '7/30/2025 6:56:31 AM', Current time (UTC): '7/30/2025 8:09:10 AM'.
2025-07-30 16:09:10.211 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 16:09:10.212 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-07-30 16:09:10.213 +08:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-07-30 16:09:10.213 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/subscription-plans - 401 0 null 55.3191ms
2025-07-30 16:09:10.214 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 16:09:10.216 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-07-30 16:09:10.216 +08:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-07-30 16:09:10.217 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users - 401 0 null 59.9189ms
2025-07-30 16:09:12.959 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/courses - null null
2025-07-30 16:09:12.960 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:09:12.960 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/courses - 204 null null 1.6426ms
2025-07-30 16:09:12.962 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses - application/json null
2025-07-30 16:09:12.963 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:09:12.963 +08:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '7/30/2025 6:56:31 AM', Current time (UTC): '7/30/2025 8:09:12 AM'.
   at Microsoft.IdentityModel.Tokens.ValidatorUtilities.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2025-07-30 16:09:12.965 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '7/30/2025 6:56:31 AM', Current time (UTC): '7/30/2025 8:09:12 AM'.
2025-07-30 16:09:12.965 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '7/30/2025 6:56:31 AM', Current time (UTC): '7/30/2025 8:09:12 AM'.
2025-07-30 16:09:12.967 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 16:09:12.968 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-30 16:09:12.968 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-30 16:09:12.971 +08:00 [ERR] Failed executing DbCommand (1ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."IsPublished", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."PublishedAt", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."IsFlagged", r."Rating", r."Status", r."StudentId", e."Id", e."AverageQuizScore", e."CertificateIssued", e."CertificateUrl", e."CompletedAt", e."CompletedLessons", e."CourseId", e."EnrolledAt", e."LastAccessedDate", e."ProgressPercentage", e."QuizCount", e."StudentId", e."TotalTimeSpent"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."IsPublished", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."PublishedAt", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-30 16:09:12.973 +08:00 [ERR] An exception occurred while iterating over the results of a query for context type 'CeceLearningPortal.Api.Data.ApplicationDbContext'.
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 1526
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 1526
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 1526
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 1526
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 16:09:12.977 +08:00 [ERR] Error retrieving courses
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 1526
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at CeceLearningPortal.Api.Services.CourseService.GetAllCoursesAsync(CourseFilterDto filter) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Services\CourseService.cs:line 95
   at CeceLearningPortal.Api.Controllers.CoursesController.GetCourses(CourseFilterDto filter) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Controllers\CoursesController.cs:line 26
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 1526
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 16:09:12.981 +08:00 [INF] Executing ObjectResult, writing value of type '<>f__AnonymousType0`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 16:09:12.982 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 12.8243ms
2025-07-30 16:09:12.983 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-30 16:09:12.983 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses - 500 null application/json; charset=utf-8 21.1905ms
2025-07-30 16:09:14.077 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/subscriptions - null null
2025-07-30 16:09:14.078 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:09:14.079 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/subscriptions - 204 null null 1.6277ms
2025-07-30 16:09:14.080 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/subscriptions - application/json null
2025-07-30 16:09:14.081 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:09:14.082 +08:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '7/30/2025 6:56:31 AM', Current time (UTC): '7/30/2025 8:09:14 AM'.
   at Microsoft.IdentityModel.Tokens.ValidatorUtilities.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2025-07-30 16:09:14.084 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '7/30/2025 6:56:31 AM', Current time (UTC): '7/30/2025 8:09:14 AM'.
2025-07-30 16:09:14.084 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '7/30/2025 6:56:31 AM', Current time (UTC): '7/30/2025 8:09:14 AM'.
2025-07-30 16:09:14.086 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 16:09:14.087 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/subscriptions - 404 0 null 6.7512ms
2025-07-30 16:09:14.089 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5295/api/admin/subscriptions, Response status code: 404
2025-07-30 16:09:21.740 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/subscription-plans - null null
2025-07-30 16:09:21.742 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:09:21.742 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/subscription-plans - 204 null null 1.9145ms
2025-07-30 16:09:21.744 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/subscription-plans - application/json null
2025-07-30 16:09:21.745 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:09:21.745 +08:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '7/30/2025 6:56:31 AM', Current time (UTC): '7/30/2025 8:09:21 AM'.
   at Microsoft.IdentityModel.Tokens.ValidatorUtilities.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2025-07-30 16:09:21.746 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '7/30/2025 6:56:31 AM', Current time (UTC): '7/30/2025 8:09:21 AM'.
2025-07-30 16:09:21.747 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '7/30/2025 6:56:31 AM', Current time (UTC): '7/30/2025 8:09:21 AM'.
2025-07-30 16:09:21.748 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 16:09:21.749 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-07-30 16:09:21.750 +08:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-07-30 16:09:21.750 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/subscription-plans - 401 0 null 6.7672ms
2025-07-30 16:09:22.604 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/subscriptions - null null
2025-07-30 16:09:22.605 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:09:22.606 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/subscriptions - 204 null null 1.7158ms
2025-07-30 16:09:22.607 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/subscriptions - application/json null
2025-07-30 16:09:22.608 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:09:22.608 +08:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '7/30/2025 6:56:31 AM', Current time (UTC): '7/30/2025 8:09:22 AM'.
   at Microsoft.IdentityModel.Tokens.ValidatorUtilities.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2025-07-30 16:09:22.610 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '7/30/2025 6:56:31 AM', Current time (UTC): '7/30/2025 8:09:22 AM'.
2025-07-30 16:09:22.610 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '7/30/2025 6:56:31 AM', Current time (UTC): '7/30/2025 8:09:22 AM'.
2025-07-30 16:09:22.612 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 16:09:22.613 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/subscriptions - 404 0 null 5.6033ms
2025-07-30 16:09:22.614 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5295/api/admin/subscriptions, Response status code: 404
2025-07-30 16:15:31.036 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users - null null
2025-07-30 16:15:31.036 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/subscription-plans - null null
2025-07-30 16:15:31.037 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:15:31.038 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:15:31.038 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users - 204 null null 2.3932ms
2025-07-30 16:15:31.038 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/subscription-plans - 204 null null 2.6978ms
2025-07-30 16:15:31.040 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/subscription-plans - application/json null
2025-07-30 16:15:31.041 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users - application/json null
2025-07-30 16:15:31.042 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:15:31.043 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:15:31.044 +08:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '7/30/2025 6:56:31 AM', Current time (UTC): '7/30/2025 8:15:31 AM'.
   at Microsoft.IdentityModel.Tokens.ValidatorUtilities.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2025-07-30 16:15:31.044 +08:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '7/30/2025 6:56:31 AM', Current time (UTC): '7/30/2025 8:15:31 AM'.
   at Microsoft.IdentityModel.Tokens.ValidatorUtilities.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2025-07-30 16:15:31.045 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '7/30/2025 6:56:31 AM', Current time (UTC): '7/30/2025 8:15:31 AM'.
2025-07-30 16:15:31.046 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '7/30/2025 6:56:31 AM', Current time (UTC): '7/30/2025 8:15:31 AM'.
2025-07-30 16:15:31.046 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '7/30/2025 6:56:31 AM', Current time (UTC): '7/30/2025 8:15:31 AM'.
2025-07-30 16:15:31.047 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '7/30/2025 6:56:31 AM', Current time (UTC): '7/30/2025 8:15:31 AM'.
2025-07-30 16:15:31.092 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 16:15:31.094 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-07-30 16:15:31.094 +08:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-07-30 16:15:31.095 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users - 401 0 null 53.8131ms
2025-07-30 16:15:31.096 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 16:15:31.097 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-07-30 16:15:31.097 +08:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-07-30 16:15:31.098 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/subscription-plans - 401 0 null 58.1892ms
2025-07-30 16:15:32.775 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/subscriptions - null null
2025-07-30 16:15:32.777 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:15:32.777 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/subscriptions - 204 null null 1.941ms
2025-07-30 16:15:32.779 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/subscriptions - application/json null
2025-07-30 16:15:32.780 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:15:32.780 +08:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '7/30/2025 6:56:31 AM', Current time (UTC): '7/30/2025 8:15:32 AM'.
   at Microsoft.IdentityModel.Tokens.ValidatorUtilities.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2025-07-30 16:15:32.781 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '7/30/2025 6:56:31 AM', Current time (UTC): '7/30/2025 8:15:32 AM'.
2025-07-30 16:15:32.782 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '7/30/2025 6:56:31 AM', Current time (UTC): '7/30/2025 8:15:32 AM'.
2025-07-30 16:15:32.783 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 16:15:32.784 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/subscriptions - 404 0 null 5.4739ms
2025-07-30 16:15:32.786 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5295/api/admin/subscriptions, Response status code: 404
2025-07-30 16:15:44.789 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users - null null
2025-07-30 16:15:44.789 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/subscription-plans - null null
2025-07-30 16:15:44.790 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:15:44.791 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:15:44.792 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users - 204 null null 2.6189ms
2025-07-30 16:15:44.792 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/subscription-plans - 204 null null 2.7614ms
2025-07-30 16:15:44.794 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/subscription-plans - application/json null
2025-07-30 16:15:44.795 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users - application/json null
2025-07-30 16:15:44.796 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:15:44.797 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:15:44.798 +08:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '7/30/2025 6:56:31 AM', Current time (UTC): '7/30/2025 8:15:44 AM'.
   at Microsoft.IdentityModel.Tokens.ValidatorUtilities.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2025-07-30 16:15:44.798 +08:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '7/30/2025 6:56:31 AM', Current time (UTC): '7/30/2025 8:15:44 AM'.
   at Microsoft.IdentityModel.Tokens.ValidatorUtilities.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2025-07-30 16:15:44.799 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '7/30/2025 6:56:31 AM', Current time (UTC): '7/30/2025 8:15:44 AM'.
2025-07-30 16:15:44.800 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '7/30/2025 6:56:31 AM', Current time (UTC): '7/30/2025 8:15:44 AM'.
2025-07-30 16:15:44.800 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '7/30/2025 6:56:31 AM', Current time (UTC): '7/30/2025 8:15:44 AM'.
2025-07-30 16:15:44.800 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '7/30/2025 6:56:31 AM', Current time (UTC): '7/30/2025 8:15:44 AM'.
2025-07-30 16:15:44.802 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 16:15:44.802 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 16:15:44.803 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-07-30 16:15:44.804 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-07-30 16:15:44.804 +08:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-07-30 16:15:44.804 +08:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-07-30 16:15:44.805 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/subscription-plans - 401 0 null 10.8572ms
2025-07-30 16:15:44.805 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users - 401 0 null 10.1757ms
2025-07-30 16:15:46.068 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/subscriptions - null null
2025-07-30 16:15:46.069 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:15:46.070 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/subscriptions - 204 null null 1.644ms
2025-07-30 16:15:46.071 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/subscriptions - application/json null
2025-07-30 16:15:46.072 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:15:46.073 +08:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '7/30/2025 6:56:31 AM', Current time (UTC): '7/30/2025 8:15:46 AM'.
   at Microsoft.IdentityModel.Tokens.ValidatorUtilities.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2025-07-30 16:15:46.074 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '7/30/2025 6:56:31 AM', Current time (UTC): '7/30/2025 8:15:46 AM'.
2025-07-30 16:15:46.074 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '7/30/2025 6:56:31 AM', Current time (UTC): '7/30/2025 8:15:46 AM'.
2025-07-30 16:15:46.076 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 16:15:46.077 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/subscriptions - 404 0 null 5.9953ms
2025-07-30 16:15:46.078 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5295/api/admin/subscriptions, Response status code: 404
2025-07-30 16:22:45.947 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/platform - null null
2025-07-30 16:22:45.949 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:22:45.950 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/platform - 204 null null 3.2258ms
2025-07-30 16:22:45.953 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/platform - application/json null
2025-07-30 16:22:45.955 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:22:45.956 +08:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '7/30/2025 6:56:31 AM', Current time (UTC): '7/30/2025 8:22:45 AM'.
   at Microsoft.IdentityModel.Tokens.ValidatorUtilities.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2025-07-30 16:22:45.958 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '7/30/2025 6:56:31 AM', Current time (UTC): '7/30/2025 8:22:45 AM'.
2025-07-30 16:22:45.959 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '7/30/2025 6:56:31 AM', Current time (UTC): '7/30/2025 8:22:45 AM'.
2025-07-30 16:22:46.021 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 16:22:46.024 +08:00 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-07-30 16:22:46.024 +08:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-07-30 16:22:46.025 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/platform - 401 0 null 72.4643ms
2025-07-30 16:22:46.134 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/course-completions - null null
2025-07-30 16:22:46.136 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:22:46.137 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/course-completions - 204 null null 2.8951ms
2025-07-30 16:22:46.139 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/course-completions - application/json null
2025-07-30 16:22:46.141 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:22:46.142 +08:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '7/30/2025 6:56:31 AM', Current time (UTC): '7/30/2025 8:22:46 AM'.
   at Microsoft.IdentityModel.Tokens.ValidatorUtilities.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2025-07-30 16:22:46.144 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '7/30/2025 6:56:31 AM', Current time (UTC): '7/30/2025 8:22:46 AM'.
2025-07-30 16:22:46.144 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '7/30/2025 6:56:31 AM', Current time (UTC): '7/30/2025 8:22:46 AM'.
2025-07-30 16:22:46.146 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 16:22:46.148 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-07-30 16:22:46.148 +08:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-07-30 16:22:46.149 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/course-completions - 401 0 null 9.4353ms
2025-07-30 16:26:13.189 +08:00 [INF] Checking database connection...
2025-07-30 16:26:13.772 +08:00 [INF] Database connection successful.
2025-07-30 16:26:13.772 +08:00 [INF] Attempting to apply migrations...
2025-07-30 16:26:13.854 +08:00 [INF] Executed DbCommand (11ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-07-30 16:26:14.080 +08:00 [WRN] Migration failed. This might be due to pending model changes. Continuing anyway...
System.InvalidOperationException: An error was generated for warning 'Microsoft.EntityFrameworkCore.Migrations.PendingModelChangesWarning': The model for context 'ApplicationDbContext' has pending changes. Add a new migration before updating the database. See https://aka.ms/efcore-docs-pending-changes. This exception can be suppressed or logged by passing event ID 'RelationalEventId.PendingModelChangesWarning' to the 'ConfigureWarnings' method in 'DbContext.OnConfiguring' or 'AddDbContext'.
   at Microsoft.EntityFrameworkCore.Diagnostics.EventDefinition`1.Log[TLoggerCategory](IDiagnosticsLogger`1 logger, TParam arg)
   at Microsoft.EntityFrameworkCore.Diagnostics.RelationalLoggerExtensions.PendingModelChangesWarning(IDiagnosticsLogger`1 diagnostics, Type contextType)
   at Microsoft.EntityFrameworkCore.Migrations.Internal.Migrator.ValidateMigrations(Boolean useTransaction, String targetMigration)
   at Microsoft.EntityFrameworkCore.Migrations.Internal.Migrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Program.cs:line 222
2025-07-30 16:26:14.139 +08:00 [INF] Starting data seeding...
2025-07-30 16:26:14.153 +08:00 [INF] User profile is available. Using 'C:\Users\User\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-07-30 16:26:14.264 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Courses" AS c)
2025-07-30 16:26:14.267 +08:00 [INF] Database already contains data. Skipping seed.
2025-07-30 16:26:14.267 +08:00 [INF] Data seeding completed.
2025-07-30 16:26:14.302 +08:00 [INF] Now listening on: http://localhost:5295
2025-07-30 16:26:14.303 +08:00 [INF] Application started. Press Ctrl+C to shut down.
2025-07-30 16:26:14.304 +08:00 [INF] Hosting environment: Development
2025-07-30 16:26:14.304 +08:00 [INF] Content root path: D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api
2025-07-30 16:26:17.606 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/auth/login - null null
2025-07-30 16:26:17.640 +08:00 [WRN] Failed to determine the https port for redirect.
2025-07-30 16:26:17.641 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:26:17.645 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/auth/login - 204 null null 39.1264ms
2025-07-30 16:26:17.649 +08:00 [INF] Request starting HTTP/1.1 POST http://localhost:5295/api/auth/login - application/json 51
2025-07-30 16:26:17.653 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:26:17.697 +08:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '7/30/2025 6:56:31 AM', Current time (UTC): '7/30/2025 8:26:17 AM'.
   at Microsoft.IdentityModel.Tokens.ValidatorUtilities.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2025-07-30 16:26:17.700 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '7/30/2025 6:56:31 AM', Current time (UTC): '7/30/2025 8:26:17 AM'.
2025-07-30 16:26:17.702 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '7/30/2025 6:56:31 AM', Current time (UTC): '7/30/2025 8:26:17 AM'.
2025-07-30 16:26:17.759 +08:00 [INF] Executed DbCommand (6ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 16:26:17.762 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AuthController.Login (CeceLearningPortal.Api)'
2025-07-30 16:26:17.770 +08:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(CeceLearningPortal.Api.DTOs.LoginDto) on controller CeceLearningPortal.Api.Controllers.AuthController (CeceLearningPortal.Api).
2025-07-30 16:26:17.845 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__normalizedEmail_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."NormalizedEmail" = @__normalizedEmail_0
LIMIT 2
2025-07-30 16:26:18.043 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@p1='?', @p2='?', @p0='?' (DbType = DateTime), @p3='?' (DbType = DateTime), @p4='?', @p5='?' (DbType = DateTime), @p6='?', @p7='?' (DbType = DateTime), @p8='?', @p9='?', @p10='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE "AspNetUsers" SET "LastLoginAt" = @p0
WHERE "Id" = @p1 AND "ConcurrencyStamp" = @p2;
INSERT INTO "RefreshTokens" ("CreatedAt", "CreatedByIp", "ExpiresAt", "ReplacedByToken", "RevokedAt", "RevokedByIp", "Token", "UserId")
VALUES (@p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10)
RETURNING "Id";
2025-07-30 16:26:18.070 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.AuthResponseDto'.
2025-07-30 16:26:18.079 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AuthController.Login (CeceLearningPortal.Api) in 305.5009ms
2025-07-30 16:26:18.079 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AuthController.Login (CeceLearningPortal.Api)'
2025-07-30 16:26:18.082 +08:00 [INF] Request finished HTTP/1.1 POST http://localhost:5295/api/auth/login - 200 null application/json; charset=utf-8 433.1703ms
2025-07-30 16:26:18.099 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/courses - null null
2025-07-30 16:26:18.100 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/platform - null null
2025-07-30 16:26:18.102 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:26:18.103 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:26:18.103 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/courses - 204 null null 4.0225ms
2025-07-30 16:26:18.104 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/platform - 204 null null 3.7638ms
2025-07-30 16:26:18.106 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses - application/json null
2025-07-30 16:26:18.107 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/platform - application/json null
2025-07-30 16:26:18.112 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:26:18.112 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:26:18.122 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 16:26:18.126 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-07-30 16:26:18.130 +08:00 [INF] Route matched with {action = "GetPlatformAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPlatformAnalytics() on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-30 16:26:18.146 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
2025-07-30 16:26:18.151 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
2025-07-30 16:26:18.162 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."Status" = 'Completed'
2025-07-30 16:26:18.168 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 16:26:18.169 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
2025-07-30 16:26:18.170 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-30 16:26:18.178 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-30 16:26:18.240 +08:00 [INF] Executed DbCommand (6ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id" AS "instructorId", a."FullName" AS "instructorName", (
    SELECT count(*)::int
    FROM "Courses" AS c0
    WHERE c0."InstructorId" = a."Id") AS "totalCourses", (
    SELECT count(*)::int
    FROM "Enrollments" AS e
    INNER JOIN "Courses" AS c1 ON e."CourseId" = c1."Id"
    WHERE c1."InstructorId" = a."Id") AS "totalStudents", (
    SELECT COALESCE(sum(p0."Amount"), 0.0)
    FROM "Payments" AS p0
    LEFT JOIN "Courses" AS c2 ON p0."CourseId" = c2."Id"
    WHERE c2."InstructorId" = a."Id" AND p0."Status" = 'Completed') AS "totalRevenue", COALESCE((
    SELECT avg(r."Rating"::double precision)
    FROM "Reviews" AS r
    INNER JOIN "Courses" AS c3 ON r."CourseId" = c3."Id"
    WHERE c3."InstructorId" = a."Id"), 0.0) AS "averageRating"
FROM "AspNetUsers" AS a
WHERE a."Role" = 'Instructor'
ORDER BY (
    SELECT COALESCE(sum(p."Amount"), 0.0)
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
    WHERE c."InstructorId" = a."Id" AND p."Status" = 'Completed') DESC
LIMIT @__p_0
2025-07-30 16:26:18.244 +08:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2025-07-30 16:26:18.264 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT c."Category" AS category, count(*)::int AS "courseCount", COALESCE(sum((
    SELECT count(*)::int
    FROM "Enrollments" AS e
    WHERE c."Id" = e."CourseId")), 0)::int AS "enrollmentCount", (
    SELECT COALESCE(sum(p."Amount"), 0.0)
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c0 ON p."CourseId" = c0."Id"
    WHERE c0."Category" = c."Category" AND p."Status" = 'Completed') AS revenue
FROM "Courses" AS c
GROUP BY c."Category"
ORDER BY COALESCE(sum((
    SELECT count(*)::int
    FROM "Enrollments" AS e
    WHERE c."Id" = e."CourseId")), 0)::int DESC
2025-07-30 16:26:18.275 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT p0."Year", p0."Month", COALESCE(sum(p0."Amount"), 0.0) AS "Revenue", count(*)::int AS "TransactionCount"
FROM (
    SELECT p."Amount", date_part('year', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "Payments" AS p
    WHERE p."Status" = 'Completed' AND p."CreatedAt" >= @__sixMonthsAgo_0
) AS p0
GROUP BY p0."Year", p0."Month"
2025-07-30 16:26:18.275 +08:00 [ERR] Failed executing DbCommand (3ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."IsPublished", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."PublishedAt", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."IsFlagged", r."Rating", r."Status", r."StudentId", e."Id", e."AverageQuizScore", e."CertificateIssued", e."CertificateUrl", e."CompletedAt", e."CompletedLessons", e."CourseId", e."EnrolledAt", e."LastAccessedDate", e."ProgressPercentage", e."QuizCount", e."StudentId", e."TotalTimeSpent"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."IsPublished", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."PublishedAt", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-30 16:26:18.282 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT a0."Year", a0."Month", count(*)::int AS "NewUsers"
FROM (
    SELECT date_part('year', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "AspNetUsers" AS a
    WHERE a."CreatedAt" >= @__sixMonthsAgo_0
) AS a0
GROUP BY a0."Year", a0."Month"
2025-07-30 16:26:18.283 +08:00 [ERR] An exception occurred while iterating over the results of a query for context type 'CeceLearningPortal.Api.Data.ApplicationDbContext'.
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 1526
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 1526
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 1526
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 1526
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 16:26:18.291 +08:00 [ERR] Error retrieving courses
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 1526
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at CeceLearningPortal.Api.Services.CourseService.GetAllCoursesAsync(CourseFilterDto filter) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Services\CourseService.cs:line 95
   at CeceLearningPortal.Api.Controllers.CoursesController.GetCourses(CourseFilterDto filter) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Controllers\CoursesController.cs:line 26
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 1526
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 16:26:18.293 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Subscriptions" AS s
WHERE s."Status" = 'Active'
2025-07-30 16:26:18.297 +08:00 [INF] Executing ObjectResult, writing value of type '<>f__AnonymousType0`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 16:26:18.301 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 121.9191ms
2025-07-30 16:26:18.302 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-30 16:26:18.302 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses - 500 null application/json; charset=utf-8 196.6132ms
2025-07-30 16:26:18.304 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s."PlanName" AS plan, count(*)::int AS count, COALESCE(sum(s."Price"), 0.0) AS "monthlyRevenue"
FROM "Subscriptions" AS s
WHERE s."Status" = 'Active'
GROUP BY s."PlanName"
2025-07-30 16:26:18.307 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType20`6[[<>f__AnonymousType21`5[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 16:26:18.319 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api) in 187.7132ms
2025-07-30 16:26:18.320 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-07-30 16:26:18.321 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/platform - 200 null application/json; charset=utf-8 213.7125ms
2025-07-30 16:26:20.993 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/platform - application/json null
2025-07-30 16:26:20.995 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:26:20.998 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 16:26:21.001 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-07-30 16:26:21.002 +08:00 [INF] Route matched with {action = "GetPlatformAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPlatformAnalytics() on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-30 16:26:21.005 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
2025-07-30 16:26:21.007 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
2025-07-30 16:26:21.009 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."Status" = 'Completed'
2025-07-30 16:26:21.011 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
2025-07-30 16:26:21.015 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id" AS "instructorId", a."FullName" AS "instructorName", (
    SELECT count(*)::int
    FROM "Courses" AS c0
    WHERE c0."InstructorId" = a."Id") AS "totalCourses", (
    SELECT count(*)::int
    FROM "Enrollments" AS e
    INNER JOIN "Courses" AS c1 ON e."CourseId" = c1."Id"
    WHERE c1."InstructorId" = a."Id") AS "totalStudents", (
    SELECT COALESCE(sum(p0."Amount"), 0.0)
    FROM "Payments" AS p0
    LEFT JOIN "Courses" AS c2 ON p0."CourseId" = c2."Id"
    WHERE c2."InstructorId" = a."Id" AND p0."Status" = 'Completed') AS "totalRevenue", COALESCE((
    SELECT avg(r."Rating"::double precision)
    FROM "Reviews" AS r
    INNER JOIN "Courses" AS c3 ON r."CourseId" = c3."Id"
    WHERE c3."InstructorId" = a."Id"), 0.0) AS "averageRating"
FROM "AspNetUsers" AS a
WHERE a."Role" = 'Instructor'
ORDER BY (
    SELECT COALESCE(sum(p."Amount"), 0.0)
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
    WHERE c."InstructorId" = a."Id" AND p."Status" = 'Completed') DESC
LIMIT @__p_0
2025-07-30 16:26:21.017 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT c."Category" AS category, count(*)::int AS "courseCount", COALESCE(sum((
    SELECT count(*)::int
    FROM "Enrollments" AS e
    WHERE c."Id" = e."CourseId")), 0)::int AS "enrollmentCount", (
    SELECT COALESCE(sum(p."Amount"), 0.0)
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c0 ON p."CourseId" = c0."Id"
    WHERE c0."Category" = c."Category" AND p."Status" = 'Completed') AS revenue
FROM "Courses" AS c
GROUP BY c."Category"
ORDER BY COALESCE(sum((
    SELECT count(*)::int
    FROM "Enrollments" AS e
    WHERE c."Id" = e."CourseId")), 0)::int DESC
2025-07-30 16:26:21.019 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT p0."Year", p0."Month", COALESCE(sum(p0."Amount"), 0.0) AS "Revenue", count(*)::int AS "TransactionCount"
FROM (
    SELECT p."Amount", date_part('year', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "Payments" AS p
    WHERE p."Status" = 'Completed' AND p."CreatedAt" >= @__sixMonthsAgo_0
) AS p0
GROUP BY p0."Year", p0."Month"
2025-07-30 16:26:21.021 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT a0."Year", a0."Month", count(*)::int AS "NewUsers"
FROM (
    SELECT date_part('year', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "AspNetUsers" AS a
    WHERE a."CreatedAt" >= @__sixMonthsAgo_0
) AS a0
GROUP BY a0."Year", a0."Month"
2025-07-30 16:26:21.023 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Subscriptions" AS s
WHERE s."Status" = 'Active'
2025-07-30 16:26:21.024 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s."PlanName" AS plan, count(*)::int AS count, COALESCE(sum(s."Price"), 0.0) AS "monthlyRevenue"
FROM "Subscriptions" AS s
WHERE s."Status" = 'Active'
GROUP BY s."PlanName"
2025-07-30 16:26:21.026 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType20`6[[<>f__AnonymousType21`5[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 16:26:21.027 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api) in 23.6294ms
2025-07-30 16:26:21.027 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-07-30 16:26:21.028 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/platform - 200 null application/json; charset=utf-8 34.9043ms
2025-07-30 16:26:21.030 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/course-completions - null null
2025-07-30 16:26:21.031 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:26:21.031 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/course-completions - 204 null null 1.6358ms
2025-07-30 16:26:21.033 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/course-completions - application/json null
2025-07-30 16:26:21.035 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:26:21.038 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 16:26:21.040 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetCourseCompletions (CeceLearningPortal.Api)'
2025-07-30 16:26:21.044 +08:00 [INF] Route matched with {action = "GetCourseCompletions", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourseCompletions(Int32) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 16:26:21.060 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT e0."Id", a."FullName", a."Avatar", a."Email", c."Title", e0."CourseId"::text, e0."CompletedAt", COALESCE(e0."AverageQuizScore", 0.0), e0."CertificateIssued", e0."CertificateUrl"
FROM (
    SELECT e."Id", e."AverageQuizScore", e."CertificateIssued", e."CertificateUrl", e."CompletedAt", e."CourseId", e."StudentId"
    FROM "Enrollments" AS e
    WHERE e."CompletedAt" IS NOT NULL
    ORDER BY e."CompletedAt" DESC
    LIMIT @__p_0
) AS e0
INNER JOIN "AspNetUsers" AS a ON e0."StudentId" = a."Id"
INNER JOIN "Courses" AS c ON e0."CourseId" = c."Id"
ORDER BY e0."CompletedAt" DESC
2025-07-30 16:26:21.062 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType9`10[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-30 16:26:21.065 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetCourseCompletions (CeceLearningPortal.Api) in 20.2554ms
2025-07-30 16:26:21.066 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetCourseCompletions (CeceLearningPortal.Api)'
2025-07-30 16:26:21.066 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/course-completions - 200 null application/json; charset=utf-8 33.4975ms
2025-07-30 16:26:22.296 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users - null null
2025-07-30 16:26:22.296 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/subscription-plans - null null
2025-07-30 16:26:22.297 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:26:22.298 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:26:22.299 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users - 204 null null 2.8079ms
2025-07-30 16:26:22.299 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/subscription-plans - 204 null null 2.9709ms
2025-07-30 16:26:22.301 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/subscription-plans - application/json null
2025-07-30 16:26:22.302 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users - application/json null
2025-07-30 16:26:22.303 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:26:22.304 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:26:22.306 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 16:26:22.306 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 16:26:22.308 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUsers (CeceLearningPortal.Api)'
2025-07-30 16:26:22.308 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetSubscriptionPlans (CeceLearningPortal.Api)'
2025-07-30 16:26:22.311 +08:00 [INF] Route matched with {action = "GetSubscriptionPlans", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetSubscriptionPlans() on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 16:26:22.312 +08:00 [INF] Route matched with {action = "GetUsers", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUsers(CeceLearningPortal.Api.DTOs.UserManagementFilterDto) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 16:26:22.320 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
2025-07-30 16:26:22.327 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."UserName", a."Email", a."FullName", a."Role", a."Status", a."CreatedAt", a."LastLoginAt", a."EmailConfirmed"
FROM "AspNetUsers" AS a
ORDER BY a."CreatedAt" DESC
LIMIT @__p_1 OFFSET @__p_0
2025-07-30 16:26:22.329 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[CeceLearningPortal.Api.DTOs.UserManagementDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-30 16:26:22.330 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."CreatedAt", s."Description", s."DisplayOrder", s."Features", s."HasAnalytics", s."HasPrioritySupport", s."HasUnlimitedAccess", s."IsActive", s."IsRecommended", s."MaxCourseAccess", s."MaxCoursesCanCreate", s."MaxStudentsPerCourse", s."MonthlyPrice", s."Name", s."PlanType", s."TransactionFeePercentage", s."UpdatedAt", s."YearlyPrice", s0."Id", s0."BillingCycle", s0."CreatedAt", s0."EndDate", s0."NextBillingDate", s0."PlanName", s0."Price", s0."StartDate", s0."Status", s0."StripeSubscriptionId", s0."SubscriptionPlanId", s0."UpdatedAt", s0."UserId"
FROM "SubscriptionPlans" AS s
LEFT JOIN "Subscriptions" AS s0 ON s."Id" = s0."SubscriptionPlanId"
ORDER BY s."Id"
2025-07-30 16:26:22.331 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[CeceLearningPortal.Api.DTOs.SubscriptionPlanDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-30 16:26:22.339 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUsers (CeceLearningPortal.Api) in 25.9998ms
2025-07-30 16:26:22.340 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetSubscriptionPlans (CeceLearningPortal.Api) in 28.2212ms
2025-07-30 16:26:22.340 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUsers (CeceLearningPortal.Api)'
2025-07-30 16:26:22.341 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetSubscriptionPlans (CeceLearningPortal.Api)'
2025-07-30 16:26:22.341 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users - 200 null application/json; charset=utf-8 39.7014ms
2025-07-30 16:26:22.342 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/subscription-plans - 200 null application/json; charset=utf-8 41.2915ms
2025-07-30 16:26:22.344 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/e090c598-224f-4b4c-870a-3c3ef6303e0a/subscription - null null
2025-07-30 16:26:22.344 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/801dc698-62a8-49c3-b578-b7c1b05049a4/subscription - null null
2025-07-30 16:26:22.344 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/28b8e854-738a-4e69-835c-71299a8f9b21/subscription - null null
2025-07-30 16:26:22.345 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/f9f0e64e-3771-4aa9-8470-21e709677e44/subscription - null null
2025-07-30 16:26:22.345 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/efead752-f0b3-48ab-93b8-7ba31e7574ba/subscription - null null
2025-07-30 16:26:22.346 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:26:22.347 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:26:22.347 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:26:22.348 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:26:22.349 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:26:22.350 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/e090c598-224f-4b4c-870a-3c3ef6303e0a/subscription - 204 null null 6.0558ms
2025-07-30 16:26:22.350 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/801dc698-62a8-49c3-b578-b7c1b05049a4/subscription - 204 null null 5.9691ms
2025-07-30 16:26:22.350 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/28b8e854-738a-4e69-835c-71299a8f9b21/subscription - 204 null null 5.9831ms
2025-07-30 16:26:22.351 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/f9f0e64e-3771-4aa9-8470-21e709677e44/subscription - 204 null null 6.1867ms
2025-07-30 16:26:22.351 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/efead752-f0b3-48ab-93b8-7ba31e7574ba/subscription - 204 null null 6.6389ms
2025-07-30 16:26:22.353 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/f9f0e64e-3771-4aa9-8470-21e709677e44/subscription - application/json null
2025-07-30 16:26:22.354 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/801dc698-62a8-49c3-b578-b7c1b05049a4/subscription - application/json null
2025-07-30 16:26:22.355 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/e090c598-224f-4b4c-870a-3c3ef6303e0a/subscription - application/json null
2025-07-30 16:26:22.356 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/28b8e854-738a-4e69-835c-71299a8f9b21/subscription - application/json null
2025-07-30 16:26:22.358 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/efead752-f0b3-48ab-93b8-7ba31e7574ba/subscription - application/json null
2025-07-30 16:26:22.359 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:26:22.359 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:26:22.360 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:26:22.361 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:26:22.362 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:26:22.364 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 16:26:22.364 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 16:26:22.365 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 16:26:22.366 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 16:26:22.368 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 16:26:22.369 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 16:26:22.382 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 16:26:22.382 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 16:26:22.384 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType83`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 16:26:22.385 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType83`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 16:26:22.386 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 17.0075ms
2025-07-30 16:26:22.386 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 16.0027ms
2025-07-30 16:26:22.387 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 16:26:22.388 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 16:26:22.389 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/801dc698-62a8-49c3-b578-b7c1b05049a4/subscription - 200 null application/json; charset=utf-8 34.9591ms
2025-07-30 16:26:22.390 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/f9f0e64e-3771-4aa9-8470-21e709677e44/subscription - 200 null application/json; charset=utf-8 36.8767ms
2025-07-30 16:26:22.410 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 16:26:22.412 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 16:26:22.412 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 16:26:22.413 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 16:26:22.414 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 16:26:22.414 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 16:26:22.415 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 16:26:22.416 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType83`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 16:26:22.417 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 16:26:22.417 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 3.9363ms
2025-07-30 16:26:22.417 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 16:26:22.418 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 16:26:22.418 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 16:26:22.419 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType83`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 16:26:22.420 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 16:26:22.420 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/e090c598-224f-4b4c-870a-3c3ef6303e0a/subscription - 200 null application/json; charset=utf-8 64.9619ms
2025-07-30 16:26:22.421 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 4.5222ms
2025-07-30 16:26:22.424 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 16:26:22.424 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/28b8e854-738a-4e69-835c-71299a8f9b21/subscription - 200 null application/json; charset=utf-8 67.9087ms
2025-07-30 16:26:22.424 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 16:26:22.427 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType83`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 16:26:22.427 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 5.7819ms
2025-07-30 16:26:22.428 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 16:26:22.429 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/efead752-f0b3-48ab-93b8-7ba31e7574ba/subscription - 200 null application/json; charset=utf-8 71.06ms
2025-07-30 16:31:24.355 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/platform - null null
2025-07-30 16:31:24.355 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/courses - null null
2025-07-30 16:31:24.357 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:31:24.359 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:31:24.359 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/platform - 204 null null 3.8944ms
2025-07-30 16:31:24.360 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/courses - 204 null null 4.2712ms
2025-07-30 16:31:24.361 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses - application/json null
2025-07-30 16:31:24.363 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/platform - application/json null
2025-07-30 16:31:24.364 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:31:24.366 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:31:24.415 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 16:31:24.416 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-07-30 16:31:24.417 +08:00 [INF] Route matched with {action = "GetPlatformAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPlatformAnalytics() on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-30 16:31:24.418 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 16:31:24.419 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
2025-07-30 16:31:24.419 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-30 16:31:24.421 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-30 16:31:24.422 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
2025-07-30 16:31:24.424 +08:00 [ERR] Failed executing DbCommand (1ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."IsPublished", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."PublishedAt", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."IsFlagged", r."Rating", r."Status", r."StudentId", e."Id", e."AverageQuizScore", e."CertificateIssued", e."CertificateUrl", e."CompletedAt", e."CompletedLessons", e."CourseId", e."EnrolledAt", e."LastAccessedDate", e."ProgressPercentage", e."QuizCount", e."StudentId", e."TotalTimeSpent"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."IsPublished", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."PublishedAt", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-30 16:31:24.424 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."Status" = 'Completed'
2025-07-30 16:31:24.427 +08:00 [ERR] An exception occurred while iterating over the results of a query for context type 'CeceLearningPortal.Api.Data.ApplicationDbContext'.
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 1526
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 1526
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 1526
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 1526
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 16:31:24.427 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
2025-07-30 16:31:24.431 +08:00 [ERR] Error retrieving courses
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 1526
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at CeceLearningPortal.Api.Services.CourseService.GetAllCoursesAsync(CourseFilterDto filter) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Services\CourseService.cs:line 95
   at CeceLearningPortal.Api.Controllers.CoursesController.GetCourses(CourseFilterDto filter) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Controllers\CoursesController.cs:line 26
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 1526
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 16:31:24.435 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id" AS "instructorId", a."FullName" AS "instructorName", (
    SELECT count(*)::int
    FROM "Courses" AS c0
    WHERE c0."InstructorId" = a."Id") AS "totalCourses", (
    SELECT count(*)::int
    FROM "Enrollments" AS e
    INNER JOIN "Courses" AS c1 ON e."CourseId" = c1."Id"
    WHERE c1."InstructorId" = a."Id") AS "totalStudents", (
    SELECT COALESCE(sum(p0."Amount"), 0.0)
    FROM "Payments" AS p0
    LEFT JOIN "Courses" AS c2 ON p0."CourseId" = c2."Id"
    WHERE c2."InstructorId" = a."Id" AND p0."Status" = 'Completed') AS "totalRevenue", COALESCE((
    SELECT avg(r."Rating"::double precision)
    FROM "Reviews" AS r
    INNER JOIN "Courses" AS c3 ON r."CourseId" = c3."Id"
    WHERE c3."InstructorId" = a."Id"), 0.0) AS "averageRating"
FROM "AspNetUsers" AS a
WHERE a."Role" = 'Instructor'
ORDER BY (
    SELECT COALESCE(sum(p."Amount"), 0.0)
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
    WHERE c."InstructorId" = a."Id" AND p."Status" = 'Completed') DESC
LIMIT @__p_0
2025-07-30 16:31:24.436 +08:00 [INF] Executing ObjectResult, writing value of type '<>f__AnonymousType0`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 16:31:24.437 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 15.5191ms
2025-07-30 16:31:24.438 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-30 16:31:24.438 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT c."Category" AS category, count(*)::int AS "courseCount", COALESCE(sum((
    SELECT count(*)::int
    FROM "Enrollments" AS e
    WHERE c."Id" = e."CourseId")), 0)::int AS "enrollmentCount", (
    SELECT COALESCE(sum(p."Amount"), 0.0)
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c0 ON p."CourseId" = c0."Id"
    WHERE c0."Category" = c."Category" AND p."Status" = 'Completed') AS revenue
FROM "Courses" AS c
GROUP BY c."Category"
ORDER BY COALESCE(sum((
    SELECT count(*)::int
    FROM "Enrollments" AS e
    WHERE c."Id" = e."CourseId")), 0)::int DESC
2025-07-30 16:31:24.439 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses - 500 null application/json; charset=utf-8 77.4447ms
2025-07-30 16:31:24.440 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT p0."Year", p0."Month", COALESCE(sum(p0."Amount"), 0.0) AS "Revenue", count(*)::int AS "TransactionCount"
FROM (
    SELECT p."Amount", date_part('year', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "Payments" AS p
    WHERE p."Status" = 'Completed' AND p."CreatedAt" >= @__sixMonthsAgo_0
) AS p0
GROUP BY p0."Year", p0."Month"
2025-07-30 16:31:24.443 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT a0."Year", a0."Month", count(*)::int AS "NewUsers"
FROM (
    SELECT date_part('year', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "AspNetUsers" AS a
    WHERE a."CreatedAt" >= @__sixMonthsAgo_0
) AS a0
GROUP BY a0."Year", a0."Month"
2025-07-30 16:31:24.445 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Subscriptions" AS s
WHERE s."Status" = 'Active'
2025-07-30 16:31:24.447 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s."PlanName" AS plan, count(*)::int AS count, COALESCE(sum(s."Price"), 0.0) AS "monthlyRevenue"
FROM "Subscriptions" AS s
WHERE s."Status" = 'Active'
GROUP BY s."PlanName"
2025-07-30 16:31:24.448 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType20`6[[<>f__AnonymousType21`5[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 16:31:24.449 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api) in 31.4949ms
2025-07-30 16:31:24.450 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-07-30 16:31:24.451 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/platform - 200 null application/json; charset=utf-8 87.5874ms
2025-07-30 16:31:25.111 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users - null null
2025-07-30 16:31:25.112 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:31:25.113 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users - 204 null null 1.8199ms
2025-07-30 16:31:25.115 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users - application/json null
2025-07-30 16:31:25.117 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:31:25.119 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 16:31:25.120 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUsers (CeceLearningPortal.Api)'
2025-07-30 16:31:25.121 +08:00 [INF] Route matched with {action = "GetUsers", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUsers(CeceLearningPortal.Api.DTOs.UserManagementFilterDto) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 16:31:25.123 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
2025-07-30 16:31:25.125 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."UserName", a."Email", a."FullName", a."Role", a."Status", a."CreatedAt", a."LastLoginAt", a."EmailConfirmed"
FROM "AspNetUsers" AS a
ORDER BY a."CreatedAt" DESC
LIMIT @__p_1 OFFSET @__p_0
2025-07-30 16:31:25.127 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[CeceLearningPortal.Api.DTOs.UserManagementDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-30 16:31:25.127 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUsers (CeceLearningPortal.Api) in 5.578ms
2025-07-30 16:31:25.128 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUsers (CeceLearningPortal.Api)'
2025-07-30 16:31:25.129 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users - 200 null application/json; charset=utf-8 13.8112ms
2025-07-30 16:31:25.131 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses - application/json null
2025-07-30 16:31:25.132 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:31:25.134 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 16:31:25.135 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-30 16:31:25.135 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-30 16:31:25.138 +08:00 [ERR] Failed executing DbCommand (1ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."IsPublished", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."PublishedAt", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."IsFlagged", r."Rating", r."Status", r."StudentId", e."Id", e."AverageQuizScore", e."CertificateIssued", e."CertificateUrl", e."CompletedAt", e."CompletedLessons", e."CourseId", e."EnrolledAt", e."LastAccessedDate", e."ProgressPercentage", e."QuizCount", e."StudentId", e."TotalTimeSpent"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."IsPublished", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."PublishedAt", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-30 16:31:25.140 +08:00 [ERR] An exception occurred while iterating over the results of a query for context type 'CeceLearningPortal.Api.Data.ApplicationDbContext'.
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 1526
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 1526
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 1526
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 1526
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 16:31:25.144 +08:00 [ERR] Error retrieving courses
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 1526
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at CeceLearningPortal.Api.Services.CourseService.GetAllCoursesAsync(CourseFilterDto filter) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Services\CourseService.cs:line 95
   at CeceLearningPortal.Api.Controllers.CoursesController.GetCourses(CourseFilterDto filter) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Controllers\CoursesController.cs:line 26
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 1526
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 16:31:25.148 +08:00 [INF] Executing ObjectResult, writing value of type '<>f__AnonymousType0`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 16:31:25.149 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 13.1122ms
2025-07-30 16:31:25.150 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-30 16:31:25.150 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses - 500 null application/json; charset=utf-8 19.4723ms
2025-07-30 16:31:25.152 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/platform - application/json null
2025-07-30 16:31:25.153 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:31:25.155 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 16:31:25.156 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-07-30 16:31:25.156 +08:00 [INF] Route matched with {action = "GetPlatformAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPlatformAnalytics() on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-30 16:31:25.157 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
2025-07-30 16:31:25.159 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
2025-07-30 16:31:25.160 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."Status" = 'Completed'
2025-07-30 16:31:25.161 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
2025-07-30 16:31:25.164 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id" AS "instructorId", a."FullName" AS "instructorName", (
    SELECT count(*)::int
    FROM "Courses" AS c0
    WHERE c0."InstructorId" = a."Id") AS "totalCourses", (
    SELECT count(*)::int
    FROM "Enrollments" AS e
    INNER JOIN "Courses" AS c1 ON e."CourseId" = c1."Id"
    WHERE c1."InstructorId" = a."Id") AS "totalStudents", (
    SELECT COALESCE(sum(p0."Amount"), 0.0)
    FROM "Payments" AS p0
    LEFT JOIN "Courses" AS c2 ON p0."CourseId" = c2."Id"
    WHERE c2."InstructorId" = a."Id" AND p0."Status" = 'Completed') AS "totalRevenue", COALESCE((
    SELECT avg(r."Rating"::double precision)
    FROM "Reviews" AS r
    INNER JOIN "Courses" AS c3 ON r."CourseId" = c3."Id"
    WHERE c3."InstructorId" = a."Id"), 0.0) AS "averageRating"
FROM "AspNetUsers" AS a
WHERE a."Role" = 'Instructor'
ORDER BY (
    SELECT COALESCE(sum(p."Amount"), 0.0)
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
    WHERE c."InstructorId" = a."Id" AND p."Status" = 'Completed') DESC
LIMIT @__p_0
2025-07-30 16:31:25.166 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT c."Category" AS category, count(*)::int AS "courseCount", COALESCE(sum((
    SELECT count(*)::int
    FROM "Enrollments" AS e
    WHERE c."Id" = e."CourseId")), 0)::int AS "enrollmentCount", (
    SELECT COALESCE(sum(p."Amount"), 0.0)
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c0 ON p."CourseId" = c0."Id"
    WHERE c0."Category" = c."Category" AND p."Status" = 'Completed') AS revenue
FROM "Courses" AS c
GROUP BY c."Category"
ORDER BY COALESCE(sum((
    SELECT count(*)::int
    FROM "Enrollments" AS e
    WHERE c."Id" = e."CourseId")), 0)::int DESC
2025-07-30 16:31:25.168 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT p0."Year", p0."Month", COALESCE(sum(p0."Amount"), 0.0) AS "Revenue", count(*)::int AS "TransactionCount"
FROM (
    SELECT p."Amount", date_part('year', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "Payments" AS p
    WHERE p."Status" = 'Completed' AND p."CreatedAt" >= @__sixMonthsAgo_0
) AS p0
GROUP BY p0."Year", p0."Month"
2025-07-30 16:31:25.169 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT a0."Year", a0."Month", count(*)::int AS "NewUsers"
FROM (
    SELECT date_part('year', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "AspNetUsers" AS a
    WHERE a."CreatedAt" >= @__sixMonthsAgo_0
) AS a0
GROUP BY a0."Year", a0."Month"
2025-07-30 16:31:25.171 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Subscriptions" AS s
WHERE s."Status" = 'Active'
2025-07-30 16:31:25.172 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s."PlanName" AS plan, count(*)::int AS count, COALESCE(sum(s."Price"), 0.0) AS "monthlyRevenue"
FROM "Subscriptions" AS s
WHERE s."Status" = 'Active'
GROUP BY s."PlanName"
2025-07-30 16:31:25.173 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType20`6[[<>f__AnonymousType21`5[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 16:31:25.174 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api) in 17.2573ms
2025-07-30 16:31:25.175 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-07-30 16:31:25.175 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/platform - 200 null application/json; charset=utf-8 23.4195ms
2025-07-30 16:31:52.606 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/platform - null null
2025-07-30 16:31:52.607 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:31:52.608 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/platform - 204 null null 1.9929ms
2025-07-30 16:31:52.609 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/platform - application/json null
2025-07-30 16:31:52.610 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:31:52.612 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 16:31:52.614 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-07-30 16:31:52.614 +08:00 [INF] Route matched with {action = "GetPlatformAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPlatformAnalytics() on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-30 16:31:52.616 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
2025-07-30 16:31:52.617 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
2025-07-30 16:31:52.618 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."Status" = 'Completed'
2025-07-30 16:31:52.619 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
2025-07-30 16:31:52.623 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id" AS "instructorId", a."FullName" AS "instructorName", (
    SELECT count(*)::int
    FROM "Courses" AS c0
    WHERE c0."InstructorId" = a."Id") AS "totalCourses", (
    SELECT count(*)::int
    FROM "Enrollments" AS e
    INNER JOIN "Courses" AS c1 ON e."CourseId" = c1."Id"
    WHERE c1."InstructorId" = a."Id") AS "totalStudents", (
    SELECT COALESCE(sum(p0."Amount"), 0.0)
    FROM "Payments" AS p0
    LEFT JOIN "Courses" AS c2 ON p0."CourseId" = c2."Id"
    WHERE c2."InstructorId" = a."Id" AND p0."Status" = 'Completed') AS "totalRevenue", COALESCE((
    SELECT avg(r."Rating"::double precision)
    FROM "Reviews" AS r
    INNER JOIN "Courses" AS c3 ON r."CourseId" = c3."Id"
    WHERE c3."InstructorId" = a."Id"), 0.0) AS "averageRating"
FROM "AspNetUsers" AS a
WHERE a."Role" = 'Instructor'
ORDER BY (
    SELECT COALESCE(sum(p."Amount"), 0.0)
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
    WHERE c."InstructorId" = a."Id" AND p."Status" = 'Completed') DESC
LIMIT @__p_0
2025-07-30 16:31:52.625 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT c."Category" AS category, count(*)::int AS "courseCount", COALESCE(sum((
    SELECT count(*)::int
    FROM "Enrollments" AS e
    WHERE c."Id" = e."CourseId")), 0)::int AS "enrollmentCount", (
    SELECT COALESCE(sum(p."Amount"), 0.0)
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c0 ON p."CourseId" = c0."Id"
    WHERE c0."Category" = c."Category" AND p."Status" = 'Completed') AS revenue
FROM "Courses" AS c
GROUP BY c."Category"
ORDER BY COALESCE(sum((
    SELECT count(*)::int
    FROM "Enrollments" AS e
    WHERE c."Id" = e."CourseId")), 0)::int DESC
2025-07-30 16:31:52.627 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT p0."Year", p0."Month", COALESCE(sum(p0."Amount"), 0.0) AS "Revenue", count(*)::int AS "TransactionCount"
FROM (
    SELECT p."Amount", date_part('year', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "Payments" AS p
    WHERE p."Status" = 'Completed' AND p."CreatedAt" >= @__sixMonthsAgo_0
) AS p0
GROUP BY p0."Year", p0."Month"
2025-07-30 16:31:52.628 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT a0."Year", a0."Month", count(*)::int AS "NewUsers"
FROM (
    SELECT date_part('year', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "AspNetUsers" AS a
    WHERE a."CreatedAt" >= @__sixMonthsAgo_0
) AS a0
GROUP BY a0."Year", a0."Month"
2025-07-30 16:31:52.630 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Subscriptions" AS s
WHERE s."Status" = 'Active'
2025-07-30 16:31:52.631 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s."PlanName" AS plan, count(*)::int AS count, COALESCE(sum(s."Price"), 0.0) AS "monthlyRevenue"
FROM "Subscriptions" AS s
WHERE s."Status" = 'Active'
GROUP BY s."PlanName"
2025-07-30 16:31:52.632 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType20`6[[<>f__AnonymousType21`5[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 16:31:52.633 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api) in 17.7253ms
2025-07-30 16:31:52.633 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-07-30 16:31:52.634 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/platform - 200 null application/json; charset=utf-8 24.5975ms
2025-07-30 16:31:52.635 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/course-completions - null null
2025-07-30 16:31:52.636 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:31:52.637 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/course-completions - 204 null null 1.3124ms
2025-07-30 16:31:52.638 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/course-completions - application/json null
2025-07-30 16:31:52.639 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:31:52.640 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 16:31:52.641 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetCourseCompletions (CeceLearningPortal.Api)'
2025-07-30 16:31:52.642 +08:00 [INF] Route matched with {action = "GetCourseCompletions", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourseCompletions(Int32) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 16:31:52.644 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT e0."Id", a."FullName", a."Avatar", a."Email", c."Title", e0."CourseId"::text, e0."CompletedAt", COALESCE(e0."AverageQuizScore", 0.0), e0."CertificateIssued", e0."CertificateUrl"
FROM (
    SELECT e."Id", e."AverageQuizScore", e."CertificateIssued", e."CertificateUrl", e."CompletedAt", e."CourseId", e."StudentId"
    FROM "Enrollments" AS e
    WHERE e."CompletedAt" IS NOT NULL
    ORDER BY e."CompletedAt" DESC
    LIMIT @__p_0
) AS e0
INNER JOIN "AspNetUsers" AS a ON e0."StudentId" = a."Id"
INNER JOIN "Courses" AS c ON e0."CourseId" = c."Id"
ORDER BY e0."CompletedAt" DESC
2025-07-30 16:31:52.645 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType9`10[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-30 16:31:52.646 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetCourseCompletions (CeceLearningPortal.Api) in 3.6077ms
2025-07-30 16:31:52.647 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetCourseCompletions (CeceLearningPortal.Api)'
2025-07-30 16:31:52.648 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/course-completions - 200 null application/json; charset=utf-8 9.562ms
2025-07-30 16:31:54.095 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users - null null
2025-07-30 16:31:54.096 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/subscription-plans - null null
2025-07-30 16:31:54.097 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:31:54.098 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:31:54.098 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users - 204 null null 2.97ms
2025-07-30 16:31:54.099 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/subscription-plans - 204 null null 2.882ms
2025-07-30 16:31:54.100 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/subscription-plans - application/json null
2025-07-30 16:31:54.101 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users - application/json null
2025-07-30 16:31:54.102 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:31:54.103 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:31:54.105 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 16:31:54.105 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 16:31:54.106 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetSubscriptionPlans (CeceLearningPortal.Api)'
2025-07-30 16:31:54.106 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUsers (CeceLearningPortal.Api)'
2025-07-30 16:31:54.107 +08:00 [INF] Route matched with {action = "GetSubscriptionPlans", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetSubscriptionPlans() on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 16:31:54.107 +08:00 [INF] Route matched with {action = "GetUsers", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUsers(CeceLearningPortal.Api.DTOs.UserManagementFilterDto) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 16:31:54.109 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."CreatedAt", s."Description", s."DisplayOrder", s."Features", s."HasAnalytics", s."HasPrioritySupport", s."HasUnlimitedAccess", s."IsActive", s."IsRecommended", s."MaxCourseAccess", s."MaxCoursesCanCreate", s."MaxStudentsPerCourse", s."MonthlyPrice", s."Name", s."PlanType", s."TransactionFeePercentage", s."UpdatedAt", s."YearlyPrice", s0."Id", s0."BillingCycle", s0."CreatedAt", s0."EndDate", s0."NextBillingDate", s0."PlanName", s0."Price", s0."StartDate", s0."Status", s0."StripeSubscriptionId", s0."SubscriptionPlanId", s0."UpdatedAt", s0."UserId"
FROM "SubscriptionPlans" AS s
LEFT JOIN "Subscriptions" AS s0 ON s."Id" = s0."SubscriptionPlanId"
ORDER BY s."Id"
2025-07-30 16:31:54.109 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
2025-07-30 16:31:54.111 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[CeceLearningPortal.Api.DTOs.SubscriptionPlanDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-30 16:31:54.112 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."UserName", a."Email", a."FullName", a."Role", a."Status", a."CreatedAt", a."LastLoginAt", a."EmailConfirmed"
FROM "AspNetUsers" AS a
ORDER BY a."CreatedAt" DESC
LIMIT @__p_1 OFFSET @__p_0
2025-07-30 16:31:54.112 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetSubscriptionPlans (CeceLearningPortal.Api) in 4.2557ms
2025-07-30 16:31:54.113 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[CeceLearningPortal.Api.DTOs.UserManagementDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-30 16:31:54.114 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetSubscriptionPlans (CeceLearningPortal.Api)'
2025-07-30 16:31:54.114 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUsers (CeceLearningPortal.Api) in 5.5325ms
2025-07-30 16:31:54.115 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/subscription-plans - 200 null application/json; charset=utf-8 14.84ms
2025-07-30 16:31:54.115 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUsers (CeceLearningPortal.Api)'
2025-07-30 16:31:54.118 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users - 200 null application/json; charset=utf-8 16.4872ms
2025-07-30 16:31:54.120 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/efead752-f0b3-48ab-93b8-7ba31e7574ba/subscription - null null
2025-07-30 16:31:54.120 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/e090c598-224f-4b4c-870a-3c3ef6303e0a/subscription - null null
2025-07-30 16:31:54.120 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/801dc698-62a8-49c3-b578-b7c1b05049a4/subscription - null null
2025-07-30 16:31:54.121 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/28b8e854-738a-4e69-835c-71299a8f9b21/subscription - null null
2025-07-30 16:31:54.121 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/f9f0e64e-3771-4aa9-8470-21e709677e44/subscription - null null
2025-07-30 16:31:54.121 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:31:54.122 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:31:54.123 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:31:54.124 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:31:54.125 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:31:54.125 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/efead752-f0b3-48ab-93b8-7ba31e7574ba/subscription - 204 null null 5.6257ms
2025-07-30 16:31:54.126 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/e090c598-224f-4b4c-870a-3c3ef6303e0a/subscription - 204 null null 5.7962ms
2025-07-30 16:31:54.126 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/801dc698-62a8-49c3-b578-b7c1b05049a4/subscription - 204 null null 5.7397ms
2025-07-30 16:31:54.127 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/28b8e854-738a-4e69-835c-71299a8f9b21/subscription - 204 null null 6.2489ms
2025-07-30 16:31:54.127 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/f9f0e64e-3771-4aa9-8470-21e709677e44/subscription - 204 null null 6.2428ms
2025-07-30 16:31:54.128 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/f9f0e64e-3771-4aa9-8470-21e709677e44/subscription - application/json null
2025-07-30 16:31:54.130 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/efead752-f0b3-48ab-93b8-7ba31e7574ba/subscription - application/json null
2025-07-30 16:31:54.131 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/e090c598-224f-4b4c-870a-3c3ef6303e0a/subscription - application/json null
2025-07-30 16:31:54.132 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/801dc698-62a8-49c3-b578-b7c1b05049a4/subscription - application/json null
2025-07-30 16:31:54.133 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/28b8e854-738a-4e69-835c-71299a8f9b21/subscription - application/json null
2025-07-30 16:31:54.134 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:31:54.135 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:31:54.136 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:31:54.137 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:31:54.138 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:31:54.139 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 16:31:54.139 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 16:31:54.141 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 16:31:54.142 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 16:31:54.142 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 16:31:54.143 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 16:31:54.145 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 16:31:54.146 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 16:31:54.147 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType83`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 16:31:54.148 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType83`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 16:31:54.149 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 4.94ms
2025-07-30 16:31:54.150 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 4.907ms
2025-07-30 16:31:54.150 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 16:31:54.151 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 16:31:54.152 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/f9f0e64e-3771-4aa9-8470-21e709677e44/subscription - 200 null application/json; charset=utf-8 23.4769ms
2025-07-30 16:31:54.153 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/efead752-f0b3-48ab-93b8-7ba31e7574ba/subscription - 200 null application/json; charset=utf-8 22.9746ms
2025-07-30 16:31:54.185 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 16:31:54.187 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 16:31:54.187 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 16:31:54.189 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 16:31:54.189 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 16:31:54.190 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 16:31:54.191 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType83`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 16:31:54.191 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 16:31:54.192 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 4.1473ms
2025-07-30 16:31:54.193 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 16:31:54.194 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 16:31:54.194 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 16:31:54.195 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 16:31:54.195 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/e090c598-224f-4b4c-870a-3c3ef6303e0a/subscription - 200 null application/json; charset=utf-8 64.0598ms
2025-07-30 16:31:54.196 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType83`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 16:31:54.197 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 16:31:54.199 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 5.7006ms
2025-07-30 16:31:54.200 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 16:31:54.200 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/801dc698-62a8-49c3-b578-b7c1b05049a4/subscription - 200 null application/json; charset=utf-8 68.1384ms
2025-07-30 16:31:54.202 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 16:31:54.203 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType83`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 16:31:54.203 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 4.1251ms
2025-07-30 16:31:54.204 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 16:31:54.204 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/28b8e854-738a-4e69-835c-71299a8f9b21/subscription - 200 null application/json; charset=utf-8 70.951ms
2025-07-30 16:31:57.103 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/courses - null null
2025-07-30 16:31:57.104 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:31:57.105 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/courses - 204 null null 1.6995ms
2025-07-30 16:31:57.106 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses - application/json null
2025-07-30 16:31:57.107 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:31:57.108 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 16:31:57.109 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-30 16:31:57.110 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-30 16:31:57.112 +08:00 [ERR] Failed executing DbCommand (0ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."IsPublished", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."PublishedAt", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."IsFlagged", r."Rating", r."Status", r."StudentId", e."Id", e."AverageQuizScore", e."CertificateIssued", e."CertificateUrl", e."CompletedAt", e."CompletedLessons", e."CourseId", e."EnrolledAt", e."LastAccessedDate", e."ProgressPercentage", e."QuizCount", e."StudentId", e."TotalTimeSpent"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."IsPublished", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."PublishedAt", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-30 16:31:57.114 +08:00 [ERR] An exception occurred while iterating over the results of a query for context type 'CeceLearningPortal.Api.Data.ApplicationDbContext'.
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 1526
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 1526
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 1526
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 1526
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 16:31:57.118 +08:00 [ERR] Error retrieving courses
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 1526
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at CeceLearningPortal.Api.Services.CourseService.GetAllCoursesAsync(CourseFilterDto filter) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Services\CourseService.cs:line 95
   at CeceLearningPortal.Api.Controllers.CoursesController.GetCourses(CourseFilterDto filter) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Controllers\CoursesController.cs:line 26
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 1526
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 16:31:57.122 +08:00 [INF] Executing ObjectResult, writing value of type '<>f__AnonymousType0`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 16:31:57.123 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 12.0115ms
2025-07-30 16:31:57.123 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-30 16:31:57.124 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses - 500 null application/json; charset=utf-8 17.7998ms
2025-07-30 16:31:58.575 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/subscription-plans - application/json null
2025-07-30 16:31:58.576 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:31:58.578 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 16:31:58.579 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetSubscriptionPlans (CeceLearningPortal.Api)'
2025-07-30 16:31:58.579 +08:00 [INF] Route matched with {action = "GetSubscriptionPlans", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetSubscriptionPlans() on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 16:31:58.581 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."CreatedAt", s."Description", s."DisplayOrder", s."Features", s."HasAnalytics", s."HasPrioritySupport", s."HasUnlimitedAccess", s."IsActive", s."IsRecommended", s."MaxCourseAccess", s."MaxCoursesCanCreate", s."MaxStudentsPerCourse", s."MonthlyPrice", s."Name", s."PlanType", s."TransactionFeePercentage", s."UpdatedAt", s."YearlyPrice", s0."Id", s0."BillingCycle", s0."CreatedAt", s0."EndDate", s0."NextBillingDate", s0."PlanName", s0."Price", s0."StartDate", s0."Status", s0."StripeSubscriptionId", s0."SubscriptionPlanId", s0."UpdatedAt", s0."UserId"
FROM "SubscriptionPlans" AS s
LEFT JOIN "Subscriptions" AS s0 ON s."Id" = s0."SubscriptionPlanId"
ORDER BY s."Id"
2025-07-30 16:31:58.582 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[CeceLearningPortal.Api.DTOs.SubscriptionPlanDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-30 16:31:58.583 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetSubscriptionPlans (CeceLearningPortal.Api) in 2.6139ms
2025-07-30 16:31:58.583 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetSubscriptionPlans (CeceLearningPortal.Api)'
2025-07-30 16:31:58.584 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/subscription-plans - 200 null application/json; charset=utf-8 9.2416ms
2025-07-30 16:31:59.992 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users - null null
2025-07-30 16:31:59.992 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/subscription-plans - null null
2025-07-30 16:31:59.994 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:31:59.995 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:31:59.995 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users - 204 null null 3.0745ms
2025-07-30 16:31:59.996 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/subscription-plans - 204 null null 3.2074ms
2025-07-30 16:31:59.997 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/subscription-plans - application/json null
2025-07-30 16:31:59.998 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users - application/json null
2025-07-30 16:31:59.999 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:32:00.000 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:32:00.001 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 16:32:00.001 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 16:32:00.002 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUsers (CeceLearningPortal.Api)'
2025-07-30 16:32:00.003 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetSubscriptionPlans (CeceLearningPortal.Api)'
2025-07-30 16:32:00.003 +08:00 [INF] Route matched with {action = "GetUsers", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUsers(CeceLearningPortal.Api.DTOs.UserManagementFilterDto) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 16:32:00.004 +08:00 [INF] Route matched with {action = "GetSubscriptionPlans", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetSubscriptionPlans() on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 16:32:00.005 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
2025-07-30 16:32:00.007 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."CreatedAt", s."Description", s."DisplayOrder", s."Features", s."HasAnalytics", s."HasPrioritySupport", s."HasUnlimitedAccess", s."IsActive", s."IsRecommended", s."MaxCourseAccess", s."MaxCoursesCanCreate", s."MaxStudentsPerCourse", s."MonthlyPrice", s."Name", s."PlanType", s."TransactionFeePercentage", s."UpdatedAt", s."YearlyPrice", s0."Id", s0."BillingCycle", s0."CreatedAt", s0."EndDate", s0."NextBillingDate", s0."PlanName", s0."Price", s0."StartDate", s0."Status", s0."StripeSubscriptionId", s0."SubscriptionPlanId", s0."UpdatedAt", s0."UserId"
FROM "SubscriptionPlans" AS s
LEFT JOIN "Subscriptions" AS s0 ON s."Id" = s0."SubscriptionPlanId"
ORDER BY s."Id"
2025-07-30 16:32:00.007 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."UserName", a."Email", a."FullName", a."Role", a."Status", a."CreatedAt", a."LastLoginAt", a."EmailConfirmed"
FROM "AspNetUsers" AS a
ORDER BY a."CreatedAt" DESC
LIMIT @__p_1 OFFSET @__p_0
2025-07-30 16:32:00.008 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[CeceLearningPortal.Api.DTOs.SubscriptionPlanDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-30 16:32:00.009 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[CeceLearningPortal.Api.DTOs.UserManagementDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-30 16:32:00.010 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetSubscriptionPlans (CeceLearningPortal.Api) in 4.619ms
2025-07-30 16:32:00.011 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUsers (CeceLearningPortal.Api) in 6.1796ms
2025-07-30 16:32:00.011 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetSubscriptionPlans (CeceLearningPortal.Api)'
2025-07-30 16:32:00.012 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUsers (CeceLearningPortal.Api)'
2025-07-30 16:32:00.012 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/subscription-plans - 200 null application/json; charset=utf-8 15.5729ms
2025-07-30 16:32:00.013 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users - 200 null application/json; charset=utf-8 14.881ms
2025-07-30 16:32:00.014 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/801dc698-62a8-49c3-b578-b7c1b05049a4/subscription - null null
2025-07-30 16:32:00.014 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/e090c598-224f-4b4c-870a-3c3ef6303e0a/subscription - null null
2025-07-30 16:32:00.014 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/28b8e854-738a-4e69-835c-71299a8f9b21/subscription - null null
2025-07-30 16:32:00.014 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/f9f0e64e-3771-4aa9-8470-21e709677e44/subscription - null null
2025-07-30 16:32:00.016 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/efead752-f0b3-48ab-93b8-7ba31e7574ba/subscription - null null
2025-07-30 16:32:00.017 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:32:00.018 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:32:00.019 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:32:00.019 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:32:00.021 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:32:00.021 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/801dc698-62a8-49c3-b578-b7c1b05049a4/subscription - 204 null null 6.7077ms
2025-07-30 16:32:00.021 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/e090c598-224f-4b4c-870a-3c3ef6303e0a/subscription - 204 null null 7.0735ms
2025-07-30 16:32:00.022 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/28b8e854-738a-4e69-835c-71299a8f9b21/subscription - 204 null null 7.3522ms
2025-07-30 16:32:00.022 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/f9f0e64e-3771-4aa9-8470-21e709677e44/subscription - 204 null null 7.7877ms
2025-07-30 16:32:00.023 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/efead752-f0b3-48ab-93b8-7ba31e7574ba/subscription - 204 null null 7.0537ms
2025-07-30 16:32:00.024 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/801dc698-62a8-49c3-b578-b7c1b05049a4/subscription - application/json null
2025-07-30 16:32:00.025 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/28b8e854-738a-4e69-835c-71299a8f9b21/subscription - application/json null
2025-07-30 16:32:00.026 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/e090c598-224f-4b4c-870a-3c3ef6303e0a/subscription - application/json null
2025-07-30 16:32:00.028 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/efead752-f0b3-48ab-93b8-7ba31e7574ba/subscription - application/json null
2025-07-30 16:32:00.029 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/f9f0e64e-3771-4aa9-8470-21e709677e44/subscription - application/json null
2025-07-30 16:32:00.030 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:32:00.031 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:32:00.032 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:32:00.033 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:32:00.034 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:32:00.035 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 16:32:00.035 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 16:32:00.035 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 16:32:00.036 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 16:32:00.036 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 16:32:00.036 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 16:32:00.037 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 16:32:00.038 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 16:32:00.039 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 16:32:00.040 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 16:32:00.041 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 16:32:00.041 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 16:32:00.042 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 16:32:00.043 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 16:32:00.043 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 16:32:00.046 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 16:32:00.048 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 16:32:00.049 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 16:32:00.050 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 16:32:00.050 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 16:32:00.051 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType83`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 16:32:00.052 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType83`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 16:32:00.054 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType83`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 16:32:00.056 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType83`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 16:32:00.058 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType83`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 16:32:00.059 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 14.6251ms
2025-07-30 16:32:00.060 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 13.2503ms
2025-07-30 16:32:00.062 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 15.8694ms
2025-07-30 16:32:00.063 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 13.4545ms
2025-07-30 16:32:00.063 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 15.3292ms
2025-07-30 16:32:00.064 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 16:32:00.065 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 16:32:00.066 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 16:32:00.067 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 16:32:00.068 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 16:32:00.069 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/28b8e854-738a-4e69-835c-71299a8f9b21/subscription - 200 null application/json; charset=utf-8 43.4317ms
2025-07-30 16:32:00.069 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/e090c598-224f-4b4c-870a-3c3ef6303e0a/subscription - 200 null application/json; charset=utf-8 43.0876ms
2025-07-30 16:32:00.070 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/801dc698-62a8-49c3-b578-b7c1b05049a4/subscription - 200 null application/json; charset=utf-8 46.0974ms
2025-07-30 16:32:00.071 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/f9f0e64e-3771-4aa9-8470-21e709677e44/subscription - 200 null application/json; charset=utf-8 41.8155ms
2025-07-30 16:32:00.072 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/efead752-f0b3-48ab-93b8-7ba31e7574ba/subscription - 200 null application/json; charset=utf-8 43.8989ms
2025-07-30 16:32:23.498 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/pending-approval - null null
2025-07-30 16:32:23.499 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users - null null
2025-07-30 16:32:23.499 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/subscription-plans - null null
2025-07-30 16:32:23.500 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:32:23.501 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:32:23.502 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:32:23.502 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/pending-approval - 204 null null 4.2406ms
2025-07-30 16:32:23.502 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users - 204 null null 3.8874ms
2025-07-30 16:32:23.503 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/subscription-plans - 204 null null 4.225ms
2025-07-30 16:32:23.504 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/subscription-plans - application/json null
2025-07-30 16:32:23.505 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users - application/json null
2025-07-30 16:32:23.507 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/pending-approval - application/json null
2025-07-30 16:32:23.508 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:32:23.509 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:32:23.510 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:32:23.511 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 16:32:23.511 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 16:32:23.512 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 16:32:23.512 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUsers (CeceLearningPortal.Api)'
2025-07-30 16:32:23.513 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetSubscriptionPlans (CeceLearningPortal.Api)'
2025-07-30 16:32:23.514 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUser (CeceLearningPortal.Api)'
2025-07-30 16:32:23.514 +08:00 [INF] Route matched with {action = "GetUsers", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUsers(CeceLearningPortal.Api.DTOs.UserManagementFilterDto) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 16:32:23.515 +08:00 [INF] Route matched with {action = "GetSubscriptionPlans", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetSubscriptionPlans() on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 16:32:23.517 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
2025-07-30 16:32:23.517 +08:00 [INF] Route matched with {action = "GetUser", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUser(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 16:32:23.517 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."CreatedAt", s."Description", s."DisplayOrder", s."Features", s."HasAnalytics", s."HasPrioritySupport", s."HasUnlimitedAccess", s."IsActive", s."IsRecommended", s."MaxCourseAccess", s."MaxCoursesCanCreate", s."MaxStudentsPerCourse", s."MonthlyPrice", s."Name", s."PlanType", s."TransactionFeePercentage", s."UpdatedAt", s."YearlyPrice", s0."Id", s0."BillingCycle", s0."CreatedAt", s0."EndDate", s0."NextBillingDate", s0."PlanName", s0."Price", s0."StartDate", s0."Status", s0."StripeSubscriptionId", s0."SubscriptionPlanId", s0."UpdatedAt", s0."UserId"
FROM "SubscriptionPlans" AS s
LEFT JOIN "Subscriptions" AS s0 ON s."Id" = s0."SubscriptionPlanId"
ORDER BY s."Id"
2025-07-30 16:32:23.518 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."UserName", a."Email", a."FullName", a."Role", a."Status", a."CreatedAt", a."LastLoginAt", a."EmailConfirmed"
FROM "AspNetUsers" AS a
ORDER BY a."CreatedAt" DESC
LIMIT @__p_1 OFFSET @__p_0
2025-07-30 16:32:23.520 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[CeceLearningPortal.Api.DTOs.SubscriptionPlanDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-30 16:32:23.520 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[CeceLearningPortal.Api.DTOs.UserManagementDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-30 16:32:23.521 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetSubscriptionPlans (CeceLearningPortal.Api) in 4.2906ms
2025-07-30 16:32:23.522 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUsers (CeceLearningPortal.Api) in 5.7192ms
2025-07-30 16:32:23.522 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetSubscriptionPlans (CeceLearningPortal.Api)'
2025-07-30 16:32:23.523 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUsers (CeceLearningPortal.Api)'
2025-07-30 16:32:23.523 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."UserName", a."Email", a."FullName", a."Role", a."Status", a."CreatedAt", a."LastLoginAt", a."EmailConfirmed"
FROM "AspNetUsers" AS a
WHERE a."Id" = @__userId_0
LIMIT 1
2025-07-30 16:32:23.523 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/subscription-plans - 200 null application/json; charset=utf-8 19.0115ms
2025-07-30 16:32:23.524 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users - 200 null application/json; charset=utf-8 18.3451ms
2025-07-30 16:32:23.525 +08:00 [INF] Executing NotFoundObjectResult, writing value of type '<>f__AnonymousType1`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 16:32:23.525 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/801dc698-62a8-49c3-b578-b7c1b05049a4/subscription - null null
2025-07-30 16:32:23.526 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/f9f0e64e-3771-4aa9-8470-21e709677e44/subscription - null null
2025-07-30 16:32:23.526 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/28b8e854-738a-4e69-835c-71299a8f9b21/subscription - null null
2025-07-30 16:32:23.526 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/e090c598-224f-4b4c-870a-3c3ef6303e0a/subscription - null null
2025-07-30 16:32:23.527 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/efead752-f0b3-48ab-93b8-7ba31e7574ba/subscription - null null
2025-07-30 16:32:23.529 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUser (CeceLearningPortal.Api) in 10.4852ms
2025-07-30 16:32:23.529 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:32:23.530 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:32:23.531 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:32:23.532 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:32:23.533 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:32:23.534 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUser (CeceLearningPortal.Api)'
2025-07-30 16:32:23.534 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/801dc698-62a8-49c3-b578-b7c1b05049a4/subscription - 204 null null 8.962ms
2025-07-30 16:32:23.535 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/f9f0e64e-3771-4aa9-8470-21e709677e44/subscription - 204 null null 9.0356ms
2025-07-30 16:32:23.535 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/28b8e854-738a-4e69-835c-71299a8f9b21/subscription - 204 null null 9.3669ms
2025-07-30 16:32:23.536 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/e090c598-224f-4b4c-870a-3c3ef6303e0a/subscription - 204 null null 9.4904ms
2025-07-30 16:32:23.536 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/efead752-f0b3-48ab-93b8-7ba31e7574ba/subscription - 204 null null 8.5605ms
2025-07-30 16:32:23.537 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/pending-approval - 404 null application/json; charset=utf-8 29.9078ms
2025-07-30 16:32:23.538 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/f9f0e64e-3771-4aa9-8470-21e709677e44/subscription - application/json null
2025-07-30 16:32:23.539 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/801dc698-62a8-49c3-b578-b7c1b05049a4/subscription - application/json null
2025-07-30 16:32:23.540 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/efead752-f0b3-48ab-93b8-7ba31e7574ba/subscription - application/json null
2025-07-30 16:32:23.541 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/e090c598-224f-4b4c-870a-3c3ef6303e0a/subscription - application/json null
2025-07-30 16:32:23.542 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/28b8e854-738a-4e69-835c-71299a8f9b21/subscription - application/json null
2025-07-30 16:32:23.546 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:32:23.547 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:32:23.548 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:32:23.549 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:32:23.549 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:32:23.551 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 16:32:23.551 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 16:32:23.551 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 16:32:23.551 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 16:32:23.552 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 16:32:23.552 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 16:32:23.553 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 16:32:23.554 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 16:32:23.555 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 16:32:23.556 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 16:32:23.556 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 16:32:23.556 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 16:32:23.557 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 16:32:23.557 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 16:32:23.558 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 16:32:23.559 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 16:32:23.560 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 16:32:23.561 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 16:32:23.562 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 16:32:23.562 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 16:32:23.563 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType83`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 16:32:23.564 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType83`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 16:32:23.565 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType83`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 16:32:23.566 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType83`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 16:32:23.567 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType83`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 16:32:23.568 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 9.7738ms
2025-07-30 16:32:23.569 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 9.5579ms
2025-07-30 16:32:23.570 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 9.597ms
2025-07-30 16:32:23.570 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 9.3299ms
2025-07-30 16:32:23.571 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 9.231ms
2025-07-30 16:32:23.572 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 16:32:23.573 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 16:32:23.573 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 16:32:23.574 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 16:32:23.575 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 16:32:23.576 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/801dc698-62a8-49c3-b578-b7c1b05049a4/subscription - 200 null application/json; charset=utf-8 36.5759ms
2025-07-30 16:32:23.576 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/f9f0e64e-3771-4aa9-8470-21e709677e44/subscription - 200 null application/json; charset=utf-8 38.2325ms
2025-07-30 16:32:23.577 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/efead752-f0b3-48ab-93b8-7ba31e7574ba/subscription - 200 null application/json; charset=utf-8 36.4758ms
2025-07-30 16:32:23.577 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/e090c598-224f-4b4c-870a-3c3ef6303e0a/subscription - 200 null application/json; charset=utf-8 35.9419ms
2025-07-30 16:32:23.578 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/28b8e854-738a-4e69-835c-71299a8f9b21/subscription - 200 null application/json; charset=utf-8 35.4476ms
2025-07-30 16:33:01.863 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/platform - null null
2025-07-30 16:33:01.864 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:33:01.865 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/platform - 204 null null 2.4636ms
2025-07-30 16:33:01.867 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/platform - application/json null
2025-07-30 16:33:01.868 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:33:01.870 +08:00 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-07-30 16:33:01.871 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/platform - null null
2025-07-30 16:33:01.873 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:33:01.873 +08:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-07-30 16:33:01.873 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/platform - 204 null null 2.0306ms
2025-07-30 16:33:01.874 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/platform - 401 0 null 7.3577ms
2025-07-30 16:33:01.878 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/platform - application/json null
2025-07-30 16:33:01.879 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:33:01.881 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 16:33:01.882 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-07-30 16:33:01.883 +08:00 [INF] Route matched with {action = "GetPlatformAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPlatformAnalytics() on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-30 16:33:01.885 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
2025-07-30 16:33:01.887 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
2025-07-30 16:33:01.888 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."Status" = 'Completed'
2025-07-30 16:33:01.891 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
2025-07-30 16:33:01.893 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id" AS "instructorId", a."FullName" AS "instructorName", (
    SELECT count(*)::int
    FROM "Courses" AS c0
    WHERE c0."InstructorId" = a."Id") AS "totalCourses", (
    SELECT count(*)::int
    FROM "Enrollments" AS e
    INNER JOIN "Courses" AS c1 ON e."CourseId" = c1."Id"
    WHERE c1."InstructorId" = a."Id") AS "totalStudents", (
    SELECT COALESCE(sum(p0."Amount"), 0.0)
    FROM "Payments" AS p0
    LEFT JOIN "Courses" AS c2 ON p0."CourseId" = c2."Id"
    WHERE c2."InstructorId" = a."Id" AND p0."Status" = 'Completed') AS "totalRevenue", COALESCE((
    SELECT avg(r."Rating"::double precision)
    FROM "Reviews" AS r
    INNER JOIN "Courses" AS c3 ON r."CourseId" = c3."Id"
    WHERE c3."InstructorId" = a."Id"), 0.0) AS "averageRating"
FROM "AspNetUsers" AS a
WHERE a."Role" = 'Instructor'
ORDER BY (
    SELECT COALESCE(sum(p."Amount"), 0.0)
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
    WHERE c."InstructorId" = a."Id" AND p."Status" = 'Completed') DESC
LIMIT @__p_0
2025-07-30 16:33:01.898 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT c."Category" AS category, count(*)::int AS "courseCount", COALESCE(sum((
    SELECT count(*)::int
    FROM "Enrollments" AS e
    WHERE c."Id" = e."CourseId")), 0)::int AS "enrollmentCount", (
    SELECT COALESCE(sum(p."Amount"), 0.0)
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c0 ON p."CourseId" = c0."Id"
    WHERE c0."Category" = c."Category" AND p."Status" = 'Completed') AS revenue
FROM "Courses" AS c
GROUP BY c."Category"
ORDER BY COALESCE(sum((
    SELECT count(*)::int
    FROM "Enrollments" AS e
    WHERE c."Id" = e."CourseId")), 0)::int DESC
2025-07-30 16:33:01.901 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT p0."Year", p0."Month", COALESCE(sum(p0."Amount"), 0.0) AS "Revenue", count(*)::int AS "TransactionCount"
FROM (
    SELECT p."Amount", date_part('year', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "Payments" AS p
    WHERE p."Status" = 'Completed' AND p."CreatedAt" >= @__sixMonthsAgo_0
) AS p0
GROUP BY p0."Year", p0."Month"
2025-07-30 16:33:01.903 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT a0."Year", a0."Month", count(*)::int AS "NewUsers"
FROM (
    SELECT date_part('year', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "AspNetUsers" AS a
    WHERE a."CreatedAt" >= @__sixMonthsAgo_0
) AS a0
GROUP BY a0."Year", a0."Month"
2025-07-30 16:33:01.905 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Subscriptions" AS s
WHERE s."Status" = 'Active'
2025-07-30 16:33:01.906 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s."PlanName" AS plan, count(*)::int AS count, COALESCE(sum(s."Price"), 0.0) AS "monthlyRevenue"
FROM "Subscriptions" AS s
WHERE s."Status" = 'Active'
GROUP BY s."PlanName"
2025-07-30 16:33:01.907 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType20`6[[<>f__AnonymousType21`5[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 16:33:01.909 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api) in 24.7431ms
2025-07-30 16:33:01.909 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-07-30 16:33:01.910 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/platform - 200 null application/json; charset=utf-8 32.1005ms
2025-07-30 16:33:01.911 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/course-completions - null null
2025-07-30 16:33:01.913 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:33:01.913 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/course-completions - 204 null null 1.6013ms
2025-07-30 16:33:01.915 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/course-completions - application/json null
2025-07-30 16:33:01.916 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:33:01.918 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 16:33:01.919 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetCourseCompletions (CeceLearningPortal.Api)'
2025-07-30 16:33:01.919 +08:00 [INF] Route matched with {action = "GetCourseCompletions", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourseCompletions(Int32) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 16:33:01.923 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT e0."Id", a."FullName", a."Avatar", a."Email", c."Title", e0."CourseId"::text, e0."CompletedAt", COALESCE(e0."AverageQuizScore", 0.0), e0."CertificateIssued", e0."CertificateUrl"
FROM (
    SELECT e."Id", e."AverageQuizScore", e."CertificateIssued", e."CertificateUrl", e."CompletedAt", e."CourseId", e."StudentId"
    FROM "Enrollments" AS e
    WHERE e."CompletedAt" IS NOT NULL
    ORDER BY e."CompletedAt" DESC
    LIMIT @__p_0
) AS e0
INNER JOIN "AspNetUsers" AS a ON e0."StudentId" = a."Id"
INNER JOIN "Courses" AS c ON e0."CourseId" = c."Id"
ORDER BY e0."CompletedAt" DESC
2025-07-30 16:33:01.924 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType9`10[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-30 16:33:01.925 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetCourseCompletions (CeceLearningPortal.Api) in 4.7074ms
2025-07-30 16:33:01.926 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetCourseCompletions (CeceLearningPortal.Api)'
2025-07-30 16:33:01.926 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/course-completions - 200 null application/json; charset=utf-8 11.7869ms
2025-07-30 16:33:01.993 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/course-completions - application/json null
2025-07-30 16:33:01.994 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:33:01.996 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 16:33:01.997 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetCourseCompletions (CeceLearningPortal.Api)'
2025-07-30 16:33:01.998 +08:00 [INF] Route matched with {action = "GetCourseCompletions", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourseCompletions(Int32) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 16:33:02.001 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT e0."Id", a."FullName", a."Avatar", a."Email", c."Title", e0."CourseId"::text, e0."CompletedAt", COALESCE(e0."AverageQuizScore", 0.0), e0."CertificateIssued", e0."CertificateUrl"
FROM (
    SELECT e."Id", e."AverageQuizScore", e."CertificateIssued", e."CertificateUrl", e."CompletedAt", e."CourseId", e."StudentId"
    FROM "Enrollments" AS e
    WHERE e."CompletedAt" IS NOT NULL
    ORDER BY e."CompletedAt" DESC
    LIMIT @__p_0
) AS e0
INNER JOIN "AspNetUsers" AS a ON e0."StudentId" = a."Id"
INNER JOIN "Courses" AS c ON e0."CourseId" = c."Id"
ORDER BY e0."CompletedAt" DESC
2025-07-30 16:33:02.002 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType9`10[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-30 16:33:02.003 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetCourseCompletions (CeceLearningPortal.Api) in 4.4262ms
2025-07-30 16:33:02.004 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetCourseCompletions (CeceLearningPortal.Api)'
2025-07-30 16:33:02.004 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/course-completions - 200 null application/json; charset=utf-8 11.3394ms
2025-07-30 16:33:27.171 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/platform - null null
2025-07-30 16:33:27.172 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:33:27.173 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/platform - 204 null null 2.001ms
2025-07-30 16:33:27.174 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/platform - application/json null
2025-07-30 16:33:27.176 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:33:27.178 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 16:33:27.179 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-07-30 16:33:27.180 +08:00 [INF] Route matched with {action = "GetPlatformAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPlatformAnalytics() on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-30 16:33:27.181 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
2025-07-30 16:33:27.183 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
2025-07-30 16:33:27.184 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."Status" = 'Completed'
2025-07-30 16:33:27.185 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
2025-07-30 16:33:27.188 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id" AS "instructorId", a."FullName" AS "instructorName", (
    SELECT count(*)::int
    FROM "Courses" AS c0
    WHERE c0."InstructorId" = a."Id") AS "totalCourses", (
    SELECT count(*)::int
    FROM "Enrollments" AS e
    INNER JOIN "Courses" AS c1 ON e."CourseId" = c1."Id"
    WHERE c1."InstructorId" = a."Id") AS "totalStudents", (
    SELECT COALESCE(sum(p0."Amount"), 0.0)
    FROM "Payments" AS p0
    LEFT JOIN "Courses" AS c2 ON p0."CourseId" = c2."Id"
    WHERE c2."InstructorId" = a."Id" AND p0."Status" = 'Completed') AS "totalRevenue", COALESCE((
    SELECT avg(r."Rating"::double precision)
    FROM "Reviews" AS r
    INNER JOIN "Courses" AS c3 ON r."CourseId" = c3."Id"
    WHERE c3."InstructorId" = a."Id"), 0.0) AS "averageRating"
FROM "AspNetUsers" AS a
WHERE a."Role" = 'Instructor'
ORDER BY (
    SELECT COALESCE(sum(p."Amount"), 0.0)
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
    WHERE c."InstructorId" = a."Id" AND p."Status" = 'Completed') DESC
LIMIT @__p_0
2025-07-30 16:33:27.190 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT c."Category" AS category, count(*)::int AS "courseCount", COALESCE(sum((
    SELECT count(*)::int
    FROM "Enrollments" AS e
    WHERE c."Id" = e."CourseId")), 0)::int AS "enrollmentCount", (
    SELECT COALESCE(sum(p."Amount"), 0.0)
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c0 ON p."CourseId" = c0."Id"
    WHERE c0."Category" = c."Category" AND p."Status" = 'Completed') AS revenue
FROM "Courses" AS c
GROUP BY c."Category"
ORDER BY COALESCE(sum((
    SELECT count(*)::int
    FROM "Enrollments" AS e
    WHERE c."Id" = e."CourseId")), 0)::int DESC
2025-07-30 16:33:27.192 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT p0."Year", p0."Month", COALESCE(sum(p0."Amount"), 0.0) AS "Revenue", count(*)::int AS "TransactionCount"
FROM (
    SELECT p."Amount", date_part('year', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "Payments" AS p
    WHERE p."Status" = 'Completed' AND p."CreatedAt" >= @__sixMonthsAgo_0
) AS p0
GROUP BY p0."Year", p0."Month"
2025-07-30 16:33:27.193 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT a0."Year", a0."Month", count(*)::int AS "NewUsers"
FROM (
    SELECT date_part('year', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "AspNetUsers" AS a
    WHERE a."CreatedAt" >= @__sixMonthsAgo_0
) AS a0
GROUP BY a0."Year", a0."Month"
2025-07-30 16:33:27.194 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Subscriptions" AS s
WHERE s."Status" = 'Active'
2025-07-30 16:33:27.196 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s."PlanName" AS plan, count(*)::int AS count, COALESCE(sum(s."Price"), 0.0) AS "monthlyRevenue"
FROM "Subscriptions" AS s
WHERE s."Status" = 'Active'
GROUP BY s."PlanName"
2025-07-30 16:33:27.197 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType20`6[[<>f__AnonymousType21`5[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 16:33:27.198 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api) in 17.2468ms
2025-07-30 16:33:27.199 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-07-30 16:33:27.199 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/platform - application/json null
2025-07-30 16:33:27.199 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/platform - 200 null application/json; charset=utf-8 24.9709ms
2025-07-30 16:33:27.200 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:33:27.202 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/course-completions - null null
2025-07-30 16:33:27.203 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 16:33:27.203 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:33:27.204 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-07-30 16:33:27.205 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/course-completions - 204 null null 2.8046ms
2025-07-30 16:33:27.205 +08:00 [INF] Route matched with {action = "GetPlatformAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPlatformAnalytics() on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-30 16:33:27.207 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/course-completions - application/json null
2025-07-30 16:33:27.208 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
2025-07-30 16:33:27.209 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:33:27.210 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
2025-07-30 16:33:27.211 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 16:33:27.212 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."Status" = 'Completed'
2025-07-30 16:33:27.212 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetCourseCompletions (CeceLearningPortal.Api)'
2025-07-30 16:33:27.214 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
2025-07-30 16:33:27.214 +08:00 [INF] Route matched with {action = "GetCourseCompletions", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourseCompletions(Int32) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 16:33:27.216 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT e0."Id", a."FullName", a."Avatar", a."Email", c."Title", e0."CourseId"::text, e0."CompletedAt", COALESCE(e0."AverageQuizScore", 0.0), e0."CertificateIssued", e0."CertificateUrl"
FROM (
    SELECT e."Id", e."AverageQuizScore", e."CertificateIssued", e."CertificateUrl", e."CompletedAt", e."CourseId", e."StudentId"
    FROM "Enrollments" AS e
    WHERE e."CompletedAt" IS NOT NULL
    ORDER BY e."CompletedAt" DESC
    LIMIT @__p_0
) AS e0
INNER JOIN "AspNetUsers" AS a ON e0."StudentId" = a."Id"
INNER JOIN "Courses" AS c ON e0."CourseId" = c."Id"
ORDER BY e0."CompletedAt" DESC
2025-07-30 16:33:27.217 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id" AS "instructorId", a."FullName" AS "instructorName", (
    SELECT count(*)::int
    FROM "Courses" AS c0
    WHERE c0."InstructorId" = a."Id") AS "totalCourses", (
    SELECT count(*)::int
    FROM "Enrollments" AS e
    INNER JOIN "Courses" AS c1 ON e."CourseId" = c1."Id"
    WHERE c1."InstructorId" = a."Id") AS "totalStudents", (
    SELECT COALESCE(sum(p0."Amount"), 0.0)
    FROM "Payments" AS p0
    LEFT JOIN "Courses" AS c2 ON p0."CourseId" = c2."Id"
    WHERE c2."InstructorId" = a."Id" AND p0."Status" = 'Completed') AS "totalRevenue", COALESCE((
    SELECT avg(r."Rating"::double precision)
    FROM "Reviews" AS r
    INNER JOIN "Courses" AS c3 ON r."CourseId" = c3."Id"
    WHERE c3."InstructorId" = a."Id"), 0.0) AS "averageRating"
FROM "AspNetUsers" AS a
WHERE a."Role" = 'Instructor'
ORDER BY (
    SELECT COALESCE(sum(p."Amount"), 0.0)
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
    WHERE c."InstructorId" = a."Id" AND p."Status" = 'Completed') DESC
LIMIT @__p_0
2025-07-30 16:33:27.218 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType9`10[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-30 16:33:27.220 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetCourseCompletions (CeceLearningPortal.Api) in 4.2015ms
2025-07-30 16:33:27.220 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT c."Category" AS category, count(*)::int AS "courseCount", COALESCE(sum((
    SELECT count(*)::int
    FROM "Enrollments" AS e
    WHERE c."Id" = e."CourseId")), 0)::int AS "enrollmentCount", (
    SELECT COALESCE(sum(p."Amount"), 0.0)
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c0 ON p."CourseId" = c0."Id"
    WHERE c0."Category" = c."Category" AND p."Status" = 'Completed') AS revenue
FROM "Courses" AS c
GROUP BY c."Category"
ORDER BY COALESCE(sum((
    SELECT count(*)::int
    FROM "Enrollments" AS e
    WHERE c."Id" = e."CourseId")), 0)::int DESC
2025-07-30 16:33:27.220 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetCourseCompletions (CeceLearningPortal.Api)'
2025-07-30 16:33:27.222 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT p0."Year", p0."Month", COALESCE(sum(p0."Amount"), 0.0) AS "Revenue", count(*)::int AS "TransactionCount"
FROM (
    SELECT p."Amount", date_part('year', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "Payments" AS p
    WHERE p."Status" = 'Completed' AND p."CreatedAt" >= @__sixMonthsAgo_0
) AS p0
GROUP BY p0."Year", p0."Month"
2025-07-30 16:33:27.222 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/course-completions - 200 null application/json; charset=utf-8 15.0813ms
2025-07-30 16:33:27.223 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT a0."Year", a0."Month", count(*)::int AS "NewUsers"
FROM (
    SELECT date_part('year', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "AspNetUsers" AS a
    WHERE a."CreatedAt" >= @__sixMonthsAgo_0
) AS a0
GROUP BY a0."Year", a0."Month"
2025-07-30 16:33:27.225 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Subscriptions" AS s
WHERE s."Status" = 'Active'
2025-07-30 16:33:27.227 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s."PlanName" AS plan, count(*)::int AS count, COALESCE(sum(s."Price"), 0.0) AS "monthlyRevenue"
FROM "Subscriptions" AS s
WHERE s."Status" = 'Active'
GROUP BY s."PlanName"
2025-07-30 16:33:27.228 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType20`6[[<>f__AnonymousType21`5[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 16:33:27.229 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api) in 21.1227ms
2025-07-30 16:33:27.229 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-07-30 16:33:27.230 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/platform - 200 null application/json; charset=utf-8 30.9675ms
2025-07-30 16:33:27.232 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/course-completions - application/json null
2025-07-30 16:33:27.233 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:33:27.234 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 16:33:27.235 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetCourseCompletions (CeceLearningPortal.Api)'
2025-07-30 16:33:27.236 +08:00 [INF] Route matched with {action = "GetCourseCompletions", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourseCompletions(Int32) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 16:33:27.237 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT e0."Id", a."FullName", a."Avatar", a."Email", c."Title", e0."CourseId"::text, e0."CompletedAt", COALESCE(e0."AverageQuizScore", 0.0), e0."CertificateIssued", e0."CertificateUrl"
FROM (
    SELECT e."Id", e."AverageQuizScore", e."CertificateIssued", e."CertificateUrl", e."CompletedAt", e."CourseId", e."StudentId"
    FROM "Enrollments" AS e
    WHERE e."CompletedAt" IS NOT NULL
    ORDER BY e."CompletedAt" DESC
    LIMIT @__p_0
) AS e0
INNER JOIN "AspNetUsers" AS a ON e0."StudentId" = a."Id"
INNER JOIN "Courses" AS c ON e0."CourseId" = c."Id"
ORDER BY e0."CompletedAt" DESC
2025-07-30 16:33:27.239 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType9`10[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-30 16:33:27.240 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetCourseCompletions (CeceLearningPortal.Api) in 3.4185ms
2025-07-30 16:33:27.241 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetCourseCompletions (CeceLearningPortal.Api)'
2025-07-30 16:33:27.241 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/course-completions - 200 null application/json; charset=utf-8 9.4297ms
2025-07-30 16:33:43.052 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/platform - null null
2025-07-30 16:33:43.054 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:33:43.054 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/platform - 204 null null 2.2539ms
2025-07-30 16:33:43.056 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/platform - application/json null
2025-07-30 16:33:43.057 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:33:43.059 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 16:33:43.060 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-07-30 16:33:43.061 +08:00 [INF] Route matched with {action = "GetPlatformAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPlatformAnalytics() on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-30 16:33:43.062 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
2025-07-30 16:33:43.063 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
2025-07-30 16:33:43.064 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."Status" = 'Completed'
2025-07-30 16:33:43.066 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
2025-07-30 16:33:43.069 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id" AS "instructorId", a."FullName" AS "instructorName", (
    SELECT count(*)::int
    FROM "Courses" AS c0
    WHERE c0."InstructorId" = a."Id") AS "totalCourses", (
    SELECT count(*)::int
    FROM "Enrollments" AS e
    INNER JOIN "Courses" AS c1 ON e."CourseId" = c1."Id"
    WHERE c1."InstructorId" = a."Id") AS "totalStudents", (
    SELECT COALESCE(sum(p0."Amount"), 0.0)
    FROM "Payments" AS p0
    LEFT JOIN "Courses" AS c2 ON p0."CourseId" = c2."Id"
    WHERE c2."InstructorId" = a."Id" AND p0."Status" = 'Completed') AS "totalRevenue", COALESCE((
    SELECT avg(r."Rating"::double precision)
    FROM "Reviews" AS r
    INNER JOIN "Courses" AS c3 ON r."CourseId" = c3."Id"
    WHERE c3."InstructorId" = a."Id"), 0.0) AS "averageRating"
FROM "AspNetUsers" AS a
WHERE a."Role" = 'Instructor'
ORDER BY (
    SELECT COALESCE(sum(p."Amount"), 0.0)
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
    WHERE c."InstructorId" = a."Id" AND p."Status" = 'Completed') DESC
LIMIT @__p_0
2025-07-30 16:33:43.071 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT c."Category" AS category, count(*)::int AS "courseCount", COALESCE(sum((
    SELECT count(*)::int
    FROM "Enrollments" AS e
    WHERE c."Id" = e."CourseId")), 0)::int AS "enrollmentCount", (
    SELECT COALESCE(sum(p."Amount"), 0.0)
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c0 ON p."CourseId" = c0."Id"
    WHERE c0."Category" = c."Category" AND p."Status" = 'Completed') AS revenue
FROM "Courses" AS c
GROUP BY c."Category"
ORDER BY COALESCE(sum((
    SELECT count(*)::int
    FROM "Enrollments" AS e
    WHERE c."Id" = e."CourseId")), 0)::int DESC
2025-07-30 16:33:43.073 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT p0."Year", p0."Month", COALESCE(sum(p0."Amount"), 0.0) AS "Revenue", count(*)::int AS "TransactionCount"
FROM (
    SELECT p."Amount", date_part('year', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "Payments" AS p
    WHERE p."Status" = 'Completed' AND p."CreatedAt" >= @__sixMonthsAgo_0
) AS p0
GROUP BY p0."Year", p0."Month"
2025-07-30 16:33:43.075 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT a0."Year", a0."Month", count(*)::int AS "NewUsers"
FROM (
    SELECT date_part('year', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "AspNetUsers" AS a
    WHERE a."CreatedAt" >= @__sixMonthsAgo_0
) AS a0
GROUP BY a0."Year", a0."Month"
2025-07-30 16:33:43.076 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Subscriptions" AS s
WHERE s."Status" = 'Active'
2025-07-30 16:33:43.078 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s."PlanName" AS plan, count(*)::int AS count, COALESCE(sum(s."Price"), 0.0) AS "monthlyRevenue"
FROM "Subscriptions" AS s
WHERE s."Status" = 'Active'
GROUP BY s."PlanName"
2025-07-30 16:33:43.079 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType20`6[[<>f__AnonymousType21`5[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 16:33:43.080 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api) in 18.2331ms
2025-07-30 16:33:43.080 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-07-30 16:33:43.080 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/platform - application/json null
2025-07-30 16:33:43.081 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/platform - 200 null application/json; charset=utf-8 24.701ms
2025-07-30 16:33:43.082 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:33:43.083 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/course-completions - null null
2025-07-30 16:33:43.085 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 16:33:43.085 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:33:43.086 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-07-30 16:33:43.086 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/course-completions - 204 null null 2.7172ms
2025-07-30 16:33:43.087 +08:00 [INF] Route matched with {action = "GetPlatformAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPlatformAnalytics() on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-30 16:33:43.088 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/course-completions - application/json null
2025-07-30 16:33:43.089 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
2025-07-30 16:33:43.090 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:33:43.091 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
2025-07-30 16:33:43.091 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 16:33:43.092 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."Status" = 'Completed'
2025-07-30 16:33:43.092 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetCourseCompletions (CeceLearningPortal.Api)'
2025-07-30 16:33:43.093 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
2025-07-30 16:33:43.094 +08:00 [INF] Route matched with {action = "GetCourseCompletions", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourseCompletions(Int32) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 16:33:43.096 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id" AS "instructorId", a."FullName" AS "instructorName", (
    SELECT count(*)::int
    FROM "Courses" AS c0
    WHERE c0."InstructorId" = a."Id") AS "totalCourses", (
    SELECT count(*)::int
    FROM "Enrollments" AS e
    INNER JOIN "Courses" AS c1 ON e."CourseId" = c1."Id"
    WHERE c1."InstructorId" = a."Id") AS "totalStudents", (
    SELECT COALESCE(sum(p0."Amount"), 0.0)
    FROM "Payments" AS p0
    LEFT JOIN "Courses" AS c2 ON p0."CourseId" = c2."Id"
    WHERE c2."InstructorId" = a."Id" AND p0."Status" = 'Completed') AS "totalRevenue", COALESCE((
    SELECT avg(r."Rating"::double precision)
    FROM "Reviews" AS r
    INNER JOIN "Courses" AS c3 ON r."CourseId" = c3."Id"
    WHERE c3."InstructorId" = a."Id"), 0.0) AS "averageRating"
FROM "AspNetUsers" AS a
WHERE a."Role" = 'Instructor'
ORDER BY (
    SELECT COALESCE(sum(p."Amount"), 0.0)
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
    WHERE c."InstructorId" = a."Id" AND p."Status" = 'Completed') DESC
LIMIT @__p_0
2025-07-30 16:33:43.096 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT e0."Id", a."FullName", a."Avatar", a."Email", c."Title", e0."CourseId"::text, e0."CompletedAt", COALESCE(e0."AverageQuizScore", 0.0), e0."CertificateIssued", e0."CertificateUrl"
FROM (
    SELECT e."Id", e."AverageQuizScore", e."CertificateIssued", e."CertificateUrl", e."CompletedAt", e."CourseId", e."StudentId"
    FROM "Enrollments" AS e
    WHERE e."CompletedAt" IS NOT NULL
    ORDER BY e."CompletedAt" DESC
    LIMIT @__p_0
) AS e0
INNER JOIN "AspNetUsers" AS a ON e0."StudentId" = a."Id"
INNER JOIN "Courses" AS c ON e0."CourseId" = c."Id"
ORDER BY e0."CompletedAt" DESC
2025-07-30 16:33:43.098 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT c."Category" AS category, count(*)::int AS "courseCount", COALESCE(sum((
    SELECT count(*)::int
    FROM "Enrollments" AS e
    WHERE c."Id" = e."CourseId")), 0)::int AS "enrollmentCount", (
    SELECT COALESCE(sum(p."Amount"), 0.0)
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c0 ON p."CourseId" = c0."Id"
    WHERE c0."Category" = c."Category" AND p."Status" = 'Completed') AS revenue
FROM "Courses" AS c
GROUP BY c."Category"
ORDER BY COALESCE(sum((
    SELECT count(*)::int
    FROM "Enrollments" AS e
    WHERE c."Id" = e."CourseId")), 0)::int DESC
2025-07-30 16:33:43.098 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType9`10[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-30 16:33:43.100 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT p0."Year", p0."Month", COALESCE(sum(p0."Amount"), 0.0) AS "Revenue", count(*)::int AS "TransactionCount"
FROM (
    SELECT p."Amount", date_part('year', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "Payments" AS p
    WHERE p."Status" = 'Completed' AND p."CreatedAt" >= @__sixMonthsAgo_0
) AS p0
GROUP BY p0."Year", p0."Month"
2025-07-30 16:33:43.100 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetCourseCompletions (CeceLearningPortal.Api) in 4.8474ms
2025-07-30 16:33:43.102 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT a0."Year", a0."Month", count(*)::int AS "NewUsers"
FROM (
    SELECT date_part('year', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "AspNetUsers" AS a
    WHERE a."CreatedAt" >= @__sixMonthsAgo_0
) AS a0
GROUP BY a0."Year", a0."Month"
2025-07-30 16:33:43.102 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetCourseCompletions (CeceLearningPortal.Api)'
2025-07-30 16:33:43.103 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Subscriptions" AS s
WHERE s."Status" = 'Active'
2025-07-30 16:33:43.103 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/course-completions - 200 null application/json; charset=utf-8 15.614ms
2025-07-30 16:33:43.105 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s."PlanName" AS plan, count(*)::int AS count, COALESCE(sum(s."Price"), 0.0) AS "monthlyRevenue"
FROM "Subscriptions" AS s
WHERE s."Status" = 'Active'
GROUP BY s."PlanName"
2025-07-30 16:33:43.107 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType20`6[[<>f__AnonymousType21`5[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 16:33:43.108 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api) in 18.948ms
2025-07-30 16:33:43.108 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-07-30 16:33:43.109 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/platform - 200 null application/json; charset=utf-8 28.4199ms
2025-07-30 16:33:43.110 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/course-completions - application/json null
2025-07-30 16:33:43.111 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:33:43.113 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 16:33:43.114 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetCourseCompletions (CeceLearningPortal.Api)'
2025-07-30 16:33:43.114 +08:00 [INF] Route matched with {action = "GetCourseCompletions", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourseCompletions(Int32) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 16:33:43.116 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT e0."Id", a."FullName", a."Avatar", a."Email", c."Title", e0."CourseId"::text, e0."CompletedAt", COALESCE(e0."AverageQuizScore", 0.0), e0."CertificateIssued", e0."CertificateUrl"
FROM (
    SELECT e."Id", e."AverageQuizScore", e."CertificateIssued", e."CertificateUrl", e."CompletedAt", e."CourseId", e."StudentId"
    FROM "Enrollments" AS e
    WHERE e."CompletedAt" IS NOT NULL
    ORDER BY e."CompletedAt" DESC
    LIMIT @__p_0
) AS e0
INNER JOIN "AspNetUsers" AS a ON e0."StudentId" = a."Id"
INNER JOIN "Courses" AS c ON e0."CourseId" = c."Id"
ORDER BY e0."CompletedAt" DESC
2025-07-30 16:33:43.118 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType9`10[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-30 16:33:43.118 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetCourseCompletions (CeceLearningPortal.Api) in 3.1709ms
2025-07-30 16:33:43.119 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetCourseCompletions (CeceLearningPortal.Api)'
2025-07-30 16:33:43.120 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/course-completions - 200 null application/json; charset=utf-8 9.2318ms
2025-07-30 16:47:19.151 +08:00 [INF] Checking database connection...
2025-07-30 16:47:19.764 +08:00 [INF] Database connection successful.
2025-07-30 16:47:19.765 +08:00 [INF] Attempting to apply migrations...
2025-07-30 16:47:19.853 +08:00 [INF] Executed DbCommand (11ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-07-30 16:47:20.089 +08:00 [WRN] Migration failed. This might be due to pending model changes. Continuing anyway...
System.InvalidOperationException: An error was generated for warning 'Microsoft.EntityFrameworkCore.Migrations.PendingModelChangesWarning': The model for context 'ApplicationDbContext' has pending changes. Add a new migration before updating the database. See https://aka.ms/efcore-docs-pending-changes. This exception can be suppressed or logged by passing event ID 'RelationalEventId.PendingModelChangesWarning' to the 'ConfigureWarnings' method in 'DbContext.OnConfiguring' or 'AddDbContext'.
   at Microsoft.EntityFrameworkCore.Diagnostics.EventDefinition`1.Log[TLoggerCategory](IDiagnosticsLogger`1 logger, TParam arg)
   at Microsoft.EntityFrameworkCore.Diagnostics.RelationalLoggerExtensions.PendingModelChangesWarning(IDiagnosticsLogger`1 diagnostics, Type contextType)
   at Microsoft.EntityFrameworkCore.Migrations.Internal.Migrator.ValidateMigrations(Boolean useTransaction, String targetMigration)
   at Microsoft.EntityFrameworkCore.Migrations.Internal.Migrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Program.cs:line 222
2025-07-30 16:47:20.100 +08:00 [INF] Starting data seeding...
2025-07-30 16:47:20.113 +08:00 [INF] User profile is available. Using 'C:\Users\User\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-07-30 16:47:20.239 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Courses" AS c)
2025-07-30 16:47:20.242 +08:00 [INF] Database already contains data. Skipping seed.
2025-07-30 16:47:20.242 +08:00 [INF] Data seeding completed.
2025-07-30 16:47:20.281 +08:00 [INF] Now listening on: http://localhost:5295
2025-07-30 16:47:20.282 +08:00 [INF] Application started. Press Ctrl+C to shut down.
2025-07-30 16:47:20.282 +08:00 [INF] Hosting environment: Development
2025-07-30 16:47:20.283 +08:00 [INF] Content root path: D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api
2025-07-30 16:47:23.887 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/auth/register - null null
2025-07-30 16:47:23.921 +08:00 [WRN] Failed to determine the https port for redirect.
2025-07-30 16:47:23.923 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:47:23.927 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/auth/register - 204 null null 40.166ms
2025-07-30 16:47:23.932 +08:00 [INF] Request starting HTTP/1.1 POST http://localhost:5295/api/auth/register - application/json 112
2025-07-30 16:47:23.936 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:47:24.036 +08:00 [INF] Executed DbCommand (5ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 16:47:24.039 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AuthController.Register (CeceLearningPortal.Api)'
2025-07-30 16:47:24.047 +08:00 [INF] Route matched with {action = "Register", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Register(CeceLearningPortal.Api.DTOs.RegisterDto) on controller CeceLearningPortal.Api.Controllers.AuthController (CeceLearningPortal.Api).
2025-07-30 16:47:24.131 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__normalizedEmail_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."NormalizedEmail" = @__normalizedEmail_0
LIMIT 2
2025-07-30 16:47:24.188 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__normalizedUserName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."NormalizedUserName" = @__normalizedUserName_0
LIMIT 1
2025-07-30 16:47:24.192 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__normalizedEmail_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."NormalizedEmail" = @__normalizedEmail_0
LIMIT 2
2025-07-30 16:47:24.311 +08:00 [INF] Executed DbCommand (14ms) [Parameters=[@p0='?', @p1='?' (DbType = Int32), @p2='?', @p3='?', @p4='?' (DbType = DateTime), @p5='?', @p6='?' (DbType = Boolean), @p7='?', @p8='?' (DbType = DateTime), @p9='?' (DbType = Boolean), @p10='?' (DbType = DateTime), @p11='?', @p12='?', @p13='?', @p14='?', @p15='?', @p16='?' (DbType = Boolean), @p17='?', @p18='?' (DbType = DateTime), @p19='?', @p20='?', @p21='?', @p22='?' (DbType = Boolean), @p23='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "AspNetUsers" ("Id", "AccessFailedCount", "Avatar", "ConcurrencyStamp", "CreatedAt", "Email", "EmailConfirmed", "FullName", "LastLoginAt", "LockoutEnabled", "LockoutEnd", "NormalizedEmail", "NormalizedUserName", "NotificationPreferences", "PasswordHash", "PhoneNumber", "PhoneNumberConfirmed", "RefreshToken", "RefreshTokenExpiryTime", "Role", "SecurityStamp", "Status", "TwoFactorEnabled", "UserName")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18, @p19, @p20, @p21, @p22, @p23);
2025-07-30 16:47:24.325 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__normalizedRoleName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."ConcurrencyStamp", a."Name", a."NormalizedName"
FROM "AspNetRoles" AS a
WHERE a."NormalizedName" = @__normalizedRoleName_0
LIMIT 2
2025-07-30 16:47:24.347 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_0='?', @__p_1='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."UserId", a."RoleId"
FROM "AspNetUserRoles" AS a
WHERE a."UserId" = @__p_0 AND a."RoleId" = @__p_1
LIMIT 1
2025-07-30 16:47:24.350 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__normalizedRoleName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."ConcurrencyStamp", a."Name", a."NormalizedName"
FROM "AspNetRoles" AS a
WHERE a."NormalizedName" = @__normalizedRoleName_0
LIMIT 2
2025-07-30 16:47:24.357 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__normalizedUserName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."NormalizedUserName" = @__normalizedUserName_0
LIMIT 1
2025-07-30 16:47:24.359 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__normalizedEmail_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."NormalizedEmail" = @__normalizedEmail_0
LIMIT 2
2025-07-30 16:47:24.377 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@p0='?', @p1='?', @p25='?', @p2='?' (DbType = Int32), @p3='?', @p4='?', @p26='?', @p5='?' (DbType = DateTime), @p6='?', @p7='?' (DbType = Boolean), @p8='?', @p9='?' (DbType = DateTime), @p10='?' (DbType = Boolean), @p11='?' (DbType = DateTime), @p12='?', @p13='?', @p14='?', @p15='?', @p16='?', @p17='?' (DbType = Boolean), @p18='?', @p19='?' (DbType = DateTime), @p20='?', @p21='?', @p22='?', @p23='?' (DbType = Boolean), @p24='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "AspNetUserRoles" ("RoleId", "UserId")
VALUES (@p0, @p1);
UPDATE "AspNetUsers" SET "AccessFailedCount" = @p2, "Avatar" = @p3, "ConcurrencyStamp" = @p4, "CreatedAt" = @p5, "Email" = @p6, "EmailConfirmed" = @p7, "FullName" = @p8, "LastLoginAt" = @p9, "LockoutEnabled" = @p10, "LockoutEnd" = @p11, "NormalizedEmail" = @p12, "NormalizedUserName" = @p13, "NotificationPreferences" = @p14, "PasswordHash" = @p15, "PhoneNumber" = @p16, "PhoneNumberConfirmed" = @p17, "RefreshToken" = @p18, "RefreshTokenExpiryTime" = @p19, "Role" = @p20, "SecurityStamp" = @p21, "Status" = @p22, "TwoFactorEnabled" = @p23, "UserName" = @p24
WHERE "Id" = @p25 AND "ConcurrencyStamp" = @p26;
2025-07-30 16:47:24.388 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.AuthResponseDto'.
2025-07-30 16:47:24.397 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AuthController.Register (CeceLearningPortal.Api) in 346.1009ms
2025-07-30 16:47:24.398 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AuthController.Register (CeceLearningPortal.Api)'
2025-07-30 16:47:24.401 +08:00 [INF] Request finished HTTP/1.1 POST http://localhost:5295/api/auth/register - 200 null application/json; charset=utf-8 469.1069ms
2025-07-30 16:47:32.863 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/auth/login - null null
2025-07-30 16:47:32.865 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:47:32.866 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/auth/login - 204 null null 3.163ms
2025-07-30 16:47:32.868 +08:00 [INF] Request starting HTTP/1.1 POST http://localhost:5295/api/auth/login - application/json 51
2025-07-30 16:47:32.869 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:47:32.875 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 16:47:32.876 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AuthController.Login (CeceLearningPortal.Api)'
2025-07-30 16:47:32.879 +08:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(CeceLearningPortal.Api.DTOs.LoginDto) on controller CeceLearningPortal.Api.Controllers.AuthController (CeceLearningPortal.Api).
2025-07-30 16:47:32.887 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__normalizedEmail_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."NormalizedEmail" = @__normalizedEmail_0
LIMIT 2
2025-07-30 16:47:32.982 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@p1='?', @p2='?', @p0='?' (DbType = DateTime), @p3='?' (DbType = DateTime), @p4='?', @p5='?' (DbType = DateTime), @p6='?', @p7='?' (DbType = DateTime), @p8='?', @p9='?', @p10='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE "AspNetUsers" SET "LastLoginAt" = @p0
WHERE "Id" = @p1 AND "ConcurrencyStamp" = @p2;
INSERT INTO "RefreshTokens" ("CreatedAt", "CreatedByIp", "ExpiresAt", "ReplacedByToken", "RevokedAt", "RevokedByIp", "Token", "UserId")
VALUES (@p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10)
RETURNING "Id";
2025-07-30 16:47:32.990 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.AuthResponseDto'.
2025-07-30 16:47:32.991 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AuthController.Login (CeceLearningPortal.Api) in 110.891ms
2025-07-30 16:47:32.992 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AuthController.Login (CeceLearningPortal.Api)'
2025-07-30 16:47:32.993 +08:00 [INF] Request finished HTTP/1.1 POST http://localhost:5295/api/auth/login - 200 null application/json; charset=utf-8 125.1013ms
2025-07-30 16:47:33.010 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/courses - null null
2025-07-30 16:47:33.011 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/platform - null null
2025-07-30 16:47:33.011 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:47:33.013 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:47:33.013 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/courses - 204 null null 3.5145ms
2025-07-30 16:47:33.014 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/platform - 204 null null 3.0056ms
2025-07-30 16:47:33.015 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/platform - application/json null
2025-07-30 16:47:33.017 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses - application/json null
2025-07-30 16:47:33.021 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:47:33.021 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:47:33.045 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 16:47:33.049 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-07-30 16:47:33.052 +08:00 [INF] Route matched with {action = "GetPlatformAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPlatformAnalytics() on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-30 16:47:33.066 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
2025-07-30 16:47:33.071 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
2025-07-30 16:47:33.081 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."Status" = 'Completed'
2025-07-30 16:47:33.088 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
2025-07-30 16:47:33.089 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 16:47:33.090 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-30 16:47:33.096 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-30 16:47:33.137 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id" AS "instructorId", a."FullName" AS "instructorName", (
    SELECT count(*)::int
    FROM "Courses" AS c0
    WHERE c0."InstructorId" = a."Id") AS "totalCourses", (
    SELECT count(*)::int
    FROM "Enrollments" AS e
    INNER JOIN "Courses" AS c1 ON e."CourseId" = c1."Id"
    WHERE c1."InstructorId" = a."Id") AS "totalStudents", (
    SELECT COALESCE(sum(p0."Amount"), 0.0)
    FROM "Payments" AS p0
    LEFT JOIN "Courses" AS c2 ON p0."CourseId" = c2."Id"
    WHERE c2."InstructorId" = a."Id" AND p0."Status" = 'Completed') AS "totalRevenue", COALESCE((
    SELECT avg(r."Rating"::double precision)
    FROM "Reviews" AS r
    INNER JOIN "Courses" AS c3 ON r."CourseId" = c3."Id"
    WHERE c3."InstructorId" = a."Id"), 0.0) AS "averageRating"
FROM "AspNetUsers" AS a
WHERE a."Role" = 'Instructor'
ORDER BY (
    SELECT COALESCE(sum(p."Amount"), 0.0)
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
    WHERE c."InstructorId" = a."Id" AND p."Status" = 'Completed') DESC
LIMIT @__p_0
2025-07-30 16:47:33.144 +08:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2025-07-30 16:47:33.164 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT c."Category" AS category, count(*)::int AS "courseCount", COALESCE(sum((
    SELECT count(*)::int
    FROM "Enrollments" AS e
    WHERE c."Id" = e."CourseId")), 0)::int AS "enrollmentCount", (
    SELECT COALESCE(sum(p."Amount"), 0.0)
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c0 ON p."CourseId" = c0."Id"
    WHERE c0."Category" = c."Category" AND p."Status" = 'Completed') AS revenue
FROM "Courses" AS c
GROUP BY c."Category"
ORDER BY COALESCE(sum((
    SELECT count(*)::int
    FROM "Enrollments" AS e
    WHERE c."Id" = e."CourseId")), 0)::int DESC
2025-07-30 16:47:33.174 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT p0."Year", p0."Month", COALESCE(sum(p0."Amount"), 0.0) AS "Revenue", count(*)::int AS "TransactionCount"
FROM (
    SELECT p."Amount", date_part('year', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "Payments" AS p
    WHERE p."Status" = 'Completed' AND p."CreatedAt" >= @__sixMonthsAgo_0
) AS p0
GROUP BY p0."Year", p0."Month"
2025-07-30 16:47:33.174 +08:00 [ERR] Failed executing DbCommand (3ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."IsPublished", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."PublishedAt", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."IsFlagged", r."Rating", r."Status", r."StudentId", e."Id", e."AverageQuizScore", e."CertificateIssued", e."CertificateUrl", e."CompletedAt", e."CompletedLessons", e."CourseId", e."EnrolledAt", e."LastAccessedDate", e."ProgressPercentage", e."QuizCount", e."StudentId", e."TotalTimeSpent"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."IsPublished", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."PublishedAt", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-30 16:47:33.182 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT a0."Year", a0."Month", count(*)::int AS "NewUsers"
FROM (
    SELECT date_part('year', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "AspNetUsers" AS a
    WHERE a."CreatedAt" >= @__sixMonthsAgo_0
) AS a0
GROUP BY a0."Year", a0."Month"
2025-07-30 16:47:33.182 +08:00 [ERR] An exception occurred while iterating over the results of a query for context type 'CeceLearningPortal.Api.Data.ApplicationDbContext'.
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 1526
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 1526
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 1526
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 1526
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 16:47:33.189 +08:00 [ERR] Error retrieving courses
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 1526
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at CeceLearningPortal.Api.Services.CourseService.GetAllCoursesAsync(CourseFilterDto filter) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Services\CourseService.cs:line 95
   at CeceLearningPortal.Api.Controllers.CoursesController.GetCourses(CourseFilterDto filter) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Controllers\CoursesController.cs:line 26
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 1526
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 16:47:33.190 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Subscriptions" AS s
WHERE s."Status" = 'Active'
2025-07-30 16:47:33.194 +08:00 [INF] Executing ObjectResult, writing value of type '<>f__AnonymousType0`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 16:47:33.198 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 101.0691ms
2025-07-30 16:47:33.198 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-30 16:47:33.199 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses - 500 null application/json; charset=utf-8 182.3424ms
2025-07-30 16:47:33.201 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s."PlanName" AS plan, count(*)::int AS count, COALESCE(sum(s."Price"), 0.0) AS "monthlyRevenue"
FROM "Subscriptions" AS s
WHERE s."Status" = 'Active'
GROUP BY s."PlanName"
2025-07-30 16:47:33.203 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType20`6[[<>f__AnonymousType21`5[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 16:47:33.213 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api) in 160.5148ms
2025-07-30 16:47:33.214 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-07-30 16:47:33.215 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/platform - 200 null application/json; charset=utf-8 199.7019ms
2025-07-30 16:47:34.890 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/platform - application/json null
2025-07-30 16:47:34.892 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:47:34.894 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 16:47:34.896 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-07-30 16:47:34.897 +08:00 [INF] Route matched with {action = "GetPlatformAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPlatformAnalytics() on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-30 16:47:34.899 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
2025-07-30 16:47:34.901 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
2025-07-30 16:47:34.903 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."Status" = 'Completed'
2025-07-30 16:47:34.904 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
2025-07-30 16:47:34.908 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id" AS "instructorId", a."FullName" AS "instructorName", (
    SELECT count(*)::int
    FROM "Courses" AS c0
    WHERE c0."InstructorId" = a."Id") AS "totalCourses", (
    SELECT count(*)::int
    FROM "Enrollments" AS e
    INNER JOIN "Courses" AS c1 ON e."CourseId" = c1."Id"
    WHERE c1."InstructorId" = a."Id") AS "totalStudents", (
    SELECT COALESCE(sum(p0."Amount"), 0.0)
    FROM "Payments" AS p0
    LEFT JOIN "Courses" AS c2 ON p0."CourseId" = c2."Id"
    WHERE c2."InstructorId" = a."Id" AND p0."Status" = 'Completed') AS "totalRevenue", COALESCE((
    SELECT avg(r."Rating"::double precision)
    FROM "Reviews" AS r
    INNER JOIN "Courses" AS c3 ON r."CourseId" = c3."Id"
    WHERE c3."InstructorId" = a."Id"), 0.0) AS "averageRating"
FROM "AspNetUsers" AS a
WHERE a."Role" = 'Instructor'
ORDER BY (
    SELECT COALESCE(sum(p."Amount"), 0.0)
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
    WHERE c."InstructorId" = a."Id" AND p."Status" = 'Completed') DESC
LIMIT @__p_0
2025-07-30 16:47:34.911 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT c."Category" AS category, count(*)::int AS "courseCount", COALESCE(sum((
    SELECT count(*)::int
    FROM "Enrollments" AS e
    WHERE c."Id" = e."CourseId")), 0)::int AS "enrollmentCount", (
    SELECT COALESCE(sum(p."Amount"), 0.0)
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c0 ON p."CourseId" = c0."Id"
    WHERE c0."Category" = c."Category" AND p."Status" = 'Completed') AS revenue
FROM "Courses" AS c
GROUP BY c."Category"
ORDER BY COALESCE(sum((
    SELECT count(*)::int
    FROM "Enrollments" AS e
    WHERE c."Id" = e."CourseId")), 0)::int DESC
2025-07-30 16:47:34.913 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT p0."Year", p0."Month", COALESCE(sum(p0."Amount"), 0.0) AS "Revenue", count(*)::int AS "TransactionCount"
FROM (
    SELECT p."Amount", date_part('year', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "Payments" AS p
    WHERE p."Status" = 'Completed' AND p."CreatedAt" >= @__sixMonthsAgo_0
) AS p0
GROUP BY p0."Year", p0."Month"
2025-07-30 16:47:34.915 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT a0."Year", a0."Month", count(*)::int AS "NewUsers"
FROM (
    SELECT date_part('year', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "AspNetUsers" AS a
    WHERE a."CreatedAt" >= @__sixMonthsAgo_0
) AS a0
GROUP BY a0."Year", a0."Month"
2025-07-30 16:47:34.916 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Subscriptions" AS s
WHERE s."Status" = 'Active'
2025-07-30 16:47:34.918 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s."PlanName" AS plan, count(*)::int AS count, COALESCE(sum(s."Price"), 0.0) AS "monthlyRevenue"
FROM "Subscriptions" AS s
WHERE s."Status" = 'Active'
GROUP BY s."PlanName"
2025-07-30 16:47:34.919 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType20`6[[<>f__AnonymousType21`5[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 16:47:34.920 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api) in 21.6383ms
2025-07-30 16:47:34.920 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-07-30 16:47:34.921 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/platform - 200 null application/json; charset=utf-8 30.4287ms
2025-07-30 16:47:34.922 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/course-completions - null null
2025-07-30 16:47:34.923 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:47:34.924 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/course-completions - 204 null null 1.6201ms
2025-07-30 16:47:34.925 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/course-completions - application/json null
2025-07-30 16:47:34.929 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:47:34.931 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 16:47:34.933 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetCourseCompletions (CeceLearningPortal.Api)'
2025-07-30 16:47:34.935 +08:00 [INF] Route matched with {action = "GetCourseCompletions", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourseCompletions(Int32) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 16:47:34.949 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT e0."Id", a."FullName", a."Avatar", a."Email", c."Title", e0."CourseId"::text, e0."CompletedAt", COALESCE(e0."AverageQuizScore", 0.0), e0."CertificateIssued", e0."CertificateUrl"
FROM (
    SELECT e."Id", e."AverageQuizScore", e."CertificateIssued", e."CertificateUrl", e."CompletedAt", e."CourseId", e."StudentId"
    FROM "Enrollments" AS e
    WHERE e."CompletedAt" IS NOT NULL
    ORDER BY e."CompletedAt" DESC
    LIMIT @__p_0
) AS e0
INNER JOIN "AspNetUsers" AS a ON e0."StudentId" = a."Id"
INNER JOIN "Courses" AS c ON e0."CourseId" = c."Id"
ORDER BY e0."CompletedAt" DESC
2025-07-30 16:47:34.951 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType9`10[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-30 16:47:34.953 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetCourseCompletions (CeceLearningPortal.Api) in 16.8901ms
2025-07-30 16:47:34.954 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetCourseCompletions (CeceLearningPortal.Api)'
2025-07-30 16:47:34.955 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/course-completions - 200 null application/json; charset=utf-8 29.2512ms
2025-07-30 16:47:37.087 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users - null null
2025-07-30 16:47:37.087 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/subscription-plans - null null
2025-07-30 16:47:37.089 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:47:37.090 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:47:37.090 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users - 204 null null 2.9263ms
2025-07-30 16:47:37.090 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/subscription-plans - 204 null null 3ms
2025-07-30 16:47:37.092 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/subscription-plans - application/json null
2025-07-30 16:47:37.093 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users - application/json null
2025-07-30 16:47:37.094 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:47:37.095 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:47:37.097 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 16:47:37.097 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 16:47:37.098 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetSubscriptionPlans (CeceLearningPortal.Api)'
2025-07-30 16:47:37.099 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUsers (CeceLearningPortal.Api)'
2025-07-30 16:47:37.101 +08:00 [INF] Route matched with {action = "GetSubscriptionPlans", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetSubscriptionPlans() on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 16:47:37.104 +08:00 [INF] Route matched with {action = "GetUsers", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUsers(CeceLearningPortal.Api.DTOs.UserManagementFilterDto) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 16:47:37.111 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
2025-07-30 16:47:37.118 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."UserName", a."Email", a."FullName", a."Role", a."Status", a."CreatedAt", a."LastLoginAt", a."EmailConfirmed"
FROM "AspNetUsers" AS a
ORDER BY a."CreatedAt" DESC
LIMIT @__p_1 OFFSET @__p_0
2025-07-30 16:47:37.119 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."CreatedAt", s."Description", s."DisplayOrder", s."Features", s."HasAnalytics", s."HasPrioritySupport", s."HasUnlimitedAccess", s."IsActive", s."IsRecommended", s."MaxCourseAccess", s."MaxCoursesCanCreate", s."MaxStudentsPerCourse", s."MonthlyPrice", s."Name", s."PlanType", s."TransactionFeePercentage", s."UpdatedAt", s."YearlyPrice", s0."Id", s0."BillingCycle", s0."CreatedAt", s0."EndDate", s0."NextBillingDate", s0."PlanName", s0."Price", s0."StartDate", s0."Status", s0."StripeSubscriptionId", s0."SubscriptionPlanId", s0."UpdatedAt", s0."UserId"
FROM "SubscriptionPlans" AS s
LEFT JOIN "Subscriptions" AS s0 ON s."Id" = s0."SubscriptionPlanId"
ORDER BY s."Id"
2025-07-30 16:47:37.120 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[CeceLearningPortal.Api.DTOs.UserManagementDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-30 16:47:37.121 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[CeceLearningPortal.Api.DTOs.SubscriptionPlanDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-30 16:47:37.131 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUsers (CeceLearningPortal.Api) in 26.3596ms
2025-07-30 16:47:37.131 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetSubscriptionPlans (CeceLearningPortal.Api) in 28.8654ms
2025-07-30 16:47:37.132 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUsers (CeceLearningPortal.Api)'
2025-07-30 16:47:37.133 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetSubscriptionPlans (CeceLearningPortal.Api)'
2025-07-30 16:47:37.133 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users - 200 null application/json; charset=utf-8 40.0728ms
2025-07-30 16:47:37.134 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/subscription-plans - 200 null application/json; charset=utf-8 41.7781ms
2025-07-30 16:47:37.135 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/efead752-f0b3-48ab-93b8-7ba31e7574ba/subscription - null null
2025-07-30 16:47:37.136 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/e090c598-224f-4b4c-870a-3c3ef6303e0a/subscription - null null
2025-07-30 16:47:37.136 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/801dc698-62a8-49c3-b578-b7c1b05049a4/subscription - null null
2025-07-30 16:47:37.136 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/28b8e854-738a-4e69-835c-71299a8f9b21/subscription - null null
2025-07-30 16:47:37.137 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/f9f0e64e-3771-4aa9-8470-21e709677e44/subscription - null null
2025-07-30 16:47:37.137 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/b9030b04-2da7-449f-94de-d6d4814a8177/subscription - null null
2025-07-30 16:47:37.138 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:47:37.140 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:47:37.140 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:47:37.141 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:47:37.142 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:47:37.143 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:47:37.143 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/efead752-f0b3-48ab-93b8-7ba31e7574ba/subscription - 204 null null 8.0036ms
2025-07-30 16:47:37.144 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/801dc698-62a8-49c3-b578-b7c1b05049a4/subscription - 204 null null 7.6094ms
2025-07-30 16:47:37.144 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/e090c598-224f-4b4c-870a-3c3ef6303e0a/subscription - 204 null null 8.1764ms
2025-07-30 16:47:37.145 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/28b8e854-738a-4e69-835c-71299a8f9b21/subscription - 204 null null 8.3542ms
2025-07-30 16:47:37.145 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/f9f0e64e-3771-4aa9-8470-21e709677e44/subscription - 204 null null 8.6562ms
2025-07-30 16:47:37.146 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/b9030b04-2da7-449f-94de-d6d4814a8177/subscription - 204 null null 8.8954ms
2025-07-30 16:47:37.147 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/e090c598-224f-4b4c-870a-3c3ef6303e0a/subscription - application/json null
2025-07-30 16:47:37.148 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/efead752-f0b3-48ab-93b8-7ba31e7574ba/subscription - application/json null
2025-07-30 16:47:37.149 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/801dc698-62a8-49c3-b578-b7c1b05049a4/subscription - application/json null
2025-07-30 16:47:37.151 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/28b8e854-738a-4e69-835c-71299a8f9b21/subscription - application/json null
2025-07-30 16:47:37.152 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/f9f0e64e-3771-4aa9-8470-21e709677e44/subscription - application/json null
2025-07-30 16:47:37.153 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/b9030b04-2da7-449f-94de-d6d4814a8177/subscription - application/json null
2025-07-30 16:47:37.154 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:47:37.155 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:47:37.156 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:47:37.157 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:47:37.158 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:47:37.159 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:47:37.161 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 16:47:37.161 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 16:47:37.163 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 16:47:37.164 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 16:47:37.166 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 16:47:37.167 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 16:47:37.179 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 16:47:37.180 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 16:47:37.182 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType83`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 16:47:37.183 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType83`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 16:47:37.185 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 16.3744ms
2025-07-30 16:47:37.185 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 17.3967ms
2025-07-30 16:47:37.186 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 16:47:37.187 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 16:47:37.187 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/e090c598-224f-4b4c-870a-3c3ef6303e0a/subscription - 200 null application/json; charset=utf-8 40.2571ms
2025-07-30 16:47:37.188 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/efead752-f0b3-48ab-93b8-7ba31e7574ba/subscription - 200 null application/json; charset=utf-8 39.7936ms
2025-07-30 16:47:37.215 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 16:47:37.216 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 16:47:37.217 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 16:47:37.217 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 16:47:37.219 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 16:47:37.219 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 16:47:37.219 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 16:47:37.220 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType83`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 16:47:37.221 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 16:47:37.222 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 4.1704ms
2025-07-30 16:47:37.222 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 16:47:37.223 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 16:47:37.223 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 16:47:37.224 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType83`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 16:47:37.225 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 16:47:37.225 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/801dc698-62a8-49c3-b578-b7c1b05049a4/subscription - 200 null application/json; charset=utf-8 75.6728ms
2025-07-30 16:47:37.226 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 4.6803ms
2025-07-30 16:47:37.229 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 16:47:37.229 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/28b8e854-738a-4e69-835c-71299a8f9b21/subscription - 200 null application/json; charset=utf-8 78.6981ms
2025-07-30 16:47:37.230 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 16:47:37.232 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType83`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 16:47:37.233 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 6.4192ms
2025-07-30 16:47:37.234 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 16:47:37.234 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/b9030b04-2da7-449f-94de-d6d4814a8177/subscription - 200 null application/json; charset=utf-8 81.3386ms
2025-07-30 16:47:37.322 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 16:47:37.323 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 16:47:37.324 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 16:47:37.328 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 16:47:37.329 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType83`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 16:47:37.330 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 5.1028ms
2025-07-30 16:47:37.330 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 16:47:37.331 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/f9f0e64e-3771-4aa9-8470-21e709677e44/subscription - 200 null application/json; charset=utf-8 179.2853ms
2025-07-30 16:47:50.152 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/courses - null null
2025-07-30 16:47:50.152 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/platform - null null
2025-07-30 16:47:50.153 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:47:50.154 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:47:50.155 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/courses - 204 null null 3.7359ms
2025-07-30 16:47:50.156 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/platform - 204 null null 4.0365ms
2025-07-30 16:47:50.158 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses - application/json null
2025-07-30 16:47:50.161 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/platform - application/json null
2025-07-30 16:47:50.163 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:47:50.164 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:47:50.165 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-30 16:47:50.166 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-30 16:47:50.166 +08:00 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-07-30 16:47:50.170 +08:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-07-30 16:47:50.171 +08:00 [ERR] Failed executing DbCommand (1ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."IsPublished", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."PublishedAt", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."IsFlagged", r."Rating", r."Status", r."StudentId", e."Id", e."AverageQuizScore", e."CertificateIssued", e."CertificateUrl", e."CompletedAt", e."CompletedLessons", e."CourseId", e."EnrolledAt", e."LastAccessedDate", e."ProgressPercentage", e."QuizCount", e."StudentId", e."TotalTimeSpent"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."IsPublished", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."PublishedAt", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-30 16:47:50.171 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/platform - 401 0 null 10.5687ms
2025-07-30 16:47:50.175 +08:00 [ERR] An exception occurred while iterating over the results of a query for context type 'CeceLearningPortal.Api.Data.ApplicationDbContext'.
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 1526
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 1526
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 1526
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 1526
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 16:47:50.181 +08:00 [ERR] Error retrieving courses
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 1526
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at CeceLearningPortal.Api.Services.CourseService.GetAllCoursesAsync(CourseFilterDto filter) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Services\CourseService.cs:line 95
   at CeceLearningPortal.Api.Controllers.CoursesController.GetCourses(CourseFilterDto filter) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Controllers\CoursesController.cs:line 26
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 1526
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 16:47:50.186 +08:00 [INF] Executing ObjectResult, writing value of type '<>f__AnonymousType0`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 16:47:50.186 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 18.6063ms
2025-07-30 16:47:50.187 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-30 16:47:50.188 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses - 500 null application/json; charset=utf-8 29.6853ms
2025-07-30 16:47:50.190 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/courses - null null
2025-07-30 16:47:50.190 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/platform - null null
2025-07-30 16:47:50.191 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:47:50.192 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:47:50.192 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/courses - 204 null null 2.3209ms
2025-07-30 16:47:50.193 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/platform - 204 null null 2.5307ms
2025-07-30 16:47:50.194 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses - application/json null
2025-07-30 16:47:50.195 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/platform - application/json null
2025-07-30 16:47:50.196 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:47:50.197 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:47:50.199 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 16:47:50.199 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 16:47:50.200 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-30 16:47:50.201 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-07-30 16:47:50.201 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-30 16:47:50.202 +08:00 [INF] Route matched with {action = "GetPlatformAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPlatformAnalytics() on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-30 16:47:50.205 +08:00 [ERR] Failed executing DbCommand (1ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."IsPublished", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."PublishedAt", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."IsFlagged", r."Rating", r."Status", r."StudentId", e."Id", e."AverageQuizScore", e."CertificateIssued", e."CertificateUrl", e."CompletedAt", e."CompletedLessons", e."CourseId", e."EnrolledAt", e."LastAccessedDate", e."ProgressPercentage", e."QuizCount", e."StudentId", e."TotalTimeSpent"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."IsPublished", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."PublishedAt", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-30 16:47:50.205 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
2025-07-30 16:47:50.207 +08:00 [ERR] An exception occurred while iterating over the results of a query for context type 'CeceLearningPortal.Api.Data.ApplicationDbContext'.
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 1526
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 1526
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 1526
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 1526
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 16:47:50.208 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
2025-07-30 16:47:50.212 +08:00 [ERR] Error retrieving courses
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 1526
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at CeceLearningPortal.Api.Services.CourseService.GetAllCoursesAsync(CourseFilterDto filter) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Services\CourseService.cs:line 95
   at CeceLearningPortal.Api.Controllers.CoursesController.GetCourses(CourseFilterDto filter) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Controllers\CoursesController.cs:line 26
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 1526
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 16:47:50.212 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."Status" = 'Completed'
2025-07-30 16:47:50.216 +08:00 [INF] Executing ObjectResult, writing value of type '<>f__AnonymousType0`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 16:47:50.217 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 14.2372ms
2025-07-30 16:47:50.217 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
2025-07-30 16:47:50.218 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-30 16:47:50.219 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses - 500 null application/json; charset=utf-8 25.0697ms
2025-07-30 16:47:50.220 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id" AS "instructorId", a."FullName" AS "instructorName", (
    SELECT count(*)::int
    FROM "Courses" AS c0
    WHERE c0."InstructorId" = a."Id") AS "totalCourses", (
    SELECT count(*)::int
    FROM "Enrollments" AS e
    INNER JOIN "Courses" AS c1 ON e."CourseId" = c1."Id"
    WHERE c1."InstructorId" = a."Id") AS "totalStudents", (
    SELECT COALESCE(sum(p0."Amount"), 0.0)
    FROM "Payments" AS p0
    LEFT JOIN "Courses" AS c2 ON p0."CourseId" = c2."Id"
    WHERE c2."InstructorId" = a."Id" AND p0."Status" = 'Completed') AS "totalRevenue", COALESCE((
    SELECT avg(r."Rating"::double precision)
    FROM "Reviews" AS r
    INNER JOIN "Courses" AS c3 ON r."CourseId" = c3."Id"
    WHERE c3."InstructorId" = a."Id"), 0.0) AS "averageRating"
FROM "AspNetUsers" AS a
WHERE a."Role" = 'Instructor'
ORDER BY (
    SELECT COALESCE(sum(p."Amount"), 0.0)
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
    WHERE c."InstructorId" = a."Id" AND p."Status" = 'Completed') DESC
LIMIT @__p_0
2025-07-30 16:47:50.224 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT c."Category" AS category, count(*)::int AS "courseCount", COALESCE(sum((
    SELECT count(*)::int
    FROM "Enrollments" AS e
    WHERE c."Id" = e."CourseId")), 0)::int AS "enrollmentCount", (
    SELECT COALESCE(sum(p."Amount"), 0.0)
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c0 ON p."CourseId" = c0."Id"
    WHERE c0."Category" = c."Category" AND p."Status" = 'Completed') AS revenue
FROM "Courses" AS c
GROUP BY c."Category"
ORDER BY COALESCE(sum((
    SELECT count(*)::int
    FROM "Enrollments" AS e
    WHERE c."Id" = e."CourseId")), 0)::int DESC
2025-07-30 16:47:50.227 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT p0."Year", p0."Month", COALESCE(sum(p0."Amount"), 0.0) AS "Revenue", count(*)::int AS "TransactionCount"
FROM (
    SELECT p."Amount", date_part('year', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "Payments" AS p
    WHERE p."Status" = 'Completed' AND p."CreatedAt" >= @__sixMonthsAgo_0
) AS p0
GROUP BY p0."Year", p0."Month"
2025-07-30 16:47:50.229 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT a0."Year", a0."Month", count(*)::int AS "NewUsers"
FROM (
    SELECT date_part('year', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "AspNetUsers" AS a
    WHERE a."CreatedAt" >= @__sixMonthsAgo_0
) AS a0
GROUP BY a0."Year", a0."Month"
2025-07-30 16:47:50.231 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Subscriptions" AS s
WHERE s."Status" = 'Active'
2025-07-30 16:47:50.233 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s."PlanName" AS plan, count(*)::int AS count, COALESCE(sum(s."Price"), 0.0) AS "monthlyRevenue"
FROM "Subscriptions" AS s
WHERE s."Status" = 'Active'
GROUP BY s."PlanName"
2025-07-30 16:47:50.234 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType20`6[[<>f__AnonymousType21`5[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 16:47:50.235 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api) in 30.8298ms
2025-07-30 16:47:50.235 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-07-30 16:47:50.236 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/platform - 200 null application/json; charset=utf-8 40.4171ms
2025-07-30 16:47:54.492 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/platform - application/json null
2025-07-30 16:47:54.494 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:47:54.496 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 16:47:54.497 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-07-30 16:47:54.498 +08:00 [INF] Route matched with {action = "GetPlatformAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPlatformAnalytics() on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-30 16:47:54.500 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
2025-07-30 16:47:54.502 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
2025-07-30 16:47:54.504 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."Status" = 'Completed'
2025-07-30 16:47:54.506 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
2025-07-30 16:47:54.512 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id" AS "instructorId", a."FullName" AS "instructorName", (
    SELECT count(*)::int
    FROM "Courses" AS c0
    WHERE c0."InstructorId" = a."Id") AS "totalCourses", (
    SELECT count(*)::int
    FROM "Enrollments" AS e
    INNER JOIN "Courses" AS c1 ON e."CourseId" = c1."Id"
    WHERE c1."InstructorId" = a."Id") AS "totalStudents", (
    SELECT COALESCE(sum(p0."Amount"), 0.0)
    FROM "Payments" AS p0
    LEFT JOIN "Courses" AS c2 ON p0."CourseId" = c2."Id"
    WHERE c2."InstructorId" = a."Id" AND p0."Status" = 'Completed') AS "totalRevenue", COALESCE((
    SELECT avg(r."Rating"::double precision)
    FROM "Reviews" AS r
    INNER JOIN "Courses" AS c3 ON r."CourseId" = c3."Id"
    WHERE c3."InstructorId" = a."Id"), 0.0) AS "averageRating"
FROM "AspNetUsers" AS a
WHERE a."Role" = 'Instructor'
ORDER BY (
    SELECT COALESCE(sum(p."Amount"), 0.0)
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
    WHERE c."InstructorId" = a."Id" AND p."Status" = 'Completed') DESC
LIMIT @__p_0
2025-07-30 16:47:54.515 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT c."Category" AS category, count(*)::int AS "courseCount", COALESCE(sum((
    SELECT count(*)::int
    FROM "Enrollments" AS e
    WHERE c."Id" = e."CourseId")), 0)::int AS "enrollmentCount", (
    SELECT COALESCE(sum(p."Amount"), 0.0)
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c0 ON p."CourseId" = c0."Id"
    WHERE c0."Category" = c."Category" AND p."Status" = 'Completed') AS revenue
FROM "Courses" AS c
GROUP BY c."Category"
ORDER BY COALESCE(sum((
    SELECT count(*)::int
    FROM "Enrollments" AS e
    WHERE c."Id" = e."CourseId")), 0)::int DESC
2025-07-30 16:47:54.517 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT p0."Year", p0."Month", COALESCE(sum(p0."Amount"), 0.0) AS "Revenue", count(*)::int AS "TransactionCount"
FROM (
    SELECT p."Amount", date_part('year', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "Payments" AS p
    WHERE p."Status" = 'Completed' AND p."CreatedAt" >= @__sixMonthsAgo_0
) AS p0
GROUP BY p0."Year", p0."Month"
2025-07-30 16:47:54.519 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT a0."Year", a0."Month", count(*)::int AS "NewUsers"
FROM (
    SELECT date_part('year', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "AspNetUsers" AS a
    WHERE a."CreatedAt" >= @__sixMonthsAgo_0
) AS a0
GROUP BY a0."Year", a0."Month"
2025-07-30 16:47:54.520 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Subscriptions" AS s
WHERE s."Status" = 'Active'
2025-07-30 16:47:54.522 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s."PlanName" AS plan, count(*)::int AS count, COALESCE(sum(s."Price"), 0.0) AS "monthlyRevenue"
FROM "Subscriptions" AS s
WHERE s."Status" = 'Active'
GROUP BY s."PlanName"
2025-07-30 16:47:54.523 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType20`6[[<>f__AnonymousType21`5[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 16:47:54.524 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api) in 24.8679ms
2025-07-30 16:47:54.525 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-07-30 16:47:54.525 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/platform - 200 null application/json; charset=utf-8 33.6125ms
2025-07-30 16:47:54.527 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/course-completions - null null
2025-07-30 16:47:54.528 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:47:54.529 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/course-completions - 204 null null 1.832ms
2025-07-30 16:47:54.530 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/course-completions - application/json null
2025-07-30 16:47:54.532 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:47:54.533 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 16:47:54.534 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetCourseCompletions (CeceLearningPortal.Api)'
2025-07-30 16:47:54.535 +08:00 [INF] Route matched with {action = "GetCourseCompletions", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourseCompletions(Int32) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 16:47:54.538 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT e0."Id", a."FullName", a."Avatar", a."Email", c."Title", e0."CourseId"::text, e0."CompletedAt", COALESCE(e0."AverageQuizScore", 0.0), e0."CertificateIssued", e0."CertificateUrl"
FROM (
    SELECT e."Id", e."AverageQuizScore", e."CertificateIssued", e."CertificateUrl", e."CompletedAt", e."CourseId", e."StudentId"
    FROM "Enrollments" AS e
    WHERE e."CompletedAt" IS NOT NULL
    ORDER BY e."CompletedAt" DESC
    LIMIT @__p_0
) AS e0
INNER JOIN "AspNetUsers" AS a ON e0."StudentId" = a."Id"
INNER JOIN "Courses" AS c ON e0."CourseId" = c."Id"
ORDER BY e0."CompletedAt" DESC
2025-07-30 16:47:54.539 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType9`10[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-30 16:47:54.540 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetCourseCompletions (CeceLearningPortal.Api) in 4.0493ms
2025-07-30 16:47:54.541 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetCourseCompletions (CeceLearningPortal.Api)'
2025-07-30 16:47:54.541 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/course-completions - 200 null application/json; charset=utf-8 10.8789ms
2025-07-30 16:47:56.608 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users - null null
2025-07-30 16:47:56.608 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/subscription-plans - null null
2025-07-30 16:47:56.609 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:47:56.610 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:47:56.611 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users - 204 null null 2.7403ms
2025-07-30 16:47:56.611 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/subscription-plans - 204 null null 3.0848ms
2025-07-30 16:47:56.613 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/subscription-plans - application/json null
2025-07-30 16:47:56.614 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users - application/json null
2025-07-30 16:47:56.615 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:47:56.616 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:47:56.618 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 16:47:56.618 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 16:47:56.619 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUsers (CeceLearningPortal.Api)'
2025-07-30 16:47:56.620 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetSubscriptionPlans (CeceLearningPortal.Api)'
2025-07-30 16:47:56.620 +08:00 [INF] Route matched with {action = "GetUsers", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUsers(CeceLearningPortal.Api.DTOs.UserManagementFilterDto) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 16:47:56.621 +08:00 [INF] Route matched with {action = "GetSubscriptionPlans", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetSubscriptionPlans() on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 16:47:56.622 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
2025-07-30 16:47:56.623 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."CreatedAt", s."Description", s."DisplayOrder", s."Features", s."HasAnalytics", s."HasPrioritySupport", s."HasUnlimitedAccess", s."IsActive", s."IsRecommended", s."MaxCourseAccess", s."MaxCoursesCanCreate", s."MaxStudentsPerCourse", s."MonthlyPrice", s."Name", s."PlanType", s."TransactionFeePercentage", s."UpdatedAt", s."YearlyPrice", s0."Id", s0."BillingCycle", s0."CreatedAt", s0."EndDate", s0."NextBillingDate", s0."PlanName", s0."Price", s0."StartDate", s0."Status", s0."StripeSubscriptionId", s0."SubscriptionPlanId", s0."UpdatedAt", s0."UserId"
FROM "SubscriptionPlans" AS s
LEFT JOIN "Subscriptions" AS s0 ON s."Id" = s0."SubscriptionPlanId"
ORDER BY s."Id"
2025-07-30 16:47:56.624 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."UserName", a."Email", a."FullName", a."Role", a."Status", a."CreatedAt", a."LastLoginAt", a."EmailConfirmed"
FROM "AspNetUsers" AS a
ORDER BY a."CreatedAt" DESC
LIMIT @__p_1 OFFSET @__p_0
2025-07-30 16:47:56.624 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[CeceLearningPortal.Api.DTOs.SubscriptionPlanDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-30 16:47:56.625 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[CeceLearningPortal.Api.DTOs.UserManagementDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-30 16:47:56.626 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetSubscriptionPlans (CeceLearningPortal.Api) in 3.5999ms
2025-07-30 16:47:56.626 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUsers (CeceLearningPortal.Api) in 4.993ms
2025-07-30 16:47:56.627 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetSubscriptionPlans (CeceLearningPortal.Api)'
2025-07-30 16:47:56.628 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUsers (CeceLearningPortal.Api)'
2025-07-30 16:47:56.629 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/subscription-plans - 200 null application/json; charset=utf-8 15.7835ms
2025-07-30 16:47:56.629 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users - 200 null application/json; charset=utf-8 15.2777ms
2025-07-30 16:47:56.631 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/efead752-f0b3-48ab-93b8-7ba31e7574ba/subscription - null null
2025-07-30 16:47:56.631 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/e090c598-224f-4b4c-870a-3c3ef6303e0a/subscription - null null
2025-07-30 16:47:56.631 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/801dc698-62a8-49c3-b578-b7c1b05049a4/subscription - null null
2025-07-30 16:47:56.631 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/28b8e854-738a-4e69-835c-71299a8f9b21/subscription - null null
2025-07-30 16:47:56.632 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/f9f0e64e-3771-4aa9-8470-21e709677e44/subscription - null null
2025-07-30 16:47:56.632 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/b9030b04-2da7-449f-94de-d6d4814a8177/subscription - null null
2025-07-30 16:47:56.633 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:47:56.634 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:47:56.635 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:47:56.636 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:47:56.637 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:47:56.638 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:47:56.638 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/efead752-f0b3-48ab-93b8-7ba31e7574ba/subscription - 204 null null 7.1384ms
2025-07-30 16:47:56.639 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/e090c598-224f-4b4c-870a-3c3ef6303e0a/subscription - 204 null null 7.4404ms
2025-07-30 16:47:56.639 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/801dc698-62a8-49c3-b578-b7c1b05049a4/subscription - 204 null null 7.602ms
2025-07-30 16:47:56.639 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/28b8e854-738a-4e69-835c-71299a8f9b21/subscription - 204 null null 7.9688ms
2025-07-30 16:47:56.640 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/f9f0e64e-3771-4aa9-8470-21e709677e44/subscription - 204 null null 8.2126ms
2025-07-30 16:47:56.640 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/b9030b04-2da7-449f-94de-d6d4814a8177/subscription - 204 null null 8.0981ms
2025-07-30 16:47:56.642 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/28b8e854-738a-4e69-835c-71299a8f9b21/subscription - application/json null
2025-07-30 16:47:56.643 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/efead752-f0b3-48ab-93b8-7ba31e7574ba/subscription - application/json null
2025-07-30 16:47:56.645 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/e090c598-224f-4b4c-870a-3c3ef6303e0a/subscription - application/json null
2025-07-30 16:47:56.646 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/801dc698-62a8-49c3-b578-b7c1b05049a4/subscription - application/json null
2025-07-30 16:47:56.647 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/f9f0e64e-3771-4aa9-8470-21e709677e44/subscription - application/json null
2025-07-30 16:47:56.649 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/b9030b04-2da7-449f-94de-d6d4814a8177/subscription - application/json null
2025-07-30 16:47:56.650 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:47:56.651 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:47:56.652 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:47:56.653 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:47:56.654 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:47:56.655 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:47:56.656 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 16:47:56.656 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 16:47:56.656 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 16:47:56.657 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 16:47:56.657 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 16:47:56.657 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 16:47:56.658 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 16:47:56.659 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 16:47:56.660 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 16:47:56.661 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 16:47:56.662 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 16:47:56.663 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 16:47:56.663 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 16:47:56.664 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 16:47:56.664 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 16:47:56.665 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 16:47:56.665 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 16:47:56.666 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 16:47:56.668 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 16:47:56.668 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 16:47:56.669 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 16:47:56.670 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 16:47:56.670 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 16:47:56.671 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 16:47:56.672 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType83`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 16:47:56.673 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType83`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 16:47:56.674 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType83`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 16:47:56.675 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType83`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 16:47:56.676 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType83`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 16:47:56.677 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType83`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 16:47:56.678 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 10.2001ms
2025-07-30 16:47:56.678 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 11.8252ms
2025-07-30 16:47:56.679 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 10.8177ms
2025-07-30 16:47:56.683 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 16:47:56.680 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 10.6273ms
2025-07-30 16:47:56.681 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 10.5198ms
2025-07-30 16:47:56.682 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 16:47:56.682 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 16:47:56.680 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 10.7496ms
2025-07-30 16:47:56.683 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/e090c598-224f-4b4c-870a-3c3ef6303e0a/subscription - 200 null application/json; charset=utf-8 38.707ms
2025-07-30 16:47:56.684 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 16:47:56.684 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 16:47:56.685 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/28b8e854-738a-4e69-835c-71299a8f9b21/subscription - 200 null application/json; charset=utf-8 43.3497ms
2025-07-30 16:47:56.685 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/efead752-f0b3-48ab-93b8-7ba31e7574ba/subscription - 200 null application/json; charset=utf-8 42.5756ms
2025-07-30 16:47:56.686 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 16:47:56.688 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/f9f0e64e-3771-4aa9-8470-21e709677e44/subscription - 200 null application/json; charset=utf-8 40.9389ms
2025-07-30 16:47:56.689 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/b9030b04-2da7-449f-94de-d6d4814a8177/subscription - 200 null application/json; charset=utf-8 40.3043ms
2025-07-30 16:47:56.692 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/801dc698-62a8-49c3-b578-b7c1b05049a4/subscription - 200 null application/json; charset=utf-8 46.4059ms
2025-07-30 16:48:07.316 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/courses - null null
2025-07-30 16:48:07.316 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/platform - null null
2025-07-30 16:48:07.317 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:48:07.318 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:48:07.319 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/courses - 204 null null 3.4575ms
2025-07-30 16:48:07.320 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/platform - 204 null null 4.0267ms
2025-07-30 16:48:07.322 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/platform - application/json null
2025-07-30 16:48:07.325 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses - application/json null
2025-07-30 16:48:07.326 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:48:07.328 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:48:07.329 +08:00 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-07-30 16:48:07.329 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-30 16:48:07.330 +08:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-07-30 16:48:07.331 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-30 16:48:07.332 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/platform - 401 0 null 9.4119ms
2025-07-30 16:48:07.335 +08:00 [ERR] Failed executing DbCommand (1ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."IsPublished", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."PublishedAt", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."IsFlagged", r."Rating", r."Status", r."StudentId", e."Id", e."AverageQuizScore", e."CertificateIssued", e."CertificateUrl", e."CompletedAt", e."CompletedLessons", e."CourseId", e."EnrolledAt", e."LastAccessedDate", e."ProgressPercentage", e."QuizCount", e."StudentId", e."TotalTimeSpent"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."IsPublished", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."PublishedAt", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-30 16:48:07.337 +08:00 [ERR] An exception occurred while iterating over the results of a query for context type 'CeceLearningPortal.Api.Data.ApplicationDbContext'.
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 1526
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 1526
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 1526
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 1526
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 16:48:07.342 +08:00 [ERR] Error retrieving courses
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 1526
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at CeceLearningPortal.Api.Services.CourseService.GetAllCoursesAsync(CourseFilterDto filter) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Services\CourseService.cs:line 95
   at CeceLearningPortal.Api.Controllers.CoursesController.GetCourses(CourseFilterDto filter) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Controllers\CoursesController.cs:line 26
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 1526
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 16:48:07.348 +08:00 [INF] Executing ObjectResult, writing value of type '<>f__AnonymousType0`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 16:48:07.348 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 15.4543ms
2025-07-30 16:48:07.349 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-30 16:48:07.350 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses - 500 null application/json; charset=utf-8 25.3653ms
2025-07-30 16:48:07.357 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/courses - null null
2025-07-30 16:48:07.357 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/platform - null null
2025-07-30 16:48:07.358 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:48:07.359 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:48:07.359 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/courses - 204 null null 2.9337ms
2025-07-30 16:48:07.360 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/platform - 204 null null 3.1709ms
2025-07-30 16:48:07.362 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses - application/json null
2025-07-30 16:48:07.364 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/platform - application/json null
2025-07-30 16:48:07.365 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:48:07.366 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:48:07.368 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 16:48:07.368 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 16:48:07.369 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-30 16:48:07.370 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-07-30 16:48:07.371 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-30 16:48:07.371 +08:00 [INF] Route matched with {action = "GetPlatformAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPlatformAnalytics() on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-30 16:48:07.374 +08:00 [ERR] Failed executing DbCommand (1ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."IsPublished", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."PublishedAt", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."IsFlagged", r."Rating", r."Status", r."StudentId", e."Id", e."AverageQuizScore", e."CertificateIssued", e."CertificateUrl", e."CompletedAt", e."CompletedLessons", e."CourseId", e."EnrolledAt", e."LastAccessedDate", e."ProgressPercentage", e."QuizCount", e."StudentId", e."TotalTimeSpent"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."IsPublished", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."PublishedAt", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-30 16:48:07.374 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
2025-07-30 16:48:07.376 +08:00 [ERR] An exception occurred while iterating over the results of a query for context type 'CeceLearningPortal.Api.Data.ApplicationDbContext'.
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 1526
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 1526
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 1526
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 1526
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 16:48:07.377 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
2025-07-30 16:48:07.382 +08:00 [ERR] Error retrieving courses
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 1526
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at CeceLearningPortal.Api.Services.CourseService.GetAllCoursesAsync(CourseFilterDto filter) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Services\CourseService.cs:line 95
   at CeceLearningPortal.Api.Controllers.CoursesController.GetCourses(CourseFilterDto filter) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Controllers\CoursesController.cs:line 26
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 1526
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 16:48:07.384 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."Status" = 'Completed'
2025-07-30 16:48:07.389 +08:00 [INF] Executing ObjectResult, writing value of type '<>f__AnonymousType0`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 16:48:07.390 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 17.7411ms
2025-07-30 16:48:07.390 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
2025-07-30 16:48:07.391 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-30 16:48:07.392 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses - 500 null application/json; charset=utf-8 30.6259ms
2025-07-30 16:48:07.395 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id" AS "instructorId", a."FullName" AS "instructorName", (
    SELECT count(*)::int
    FROM "Courses" AS c0
    WHERE c0."InstructorId" = a."Id") AS "totalCourses", (
    SELECT count(*)::int
    FROM "Enrollments" AS e
    INNER JOIN "Courses" AS c1 ON e."CourseId" = c1."Id"
    WHERE c1."InstructorId" = a."Id") AS "totalStudents", (
    SELECT COALESCE(sum(p0."Amount"), 0.0)
    FROM "Payments" AS p0
    LEFT JOIN "Courses" AS c2 ON p0."CourseId" = c2."Id"
    WHERE c2."InstructorId" = a."Id" AND p0."Status" = 'Completed') AS "totalRevenue", COALESCE((
    SELECT avg(r."Rating"::double precision)
    FROM "Reviews" AS r
    INNER JOIN "Courses" AS c3 ON r."CourseId" = c3."Id"
    WHERE c3."InstructorId" = a."Id"), 0.0) AS "averageRating"
FROM "AspNetUsers" AS a
WHERE a."Role" = 'Instructor'
ORDER BY (
    SELECT COALESCE(sum(p."Amount"), 0.0)
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
    WHERE c."InstructorId" = a."Id" AND p."Status" = 'Completed') DESC
LIMIT @__p_0
2025-07-30 16:48:07.398 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT c."Category" AS category, count(*)::int AS "courseCount", COALESCE(sum((
    SELECT count(*)::int
    FROM "Enrollments" AS e
    WHERE c."Id" = e."CourseId")), 0)::int AS "enrollmentCount", (
    SELECT COALESCE(sum(p."Amount"), 0.0)
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c0 ON p."CourseId" = c0."Id"
    WHERE c0."Category" = c."Category" AND p."Status" = 'Completed') AS revenue
FROM "Courses" AS c
GROUP BY c."Category"
ORDER BY COALESCE(sum((
    SELECT count(*)::int
    FROM "Enrollments" AS e
    WHERE c."Id" = e."CourseId")), 0)::int DESC
2025-07-30 16:48:07.400 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT p0."Year", p0."Month", COALESCE(sum(p0."Amount"), 0.0) AS "Revenue", count(*)::int AS "TransactionCount"
FROM (
    SELECT p."Amount", date_part('year', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "Payments" AS p
    WHERE p."Status" = 'Completed' AND p."CreatedAt" >= @__sixMonthsAgo_0
) AS p0
GROUP BY p0."Year", p0."Month"
2025-07-30 16:48:07.402 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT a0."Year", a0."Month", count(*)::int AS "NewUsers"
FROM (
    SELECT date_part('year', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "AspNetUsers" AS a
    WHERE a."CreatedAt" >= @__sixMonthsAgo_0
) AS a0
GROUP BY a0."Year", a0."Month"
2025-07-30 16:48:07.403 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Subscriptions" AS s
WHERE s."Status" = 'Active'
2025-07-30 16:48:07.405 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s."PlanName" AS plan, count(*)::int AS count, COALESCE(sum(s."Price"), 0.0) AS "monthlyRevenue"
FROM "Subscriptions" AS s
WHERE s."Status" = 'Active'
GROUP BY s."PlanName"
2025-07-30 16:48:07.406 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType20`6[[<>f__AnonymousType21`5[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 16:48:07.407 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api) in 33.9421ms
2025-07-30 16:48:07.408 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-07-30 16:48:07.408 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/platform - 200 null application/json; charset=utf-8 44.7624ms
2025-07-30 16:48:11.374 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/platform - application/json null
2025-07-30 16:48:11.376 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:48:11.377 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 16:48:11.379 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-07-30 16:48:11.380 +08:00 [INF] Route matched with {action = "GetPlatformAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPlatformAnalytics() on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-30 16:48:11.381 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
2025-07-30 16:48:11.383 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
2025-07-30 16:48:11.384 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."Status" = 'Completed'
2025-07-30 16:48:11.386 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
2025-07-30 16:48:11.389 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id" AS "instructorId", a."FullName" AS "instructorName", (
    SELECT count(*)::int
    FROM "Courses" AS c0
    WHERE c0."InstructorId" = a."Id") AS "totalCourses", (
    SELECT count(*)::int
    FROM "Enrollments" AS e
    INNER JOIN "Courses" AS c1 ON e."CourseId" = c1."Id"
    WHERE c1."InstructorId" = a."Id") AS "totalStudents", (
    SELECT COALESCE(sum(p0."Amount"), 0.0)
    FROM "Payments" AS p0
    LEFT JOIN "Courses" AS c2 ON p0."CourseId" = c2."Id"
    WHERE c2."InstructorId" = a."Id" AND p0."Status" = 'Completed') AS "totalRevenue", COALESCE((
    SELECT avg(r."Rating"::double precision)
    FROM "Reviews" AS r
    INNER JOIN "Courses" AS c3 ON r."CourseId" = c3."Id"
    WHERE c3."InstructorId" = a."Id"), 0.0) AS "averageRating"
FROM "AspNetUsers" AS a
WHERE a."Role" = 'Instructor'
ORDER BY (
    SELECT COALESCE(sum(p."Amount"), 0.0)
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
    WHERE c."InstructorId" = a."Id" AND p."Status" = 'Completed') DESC
LIMIT @__p_0
2025-07-30 16:48:11.392 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT c."Category" AS category, count(*)::int AS "courseCount", COALESCE(sum((
    SELECT count(*)::int
    FROM "Enrollments" AS e
    WHERE c."Id" = e."CourseId")), 0)::int AS "enrollmentCount", (
    SELECT COALESCE(sum(p."Amount"), 0.0)
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c0 ON p."CourseId" = c0."Id"
    WHERE c0."Category" = c."Category" AND p."Status" = 'Completed') AS revenue
FROM "Courses" AS c
GROUP BY c."Category"
ORDER BY COALESCE(sum((
    SELECT count(*)::int
    FROM "Enrollments" AS e
    WHERE c."Id" = e."CourseId")), 0)::int DESC
2025-07-30 16:48:11.394 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT p0."Year", p0."Month", COALESCE(sum(p0."Amount"), 0.0) AS "Revenue", count(*)::int AS "TransactionCount"
FROM (
    SELECT p."Amount", date_part('year', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "Payments" AS p
    WHERE p."Status" = 'Completed' AND p."CreatedAt" >= @__sixMonthsAgo_0
) AS p0
GROUP BY p0."Year", p0."Month"
2025-07-30 16:48:11.396 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT a0."Year", a0."Month", count(*)::int AS "NewUsers"
FROM (
    SELECT date_part('year', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "AspNetUsers" AS a
    WHERE a."CreatedAt" >= @__sixMonthsAgo_0
) AS a0
GROUP BY a0."Year", a0."Month"
2025-07-30 16:48:11.397 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Subscriptions" AS s
WHERE s."Status" = 'Active'
2025-07-30 16:48:11.399 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s."PlanName" AS plan, count(*)::int AS count, COALESCE(sum(s."Price"), 0.0) AS "monthlyRevenue"
FROM "Subscriptions" AS s
WHERE s."Status" = 'Active'
GROUP BY s."PlanName"
2025-07-30 16:48:11.400 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType20`6[[<>f__AnonymousType21`5[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 16:48:11.401 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api) in 20.5945ms
2025-07-30 16:48:11.402 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-07-30 16:48:11.402 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/platform - 200 null application/json; charset=utf-8 28.092ms
2025-07-30 16:48:11.404 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/course-completions - null null
2025-07-30 16:48:11.405 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:48:11.406 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/course-completions - 204 null null 1.6545ms
2025-07-30 16:48:11.407 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/course-completions - application/json null
2025-07-30 16:48:11.409 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:48:11.411 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 16:48:11.412 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetCourseCompletions (CeceLearningPortal.Api)'
2025-07-30 16:48:11.413 +08:00 [INF] Route matched with {action = "GetCourseCompletions", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourseCompletions(Int32) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 16:48:11.415 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT e0."Id", a."FullName", a."Avatar", a."Email", c."Title", e0."CourseId"::text, e0."CompletedAt", COALESCE(e0."AverageQuizScore", 0.0), e0."CertificateIssued", e0."CertificateUrl"
FROM (
    SELECT e."Id", e."AverageQuizScore", e."CertificateIssued", e."CertificateUrl", e."CompletedAt", e."CourseId", e."StudentId"
    FROM "Enrollments" AS e
    WHERE e."CompletedAt" IS NOT NULL
    ORDER BY e."CompletedAt" DESC
    LIMIT @__p_0
) AS e0
INNER JOIN "AspNetUsers" AS a ON e0."StudentId" = a."Id"
INNER JOIN "Courses" AS c ON e0."CourseId" = c."Id"
ORDER BY e0."CompletedAt" DESC
2025-07-30 16:48:11.416 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType9`10[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-30 16:48:11.417 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetCourseCompletions (CeceLearningPortal.Api) in 3.6627ms
2025-07-30 16:48:11.418 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetCourseCompletions (CeceLearningPortal.Api)'
2025-07-30 16:48:11.418 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/course-completions - 200 null application/json; charset=utf-8 11.2387ms
2025-07-30 16:48:12.454 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users - null null
2025-07-30 16:48:12.454 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/subscription-plans - null null
2025-07-30 16:48:12.455 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:48:12.457 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:48:12.457 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users - 204 null null 3.675ms
2025-07-30 16:48:12.458 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/subscription-plans - 204 null null 3.8703ms
2025-07-30 16:48:12.459 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/subscription-plans - application/json null
2025-07-30 16:48:12.461 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users - application/json null
2025-07-30 16:48:12.463 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:48:12.464 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:48:12.466 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 16:48:12.466 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 16:48:12.467 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUsers (CeceLearningPortal.Api)'
2025-07-30 16:48:12.468 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetSubscriptionPlans (CeceLearningPortal.Api)'
2025-07-30 16:48:12.469 +08:00 [INF] Route matched with {action = "GetUsers", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUsers(CeceLearningPortal.Api.DTOs.UserManagementFilterDto) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 16:48:12.469 +08:00 [INF] Route matched with {action = "GetSubscriptionPlans", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetSubscriptionPlans() on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 16:48:12.471 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
2025-07-30 16:48:12.472 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."CreatedAt", s."Description", s."DisplayOrder", s."Features", s."HasAnalytics", s."HasPrioritySupport", s."HasUnlimitedAccess", s."IsActive", s."IsRecommended", s."MaxCourseAccess", s."MaxCoursesCanCreate", s."MaxStudentsPerCourse", s."MonthlyPrice", s."Name", s."PlanType", s."TransactionFeePercentage", s."UpdatedAt", s."YearlyPrice", s0."Id", s0."BillingCycle", s0."CreatedAt", s0."EndDate", s0."NextBillingDate", s0."PlanName", s0."Price", s0."StartDate", s0."Status", s0."StripeSubscriptionId", s0."SubscriptionPlanId", s0."UpdatedAt", s0."UserId"
FROM "SubscriptionPlans" AS s
LEFT JOIN "Subscriptions" AS s0 ON s."Id" = s0."SubscriptionPlanId"
ORDER BY s."Id"
2025-07-30 16:48:12.472 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."UserName", a."Email", a."FullName", a."Role", a."Status", a."CreatedAt", a."LastLoginAt", a."EmailConfirmed"
FROM "AspNetUsers" AS a
ORDER BY a."CreatedAt" DESC
LIMIT @__p_1 OFFSET @__p_0
2025-07-30 16:48:12.473 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[CeceLearningPortal.Api.DTOs.SubscriptionPlanDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-30 16:48:12.474 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[CeceLearningPortal.Api.DTOs.UserManagementDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-30 16:48:12.475 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetSubscriptionPlans (CeceLearningPortal.Api) in 3.7667ms
2025-07-30 16:48:12.475 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUsers (CeceLearningPortal.Api) in 5.1516ms
2025-07-30 16:48:12.476 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetSubscriptionPlans (CeceLearningPortal.Api)'
2025-07-30 16:48:12.477 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUsers (CeceLearningPortal.Api)'
2025-07-30 16:48:12.477 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/subscription-plans - 200 null application/json; charset=utf-8 17.6979ms
2025-07-30 16:48:12.478 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users - 200 null application/json; charset=utf-8 16.8361ms
2025-07-30 16:48:12.480 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/efead752-f0b3-48ab-93b8-7ba31e7574ba/subscription - null null
2025-07-30 16:48:12.480 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/e090c598-224f-4b4c-870a-3c3ef6303e0a/subscription - null null
2025-07-30 16:48:12.480 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/801dc698-62a8-49c3-b578-b7c1b05049a4/subscription - null null
2025-07-30 16:48:12.480 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/28b8e854-738a-4e69-835c-71299a8f9b21/subscription - null null
2025-07-30 16:48:12.481 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/f9f0e64e-3771-4aa9-8470-21e709677e44/subscription - null null
2025-07-30 16:48:12.481 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/b9030b04-2da7-449f-94de-d6d4814a8177/subscription - null null
2025-07-30 16:48:12.482 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:48:12.483 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:48:12.484 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:48:12.485 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:48:12.487 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:48:12.488 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:48:12.488 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/efead752-f0b3-48ab-93b8-7ba31e7574ba/subscription - 204 null null 7.9342ms
2025-07-30 16:48:12.488 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/e090c598-224f-4b4c-870a-3c3ef6303e0a/subscription - 204 null null 8.2966ms
2025-07-30 16:48:12.489 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/801dc698-62a8-49c3-b578-b7c1b05049a4/subscription - 204 null null 8.5755ms
2025-07-30 16:48:12.489 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/28b8e854-738a-4e69-835c-71299a8f9b21/subscription - 204 null null 8.9704ms
2025-07-30 16:48:12.490 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/f9f0e64e-3771-4aa9-8470-21e709677e44/subscription - 204 null null 9.2508ms
2025-07-30 16:48:12.490 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/b9030b04-2da7-449f-94de-d6d4814a8177/subscription - 204 null null 9.1787ms
2025-07-30 16:48:12.492 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/e090c598-224f-4b4c-870a-3c3ef6303e0a/subscription - application/json null
2025-07-30 16:48:12.493 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/efead752-f0b3-48ab-93b8-7ba31e7574ba/subscription - application/json null
2025-07-30 16:48:12.495 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/28b8e854-738a-4e69-835c-71299a8f9b21/subscription - application/json null
2025-07-30 16:48:12.496 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/801dc698-62a8-49c3-b578-b7c1b05049a4/subscription - application/json null
2025-07-30 16:48:12.497 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/f9f0e64e-3771-4aa9-8470-21e709677e44/subscription - application/json null
2025-07-30 16:48:12.498 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/b9030b04-2da7-449f-94de-d6d4814a8177/subscription - application/json null
2025-07-30 16:48:12.500 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:48:12.501 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:48:12.502 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:48:12.503 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:48:12.506 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 16:48:12.505 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:48:12.504 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:48:12.506 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 16:48:12.507 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 16:48:12.507 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 16:48:12.507 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 16:48:12.508 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 16:48:12.509 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 16:48:12.509 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 16:48:12.510 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 16:48:12.511 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 16:48:12.512 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 16:48:12.513 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 16:48:12.514 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 16:48:12.514 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 16:48:12.515 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 16:48:12.515 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 16:48:12.516 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 16:48:12.517 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 16:48:12.517 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 16:48:12.518 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 16:48:12.519 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 16:48:12.520 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 16:48:12.521 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 16:48:12.522 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 16:48:12.522 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType83`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 16:48:12.523 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType83`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 16:48:12.525 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType83`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 16:48:12.526 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType83`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 16:48:12.527 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType83`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 16:48:12.529 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType83`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 16:48:12.530 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 14.0005ms
2025-07-30 16:48:12.531 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 13.0007ms
2025-07-30 16:48:12.531 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 13.0759ms
2025-07-30 16:48:12.532 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 12.9429ms
2025-07-30 16:48:12.533 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 12.8822ms
2025-07-30 16:48:12.534 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 12.5878ms
2025-07-30 16:48:12.534 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 16:48:12.535 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 16:48:12.536 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 16:48:12.536 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 16:48:12.537 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 16:48:12.537 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 16:48:12.538 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/efead752-f0b3-48ab-93b8-7ba31e7574ba/subscription - 200 null application/json; charset=utf-8 44.6477ms
2025-07-30 16:48:12.538 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/e090c598-224f-4b4c-870a-3c3ef6303e0a/subscription - 200 null application/json; charset=utf-8 46.4105ms
2025-07-30 16:48:12.539 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/28b8e854-738a-4e69-835c-71299a8f9b21/subscription - 200 null application/json; charset=utf-8 44.2733ms
2025-07-30 16:48:12.539 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/801dc698-62a8-49c3-b578-b7c1b05049a4/subscription - 200 null application/json; charset=utf-8 43.3368ms
2025-07-30 16:48:12.540 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/b9030b04-2da7-449f-94de-d6d4814a8177/subscription - 200 null application/json; charset=utf-8 41.4718ms
2025-07-30 16:48:12.541 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/f9f0e64e-3771-4aa9-8470-21e709677e44/subscription - 200 null application/json; charset=utf-8 43.2102ms
2025-07-30 16:49:01.440 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/platform - null null
2025-07-30 16:49:01.442 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:49:01.442 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/platform - 204 null null 1.785ms
2025-07-30 16:49:01.444 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/platform - application/json null
2025-07-30 16:49:01.445 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:49:01.447 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 16:49:01.448 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-07-30 16:49:01.449 +08:00 [INF] Route matched with {action = "GetPlatformAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPlatformAnalytics() on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-30 16:49:01.451 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
2025-07-30 16:49:01.452 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
2025-07-30 16:49:01.454 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."Status" = 'Completed'
2025-07-30 16:49:01.456 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
2025-07-30 16:49:01.459 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id" AS "instructorId", a."FullName" AS "instructorName", (
    SELECT count(*)::int
    FROM "Courses" AS c0
    WHERE c0."InstructorId" = a."Id") AS "totalCourses", (
    SELECT count(*)::int
    FROM "Enrollments" AS e
    INNER JOIN "Courses" AS c1 ON e."CourseId" = c1."Id"
    WHERE c1."InstructorId" = a."Id") AS "totalStudents", (
    SELECT COALESCE(sum(p0."Amount"), 0.0)
    FROM "Payments" AS p0
    LEFT JOIN "Courses" AS c2 ON p0."CourseId" = c2."Id"
    WHERE c2."InstructorId" = a."Id" AND p0."Status" = 'Completed') AS "totalRevenue", COALESCE((
    SELECT avg(r."Rating"::double precision)
    FROM "Reviews" AS r
    INNER JOIN "Courses" AS c3 ON r."CourseId" = c3."Id"
    WHERE c3."InstructorId" = a."Id"), 0.0) AS "averageRating"
FROM "AspNetUsers" AS a
WHERE a."Role" = 'Instructor'
ORDER BY (
    SELECT COALESCE(sum(p."Amount"), 0.0)
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
    WHERE c."InstructorId" = a."Id" AND p."Status" = 'Completed') DESC
LIMIT @__p_0
2025-07-30 16:49:01.461 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT c."Category" AS category, count(*)::int AS "courseCount", COALESCE(sum((
    SELECT count(*)::int
    FROM "Enrollments" AS e
    WHERE c."Id" = e."CourseId")), 0)::int AS "enrollmentCount", (
    SELECT COALESCE(sum(p."Amount"), 0.0)
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c0 ON p."CourseId" = c0."Id"
    WHERE c0."Category" = c."Category" AND p."Status" = 'Completed') AS revenue
FROM "Courses" AS c
GROUP BY c."Category"
ORDER BY COALESCE(sum((
    SELECT count(*)::int
    FROM "Enrollments" AS e
    WHERE c."Id" = e."CourseId")), 0)::int DESC
2025-07-30 16:49:01.463 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT p0."Year", p0."Month", COALESCE(sum(p0."Amount"), 0.0) AS "Revenue", count(*)::int AS "TransactionCount"
FROM (
    SELECT p."Amount", date_part('year', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "Payments" AS p
    WHERE p."Status" = 'Completed' AND p."CreatedAt" >= @__sixMonthsAgo_0
) AS p0
GROUP BY p0."Year", p0."Month"
2025-07-30 16:49:01.464 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT a0."Year", a0."Month", count(*)::int AS "NewUsers"
FROM (
    SELECT date_part('year', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "AspNetUsers" AS a
    WHERE a."CreatedAt" >= @__sixMonthsAgo_0
) AS a0
GROUP BY a0."Year", a0."Month"
2025-07-30 16:49:01.466 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Subscriptions" AS s
WHERE s."Status" = 'Active'
2025-07-30 16:49:01.467 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s."PlanName" AS plan, count(*)::int AS count, COALESCE(sum(s."Price"), 0.0) AS "monthlyRevenue"
FROM "Subscriptions" AS s
WHERE s."Status" = 'Active'
GROUP BY s."PlanName"
2025-07-30 16:49:01.468 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType20`6[[<>f__AnonymousType21`5[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 16:49:01.469 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api) in 19.5268ms
2025-07-30 16:49:01.470 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-07-30 16:49:01.471 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/platform - 200 null application/json; charset=utf-8 27.138ms
2025-07-30 16:49:01.472 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/course-completions - null null
2025-07-30 16:49:01.474 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:49:01.474 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/course-completions - 204 null null 1.5253ms
2025-07-30 16:49:01.475 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/course-completions - application/json null
2025-07-30 16:49:01.476 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:49:01.478 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 16:49:01.479 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetCourseCompletions (CeceLearningPortal.Api)'
2025-07-30 16:49:01.479 +08:00 [INF] Route matched with {action = "GetCourseCompletions", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourseCompletions(Int32) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 16:49:01.481 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT e0."Id", a."FullName", a."Avatar", a."Email", c."Title", e0."CourseId"::text, e0."CompletedAt", COALESCE(e0."AverageQuizScore", 0.0), e0."CertificateIssued", e0."CertificateUrl"
FROM (
    SELECT e."Id", e."AverageQuizScore", e."CertificateIssued", e."CertificateUrl", e."CompletedAt", e."CourseId", e."StudentId"
    FROM "Enrollments" AS e
    WHERE e."CompletedAt" IS NOT NULL
    ORDER BY e."CompletedAt" DESC
    LIMIT @__p_0
) AS e0
INNER JOIN "AspNetUsers" AS a ON e0."StudentId" = a."Id"
INNER JOIN "Courses" AS c ON e0."CourseId" = c."Id"
ORDER BY e0."CompletedAt" DESC
2025-07-30 16:49:01.483 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType9`10[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-30 16:49:01.484 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetCourseCompletions (CeceLearningPortal.Api) in 3.4388ms
2025-07-30 16:49:01.484 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetCourseCompletions (CeceLearningPortal.Api)'
2025-07-30 16:49:01.485 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/course-completions - 200 null application/json; charset=utf-8 9.4707ms
2025-07-30 16:49:03.634 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/auth/login - null null
2025-07-30 16:49:03.635 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:49:03.635 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/auth/login - 204 null null 1.5588ms
2025-07-30 16:49:03.637 +08:00 [INF] Request starting HTTP/1.1 POST http://localhost:5295/api/auth/login - application/json 51
2025-07-30 16:49:03.638 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:49:03.639 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 16:49:03.640 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AuthController.Login (CeceLearningPortal.Api)'
2025-07-30 16:49:03.641 +08:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(CeceLearningPortal.Api.DTOs.LoginDto) on controller CeceLearningPortal.Api.Controllers.AuthController (CeceLearningPortal.Api).
2025-07-30 16:49:03.645 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__normalizedEmail_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."NormalizedEmail" = @__normalizedEmail_0
LIMIT 2
2025-07-30 16:49:03.695 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@p1='?', @p2='?', @p0='?' (DbType = DateTime), @p3='?' (DbType = DateTime), @p4='?', @p5='?' (DbType = DateTime), @p6='?', @p7='?' (DbType = DateTime), @p8='?', @p9='?', @p10='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE "AspNetUsers" SET "LastLoginAt" = @p0
WHERE "Id" = @p1 AND "ConcurrencyStamp" = @p2;
INSERT INTO "RefreshTokens" ("CreatedAt", "CreatedByIp", "ExpiresAt", "ReplacedByToken", "RevokedAt", "RevokedByIp", "Token", "UserId")
VALUES (@p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10)
RETURNING "Id";
2025-07-30 16:49:03.697 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.AuthResponseDto'.
2025-07-30 16:49:03.698 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AuthController.Login (CeceLearningPortal.Api) in 56.0375ms
2025-07-30 16:49:03.699 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AuthController.Login (CeceLearningPortal.Api)'
2025-07-30 16:49:03.699 +08:00 [INF] Request finished HTTP/1.1 POST http://localhost:5295/api/auth/login - 200 null application/json; charset=utf-8 62.3741ms
2025-07-30 16:49:03.722 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/courses - null null
2025-07-30 16:49:03.723 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/platform - application/json null
2025-07-30 16:49:03.724 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:49:03.725 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:49:03.725 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/courses - 204 null null 2.9771ms
2025-07-30 16:49:03.727 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 16:49:03.727 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses - application/json null
2025-07-30 16:49:03.729 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-07-30 16:49:03.730 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:49:03.731 +08:00 [INF] Route matched with {action = "GetPlatformAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPlatformAnalytics() on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-30 16:49:03.732 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 16:49:03.733 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
2025-07-30 16:49:03.733 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-30 16:49:03.735 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
2025-07-30 16:49:03.735 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-30 16:49:03.736 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."Status" = 'Completed'
2025-07-30 16:49:03.738 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
2025-07-30 16:49:03.738 +08:00 [ERR] Failed executing DbCommand (1ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."IsPublished", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."PublishedAt", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."IsFlagged", r."Rating", r."Status", r."StudentId", e."Id", e."AverageQuizScore", e."CertificateIssued", e."CertificateUrl", e."CompletedAt", e."CompletedLessons", e."CourseId", e."EnrolledAt", e."LastAccessedDate", e."ProgressPercentage", e."QuizCount", e."StudentId", e."TotalTimeSpent"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."IsPublished", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."PublishedAt", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-30 16:49:03.740 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id" AS "instructorId", a."FullName" AS "instructorName", (
    SELECT count(*)::int
    FROM "Courses" AS c0
    WHERE c0."InstructorId" = a."Id") AS "totalCourses", (
    SELECT count(*)::int
    FROM "Enrollments" AS e
    INNER JOIN "Courses" AS c1 ON e."CourseId" = c1."Id"
    WHERE c1."InstructorId" = a."Id") AS "totalStudents", (
    SELECT COALESCE(sum(p0."Amount"), 0.0)
    FROM "Payments" AS p0
    LEFT JOIN "Courses" AS c2 ON p0."CourseId" = c2."Id"
    WHERE c2."InstructorId" = a."Id" AND p0."Status" = 'Completed') AS "totalRevenue", COALESCE((
    SELECT avg(r."Rating"::double precision)
    FROM "Reviews" AS r
    INNER JOIN "Courses" AS c3 ON r."CourseId" = c3."Id"
    WHERE c3."InstructorId" = a."Id"), 0.0) AS "averageRating"
FROM "AspNetUsers" AS a
WHERE a."Role" = 'Instructor'
ORDER BY (
    SELECT COALESCE(sum(p."Amount"), 0.0)
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
    WHERE c."InstructorId" = a."Id" AND p."Status" = 'Completed') DESC
LIMIT @__p_0
2025-07-30 16:49:03.741 +08:00 [ERR] An exception occurred while iterating over the results of a query for context type 'CeceLearningPortal.Api.Data.ApplicationDbContext'.
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 1526
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 1526
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 1526
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 1526
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 16:49:03.743 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT c."Category" AS category, count(*)::int AS "courseCount", COALESCE(sum((
    SELECT count(*)::int
    FROM "Enrollments" AS e
    WHERE c."Id" = e."CourseId")), 0)::int AS "enrollmentCount", (
    SELECT COALESCE(sum(p."Amount"), 0.0)
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c0 ON p."CourseId" = c0."Id"
    WHERE c0."Category" = c."Category" AND p."Status" = 'Completed') AS revenue
FROM "Courses" AS c
GROUP BY c."Category"
ORDER BY COALESCE(sum((
    SELECT count(*)::int
    FROM "Enrollments" AS e
    WHERE c."Id" = e."CourseId")), 0)::int DESC
2025-07-30 16:49:03.747 +08:00 [ERR] Error retrieving courses
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 1526
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at CeceLearningPortal.Api.Services.CourseService.GetAllCoursesAsync(CourseFilterDto filter) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Services\CourseService.cs:line 95
   at CeceLearningPortal.Api.Controllers.CoursesController.GetCourses(CourseFilterDto filter) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Controllers\CoursesController.cs:line 26
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 1526
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 16:49:03.748 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT p0."Year", p0."Month", COALESCE(sum(p0."Amount"), 0.0) AS "Revenue", count(*)::int AS "TransactionCount"
FROM (
    SELECT p."Amount", date_part('year', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "Payments" AS p
    WHERE p."Status" = 'Completed' AND p."CreatedAt" >= @__sixMonthsAgo_0
) AS p0
GROUP BY p0."Year", p0."Month"
2025-07-30 16:49:03.752 +08:00 [INF] Executing ObjectResult, writing value of type '<>f__AnonymousType0`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 16:49:03.753 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT a0."Year", a0."Month", count(*)::int AS "NewUsers"
FROM (
    SELECT date_part('year', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "AspNetUsers" AS a
    WHERE a."CreatedAt" >= @__sixMonthsAgo_0
) AS a0
GROUP BY a0."Year", a0."Month"
2025-07-30 16:49:03.753 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 16.7002ms
2025-07-30 16:49:03.755 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Subscriptions" AS s
WHERE s."Status" = 'Active'
2025-07-30 16:49:03.755 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-30 16:49:03.757 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s."PlanName" AS plan, count(*)::int AS count, COALESCE(sum(s."Price"), 0.0) AS "monthlyRevenue"
FROM "Subscriptions" AS s
WHERE s."Status" = 'Active'
GROUP BY s."PlanName"
2025-07-30 16:49:03.757 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses - 500 null application/json; charset=utf-8 29.2013ms
2025-07-30 16:49:03.758 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType20`6[[<>f__AnonymousType21`5[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 16:49:03.760 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api) in 27.8542ms
2025-07-30 16:49:03.761 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-07-30 16:49:03.761 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/platform - 200 null application/json; charset=utf-8 38.2226ms
2025-07-30 16:49:06.620 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/platform - null null
2025-07-30 16:49:06.622 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:49:06.622 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/platform - 204 null null 1.9123ms
2025-07-30 16:49:06.624 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/platform - application/json null
2025-07-30 16:49:06.625 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:49:06.627 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 16:49:06.628 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-07-30 16:49:06.629 +08:00 [INF] Route matched with {action = "GetPlatformAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPlatformAnalytics() on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-30 16:49:06.631 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
2025-07-30 16:49:06.632 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
2025-07-30 16:49:06.634 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."Status" = 'Completed'
2025-07-30 16:49:06.635 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
2025-07-30 16:49:06.638 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id" AS "instructorId", a."FullName" AS "instructorName", (
    SELECT count(*)::int
    FROM "Courses" AS c0
    WHERE c0."InstructorId" = a."Id") AS "totalCourses", (
    SELECT count(*)::int
    FROM "Enrollments" AS e
    INNER JOIN "Courses" AS c1 ON e."CourseId" = c1."Id"
    WHERE c1."InstructorId" = a."Id") AS "totalStudents", (
    SELECT COALESCE(sum(p0."Amount"), 0.0)
    FROM "Payments" AS p0
    LEFT JOIN "Courses" AS c2 ON p0."CourseId" = c2."Id"
    WHERE c2."InstructorId" = a."Id" AND p0."Status" = 'Completed') AS "totalRevenue", COALESCE((
    SELECT avg(r."Rating"::double precision)
    FROM "Reviews" AS r
    INNER JOIN "Courses" AS c3 ON r."CourseId" = c3."Id"
    WHERE c3."InstructorId" = a."Id"), 0.0) AS "averageRating"
FROM "AspNetUsers" AS a
WHERE a."Role" = 'Instructor'
ORDER BY (
    SELECT COALESCE(sum(p."Amount"), 0.0)
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
    WHERE c."InstructorId" = a."Id" AND p."Status" = 'Completed') DESC
LIMIT @__p_0
2025-07-30 16:49:06.640 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT c."Category" AS category, count(*)::int AS "courseCount", COALESCE(sum((
    SELECT count(*)::int
    FROM "Enrollments" AS e
    WHERE c."Id" = e."CourseId")), 0)::int AS "enrollmentCount", (
    SELECT COALESCE(sum(p."Amount"), 0.0)
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c0 ON p."CourseId" = c0."Id"
    WHERE c0."Category" = c."Category" AND p."Status" = 'Completed') AS revenue
FROM "Courses" AS c
GROUP BY c."Category"
ORDER BY COALESCE(sum((
    SELECT count(*)::int
    FROM "Enrollments" AS e
    WHERE c."Id" = e."CourseId")), 0)::int DESC
2025-07-30 16:49:06.642 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT p0."Year", p0."Month", COALESCE(sum(p0."Amount"), 0.0) AS "Revenue", count(*)::int AS "TransactionCount"
FROM (
    SELECT p."Amount", date_part('year', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "Payments" AS p
    WHERE p."Status" = 'Completed' AND p."CreatedAt" >= @__sixMonthsAgo_0
) AS p0
GROUP BY p0."Year", p0."Month"
2025-07-30 16:49:06.643 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT a0."Year", a0."Month", count(*)::int AS "NewUsers"
FROM (
    SELECT date_part('year', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "AspNetUsers" AS a
    WHERE a."CreatedAt" >= @__sixMonthsAgo_0
) AS a0
GROUP BY a0."Year", a0."Month"
2025-07-30 16:49:06.645 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Subscriptions" AS s
WHERE s."Status" = 'Active'
2025-07-30 16:49:06.646 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s."PlanName" AS plan, count(*)::int AS count, COALESCE(sum(s."Price"), 0.0) AS "monthlyRevenue"
FROM "Subscriptions" AS s
WHERE s."Status" = 'Active'
GROUP BY s."PlanName"
2025-07-30 16:49:06.647 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType20`6[[<>f__AnonymousType21`5[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 16:49:06.648 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api) in 18.1966ms
2025-07-30 16:49:06.649 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-07-30 16:49:06.649 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/platform - 200 null application/json; charset=utf-8 25.6548ms
2025-07-30 16:49:06.651 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/course-completions - null null
2025-07-30 16:49:06.652 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:49:06.653 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/course-completions - 204 null null 1.6905ms
2025-07-30 16:49:06.654 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/course-completions - application/json null
2025-07-30 16:49:06.656 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:49:06.657 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 16:49:06.658 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetCourseCompletions (CeceLearningPortal.Api)'
2025-07-30 16:49:06.659 +08:00 [INF] Route matched with {action = "GetCourseCompletions", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourseCompletions(Int32) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 16:49:06.661 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT e0."Id", a."FullName", a."Avatar", a."Email", c."Title", e0."CourseId"::text, e0."CompletedAt", COALESCE(e0."AverageQuizScore", 0.0), e0."CertificateIssued", e0."CertificateUrl"
FROM (
    SELECT e."Id", e."AverageQuizScore", e."CertificateIssued", e."CertificateUrl", e."CompletedAt", e."CourseId", e."StudentId"
    FROM "Enrollments" AS e
    WHERE e."CompletedAt" IS NOT NULL
    ORDER BY e."CompletedAt" DESC
    LIMIT @__p_0
) AS e0
INNER JOIN "AspNetUsers" AS a ON e0."StudentId" = a."Id"
INNER JOIN "Courses" AS c ON e0."CourseId" = c."Id"
ORDER BY e0."CompletedAt" DESC
2025-07-30 16:49:06.662 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType9`10[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-30 16:49:06.663 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetCourseCompletions (CeceLearningPortal.Api) in 3.9566ms
2025-07-30 16:49:06.664 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetCourseCompletions (CeceLearningPortal.Api)'
2025-07-30 16:49:06.665 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/course-completions - 200 null application/json; charset=utf-8 10.6059ms
2025-07-30 16:49:09.737 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/courses - null null
2025-07-30 16:49:09.738 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:49:09.738 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/courses - 204 null null 1.5241ms
2025-07-30 16:49:09.740 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses - application/json null
2025-07-30 16:49:09.741 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:49:09.742 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 16:49:09.743 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-30 16:49:09.744 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-30 16:49:09.746 +08:00 [ERR] Failed executing DbCommand (1ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."IsPublished", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."PublishedAt", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."IsFlagged", r."Rating", r."Status", r."StudentId", e."Id", e."AverageQuizScore", e."CertificateIssued", e."CertificateUrl", e."CompletedAt", e."CompletedLessons", e."CourseId", e."EnrolledAt", e."LastAccessedDate", e."ProgressPercentage", e."QuizCount", e."StudentId", e."TotalTimeSpent"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."IsPublished", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."PublishedAt", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-30 16:49:09.749 +08:00 [ERR] An exception occurred while iterating over the results of a query for context type 'CeceLearningPortal.Api.Data.ApplicationDbContext'.
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 1526
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 1526
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 1526
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 1526
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 16:49:09.753 +08:00 [ERR] Error retrieving courses
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 1526
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at CeceLearningPortal.Api.Services.CourseService.GetAllCoursesAsync(CourseFilterDto filter) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Services\CourseService.cs:line 95
   at CeceLearningPortal.Api.Controllers.CoursesController.GetCourses(CourseFilterDto filter) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Controllers\CoursesController.cs:line 26
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 1526
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 16:49:09.757 +08:00 [INF] Executing ObjectResult, writing value of type '<>f__AnonymousType0`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 16:49:09.758 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 13.0121ms
2025-07-30 16:49:09.758 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-30 16:49:09.759 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses - 500 null application/json; charset=utf-8 19.0767ms
2025-07-30 16:49:14.257 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users - null null
2025-07-30 16:49:14.258 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/subscription-plans - null null
2025-07-30 16:49:14.259 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:49:14.260 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:49:14.260 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users - 204 null null 3.0702ms
2025-07-30 16:49:14.261 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/subscription-plans - 204 null null 3.2936ms
2025-07-30 16:49:14.263 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/subscription-plans - application/json null
2025-07-30 16:49:14.264 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users - application/json null
2025-07-30 16:49:14.265 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:49:14.266 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:49:14.268 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 16:49:14.268 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 16:49:14.269 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUsers (CeceLearningPortal.Api)'
2025-07-30 16:49:14.270 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetSubscriptionPlans (CeceLearningPortal.Api)'
2025-07-30 16:49:14.270 +08:00 [INF] Route matched with {action = "GetUsers", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUsers(CeceLearningPortal.Api.DTOs.UserManagementFilterDto) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 16:49:14.270 +08:00 [INF] Route matched with {action = "GetSubscriptionPlans", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetSubscriptionPlans() on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 16:49:14.272 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
2025-07-30 16:49:14.273 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."CreatedAt", s."Description", s."DisplayOrder", s."Features", s."HasAnalytics", s."HasPrioritySupport", s."HasUnlimitedAccess", s."IsActive", s."IsRecommended", s."MaxCourseAccess", s."MaxCoursesCanCreate", s."MaxStudentsPerCourse", s."MonthlyPrice", s."Name", s."PlanType", s."TransactionFeePercentage", s."UpdatedAt", s."YearlyPrice", s0."Id", s0."BillingCycle", s0."CreatedAt", s0."EndDate", s0."NextBillingDate", s0."PlanName", s0."Price", s0."StartDate", s0."Status", s0."StripeSubscriptionId", s0."SubscriptionPlanId", s0."UpdatedAt", s0."UserId"
FROM "SubscriptionPlans" AS s
LEFT JOIN "Subscriptions" AS s0 ON s."Id" = s0."SubscriptionPlanId"
ORDER BY s."Id"
2025-07-30 16:49:14.273 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."UserName", a."Email", a."FullName", a."Role", a."Status", a."CreatedAt", a."LastLoginAt", a."EmailConfirmed"
FROM "AspNetUsers" AS a
ORDER BY a."CreatedAt" DESC
LIMIT @__p_1 OFFSET @__p_0
2025-07-30 16:49:14.274 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[CeceLearningPortal.Api.DTOs.SubscriptionPlanDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-30 16:49:14.275 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[CeceLearningPortal.Api.DTOs.UserManagementDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-30 16:49:14.275 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetSubscriptionPlans (CeceLearningPortal.Api) in 3.5132ms
2025-07-30 16:49:14.276 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUsers (CeceLearningPortal.Api) in 4.9694ms
2025-07-30 16:49:14.277 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetSubscriptionPlans (CeceLearningPortal.Api)'
2025-07-30 16:49:14.278 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/subscription-plans - 200 null application/json; charset=utf-8 14.8871ms
2025-07-30 16:49:14.277 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUsers (CeceLearningPortal.Api)'
2025-07-30 16:49:14.280 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users - 200 null application/json; charset=utf-8 15.8041ms
2025-07-30 16:49:14.282 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/b9030b04-2da7-449f-94de-d6d4814a8177/subscription - null null
2025-07-30 16:49:14.282 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/efead752-f0b3-48ab-93b8-7ba31e7574ba/subscription - null null
2025-07-30 16:49:14.282 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/e090c598-224f-4b4c-870a-3c3ef6303e0a/subscription - null null
2025-07-30 16:49:14.282 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/801dc698-62a8-49c3-b578-b7c1b05049a4/subscription - null null
2025-07-30 16:49:14.283 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/f9f0e64e-3771-4aa9-8470-21e709677e44/subscription - null null
2025-07-30 16:49:14.283 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/28b8e854-738a-4e69-835c-71299a8f9b21/subscription - null null
2025-07-30 16:49:14.283 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:49:14.284 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:49:14.285 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:49:14.286 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:49:14.287 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:49:14.288 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:49:14.289 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/b9030b04-2da7-449f-94de-d6d4814a8177/subscription - 204 null null 7.1476ms
2025-07-30 16:49:14.289 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/efead752-f0b3-48ab-93b8-7ba31e7574ba/subscription - 204 null null 7.2132ms
2025-07-30 16:49:14.289 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/e090c598-224f-4b4c-870a-3c3ef6303e0a/subscription - 204 null null 7.1688ms
2025-07-30 16:49:14.290 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/801dc698-62a8-49c3-b578-b7c1b05049a4/subscription - 204 null null 7.378ms
2025-07-30 16:49:14.290 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/f9f0e64e-3771-4aa9-8470-21e709677e44/subscription - 204 null null 7.5738ms
2025-07-30 16:49:14.291 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/28b8e854-738a-4e69-835c-71299a8f9b21/subscription - 204 null null 8.0416ms
2025-07-30 16:49:14.292 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/28b8e854-738a-4e69-835c-71299a8f9b21/subscription - application/json null
2025-07-30 16:49:14.294 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/e090c598-224f-4b4c-870a-3c3ef6303e0a/subscription - application/json null
2025-07-30 16:49:14.295 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/efead752-f0b3-48ab-93b8-7ba31e7574ba/subscription - application/json null
2025-07-30 16:49:14.296 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/b9030b04-2da7-449f-94de-d6d4814a8177/subscription - application/json null
2025-07-30 16:49:14.298 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/801dc698-62a8-49c3-b578-b7c1b05049a4/subscription - application/json null
2025-07-30 16:49:14.299 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/f9f0e64e-3771-4aa9-8470-21e709677e44/subscription - application/json null
2025-07-30 16:49:14.300 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:49:14.301 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:49:14.302 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:49:14.303 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:49:14.304 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:49:14.305 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:49:14.306 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 16:49:14.306 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 16:49:14.307 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 16:49:14.307 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 16:49:14.307 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 16:49:14.308 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 16:49:14.308 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 16:49:14.309 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 16:49:14.310 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 16:49:14.311 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 16:49:14.312 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 16:49:14.313 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 16:49:14.314 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 16:49:14.314 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 16:49:14.315 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 16:49:14.315 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 16:49:14.315 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 16:49:14.316 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 16:49:14.318 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 16:49:14.318 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 16:49:14.319 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 16:49:14.320 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 16:49:14.321 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 16:49:14.321 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 16:49:14.322 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType83`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 16:49:14.323 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType83`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 16:49:14.324 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType83`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 16:49:14.325 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType83`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 16:49:14.326 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType83`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 16:49:14.327 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType83`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 16:49:14.328 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 11.1091ms
2025-07-30 16:49:14.329 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 11.3084ms
2025-07-30 16:49:14.330 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 11.2696ms
2025-07-30 16:49:14.330 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 11.1962ms
2025-07-30 16:49:14.331 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 11.1929ms
2025-07-30 16:49:14.332 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 11.0081ms
2025-07-30 16:49:14.333 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 16:49:14.333 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 16:49:14.334 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 16:49:14.334 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 16:49:14.335 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 16:49:14.335 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 16:49:14.336 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/e090c598-224f-4b4c-870a-3c3ef6303e0a/subscription - 200 null application/json; charset=utf-8 42.2062ms
2025-07-30 16:49:14.336 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/28b8e854-738a-4e69-835c-71299a8f9b21/subscription - 200 null application/json; charset=utf-8 44.0064ms
2025-07-30 16:49:14.337 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/efead752-f0b3-48ab-93b8-7ba31e7574ba/subscription - 200 null application/json; charset=utf-8 41.8358ms
2025-07-30 16:49:14.337 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/b9030b04-2da7-449f-94de-d6d4814a8177/subscription - 200 null application/json; charset=utf-8 41.0174ms
2025-07-30 16:49:14.338 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/801dc698-62a8-49c3-b578-b7c1b05049a4/subscription - 200 null application/json; charset=utf-8 40.3365ms
2025-07-30 16:49:14.338 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/f9f0e64e-3771-4aa9-8470-21e709677e44/subscription - 200 null application/json; charset=utf-8 39.5687ms
2025-07-30 16:50:04.758 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/platform - null null
2025-07-30 16:50:04.759 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:50:04.760 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/platform - 204 null null 1.767ms
2025-07-30 16:50:04.762 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/platform - application/json null
2025-07-30 16:50:04.763 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:50:04.764 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 16:50:04.766 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-07-30 16:50:04.766 +08:00 [INF] Route matched with {action = "GetPlatformAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPlatformAnalytics() on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-30 16:50:04.768 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
2025-07-30 16:50:04.769 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
2025-07-30 16:50:04.771 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."Status" = 'Completed'
2025-07-30 16:50:04.772 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
2025-07-30 16:50:04.776 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id" AS "instructorId", a."FullName" AS "instructorName", (
    SELECT count(*)::int
    FROM "Courses" AS c0
    WHERE c0."InstructorId" = a."Id") AS "totalCourses", (
    SELECT count(*)::int
    FROM "Enrollments" AS e
    INNER JOIN "Courses" AS c1 ON e."CourseId" = c1."Id"
    WHERE c1."InstructorId" = a."Id") AS "totalStudents", (
    SELECT COALESCE(sum(p0."Amount"), 0.0)
    FROM "Payments" AS p0
    LEFT JOIN "Courses" AS c2 ON p0."CourseId" = c2."Id"
    WHERE c2."InstructorId" = a."Id" AND p0."Status" = 'Completed') AS "totalRevenue", COALESCE((
    SELECT avg(r."Rating"::double precision)
    FROM "Reviews" AS r
    INNER JOIN "Courses" AS c3 ON r."CourseId" = c3."Id"
    WHERE c3."InstructorId" = a."Id"), 0.0) AS "averageRating"
FROM "AspNetUsers" AS a
WHERE a."Role" = 'Instructor'
ORDER BY (
    SELECT COALESCE(sum(p."Amount"), 0.0)
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
    WHERE c."InstructorId" = a."Id" AND p."Status" = 'Completed') DESC
LIMIT @__p_0
2025-07-30 16:50:04.779 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT c."Category" AS category, count(*)::int AS "courseCount", COALESCE(sum((
    SELECT count(*)::int
    FROM "Enrollments" AS e
    WHERE c."Id" = e."CourseId")), 0)::int AS "enrollmentCount", (
    SELECT COALESCE(sum(p."Amount"), 0.0)
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c0 ON p."CourseId" = c0."Id"
    WHERE c0."Category" = c."Category" AND p."Status" = 'Completed') AS revenue
FROM "Courses" AS c
GROUP BY c."Category"
ORDER BY COALESCE(sum((
    SELECT count(*)::int
    FROM "Enrollments" AS e
    WHERE c."Id" = e."CourseId")), 0)::int DESC
2025-07-30 16:50:04.780 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT p0."Year", p0."Month", COALESCE(sum(p0."Amount"), 0.0) AS "Revenue", count(*)::int AS "TransactionCount"
FROM (
    SELECT p."Amount", date_part('year', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "Payments" AS p
    WHERE p."Status" = 'Completed' AND p."CreatedAt" >= @__sixMonthsAgo_0
) AS p0
GROUP BY p0."Year", p0."Month"
2025-07-30 16:50:04.782 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT a0."Year", a0."Month", count(*)::int AS "NewUsers"
FROM (
    SELECT date_part('year', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "AspNetUsers" AS a
    WHERE a."CreatedAt" >= @__sixMonthsAgo_0
) AS a0
GROUP BY a0."Year", a0."Month"
2025-07-30 16:50:04.784 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Subscriptions" AS s
WHERE s."Status" = 'Active'
2025-07-30 16:50:04.785 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s."PlanName" AS plan, count(*)::int AS count, COALESCE(sum(s."Price"), 0.0) AS "monthlyRevenue"
FROM "Subscriptions" AS s
WHERE s."Status" = 'Active'
GROUP BY s."PlanName"
2025-07-30 16:50:04.786 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType20`6[[<>f__AnonymousType21`5[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 16:50:04.787 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api) in 20.1702ms
2025-07-30 16:50:04.788 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-07-30 16:50:04.789 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/platform - 200 null application/json; charset=utf-8 27.3405ms
2025-07-30 16:50:04.790 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/course-completions - null null
2025-07-30 16:50:04.791 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:50:04.792 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/course-completions - 204 null null 1.3629ms
2025-07-30 16:50:04.793 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/course-completions - application/json null
2025-07-30 16:50:04.794 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:50:04.796 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 16:50:04.797 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetCourseCompletions (CeceLearningPortal.Api)'
2025-07-30 16:50:04.797 +08:00 [INF] Route matched with {action = "GetCourseCompletions", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourseCompletions(Int32) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 16:50:04.799 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT e0."Id", a."FullName", a."Avatar", a."Email", c."Title", e0."CourseId"::text, e0."CompletedAt", COALESCE(e0."AverageQuizScore", 0.0), e0."CertificateIssued", e0."CertificateUrl"
FROM (
    SELECT e."Id", e."AverageQuizScore", e."CertificateIssued", e."CertificateUrl", e."CompletedAt", e."CourseId", e."StudentId"
    FROM "Enrollments" AS e
    WHERE e."CompletedAt" IS NOT NULL
    ORDER BY e."CompletedAt" DESC
    LIMIT @__p_0
) AS e0
INNER JOIN "AspNetUsers" AS a ON e0."StudentId" = a."Id"
INNER JOIN "Courses" AS c ON e0."CourseId" = c."Id"
ORDER BY e0."CompletedAt" DESC
2025-07-30 16:50:04.800 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType9`10[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-30 16:50:04.801 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetCourseCompletions (CeceLearningPortal.Api) in 3.2518ms
2025-07-30 16:50:04.802 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetCourseCompletions (CeceLearningPortal.Api)'
2025-07-30 16:50:04.802 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/course-completions - 200 null application/json; charset=utf-8 9.1263ms
2025-07-30 16:51:03.851 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/auth/login - null null
2025-07-30 16:51:03.852 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:51:03.853 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/auth/login - 204 null null 1.797ms
2025-07-30 16:51:03.855 +08:00 [INF] Request starting HTTP/1.1 POST http://localhost:5295/api/auth/login - application/json 51
2025-07-30 16:51:03.856 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:51:03.857 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 16:51:03.858 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AuthController.Login (CeceLearningPortal.Api)'
2025-07-30 16:51:03.859 +08:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(CeceLearningPortal.Api.DTOs.LoginDto) on controller CeceLearningPortal.Api.Controllers.AuthController (CeceLearningPortal.Api).
2025-07-30 16:51:03.860 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__normalizedEmail_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."NormalizedEmail" = @__normalizedEmail_0
LIMIT 2
2025-07-30 16:51:03.907 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@p1='?', @p2='?', @p0='?' (DbType = DateTime), @p3='?' (DbType = DateTime), @p4='?', @p5='?' (DbType = DateTime), @p6='?', @p7='?' (DbType = DateTime), @p8='?', @p9='?', @p10='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE "AspNetUsers" SET "LastLoginAt" = @p0
WHERE "Id" = @p1 AND "ConcurrencyStamp" = @p2;
INSERT INTO "RefreshTokens" ("CreatedAt", "CreatedByIp", "ExpiresAt", "ReplacedByToken", "RevokedAt", "RevokedByIp", "Token", "UserId")
VALUES (@p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10)
RETURNING "Id";
2025-07-30 16:51:03.909 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.AuthResponseDto'.
2025-07-30 16:51:03.909 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AuthController.Login (CeceLearningPortal.Api) in 49.5976ms
2025-07-30 16:51:03.910 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AuthController.Login (CeceLearningPortal.Api)'
2025-07-30 16:51:03.910 +08:00 [INF] Request finished HTTP/1.1 POST http://localhost:5295/api/auth/login - 200 null application/json; charset=utf-8 55.7854ms
2025-07-30 16:51:03.925 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/courses - null null
2025-07-30 16:51:03.926 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/platform - null null
2025-07-30 16:51:03.926 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:51:03.927 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:51:03.928 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/courses - 204 null null 2.9027ms
2025-07-30 16:51:03.928 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/platform - 204 null null 2.6875ms
2025-07-30 16:51:03.930 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/platform - application/json null
2025-07-30 16:51:03.932 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses - application/json null
2025-07-30 16:51:03.934 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:51:03.935 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:51:03.936 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 16:51:03.937 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 16:51:03.938 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-07-30 16:51:03.939 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-30 16:51:03.940 +08:00 [INF] Route matched with {action = "GetPlatformAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPlatformAnalytics() on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-30 16:51:03.941 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-30 16:51:03.944 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
2025-07-30 16:51:03.945 +08:00 [ERR] Failed executing DbCommand (1ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."IsPublished", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."PublishedAt", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."IsFlagged", r."Rating", r."Status", r."StudentId", e."Id", e."AverageQuizScore", e."CertificateIssued", e."CertificateUrl", e."CompletedAt", e."CompletedLessons", e."CourseId", e."EnrolledAt", e."LastAccessedDate", e."ProgressPercentage", e."QuizCount", e."StudentId", e."TotalTimeSpent"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."IsPublished", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."PublishedAt", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-30 16:51:03.946 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
2025-07-30 16:51:03.949 +08:00 [ERR] An exception occurred while iterating over the results of a query for context type 'CeceLearningPortal.Api.Data.ApplicationDbContext'.
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 1526
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 1526
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 1526
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 1526
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 16:51:03.950 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."Status" = 'Completed'
2025-07-30 16:51:03.954 +08:00 [ERR] Error retrieving courses
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 1526
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at CeceLearningPortal.Api.Services.CourseService.GetAllCoursesAsync(CourseFilterDto filter) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Services\CourseService.cs:line 95
   at CeceLearningPortal.Api.Controllers.CoursesController.GetCourses(CourseFilterDto filter) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Controllers\CoursesController.cs:line 26
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 1526
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 16:51:03.955 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
2025-07-30 16:51:03.959 +08:00 [INF] Executing ObjectResult, writing value of type '<>f__AnonymousType0`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 16:51:03.960 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 16.1212ms
2025-07-30 16:51:03.961 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-30 16:51:03.961 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id" AS "instructorId", a."FullName" AS "instructorName", (
    SELECT count(*)::int
    FROM "Courses" AS c0
    WHERE c0."InstructorId" = a."Id") AS "totalCourses", (
    SELECT count(*)::int
    FROM "Enrollments" AS e
    INNER JOIN "Courses" AS c1 ON e."CourseId" = c1."Id"
    WHERE c1."InstructorId" = a."Id") AS "totalStudents", (
    SELECT COALESCE(sum(p0."Amount"), 0.0)
    FROM "Payments" AS p0
    LEFT JOIN "Courses" AS c2 ON p0."CourseId" = c2."Id"
    WHERE c2."InstructorId" = a."Id" AND p0."Status" = 'Completed') AS "totalRevenue", COALESCE((
    SELECT avg(r."Rating"::double precision)
    FROM "Reviews" AS r
    INNER JOIN "Courses" AS c3 ON r."CourseId" = c3."Id"
    WHERE c3."InstructorId" = a."Id"), 0.0) AS "averageRating"
FROM "AspNetUsers" AS a
WHERE a."Role" = 'Instructor'
ORDER BY (
    SELECT COALESCE(sum(p."Amount"), 0.0)
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
    WHERE c."InstructorId" = a."Id" AND p."Status" = 'Completed') DESC
LIMIT @__p_0
2025-07-30 16:51:03.962 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses - 500 null application/json; charset=utf-8 29.5389ms
2025-07-30 16:51:03.964 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT c."Category" AS category, count(*)::int AS "courseCount", COALESCE(sum((
    SELECT count(*)::int
    FROM "Enrollments" AS e
    WHERE c."Id" = e."CourseId")), 0)::int AS "enrollmentCount", (
    SELECT COALESCE(sum(p."Amount"), 0.0)
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c0 ON p."CourseId" = c0."Id"
    WHERE c0."Category" = c."Category" AND p."Status" = 'Completed') AS revenue
FROM "Courses" AS c
GROUP BY c."Category"
ORDER BY COALESCE(sum((
    SELECT count(*)::int
    FROM "Enrollments" AS e
    WHERE c."Id" = e."CourseId")), 0)::int DESC
2025-07-30 16:51:03.966 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT p0."Year", p0."Month", COALESCE(sum(p0."Amount"), 0.0) AS "Revenue", count(*)::int AS "TransactionCount"
FROM (
    SELECT p."Amount", date_part('year', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "Payments" AS p
    WHERE p."Status" = 'Completed' AND p."CreatedAt" >= @__sixMonthsAgo_0
) AS p0
GROUP BY p0."Year", p0."Month"
2025-07-30 16:51:03.968 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT a0."Year", a0."Month", count(*)::int AS "NewUsers"
FROM (
    SELECT date_part('year', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "AspNetUsers" AS a
    WHERE a."CreatedAt" >= @__sixMonthsAgo_0
) AS a0
GROUP BY a0."Year", a0."Month"
2025-07-30 16:51:03.970 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Subscriptions" AS s
WHERE s."Status" = 'Active'
2025-07-30 16:51:03.971 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s."PlanName" AS plan, count(*)::int AS count, COALESCE(sum(s."Price"), 0.0) AS "monthlyRevenue"
FROM "Subscriptions" AS s
WHERE s."Status" = 'Active'
GROUP BY s."PlanName"
2025-07-30 16:51:03.972 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType20`6[[<>f__AnonymousType21`5[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 16:51:03.973 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api) in 30.9175ms
2025-07-30 16:51:03.974 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-07-30 16:51:03.975 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/platform - 200 null application/json; charset=utf-8 44.5093ms
2025-07-30 16:51:08.401 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/platform - application/json null
2025-07-30 16:51:08.403 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:51:08.404 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 16:51:08.406 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-07-30 16:51:08.406 +08:00 [INF] Route matched with {action = "GetPlatformAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPlatformAnalytics() on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-30 16:51:08.408 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
2025-07-30 16:51:08.409 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
2025-07-30 16:51:08.411 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."Status" = 'Completed'
2025-07-30 16:51:08.412 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
2025-07-30 16:51:08.415 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id" AS "instructorId", a."FullName" AS "instructorName", (
    SELECT count(*)::int
    FROM "Courses" AS c0
    WHERE c0."InstructorId" = a."Id") AS "totalCourses", (
    SELECT count(*)::int
    FROM "Enrollments" AS e
    INNER JOIN "Courses" AS c1 ON e."CourseId" = c1."Id"
    WHERE c1."InstructorId" = a."Id") AS "totalStudents", (
    SELECT COALESCE(sum(p0."Amount"), 0.0)
    FROM "Payments" AS p0
    LEFT JOIN "Courses" AS c2 ON p0."CourseId" = c2."Id"
    WHERE c2."InstructorId" = a."Id" AND p0."Status" = 'Completed') AS "totalRevenue", COALESCE((
    SELECT avg(r."Rating"::double precision)
    FROM "Reviews" AS r
    INNER JOIN "Courses" AS c3 ON r."CourseId" = c3."Id"
    WHERE c3."InstructorId" = a."Id"), 0.0) AS "averageRating"
FROM "AspNetUsers" AS a
WHERE a."Role" = 'Instructor'
ORDER BY (
    SELECT COALESCE(sum(p."Amount"), 0.0)
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
    WHERE c."InstructorId" = a."Id" AND p."Status" = 'Completed') DESC
LIMIT @__p_0
2025-07-30 16:51:08.417 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT c."Category" AS category, count(*)::int AS "courseCount", COALESCE(sum((
    SELECT count(*)::int
    FROM "Enrollments" AS e
    WHERE c."Id" = e."CourseId")), 0)::int AS "enrollmentCount", (
    SELECT COALESCE(sum(p."Amount"), 0.0)
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c0 ON p."CourseId" = c0."Id"
    WHERE c0."Category" = c."Category" AND p."Status" = 'Completed') AS revenue
FROM "Courses" AS c
GROUP BY c."Category"
ORDER BY COALESCE(sum((
    SELECT count(*)::int
    FROM "Enrollments" AS e
    WHERE c."Id" = e."CourseId")), 0)::int DESC
2025-07-30 16:51:08.419 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT p0."Year", p0."Month", COALESCE(sum(p0."Amount"), 0.0) AS "Revenue", count(*)::int AS "TransactionCount"
FROM (
    SELECT p."Amount", date_part('year', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "Payments" AS p
    WHERE p."Status" = 'Completed' AND p."CreatedAt" >= @__sixMonthsAgo_0
) AS p0
GROUP BY p0."Year", p0."Month"
2025-07-30 16:51:08.420 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT a0."Year", a0."Month", count(*)::int AS "NewUsers"
FROM (
    SELECT date_part('year', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "AspNetUsers" AS a
    WHERE a."CreatedAt" >= @__sixMonthsAgo_0
) AS a0
GROUP BY a0."Year", a0."Month"
2025-07-30 16:51:08.422 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Subscriptions" AS s
WHERE s."Status" = 'Active'
2025-07-30 16:51:08.423 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s."PlanName" AS plan, count(*)::int AS count, COALESCE(sum(s."Price"), 0.0) AS "monthlyRevenue"
FROM "Subscriptions" AS s
WHERE s."Status" = 'Active'
GROUP BY s."PlanName"
2025-07-30 16:51:08.424 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType20`6[[<>f__AnonymousType21`5[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 16:51:08.425 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api) in 18.2561ms
2025-07-30 16:51:08.426 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-07-30 16:51:08.427 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/platform - 200 null application/json; charset=utf-8 25.3258ms
2025-07-30 16:51:08.428 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/course-completions - null null
2025-07-30 16:51:08.429 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:51:08.430 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/course-completions - 204 null null 1.5382ms
2025-07-30 16:51:08.431 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/course-completions - application/json null
2025-07-30 16:51:08.432 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:51:08.434 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 16:51:08.435 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetCourseCompletions (CeceLearningPortal.Api)'
2025-07-30 16:51:08.435 +08:00 [INF] Route matched with {action = "GetCourseCompletions", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourseCompletions(Int32) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 16:51:08.447 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT e0."Id", a."FullName", a."Avatar", a."Email", c."Title", e0."CourseId"::text, e0."CompletedAt", COALESCE(e0."AverageQuizScore", 0.0), e0."CertificateIssued", e0."CertificateUrl"
FROM (
    SELECT e."Id", e."AverageQuizScore", e."CertificateIssued", e."CertificateUrl", e."CompletedAt", e."CourseId", e."StudentId"
    FROM "Enrollments" AS e
    WHERE e."CompletedAt" IS NOT NULL
    ORDER BY e."CompletedAt" DESC
    LIMIT @__p_0
) AS e0
INNER JOIN "AspNetUsers" AS a ON e0."StudentId" = a."Id"
INNER JOIN "Courses" AS c ON e0."CourseId" = c."Id"
ORDER BY e0."CompletedAt" DESC
2025-07-30 16:51:08.448 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType9`10[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-30 16:51:08.449 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetCourseCompletions (CeceLearningPortal.Api) in 12.7316ms
2025-07-30 16:51:08.450 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetCourseCompletions (CeceLearningPortal.Api)'
2025-07-30 16:51:08.450 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/course-completions - 200 null application/json; charset=utf-8 19.07ms
2025-07-30 16:51:10.085 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users - null null
2025-07-30 16:51:10.086 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/subscription-plans - null null
2025-07-30 16:51:10.087 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:51:10.088 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:51:10.088 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users - 204 null null 2.9548ms
2025-07-30 16:51:10.089 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/subscription-plans - 204 null null 3.0393ms
2025-07-30 16:51:10.090 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/subscription-plans - application/json null
2025-07-30 16:51:10.091 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users - application/json null
2025-07-30 16:51:10.092 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:51:10.093 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:51:10.094 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 16:51:10.094 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 16:51:10.095 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetSubscriptionPlans (CeceLearningPortal.Api)'
2025-07-30 16:51:10.096 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUsers (CeceLearningPortal.Api)'
2025-07-30 16:51:10.097 +08:00 [INF] Route matched with {action = "GetSubscriptionPlans", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetSubscriptionPlans() on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 16:51:10.097 +08:00 [INF] Route matched with {action = "GetUsers", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUsers(CeceLearningPortal.Api.DTOs.UserManagementFilterDto) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 16:51:10.099 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."CreatedAt", s."Description", s."DisplayOrder", s."Features", s."HasAnalytics", s."HasPrioritySupport", s."HasUnlimitedAccess", s."IsActive", s."IsRecommended", s."MaxCourseAccess", s."MaxCoursesCanCreate", s."MaxStudentsPerCourse", s."MonthlyPrice", s."Name", s."PlanType", s."TransactionFeePercentage", s."UpdatedAt", s."YearlyPrice", s0."Id", s0."BillingCycle", s0."CreatedAt", s0."EndDate", s0."NextBillingDate", s0."PlanName", s0."Price", s0."StartDate", s0."Status", s0."StripeSubscriptionId", s0."SubscriptionPlanId", s0."UpdatedAt", s0."UserId"
FROM "SubscriptionPlans" AS s
LEFT JOIN "Subscriptions" AS s0 ON s."Id" = s0."SubscriptionPlanId"
ORDER BY s."Id"
2025-07-30 16:51:10.099 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
2025-07-30 16:51:10.100 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[CeceLearningPortal.Api.DTOs.SubscriptionPlanDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-30 16:51:10.101 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."UserName", a."Email", a."FullName", a."Role", a."Status", a."CreatedAt", a."LastLoginAt", a."EmailConfirmed"
FROM "AspNetUsers" AS a
ORDER BY a."CreatedAt" DESC
LIMIT @__p_1 OFFSET @__p_0
2025-07-30 16:51:10.101 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetSubscriptionPlans (CeceLearningPortal.Api) in 3.2361ms
2025-07-30 16:51:10.102 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[CeceLearningPortal.Api.DTOs.UserManagementDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-30 16:51:10.103 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetSubscriptionPlans (CeceLearningPortal.Api)'
2025-07-30 16:51:10.104 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUsers (CeceLearningPortal.Api) in 4.8023ms
2025-07-30 16:51:10.104 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/subscription-plans - 200 null application/json; charset=utf-8 13.9919ms
2025-07-30 16:51:10.105 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUsers (CeceLearningPortal.Api)'
2025-07-30 16:51:10.106 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users - 200 null application/json; charset=utf-8 14.8999ms
2025-07-30 16:51:10.108 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/b9030b04-2da7-449f-94de-d6d4814a8177/subscription - null null
2025-07-30 16:51:10.108 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/efead752-f0b3-48ab-93b8-7ba31e7574ba/subscription - null null
2025-07-30 16:51:10.108 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/e090c598-224f-4b4c-870a-3c3ef6303e0a/subscription - null null
2025-07-30 16:51:10.108 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/28b8e854-738a-4e69-835c-71299a8f9b21/subscription - null null
2025-07-30 16:51:10.109 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/801dc698-62a8-49c3-b578-b7c1b05049a4/subscription - null null
2025-07-30 16:51:10.109 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/f9f0e64e-3771-4aa9-8470-21e709677e44/subscription - null null
2025-07-30 16:51:10.109 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:51:10.110 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:51:10.111 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:51:10.113 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:51:10.114 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:51:10.115 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:51:10.116 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/b9030b04-2da7-449f-94de-d6d4814a8177/subscription - 204 null null 8.1001ms
2025-07-30 16:51:10.116 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/efead752-f0b3-48ab-93b8-7ba31e7574ba/subscription - 204 null null 8.2096ms
2025-07-30 16:51:10.116 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/e090c598-224f-4b4c-870a-3c3ef6303e0a/subscription - 204 null null 8.1986ms
2025-07-30 16:51:10.117 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/28b8e854-738a-4e69-835c-71299a8f9b21/subscription - 204 null null 8.3402ms
2025-07-30 16:51:10.117 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/801dc698-62a8-49c3-b578-b7c1b05049a4/subscription - 204 null null 8.454ms
2025-07-30 16:51:10.118 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/f9f0e64e-3771-4aa9-8470-21e709677e44/subscription - 204 null null 8.8775ms
2025-07-30 16:51:10.119 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/801dc698-62a8-49c3-b578-b7c1b05049a4/subscription - application/json null
2025-07-30 16:51:10.120 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/e090c598-224f-4b4c-870a-3c3ef6303e0a/subscription - application/json null
2025-07-30 16:51:10.121 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/b9030b04-2da7-449f-94de-d6d4814a8177/subscription - application/json null
2025-07-30 16:51:10.123 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/efead752-f0b3-48ab-93b8-7ba31e7574ba/subscription - application/json null
2025-07-30 16:51:10.124 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/28b8e854-738a-4e69-835c-71299a8f9b21/subscription - application/json null
2025-07-30 16:51:10.125 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/f9f0e64e-3771-4aa9-8470-21e709677e44/subscription - application/json null
2025-07-30 16:51:10.126 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:51:10.127 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:51:10.128 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:51:10.129 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:51:10.130 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:51:10.131 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:51:10.133 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 16:51:10.133 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 16:51:10.133 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 16:51:10.133 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 16:51:10.134 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 16:51:10.134 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 16:51:10.135 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 16:51:10.135 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 16:51:10.136 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 16:51:10.137 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 16:51:10.138 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 16:51:10.139 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 16:51:10.139 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 16:51:10.140 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 16:51:10.140 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 16:51:10.141 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 16:51:10.141 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 16:51:10.141 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 16:51:10.143 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 16:51:10.144 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 16:51:10.144 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 16:51:10.145 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 16:51:10.146 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 16:51:10.147 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 16:51:10.148 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType83`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 16:51:10.149 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType83`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 16:51:10.150 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType83`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 16:51:10.151 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType83`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 16:51:10.152 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType83`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 16:51:10.153 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType83`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 16:51:10.154 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 11.8988ms
2025-07-30 16:51:10.155 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 11.7013ms
2025-07-30 16:51:10.155 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 11.5997ms
2025-07-30 16:51:10.156 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 11.7579ms
2025-07-30 16:51:10.157 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 11.4386ms
2025-07-30 16:51:10.158 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 11.2812ms
2025-07-30 16:51:10.158 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 16:51:10.159 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 16:51:10.159 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 16:51:10.160 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 16:51:10.161 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 16:51:10.161 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 16:51:10.161 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/801dc698-62a8-49c3-b578-b7c1b05049a4/subscription - 200 null application/json; charset=utf-8 42.5679ms
2025-07-30 16:51:10.162 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/e090c598-224f-4b4c-870a-3c3ef6303e0a/subscription - 200 null application/json; charset=utf-8 41.7978ms
2025-07-30 16:51:10.162 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/b9030b04-2da7-449f-94de-d6d4814a8177/subscription - 200 null application/json; charset=utf-8 41.0453ms
2025-07-30 16:51:10.163 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/efead752-f0b3-48ab-93b8-7ba31e7574ba/subscription - 200 null application/json; charset=utf-8 40.071ms
2025-07-30 16:51:10.164 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/28b8e854-738a-4e69-835c-71299a8f9b21/subscription - 200 null application/json; charset=utf-8 39.5223ms
2025-07-30 16:51:10.164 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/f9f0e64e-3771-4aa9-8470-21e709677e44/subscription - 200 null application/json; charset=utf-8 38.8324ms
2025-07-30 16:51:37.308 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users - null null
2025-07-30 16:51:37.309 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:51:37.309 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users - 204 null null 1.607ms
2025-07-30 16:51:37.311 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users - application/json null
2025-07-30 16:51:37.312 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:51:37.313 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 16:51:37.314 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUsers (CeceLearningPortal.Api)'
2025-07-30 16:51:37.315 +08:00 [INF] Route matched with {action = "GetUsers", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUsers(CeceLearningPortal.Api.DTOs.UserManagementFilterDto) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 16:51:37.316 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
2025-07-30 16:51:37.318 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."UserName", a."Email", a."FullName", a."Role", a."Status", a."CreatedAt", a."LastLoginAt", a."EmailConfirmed"
FROM "AspNetUsers" AS a
ORDER BY a."CreatedAt" DESC
LIMIT @__p_1 OFFSET @__p_0
2025-07-30 16:51:37.319 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[CeceLearningPortal.Api.DTOs.UserManagementDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-30 16:51:37.319 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUsers (CeceLearningPortal.Api) in 3.6119ms
2025-07-30 16:51:37.320 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUsers (CeceLearningPortal.Api)'
2025-07-30 16:51:37.320 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users - 200 null application/json; charset=utf-8 9.8336ms
2025-07-30 16:51:37.328 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/b9030b04-2da7-449f-94de-d6d4814a8177/subscription - null null
2025-07-30 16:51:37.329 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/efead752-f0b3-48ab-93b8-7ba31e7574ba/subscription - null null
2025-07-30 16:51:37.329 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/e090c598-224f-4b4c-870a-3c3ef6303e0a/subscription - null null
2025-07-30 16:51:37.329 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/801dc698-62a8-49c3-b578-b7c1b05049a4/subscription - null null
2025-07-30 16:51:37.329 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/28b8e854-738a-4e69-835c-71299a8f9b21/subscription - null null
2025-07-30 16:51:37.329 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:51:37.329 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/f9f0e64e-3771-4aa9-8470-21e709677e44/subscription - null null
2025-07-30 16:51:37.331 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:51:37.332 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:51:37.333 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:51:37.334 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:51:37.334 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/b9030b04-2da7-449f-94de-d6d4814a8177/subscription - 204 null null 6.3647ms
2025-07-30 16:51:37.335 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:51:37.336 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/efead752-f0b3-48ab-93b8-7ba31e7574ba/subscription - 204 null null 7.1062ms
2025-07-30 16:51:37.336 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/e090c598-224f-4b4c-870a-3c3ef6303e0a/subscription - 204 null null 7.2891ms
2025-07-30 16:51:37.336 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/801dc698-62a8-49c3-b578-b7c1b05049a4/subscription - 204 null null 7.3937ms
2025-07-30 16:51:37.337 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/28b8e854-738a-4e69-835c-71299a8f9b21/subscription - 204 null null 7.6053ms
2025-07-30 16:51:37.338 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/b9030b04-2da7-449f-94de-d6d4814a8177/subscription - application/json null
2025-07-30 16:51:37.339 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/f9f0e64e-3771-4aa9-8470-21e709677e44/subscription - 204 null null 9.1061ms
2025-07-30 16:51:37.340 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/28b8e854-738a-4e69-835c-71299a8f9b21/subscription - application/json null
2025-07-30 16:51:37.341 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/efead752-f0b3-48ab-93b8-7ba31e7574ba/subscription - application/json null
2025-07-30 16:51:37.342 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/e090c598-224f-4b4c-870a-3c3ef6303e0a/subscription - application/json null
2025-07-30 16:51:37.343 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/801dc698-62a8-49c3-b578-b7c1b05049a4/subscription - application/json null
2025-07-30 16:51:37.344 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:51:37.346 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/f9f0e64e-3771-4aa9-8470-21e709677e44/subscription - application/json null
2025-07-30 16:51:37.346 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:51:37.348 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:51:37.349 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:51:37.350 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:51:37.351 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 16:51:37.351 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:51:37.352 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 16:51:37.352 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 16:51:37.353 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 16:51:37.353 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 16:51:37.354 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 16:51:37.355 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 16:51:37.355 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 16:51:37.356 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 16:51:37.357 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 16:51:37.358 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 16:51:37.358 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 16:51:37.359 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 16:51:37.359 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 16:51:37.360 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 16:51:37.360 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 16:51:37.361 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 16:51:37.362 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 16:51:37.362 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 16:51:37.363 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 16:51:37.364 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 16:51:37.365 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 16:51:37.366 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 16:51:37.367 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 16:51:37.367 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType83`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 16:51:37.368 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType83`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 16:51:37.369 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType83`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 16:51:37.370 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType83`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 16:51:37.371 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType83`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 16:51:37.372 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType83`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 16:51:37.373 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 11.515ms
2025-07-30 16:51:37.374 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 11.0005ms
2025-07-30 16:51:37.374 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 10.8874ms
2025-07-30 16:51:37.375 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 10.4374ms
2025-07-30 16:51:37.376 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 10.1826ms
2025-07-30 16:51:37.376 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 10.0315ms
2025-07-30 16:51:37.377 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 16:51:37.377 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 16:51:37.378 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 16:51:37.378 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 16:51:37.379 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 16:51:37.379 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 16:51:37.380 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/b9030b04-2da7-449f-94de-d6d4814a8177/subscription - 200 null application/json; charset=utf-8 41.6322ms
2025-07-30 16:51:37.380 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/28b8e854-738a-4e69-835c-71299a8f9b21/subscription - 200 null application/json; charset=utf-8 40.5051ms
2025-07-30 16:51:37.381 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/efead752-f0b3-48ab-93b8-7ba31e7574ba/subscription - 200 null application/json; charset=utf-8 39.9241ms
2025-07-30 16:51:37.382 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/e090c598-224f-4b4c-870a-3c3ef6303e0a/subscription - 200 null application/json; charset=utf-8 39.2996ms
2025-07-30 16:51:37.382 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/801dc698-62a8-49c3-b578-b7c1b05049a4/subscription - 200 null application/json; charset=utf-8 38.686ms
2025-07-30 16:51:37.383 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/f9f0e64e-3771-4aa9-8470-21e709677e44/subscription - 200 null application/json; charset=utf-8 37.0541ms
2025-07-30 16:54:01.066 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users - null null
2025-07-30 16:54:01.067 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/subscription-plans - null null
2025-07-30 16:54:01.068 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:54:01.069 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:54:01.070 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users - 204 null null 3.2474ms
2025-07-30 16:54:01.070 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/subscription-plans - 204 null null 3.6729ms
2025-07-30 16:54:01.072 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/subscription-plans - application/json null
2025-07-30 16:54:01.073 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users - application/json null
2025-07-30 16:54:01.074 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:54:01.075 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:54:01.122 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 16:54:01.123 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUsers (CeceLearningPortal.Api)'
2025-07-30 16:54:01.124 +08:00 [INF] Route matched with {action = "GetUsers", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUsers(CeceLearningPortal.Api.DTOs.UserManagementFilterDto) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 16:54:01.126 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
2025-07-30 16:54:01.126 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 16:54:01.127 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."UserName", a."Email", a."FullName", a."Role", a."Status", a."CreatedAt", a."LastLoginAt", a."EmailConfirmed"
FROM "AspNetUsers" AS a
ORDER BY a."CreatedAt" DESC
LIMIT @__p_1 OFFSET @__p_0
2025-07-30 16:54:01.128 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetSubscriptionPlans (CeceLearningPortal.Api)'
2025-07-30 16:54:01.129 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[CeceLearningPortal.Api.DTOs.UserManagementDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-30 16:54:01.129 +08:00 [INF] Route matched with {action = "GetSubscriptionPlans", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetSubscriptionPlans() on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 16:54:01.130 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUsers (CeceLearningPortal.Api) in 5.4361ms
2025-07-30 16:54:01.131 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUsers (CeceLearningPortal.Api)'
2025-07-30 16:54:01.132 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users - 200 null application/json; charset=utf-8 58.8082ms
2025-07-30 16:54:01.132 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."CreatedAt", s."Description", s."DisplayOrder", s."Features", s."HasAnalytics", s."HasPrioritySupport", s."HasUnlimitedAccess", s."IsActive", s."IsRecommended", s."MaxCourseAccess", s."MaxCoursesCanCreate", s."MaxStudentsPerCourse", s."MonthlyPrice", s."Name", s."PlanType", s."TransactionFeePercentage", s."UpdatedAt", s."YearlyPrice", s0."Id", s0."BillingCycle", s0."CreatedAt", s0."EndDate", s0."NextBillingDate", s0."PlanName", s0."Price", s0."StartDate", s0."Status", s0."StripeSubscriptionId", s0."SubscriptionPlanId", s0."UpdatedAt", s0."UserId"
FROM "SubscriptionPlans" AS s
LEFT JOIN "Subscriptions" AS s0 ON s."Id" = s0."SubscriptionPlanId"
ORDER BY s."Id"
2025-07-30 16:54:01.133 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/b9030b04-2da7-449f-94de-d6d4814a8177/subscription - null null
2025-07-30 16:54:01.135 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[CeceLearningPortal.Api.DTOs.SubscriptionPlanDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-30 16:54:01.135 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/efead752-f0b3-48ab-93b8-7ba31e7574ba/subscription - null null
2025-07-30 16:54:01.135 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/e090c598-224f-4b4c-870a-3c3ef6303e0a/subscription - null null
2025-07-30 16:54:01.135 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/801dc698-62a8-49c3-b578-b7c1b05049a4/subscription - null null
2025-07-30 16:54:01.135 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/28b8e854-738a-4e69-835c-71299a8f9b21/subscription - null null
2025-07-30 16:54:01.136 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:54:01.137 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetSubscriptionPlans (CeceLearningPortal.Api) in 5.7924ms
2025-07-30 16:54:01.138 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:54:01.139 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:54:01.140 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:54:01.141 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:54:01.141 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/b9030b04-2da7-449f-94de-d6d4814a8177/subscription - 204 null null 7.7444ms
2025-07-30 16:54:01.142 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetSubscriptionPlans (CeceLearningPortal.Api)'
2025-07-30 16:54:01.142 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/efead752-f0b3-48ab-93b8-7ba31e7574ba/subscription - 204 null null 7.0359ms
2025-07-30 16:54:01.142 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/e090c598-224f-4b4c-870a-3c3ef6303e0a/subscription - 204 null null 7.3507ms
2025-07-30 16:54:01.143 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/801dc698-62a8-49c3-b578-b7c1b05049a4/subscription - 204 null null 7.7356ms
2025-07-30 16:54:01.143 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/28b8e854-738a-4e69-835c-71299a8f9b21/subscription - 204 null null 8.0631ms
2025-07-30 16:54:01.145 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/f9f0e64e-3771-4aa9-8470-21e709677e44/subscription - null null
2025-07-30 16:54:01.145 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/subscription-plans - 200 null application/json; charset=utf-8 73.3394ms
2025-07-30 16:54:01.146 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/b9030b04-2da7-449f-94de-d6d4814a8177/subscription - application/json null
2025-07-30 16:54:01.148 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/efead752-f0b3-48ab-93b8-7ba31e7574ba/subscription - application/json null
2025-07-30 16:54:01.149 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/e090c598-224f-4b4c-870a-3c3ef6303e0a/subscription - application/json null
2025-07-30 16:54:01.150 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/801dc698-62a8-49c3-b578-b7c1b05049a4/subscription - application/json null
2025-07-30 16:54:01.152 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:54:01.153 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/28b8e854-738a-4e69-835c-71299a8f9b21/subscription - application/json null
2025-07-30 16:54:01.154 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:54:01.155 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:54:01.156 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:54:01.157 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:54:01.158 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/f9f0e64e-3771-4aa9-8470-21e709677e44/subscription - 204 null null 12.9924ms
2025-07-30 16:54:01.159 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:54:01.160 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 16:54:01.160 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 16:54:01.162 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/f9f0e64e-3771-4aa9-8470-21e709677e44/subscription - application/json null
2025-07-30 16:54:01.163 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 16:54:01.164 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 16:54:01.165 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:54:01.166 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 16:54:01.167 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 16:54:01.168 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 16:54:01.170 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 16:54:01.170 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 16:54:01.172 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType83`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 16:54:01.172 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 16:54:01.173 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 5.0824ms
2025-07-30 16:54:01.175 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 16:54:01.176 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/b9030b04-2da7-449f-94de-d6d4814a8177/subscription - 200 null application/json; charset=utf-8 29.646ms
2025-07-30 16:54:01.176 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 16:54:01.180 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType83`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 16:54:01.181 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 6.699ms
2025-07-30 16:54:01.182 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 16:54:01.183 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/f9f0e64e-3771-4aa9-8470-21e709677e44/subscription - 200 null application/json; charset=utf-8 21.0528ms
2025-07-30 16:54:01.216 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 16:54:01.218 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 16:54:01.219 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 16:54:01.219 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 16:54:01.221 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 16:54:01.222 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 16:54:01.224 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType83`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 16:54:01.224 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 16:54:01.225 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 5.2668ms
2025-07-30 16:54:01.226 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 16:54:01.228 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 16:54:01.228 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 16:54:01.229 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 16:54:01.231 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType83`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 16:54:01.232 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/e090c598-224f-4b4c-870a-3c3ef6303e0a/subscription - 200 null application/json; charset=utf-8 82.6959ms
2025-07-30 16:54:01.232 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 16:54:01.233 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 16:54:01.233 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 6.6231ms
2025-07-30 16:54:01.239 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType83`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 16:54:01.239 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 16:54:01.240 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 16:54:01.240 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 71.2831ms
2025-07-30 16:54:01.241 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/801dc698-62a8-49c3-b578-b7c1b05049a4/subscription - 200 null application/json; charset=utf-8 90.5648ms
2025-07-30 16:54:01.243 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType83`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 16:54:01.243 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 16:54:01.246 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 9.103ms
2025-07-30 16:54:01.247 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/efead752-f0b3-48ab-93b8-7ba31e7574ba/subscription - 200 null application/json; charset=utf-8 99.1011ms
2025-07-30 16:54:01.248 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 16:54:01.250 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/28b8e854-738a-4e69-835c-71299a8f9b21/subscription - 200 null application/json; charset=utf-8 97.1783ms
2025-07-30 16:54:21.073 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users - null null
2025-07-30 16:54:21.073 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/subscription-plans - null null
2025-07-30 16:54:21.074 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:54:21.075 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:54:21.075 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users - 204 null null 2.3892ms
2025-07-30 16:54:21.076 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/subscription-plans - 204 null null 2.5417ms
2025-07-30 16:54:21.077 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/subscription-plans - application/json null
2025-07-30 16:54:21.078 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users - application/json null
2025-07-30 16:54:21.079 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:54:21.080 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:54:21.081 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 16:54:21.081 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 16:54:21.082 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetSubscriptionPlans (CeceLearningPortal.Api)'
2025-07-30 16:54:21.083 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUsers (CeceLearningPortal.Api)'
2025-07-30 16:54:21.083 +08:00 [INF] Route matched with {action = "GetSubscriptionPlans", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetSubscriptionPlans() on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 16:54:21.084 +08:00 [INF] Route matched with {action = "GetUsers", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUsers(CeceLearningPortal.Api.DTOs.UserManagementFilterDto) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 16:54:21.086 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
2025-07-30 16:54:21.086 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."CreatedAt", s."Description", s."DisplayOrder", s."Features", s."HasAnalytics", s."HasPrioritySupport", s."HasUnlimitedAccess", s."IsActive", s."IsRecommended", s."MaxCourseAccess", s."MaxCoursesCanCreate", s."MaxStudentsPerCourse", s."MonthlyPrice", s."Name", s."PlanType", s."TransactionFeePercentage", s."UpdatedAt", s."YearlyPrice", s0."Id", s0."BillingCycle", s0."CreatedAt", s0."EndDate", s0."NextBillingDate", s0."PlanName", s0."Price", s0."StartDate", s0."Status", s0."StripeSubscriptionId", s0."SubscriptionPlanId", s0."UpdatedAt", s0."UserId"
FROM "SubscriptionPlans" AS s
LEFT JOIN "Subscriptions" AS s0 ON s."Id" = s0."SubscriptionPlanId"
ORDER BY s."Id"
2025-07-30 16:54:21.087 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."UserName", a."Email", a."FullName", a."Role", a."Status", a."CreatedAt", a."LastLoginAt", a."EmailConfirmed"
FROM "AspNetUsers" AS a
ORDER BY a."CreatedAt" DESC
LIMIT @__p_1 OFFSET @__p_0
2025-07-30 16:54:21.088 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[CeceLearningPortal.Api.DTOs.SubscriptionPlanDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-30 16:54:21.089 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[CeceLearningPortal.Api.DTOs.UserManagementDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-30 16:54:21.089 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetSubscriptionPlans (CeceLearningPortal.Api) in 4.5956ms
2025-07-30 16:54:21.090 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUsers (CeceLearningPortal.Api) in 4.4361ms
2025-07-30 16:54:21.090 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetSubscriptionPlans (CeceLearningPortal.Api)'
2025-07-30 16:54:21.091 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUsers (CeceLearningPortal.Api)'
2025-07-30 16:54:21.091 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/subscription-plans - 200 null application/json; charset=utf-8 14.4359ms
2025-07-30 16:54:21.092 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users - 200 null application/json; charset=utf-8 13.7506ms
2025-07-30 16:54:21.093 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/efead752-f0b3-48ab-93b8-7ba31e7574ba/subscription - null null
2025-07-30 16:54:21.093 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/e090c598-224f-4b4c-870a-3c3ef6303e0a/subscription - null null
2025-07-30 16:54:21.093 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/801dc698-62a8-49c3-b578-b7c1b05049a4/subscription - null null
2025-07-30 16:54:21.093 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/28b8e854-738a-4e69-835c-71299a8f9b21/subscription - null null
2025-07-30 16:54:21.094 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/f9f0e64e-3771-4aa9-8470-21e709677e44/subscription - null null
2025-07-30 16:54:21.094 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/b9030b04-2da7-449f-94de-d6d4814a8177/subscription - null null
2025-07-30 16:54:21.095 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:54:21.096 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:54:21.097 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:54:21.098 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:54:21.099 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:54:21.100 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:54:21.100 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/efead752-f0b3-48ab-93b8-7ba31e7574ba/subscription - 204 null null 7.1871ms
2025-07-30 16:54:21.101 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/e090c598-224f-4b4c-870a-3c3ef6303e0a/subscription - 204 null null 7.4935ms
2025-07-30 16:54:21.101 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/801dc698-62a8-49c3-b578-b7c1b05049a4/subscription - 204 null null 7.7273ms
2025-07-30 16:54:21.102 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/28b8e854-738a-4e69-835c-71299a8f9b21/subscription - 204 null null 8.1098ms
2025-07-30 16:54:21.102 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/f9f0e64e-3771-4aa9-8470-21e709677e44/subscription - 204 null null 8.414ms
2025-07-30 16:54:21.102 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/b9030b04-2da7-449f-94de-d6d4814a8177/subscription - 204 null null 8.2628ms
2025-07-30 16:54:21.104 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/efead752-f0b3-48ab-93b8-7ba31e7574ba/subscription - application/json null
2025-07-30 16:54:21.105 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/801dc698-62a8-49c3-b578-b7c1b05049a4/subscription - application/json null
2025-07-30 16:54:21.106 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/e090c598-224f-4b4c-870a-3c3ef6303e0a/subscription - application/json null
2025-07-30 16:54:21.107 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/28b8e854-738a-4e69-835c-71299a8f9b21/subscription - application/json null
2025-07-30 16:54:21.109 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/f9f0e64e-3771-4aa9-8470-21e709677e44/subscription - application/json null
2025-07-30 16:54:21.110 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/b9030b04-2da7-449f-94de-d6d4814a8177/subscription - application/json null
2025-07-30 16:54:21.111 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:54:21.111 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:54:21.112 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:54:21.113 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:54:21.114 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:54:21.115 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:54:21.116 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 16:54:21.116 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 16:54:21.117 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 16:54:21.117 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 16:54:21.117 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 16:54:21.118 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 16:54:21.119 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 16:54:21.119 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 16:54:21.120 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 16:54:21.121 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 16:54:21.122 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 16:54:21.122 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 16:54:21.123 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 16:54:21.124 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 16:54:21.124 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 16:54:21.124 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 16:54:21.125 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 16:54:21.126 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 16:54:21.126 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 16:54:21.128 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 16:54:21.128 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 16:54:21.129 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 16:54:21.130 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 16:54:21.130 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 16:54:21.131 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType83`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 16:54:21.132 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType83`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 16:54:21.133 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType83`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 16:54:21.134 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType83`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 16:54:21.135 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType83`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 16:54:21.136 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType83`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 16:54:21.137 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 11.1563ms
2025-07-30 16:54:21.137 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 9.8137ms
2025-07-30 16:54:21.138 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 11.1905ms
2025-07-30 16:54:21.138 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 10.2681ms
2025-07-30 16:54:21.139 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 10.0637ms
2025-07-30 16:54:21.140 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 9.8095ms
2025-07-30 16:54:21.140 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 16:54:21.141 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 16:54:21.141 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 16:54:21.142 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 16:54:21.142 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 16:54:21.143 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 16:54:21.143 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/efead752-f0b3-48ab-93b8-7ba31e7574ba/subscription - 200 null application/json; charset=utf-8 39.4231ms
2025-07-30 16:54:21.144 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/e090c598-224f-4b4c-870a-3c3ef6303e0a/subscription - 200 null application/json; charset=utf-8 37.5724ms
2025-07-30 16:54:21.144 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/801dc698-62a8-49c3-b578-b7c1b05049a4/subscription - 200 null application/json; charset=utf-8 39.213ms
2025-07-30 16:54:21.145 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/28b8e854-738a-4e69-835c-71299a8f9b21/subscription - 200 null application/json; charset=utf-8 37.2923ms
2025-07-30 16:54:21.145 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/f9f0e64e-3771-4aa9-8470-21e709677e44/subscription - 200 null application/json; charset=utf-8 36.5654ms
2025-07-30 16:54:21.146 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/b9030b04-2da7-449f-94de-d6d4814a8177/subscription - 200 null application/json; charset=utf-8 36.0642ms
2025-07-30 16:54:45.078 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users - null null
2025-07-30 16:54:45.078 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/subscription-plans - null null
2025-07-30 16:54:45.079 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:54:45.080 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:54:45.081 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users - 204 null null 2.7434ms
2025-07-30 16:54:45.081 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/subscription-plans - 204 null null 3.048ms
2025-07-30 16:54:45.082 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/subscription-plans - application/json null
2025-07-30 16:54:45.084 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users - application/json null
2025-07-30 16:54:45.085 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:54:45.086 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:54:45.087 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 16:54:45.087 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 16:54:45.088 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUsers (CeceLearningPortal.Api)'
2025-07-30 16:54:45.089 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetSubscriptionPlans (CeceLearningPortal.Api)'
2025-07-30 16:54:45.089 +08:00 [INF] Route matched with {action = "GetUsers", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUsers(CeceLearningPortal.Api.DTOs.UserManagementFilterDto) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 16:54:45.090 +08:00 [INF] Route matched with {action = "GetSubscriptionPlans", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetSubscriptionPlans() on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 16:54:45.091 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
2025-07-30 16:54:45.092 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."CreatedAt", s."Description", s."DisplayOrder", s."Features", s."HasAnalytics", s."HasPrioritySupport", s."HasUnlimitedAccess", s."IsActive", s."IsRecommended", s."MaxCourseAccess", s."MaxCoursesCanCreate", s."MaxStudentsPerCourse", s."MonthlyPrice", s."Name", s."PlanType", s."TransactionFeePercentage", s."UpdatedAt", s."YearlyPrice", s0."Id", s0."BillingCycle", s0."CreatedAt", s0."EndDate", s0."NextBillingDate", s0."PlanName", s0."Price", s0."StartDate", s0."Status", s0."StripeSubscriptionId", s0."SubscriptionPlanId", s0."UpdatedAt", s0."UserId"
FROM "SubscriptionPlans" AS s
LEFT JOIN "Subscriptions" AS s0 ON s."Id" = s0."SubscriptionPlanId"
ORDER BY s."Id"
2025-07-30 16:54:45.093 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."UserName", a."Email", a."FullName", a."Role", a."Status", a."CreatedAt", a."LastLoginAt", a."EmailConfirmed"
FROM "AspNetUsers" AS a
ORDER BY a."CreatedAt" DESC
LIMIT @__p_1 OFFSET @__p_0
2025-07-30 16:54:45.093 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[CeceLearningPortal.Api.DTOs.SubscriptionPlanDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-30 16:54:45.094 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[CeceLearningPortal.Api.DTOs.UserManagementDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-30 16:54:45.095 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetSubscriptionPlans (CeceLearningPortal.Api) in 3.6295ms
2025-07-30 16:54:45.095 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUsers (CeceLearningPortal.Api) in 5.0516ms
2025-07-30 16:54:45.096 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetSubscriptionPlans (CeceLearningPortal.Api)'
2025-07-30 16:54:45.097 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUsers (CeceLearningPortal.Api)'
2025-07-30 16:54:45.097 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/subscription-plans - 200 null application/json; charset=utf-8 14.7611ms
2025-07-30 16:54:45.098 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users - 200 null application/json; charset=utf-8 13.9968ms
2025-07-30 16:54:45.099 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/efead752-f0b3-48ab-93b8-7ba31e7574ba/subscription - null null
2025-07-30 16:54:45.099 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/e090c598-224f-4b4c-870a-3c3ef6303e0a/subscription - null null
2025-07-30 16:54:45.100 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/28b8e854-738a-4e69-835c-71299a8f9b21/subscription - null null
2025-07-30 16:54:45.100 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/801dc698-62a8-49c3-b578-b7c1b05049a4/subscription - null null
2025-07-30 16:54:45.100 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/f9f0e64e-3771-4aa9-8470-21e709677e44/subscription - null null
2025-07-30 16:54:45.101 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/b9030b04-2da7-449f-94de-d6d4814a8177/subscription - null null
2025-07-30 16:54:45.102 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:54:45.103 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:54:45.104 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:54:45.105 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:54:45.106 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:54:45.107 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:54:45.107 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/efead752-f0b3-48ab-93b8-7ba31e7574ba/subscription - 204 null null 8.292ms
2025-07-30 16:54:45.107 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/e090c598-224f-4b4c-870a-3c3ef6303e0a/subscription - 204 null null 8.0855ms
2025-07-30 16:54:45.108 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/28b8e854-738a-4e69-835c-71299a8f9b21/subscription - 204 null null 8.2367ms
2025-07-30 16:54:45.108 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/801dc698-62a8-49c3-b578-b7c1b05049a4/subscription - 204 null null 8.4116ms
2025-07-30 16:54:45.109 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/f9f0e64e-3771-4aa9-8470-21e709677e44/subscription - 204 null null 8.8162ms
2025-07-30 16:54:45.109 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/b9030b04-2da7-449f-94de-d6d4814a8177/subscription - 204 null null 8.5561ms
2025-07-30 16:54:45.111 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/b9030b04-2da7-449f-94de-d6d4814a8177/subscription - application/json null
2025-07-30 16:54:45.112 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/801dc698-62a8-49c3-b578-b7c1b05049a4/subscription - application/json null
2025-07-30 16:54:45.113 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/e090c598-224f-4b4c-870a-3c3ef6303e0a/subscription - application/json null
2025-07-30 16:54:45.114 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/efead752-f0b3-48ab-93b8-7ba31e7574ba/subscription - application/json null
2025-07-30 16:54:45.115 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/28b8e854-738a-4e69-835c-71299a8f9b21/subscription - application/json null
2025-07-30 16:54:45.116 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/f9f0e64e-3771-4aa9-8470-21e709677e44/subscription - application/json null
2025-07-30 16:54:45.118 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:54:45.119 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:54:45.120 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:54:45.121 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:54:45.122 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:54:45.122 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:54:45.124 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 16:54:45.124 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 16:54:45.124 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 16:54:45.124 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 16:54:45.125 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 16:54:45.125 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 16:54:45.126 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 16:54:45.126 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 16:54:45.127 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 16:54:45.128 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 16:54:45.129 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 16:54:45.130 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 16:54:45.130 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 16:54:45.131 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 16:54:45.131 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 16:54:45.132 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 16:54:45.132 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 16:54:45.133 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 16:54:45.134 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 16:54:45.135 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 16:54:45.136 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 16:54:45.136 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 16:54:45.137 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 16:54:45.138 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 16:54:45.139 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType83`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 16:54:45.140 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType83`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 16:54:45.141 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType83`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 16:54:45.142 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType83`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 16:54:45.143 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType83`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 16:54:45.144 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType83`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 16:54:45.145 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 11.1636ms
2025-07-30 16:54:45.145 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 10.9636ms
2025-07-30 16:54:45.146 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 10.8152ms
2025-07-30 16:54:45.146 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 10.6492ms
2025-07-30 16:54:45.147 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 10.3834ms
2025-07-30 16:54:45.148 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 10.198ms
2025-07-30 16:54:45.148 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 16:54:45.149 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 16:54:45.149 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 16:54:45.150 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 16:54:45.150 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 16:54:45.151 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 16:54:45.152 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/b9030b04-2da7-449f-94de-d6d4814a8177/subscription - 200 null application/json; charset=utf-8 41.0189ms
2025-07-30 16:54:45.152 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/801dc698-62a8-49c3-b578-b7c1b05049a4/subscription - 200 null application/json; charset=utf-8 40.4534ms
2025-07-30 16:54:45.153 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/e090c598-224f-4b4c-870a-3c3ef6303e0a/subscription - 200 null application/json; charset=utf-8 39.7904ms
2025-07-30 16:54:45.153 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/efead752-f0b3-48ab-93b8-7ba31e7574ba/subscription - 200 null application/json; charset=utf-8 39.1298ms
2025-07-30 16:54:45.154 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/28b8e854-738a-4e69-835c-71299a8f9b21/subscription - 200 null application/json; charset=utf-8 38.4158ms
2025-07-30 16:54:45.154 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/f9f0e64e-3771-4aa9-8470-21e709677e44/subscription - 200 null application/json; charset=utf-8 37.7285ms
2025-07-30 16:56:04.281 +08:00 [INF] Checking database connection...
2025-07-30 16:56:04.952 +08:00 [INF] Database connection successful.
2025-07-30 16:56:04.952 +08:00 [INF] Attempting to apply migrations...
2025-07-30 16:56:05.044 +08:00 [INF] Executed DbCommand (12ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-07-30 16:56:05.292 +08:00 [WRN] Migration failed. This might be due to pending model changes. Continuing anyway...
System.InvalidOperationException: An error was generated for warning 'Microsoft.EntityFrameworkCore.Migrations.PendingModelChangesWarning': The model for context 'ApplicationDbContext' has pending changes. Add a new migration before updating the database. See https://aka.ms/efcore-docs-pending-changes. This exception can be suppressed or logged by passing event ID 'RelationalEventId.PendingModelChangesWarning' to the 'ConfigureWarnings' method in 'DbContext.OnConfiguring' or 'AddDbContext'.
   at Microsoft.EntityFrameworkCore.Diagnostics.EventDefinition`1.Log[TLoggerCategory](IDiagnosticsLogger`1 logger, TParam arg)
   at Microsoft.EntityFrameworkCore.Diagnostics.RelationalLoggerExtensions.PendingModelChangesWarning(IDiagnosticsLogger`1 diagnostics, Type contextType)
   at Microsoft.EntityFrameworkCore.Migrations.Internal.Migrator.ValidateMigrations(Boolean useTransaction, String targetMigration)
   at Microsoft.EntityFrameworkCore.Migrations.Internal.Migrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Program.cs:line 226
2025-07-30 16:56:05.303 +08:00 [INF] Starting data seeding...
2025-07-30 16:56:05.319 +08:00 [INF] User profile is available. Using 'C:\Users\User\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-07-30 16:56:05.437 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Courses" AS c)
2025-07-30 16:56:05.439 +08:00 [INF] Database already contains data. Skipping seed.
2025-07-30 16:56:05.439 +08:00 [INF] Data seeding completed.
2025-07-30 16:56:05.478 +08:00 [INF] Now listening on: http://localhost:5295
2025-07-30 16:56:05.480 +08:00 [INF] Application started. Press Ctrl+C to shut down.
2025-07-30 16:56:05.480 +08:00 [INF] Hosting environment: Development
2025-07-30 16:56:05.480 +08:00 [INF] Content root path: D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api
2025-07-30 16:58:27.099 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users - null null
2025-07-30 16:58:27.099 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/subscription-plans - null null
2025-07-30 16:58:27.132 +08:00 [WRN] Failed to determine the https port for redirect.
2025-07-30 16:58:27.132 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:58:27.132 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:58:27.136 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users - 204 null null 37.1884ms
2025-07-30 16:58:27.136 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/subscription-plans - 204 null null 37.2046ms
2025-07-30 16:58:27.139 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/subscription-plans - application/json null
2025-07-30 16:58:27.139 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users - application/json null
2025-07-30 16:58:27.144 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:58:27.144 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:58:27.258 +08:00 [INF] Executed DbCommand (7ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 16:58:27.263 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUsers (CeceLearningPortal.Api)'
2025-07-30 16:58:27.275 +08:00 [INF] Route matched with {action = "GetUsers", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUsers(CeceLearningPortal.Api.DTOs.UserManagementFilterDto) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 16:58:27.326 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
2025-07-30 16:58:27.342 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."UserName", a."Email", a."FullName", a."Role", a."Status", a."CreatedAt", a."LastLoginAt", a."EmailConfirmed"
FROM "AspNetUsers" AS a
ORDER BY a."CreatedAt" DESC
LIMIT @__p_1 OFFSET @__p_0
2025-07-30 16:58:27.350 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[CeceLearningPortal.Api.DTOs.UserManagementDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-30 16:58:27.375 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUsers (CeceLearningPortal.Api) in 97.4753ms
2025-07-30 16:58:27.375 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUsers (CeceLearningPortal.Api)'
2025-07-30 16:58:27.378 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users - 200 null application/json; charset=utf-8 238.8149ms
2025-07-30 16:58:27.378 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/b9030b04-2da7-449f-94de-d6d4814a8177/subscription - null null
2025-07-30 16:58:27.378 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:58:27.378 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/b9030b04-2da7-449f-94de-d6d4814a8177/subscription - 204 null null 0.333ms
2025-07-30 16:58:27.380 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/e090c598-224f-4b4c-870a-3c3ef6303e0a/subscription - null null
2025-07-30 16:58:27.380 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/efead752-f0b3-48ab-93b8-7ba31e7574ba/subscription - null null
2025-07-30 16:58:27.380 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/801dc698-62a8-49c3-b578-b7c1b05049a4/subscription - null null
2025-07-30 16:58:27.380 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/28b8e854-738a-4e69-835c-71299a8f9b21/subscription - null null
2025-07-30 16:58:27.381 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/f9f0e64e-3771-4aa9-8470-21e709677e44/subscription - null null
2025-07-30 16:58:27.381 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:58:27.381 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:58:27.381 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:58:27.381 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:58:27.381 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:58:27.381 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/e090c598-224f-4b4c-870a-3c3ef6303e0a/subscription - 204 null null 1.0042ms
2025-07-30 16:58:27.381 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/801dc698-62a8-49c3-b578-b7c1b05049a4/subscription - 204 null null 0.938ms
2025-07-30 16:58:27.381 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/f9f0e64e-3771-4aa9-8470-21e709677e44/subscription - 204 null null 0.6092ms
2025-07-30 16:58:27.381 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/28b8e854-738a-4e69-835c-71299a8f9b21/subscription - 204 null null 1.0011ms
2025-07-30 16:58:27.381 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/efead752-f0b3-48ab-93b8-7ba31e7574ba/subscription - 204 null null 1.2816ms
2025-07-30 16:58:27.382 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/b9030b04-2da7-449f-94de-d6d4814a8177/subscription - application/json null
2025-07-30 16:58:27.383 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:58:27.383 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/e090c598-224f-4b4c-870a-3c3ef6303e0a/subscription - application/json null
2025-07-30 16:58:27.383 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/efead752-f0b3-48ab-93b8-7ba31e7574ba/subscription - application/json null
2025-07-30 16:58:27.383 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:58:27.383 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:58:27.383 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/801dc698-62a8-49c3-b578-b7c1b05049a4/subscription - application/json null
2025-07-30 16:58:27.383 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/f9f0e64e-3771-4aa9-8470-21e709677e44/subscription - application/json null
2025-07-30 16:58:27.383 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:58:27.383 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:58:27.387 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 16:58:27.388 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 16:58:27.391 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 16:58:27.408 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 16:58:27.409 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetSubscriptionPlans (CeceLearningPortal.Api)'
2025-07-30 16:58:27.411 +08:00 [INF] Route matched with {action = "GetSubscriptionPlans", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetSubscriptionPlans() on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 16:58:27.439 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 16:58:27.440 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 16:58:27.440 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 16:58:27.449 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 16:58:27.450 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 16:58:27.450 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 16:58:27.452 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 16:58:27.452 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 16:58:27.452 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 16:58:27.452 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 16:58:27.452 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 16:58:27.453 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType83`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 16:58:27.453 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType83`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 16:58:27.453 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 16:58:27.453 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType83`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 16:58:27.454 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."CreatedAt", s."Description", s."DisplayOrder", s."Features", s."HasAnalytics", s."HasPrioritySupport", s."HasUnlimitedAccess", s."IsActive", s."IsRecommended", s."MaxCourseAccess", s."MaxCoursesCanCreate", s."MaxStudentsPerCourse", s."MonthlyPrice", s."Name", s."PlanType", s."TransactionFeePercentage", s."UpdatedAt", s."YearlyPrice", s0."Id", s0."BillingCycle", s0."CreatedAt", s0."EndDate", s0."NextBillingDate", s0."PlanName", s0."Price", s0."StartDate", s0."Status", s0."StripeSubscriptionId", s0."SubscriptionPlanId", s0."UpdatedAt", s0."UserId"
FROM "SubscriptionPlans" AS s
LEFT JOIN "Subscriptions" AS s0 ON s."Id" = s0."SubscriptionPlanId"
ORDER BY s."Id"
2025-07-30 16:58:27.455 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[CeceLearningPortal.Api.DTOs.SubscriptionPlanDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-30 16:58:27.455 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 16:58:27.455 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType83`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 16:58:27.455 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 16:58:27.455 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 16:58:27.456 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 16:58:27.457 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 16:58:27.457 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType83`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 16:58:27.459 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 9.1846ms
2025-07-30 16:58:27.459 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 6.9608ms
2025-07-30 16:58:27.459 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 16:58:27.459 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 68.4658ms
2025-07-30 16:58:27.459 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetSubscriptionPlans (CeceLearningPortal.Api) in 47.7355ms
2025-07-30 16:58:27.459 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 3.521ms
2025-07-30 16:58:27.459 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 19.0843ms
2025-07-30 16:58:27.459 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 16:58:27.460 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 16:58:27.459 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 16:58:27.460 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/b9030b04-2da7-449f-94de-d6d4814a8177/subscription - 200 null application/json; charset=utf-8 77.1674ms
2025-07-30 16:58:27.459 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetSubscriptionPlans (CeceLearningPortal.Api)'
2025-07-30 16:58:27.460 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/f9f0e64e-3771-4aa9-8470-21e709677e44/subscription - 200 null application/json; charset=utf-8 76.3113ms
2025-07-30 16:58:27.459 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/801dc698-62a8-49c3-b578-b7c1b05049a4/subscription - 200 null application/json; charset=utf-8 76.1146ms
2025-07-30 16:58:27.459 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 16:58:27.460 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/e090c598-224f-4b4c-870a-3c3ef6303e0a/subscription - 200 null application/json; charset=utf-8 76.6761ms
2025-07-30 16:58:27.460 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/efead752-f0b3-48ab-93b8-7ba31e7574ba/subscription - 200 null application/json; charset=utf-8 76.8483ms
2025-07-30 16:58:27.460 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/subscription-plans - 200 null application/json; charset=utf-8 321.0576ms
2025-07-30 16:58:27.462 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/28b8e854-738a-4e69-835c-71299a8f9b21/subscription - application/json null
2025-07-30 16:58:27.462 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:58:27.463 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 16:58:27.463 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 16:58:27.463 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 16:58:27.465 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 16:58:27.465 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType83`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 16:58:27.465 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 1.61ms
2025-07-30 16:58:27.465 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 16:58:27.465 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/28b8e854-738a-4e69-835c-71299a8f9b21/subscription - 200 null application/json; charset=utf-8 3.6812ms
2025-07-30 16:58:36.075 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users - null null
2025-07-30 16:58:36.075 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/subscription-plans - null null
2025-07-30 16:58:36.075 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:58:36.075 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:58:36.075 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users - 204 null null 0.6243ms
2025-07-30 16:58:36.075 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/subscription-plans - 204 null null 0.6002ms
2025-07-30 16:58:36.076 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/subscription-plans - application/json null
2025-07-30 16:58:36.076 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users - application/json null
2025-07-30 16:58:36.077 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:58:36.077 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:58:36.080 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 16:58:36.080 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 16:58:36.080 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUsers (CeceLearningPortal.Api)'
2025-07-30 16:58:36.080 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetSubscriptionPlans (CeceLearningPortal.Api)'
2025-07-30 16:58:36.080 +08:00 [INF] Route matched with {action = "GetUsers", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUsers(CeceLearningPortal.Api.DTOs.UserManagementFilterDto) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 16:58:36.080 +08:00 [INF] Route matched with {action = "GetSubscriptionPlans", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetSubscriptionPlans() on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 16:58:36.096 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."CreatedAt", s."Description", s."DisplayOrder", s."Features", s."HasAnalytics", s."HasPrioritySupport", s."HasUnlimitedAccess", s."IsActive", s."IsRecommended", s."MaxCourseAccess", s."MaxCoursesCanCreate", s."MaxStudentsPerCourse", s."MonthlyPrice", s."Name", s."PlanType", s."TransactionFeePercentage", s."UpdatedAt", s."YearlyPrice", s0."Id", s0."BillingCycle", s0."CreatedAt", s0."EndDate", s0."NextBillingDate", s0."PlanName", s0."Price", s0."StartDate", s0."Status", s0."StripeSubscriptionId", s0."SubscriptionPlanId", s0."UpdatedAt", s0."UserId"
FROM "SubscriptionPlans" AS s
LEFT JOIN "Subscriptions" AS s0 ON s."Id" = s0."SubscriptionPlanId"
ORDER BY s."Id"
2025-07-30 16:58:36.096 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
2025-07-30 16:58:36.096 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[CeceLearningPortal.Api.DTOs.SubscriptionPlanDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-30 16:58:36.096 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetSubscriptionPlans (CeceLearningPortal.Api) in 15.4783ms
2025-07-30 16:58:36.096 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetSubscriptionPlans (CeceLearningPortal.Api)'
2025-07-30 16:58:36.096 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/subscription-plans - 200 null application/json; charset=utf-8 19.8081ms
2025-07-30 16:58:36.097 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."UserName", a."Email", a."FullName", a."Role", a."Status", a."CreatedAt", a."LastLoginAt", a."EmailConfirmed"
FROM "AspNetUsers" AS a
ORDER BY a."CreatedAt" DESC
LIMIT @__p_1 OFFSET @__p_0
2025-07-30 16:58:36.098 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[CeceLearningPortal.Api.DTOs.UserManagementDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-30 16:58:36.098 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUsers (CeceLearningPortal.Api) in 17.1541ms
2025-07-30 16:58:36.098 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUsers (CeceLearningPortal.Api)'
2025-07-30 16:58:36.098 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users - 200 null application/json; charset=utf-8 21.3798ms
2025-07-30 16:58:36.099 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/b9030b04-2da7-449f-94de-d6d4814a8177/subscription - null null
2025-07-30 16:58:36.099 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:58:36.099 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/b9030b04-2da7-449f-94de-d6d4814a8177/subscription - 204 null null 0.2089ms
2025-07-30 16:58:36.099 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/efead752-f0b3-48ab-93b8-7ba31e7574ba/subscription - null null
2025-07-30 16:58:36.100 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/e090c598-224f-4b4c-870a-3c3ef6303e0a/subscription - null null
2025-07-30 16:58:36.100 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:58:36.100 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:58:36.100 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/efead752-f0b3-48ab-93b8-7ba31e7574ba/subscription - 204 null null 0.2001ms
2025-07-30 16:58:36.100 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/e090c598-224f-4b4c-870a-3c3ef6303e0a/subscription - 204 null null 0.1756ms
2025-07-30 16:58:36.100 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/801dc698-62a8-49c3-b578-b7c1b05049a4/subscription - null null
2025-07-30 16:58:36.100 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:58:36.100 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/801dc698-62a8-49c3-b578-b7c1b05049a4/subscription - 204 null null 0.1513ms
2025-07-30 16:58:36.100 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/28b8e854-738a-4e69-835c-71299a8f9b21/subscription - null null
2025-07-30 16:58:36.100 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:58:36.100 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/28b8e854-738a-4e69-835c-71299a8f9b21/subscription - 204 null null 0.1565ms
2025-07-30 16:58:36.100 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/f9f0e64e-3771-4aa9-8470-21e709677e44/subscription - null null
2025-07-30 16:58:36.100 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:58:36.101 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/f9f0e64e-3771-4aa9-8470-21e709677e44/subscription - 204 null null 0.1861ms
2025-07-30 16:58:36.101 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/b9030b04-2da7-449f-94de-d6d4814a8177/subscription - application/json null
2025-07-30 16:58:36.101 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/efead752-f0b3-48ab-93b8-7ba31e7574ba/subscription - application/json null
2025-07-30 16:58:36.101 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:58:36.102 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/e090c598-224f-4b4c-870a-3c3ef6303e0a/subscription - application/json null
2025-07-30 16:58:36.102 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:58:36.102 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/801dc698-62a8-49c3-b578-b7c1b05049a4/subscription - application/json null
2025-07-30 16:58:36.102 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/28b8e854-738a-4e69-835c-71299a8f9b21/subscription - application/json null
2025-07-30 16:58:36.102 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:58:36.102 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/f9f0e64e-3771-4aa9-8470-21e709677e44/subscription - application/json null
2025-07-30 16:58:36.102 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:58:36.102 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:58:36.102 +08:00 [INF] CORS policy execution successful.
2025-07-30 16:58:36.104 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 16:58:36.104 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 16:58:36.104 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 16:58:36.104 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 16:58:36.104 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 16:58:36.104 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 16:58:36.104 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 16:58:36.104 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 16:58:36.104 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 16:58:36.104 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 16:58:36.104 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 16:58:36.104 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 16:58:36.104 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 16:58:36.104 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 16:58:36.104 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 16:58:36.104 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 16:58:36.104 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 16:58:36.105 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 16:58:36.106 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 16:58:36.106 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 16:58:36.106 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType83`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 16:58:36.106 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 16:58:36.106 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 16:58:36.106 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 1.6085ms
2025-07-30 16:58:36.106 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType83`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 16:58:36.106 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType83`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 16:58:36.106 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 16:58:36.106 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType83`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 16:58:36.106 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 1.8422ms
2025-07-30 16:58:36.106 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 1.7661ms
2025-07-30 16:58:36.106 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/b9030b04-2da7-449f-94de-d6d4814a8177/subscription - 200 null application/json; charset=utf-8 5.0664ms
2025-07-30 16:58:36.106 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 1.8073ms
2025-07-30 16:58:36.107 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 16:58:36.107 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 16:58:36.107 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 16:58:36.107 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/e090c598-224f-4b4c-870a-3c3ef6303e0a/subscription - 200 null application/json; charset=utf-8 5.1721ms
2025-07-30 16:58:36.107 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/f9f0e64e-3771-4aa9-8470-21e709677e44/subscription - 200 null application/json; charset=utf-8 4.9254ms
2025-07-30 16:58:36.107 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/28b8e854-738a-4e69-835c-71299a8f9b21/subscription - 200 null application/json; charset=utf-8 5.0864ms
2025-07-30 16:58:36.107 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 16:58:36.107 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 16:58:36.107 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType83`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 16:58:36.107 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 2.6768ms
2025-07-30 16:58:36.107 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType83`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 16:58:36.108 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 16:58:36.108 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 3.0846ms
2025-07-30 16:58:36.108 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/efead752-f0b3-48ab-93b8-7ba31e7574ba/subscription - 200 null application/json; charset=utf-8 6.2002ms
2025-07-30 16:58:36.108 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 16:58:36.108 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/801dc698-62a8-49c3-b578-b7c1b05049a4/subscription - 200 null application/json; charset=utf-8 6.2448ms
2025-07-30 17:00:15.438 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/approve - null null
2025-07-30 17:00:15.439 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:00:15.439 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/approve - 204 null null 0.4591ms
2025-07-30 17:00:15.440 +08:00 [INF] Request starting HTTP/1.1 POST http://localhost:5295/api/admin/users/approve - application/json 89
2025-07-30 17:00:15.441 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:00:15.442 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:00:15.443 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.ApproveUser (CeceLearningPortal.Api)'
2025-07-30 17:00:15.445 +08:00 [INF] Route matched with {action = "ApproveUser", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] ApproveUser(CeceLearningPortal.Api.DTOs.ApproveUserDto) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 17:00:15.464 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."Id" = @__p_0
LIMIT 1
2025-07-30 17:00:15.514 +08:00 [INF] User b9030b04-2da7-449f-94de-d6d4814a8177 approved by admin 28b8e854-738a-4e69-835c-71299a8f9b21
2025-07-30 17:00:15.554 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@p1='?', @p2='?', @p0='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE "AspNetUsers" SET "Status" = @p0
WHERE "Id" = @p1 AND "ConcurrencyStamp" = @p2;
2025-07-30 17:00:15.596 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[@p0='?', @p1='?' (DbType = DateTime), @p2='?' (DbType = Boolean), @p3='?', @p4='?', @p5='?', @p6='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "Notifications" ("ActionUrl", "CreatedAt", "IsRead", "Message", "Title", "Type", "UserId")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6)
RETURNING "Id";
2025-07-30 17:00:15.602 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType0`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 17:00:15.603 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.ApproveUser (CeceLearningPortal.Api) in 157.6598ms
2025-07-30 17:00:15.603 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.ApproveUser (CeceLearningPortal.Api)'
2025-07-30 17:00:15.603 +08:00 [INF] Request finished HTTP/1.1 POST http://localhost:5295/api/admin/users/approve - 200 null application/json; charset=utf-8 163.4124ms
2025-07-30 17:00:15.605 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users - null null
2025-07-30 17:00:15.605 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:00:15.605 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users - 204 null null 0.1887ms
2025-07-30 17:00:15.606 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users - application/json null
2025-07-30 17:00:15.606 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:00:15.607 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:00:15.607 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUsers (CeceLearningPortal.Api)'
2025-07-30 17:00:15.607 +08:00 [INF] Route matched with {action = "GetUsers", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUsers(CeceLearningPortal.Api.DTOs.UserManagementFilterDto) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 17:00:15.608 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
2025-07-30 17:00:15.609 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."UserName", a."Email", a."FullName", a."Role", a."Status", a."CreatedAt", a."LastLoginAt", a."EmailConfirmed"
FROM "AspNetUsers" AS a
ORDER BY a."CreatedAt" DESC
LIMIT @__p_1 OFFSET @__p_0
2025-07-30 17:00:15.609 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[CeceLearningPortal.Api.DTOs.UserManagementDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-30 17:00:15.609 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUsers (CeceLearningPortal.Api) in 1.6838ms
2025-07-30 17:00:15.609 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUsers (CeceLearningPortal.Api)'
2025-07-30 17:00:15.609 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users - 200 null application/json; charset=utf-8 3.457ms
2025-07-30 17:00:15.621 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/b9030b04-2da7-449f-94de-d6d4814a8177/subscription - null null
2025-07-30 17:00:15.621 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:00:15.621 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/b9030b04-2da7-449f-94de-d6d4814a8177/subscription - 204 null null 0.3021ms
2025-07-30 17:00:15.621 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/efead752-f0b3-48ab-93b8-7ba31e7574ba/subscription - null null
2025-07-30 17:00:15.621 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/e090c598-224f-4b4c-870a-3c3ef6303e0a/subscription - null null
2025-07-30 17:00:15.621 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:00:15.621 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:00:15.621 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/efead752-f0b3-48ab-93b8-7ba31e7574ba/subscription - 204 null null 0.1548ms
2025-07-30 17:00:15.621 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/e090c598-224f-4b4c-870a-3c3ef6303e0a/subscription - 204 null null 0.1995ms
2025-07-30 17:00:15.622 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/801dc698-62a8-49c3-b578-b7c1b05049a4/subscription - null null
2025-07-30 17:00:15.622 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:00:15.622 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/801dc698-62a8-49c3-b578-b7c1b05049a4/subscription - 204 null null 0.1169ms
2025-07-30 17:00:15.622 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/28b8e854-738a-4e69-835c-71299a8f9b21/subscription - null null
2025-07-30 17:00:15.622 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:00:15.622 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/28b8e854-738a-4e69-835c-71299a8f9b21/subscription - 204 null null 0.1204ms
2025-07-30 17:00:15.622 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/f9f0e64e-3771-4aa9-8470-21e709677e44/subscription - null null
2025-07-30 17:00:15.622 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:00:15.622 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/f9f0e64e-3771-4aa9-8470-21e709677e44/subscription - 204 null null 0.1337ms
2025-07-30 17:00:15.623 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/b9030b04-2da7-449f-94de-d6d4814a8177/subscription - application/json null
2025-07-30 17:00:15.623 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:00:15.623 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/e090c598-224f-4b4c-870a-3c3ef6303e0a/subscription - application/json null
2025-07-30 17:00:15.624 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/801dc698-62a8-49c3-b578-b7c1b05049a4/subscription - application/json null
2025-07-30 17:00:15.624 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:00:15.624 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:00:15.624 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/efead752-f0b3-48ab-93b8-7ba31e7574ba/subscription - application/json null
2025-07-30 17:00:15.624 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:00:15.624 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/f9f0e64e-3771-4aa9-8470-21e709677e44/subscription - application/json null
2025-07-30 17:00:15.624 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/28b8e854-738a-4e69-835c-71299a8f9b21/subscription - application/json null
2025-07-30 17:00:15.624 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:00:15.624 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:00:15.625 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:00:15.625 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:00:15.625 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:00:15.625 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:00:15.625 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:00:15.625 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:00:15.625 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 17:00:15.625 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 17:00:15.625 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 17:00:15.625 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 17:00:15.625 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 17:00:15.625 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 17:00:15.625 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 17:00:15.625 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 17:00:15.625 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 17:00:15.625 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 17:00:15.625 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 17:00:15.625 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 17:00:15.626 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 17:00:15.626 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 17:00:15.626 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 17:00:15.626 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 17:00:15.626 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 17:00:15.626 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType83`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 17:00:15.626 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType83`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 17:00:15.626 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType83`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 17:00:15.626 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 17:00:15.627 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 1.0195ms
2025-07-30 17:00:15.626 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType83`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 17:00:15.626 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType83`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 17:00:15.627 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 1.067ms
2025-07-30 17:00:15.627 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 17:00:15.627 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 1.3547ms
2025-07-30 17:00:15.627 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType83`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 17:00:15.627 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/e090c598-224f-4b4c-870a-3c3ef6303e0a/subscription - 200 null application/json; charset=utf-8 3.4069ms
2025-07-30 17:00:15.627 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 1.2806ms
2025-07-30 17:00:15.627 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 17:00:15.627 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 17:00:15.627 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 1.3584ms
2025-07-30 17:00:15.627 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 1.5475ms
2025-07-30 17:00:15.627 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 17:00:15.627 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/28b8e854-738a-4e69-835c-71299a8f9b21/subscription - 200 null application/json; charset=utf-8 2.7886ms
2025-07-30 17:00:15.627 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 17:00:15.627 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/f9f0e64e-3771-4aa9-8470-21e709677e44/subscription - 200 null application/json; charset=utf-8 2.8202ms
2025-07-30 17:00:15.627 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 17:00:15.627 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/801dc698-62a8-49c3-b578-b7c1b05049a4/subscription - 200 null application/json; charset=utf-8 3.5419ms
2025-07-30 17:00:15.627 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/b9030b04-2da7-449f-94de-d6d4814a8177/subscription - 200 null application/json; charset=utf-8 3.9053ms
2025-07-30 17:00:15.627 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/efead752-f0b3-48ab-93b8-7ba31e7574ba/subscription - 200 null application/json; charset=utf-8 3.3225ms
2025-07-30 17:01:13.620 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/subscription-plans - null null
2025-07-30 17:01:13.620 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users - null null
2025-07-30 17:01:13.621 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:01:13.621 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:01:13.621 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users - 204 null null 0.4443ms
2025-07-30 17:01:13.621 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/subscription-plans - 204 null null 0.5739ms
2025-07-30 17:01:13.622 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/subscription-plans - application/json null
2025-07-30 17:01:13.622 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:01:13.622 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users - application/json null
2025-07-30 17:01:13.622 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:01:13.669 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:01:13.669 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUsers (CeceLearningPortal.Api)'
2025-07-30 17:01:13.669 +08:00 [INF] Route matched with {action = "GetUsers", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUsers(CeceLearningPortal.Api.DTOs.UserManagementFilterDto) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 17:01:13.671 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
2025-07-30 17:01:13.672 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."UserName", a."Email", a."FullName", a."Role", a."Status", a."CreatedAt", a."LastLoginAt", a."EmailConfirmed"
FROM "AspNetUsers" AS a
ORDER BY a."CreatedAt" DESC
LIMIT @__p_1 OFFSET @__p_0
2025-07-30 17:01:13.672 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[CeceLearningPortal.Api.DTOs.UserManagementDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-30 17:01:13.672 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:01:13.672 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUsers (CeceLearningPortal.Api) in 3.0433ms
2025-07-30 17:01:13.672 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetSubscriptionPlans (CeceLearningPortal.Api)'
2025-07-30 17:01:13.673 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUsers (CeceLearningPortal.Api)'
2025-07-30 17:01:13.673 +08:00 [INF] Route matched with {action = "GetSubscriptionPlans", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetSubscriptionPlans() on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 17:01:13.673 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users - 200 null application/json; charset=utf-8 50.9975ms
2025-07-30 17:01:13.674 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."CreatedAt", s."Description", s."DisplayOrder", s."Features", s."HasAnalytics", s."HasPrioritySupport", s."HasUnlimitedAccess", s."IsActive", s."IsRecommended", s."MaxCourseAccess", s."MaxCoursesCanCreate", s."MaxStudentsPerCourse", s."MonthlyPrice", s."Name", s."PlanType", s."TransactionFeePercentage", s."UpdatedAt", s."YearlyPrice", s0."Id", s0."BillingCycle", s0."CreatedAt", s0."EndDate", s0."NextBillingDate", s0."PlanName", s0."Price", s0."StartDate", s0."Status", s0."StripeSubscriptionId", s0."SubscriptionPlanId", s0."UpdatedAt", s0."UserId"
FROM "SubscriptionPlans" AS s
LEFT JOIN "Subscriptions" AS s0 ON s."Id" = s0."SubscriptionPlanId"
ORDER BY s."Id"
2025-07-30 17:01:13.674 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/b9030b04-2da7-449f-94de-d6d4814a8177/subscription - null null
2025-07-30 17:01:13.674 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[CeceLearningPortal.Api.DTOs.SubscriptionPlanDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-30 17:01:13.675 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:01:13.675 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/b9030b04-2da7-449f-94de-d6d4814a8177/subscription - 204 null null 0.1593ms
2025-07-30 17:01:13.675 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetSubscriptionPlans (CeceLearningPortal.Api) in 1.9484ms
2025-07-30 17:01:13.675 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetSubscriptionPlans (CeceLearningPortal.Api)'
2025-07-30 17:01:13.675 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/subscription-plans - 200 null application/json; charset=utf-8 53.146ms
2025-07-30 17:01:13.675 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/efead752-f0b3-48ab-93b8-7ba31e7574ba/subscription - null null
2025-07-30 17:01:13.675 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/e090c598-224f-4b4c-870a-3c3ef6303e0a/subscription - null null
2025-07-30 17:01:13.675 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:01:13.675 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:01:13.675 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/efead752-f0b3-48ab-93b8-7ba31e7574ba/subscription - 204 null null 0.245ms
2025-07-30 17:01:13.675 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/e090c598-224f-4b4c-870a-3c3ef6303e0a/subscription - 204 null null 0.2277ms
2025-07-30 17:01:13.675 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/801dc698-62a8-49c3-b578-b7c1b05049a4/subscription - null null
2025-07-30 17:01:13.676 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:01:13.676 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/801dc698-62a8-49c3-b578-b7c1b05049a4/subscription - 204 null null 0.1146ms
2025-07-30 17:01:13.676 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/28b8e854-738a-4e69-835c-71299a8f9b21/subscription - null null
2025-07-30 17:01:13.676 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:01:13.676 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/28b8e854-738a-4e69-835c-71299a8f9b21/subscription - 204 null null 0.1028ms
2025-07-30 17:01:13.676 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/f9f0e64e-3771-4aa9-8470-21e709677e44/subscription - null null
2025-07-30 17:01:13.677 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:01:13.677 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/f9f0e64e-3771-4aa9-8470-21e709677e44/subscription - 204 null null 0.1036ms
2025-07-30 17:01:13.678 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/b9030b04-2da7-449f-94de-d6d4814a8177/subscription - application/json null
2025-07-30 17:01:13.678 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:01:13.678 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/e090c598-224f-4b4c-870a-3c3ef6303e0a/subscription - application/json null
2025-07-30 17:01:13.678 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:01:13.678 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/efead752-f0b3-48ab-93b8-7ba31e7574ba/subscription - application/json null
2025-07-30 17:01:13.678 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:01:13.678 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/801dc698-62a8-49c3-b578-b7c1b05049a4/subscription - application/json null
2025-07-30 17:01:13.678 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:01:13.679 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/28b8e854-738a-4e69-835c-71299a8f9b21/subscription - application/json null
2025-07-30 17:01:13.679 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/f9f0e64e-3771-4aa9-8470-21e709677e44/subscription - application/json null
2025-07-30 17:01:13.679 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:01:13.679 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:01:13.679 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:01:13.679 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:01:13.679 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 17:01:13.679 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 17:01:13.679 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 17:01:13.679 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 17:01:13.681 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 17:01:13.681 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType83`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 17:01:13.681 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 1.465ms
2025-07-30 17:01:13.681 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 17:01:13.681 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/b9030b04-2da7-449f-94de-d6d4814a8177/subscription - 200 null application/json; charset=utf-8 3.5222ms
2025-07-30 17:01:13.682 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 17:01:13.682 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType83`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 17:01:13.682 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 2.865ms
2025-07-30 17:01:13.682 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 17:01:13.682 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/e090c598-224f-4b4c-870a-3c3ef6303e0a/subscription - 200 null application/json; charset=utf-8 4.729ms
2025-07-30 17:01:13.728 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:01:13.728 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 17:01:13.728 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 17:01:13.730 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 17:01:13.730 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType83`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 17:01:13.730 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 1.5329ms
2025-07-30 17:01:13.730 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 17:01:13.730 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/801dc698-62a8-49c3-b578-b7c1b05049a4/subscription - 200 null application/json; charset=utf-8 51.7801ms
2025-07-30 17:01:13.733 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:01:13.733 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 17:01:13.733 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 17:01:13.735 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 17:01:13.735 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType83`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 17:01:13.735 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 1.3985ms
2025-07-30 17:01:13.735 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 17:01:13.735 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/f9f0e64e-3771-4aa9-8470-21e709677e44/subscription - 200 null application/json; charset=utf-8 56.294ms
2025-07-30 17:01:13.744 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:01:13.744 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 17:01:13.744 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 17:01:13.745 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:01:13.745 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 17:01:13.745 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 17:01:13.746 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 17:01:13.746 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType83`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 17:01:13.746 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 1.1107ms
2025-07-30 17:01:13.746 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 17:01:13.746 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/28b8e854-738a-4e69-835c-71299a8f9b21/subscription - 200 null application/json; charset=utf-8 67.8897ms
2025-07-30 17:01:13.746 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 17:01:13.747 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType83`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 17:01:13.747 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 2.9309ms
2025-07-30 17:01:13.747 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 17:01:13.747 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/efead752-f0b3-48ab-93b8-7ba31e7574ba/subscription - 200 null application/json; charset=utf-8 69.1584ms
2025-07-30 17:01:38.052 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users - null null
2025-07-30 17:01:38.053 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:01:38.053 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/subscription-plans - null null
2025-07-30 17:01:38.053 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users - 204 null null 0.2628ms
2025-07-30 17:01:38.053 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:01:38.053 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/subscription-plans - 204 null null 0.3468ms
2025-07-30 17:01:38.054 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users - application/json null
2025-07-30 17:01:38.054 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/subscription-plans - application/json null
2025-07-30 17:01:38.054 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:01:38.054 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:01:38.055 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:01:38.055 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:01:38.055 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUsers (CeceLearningPortal.Api)'
2025-07-30 17:01:38.055 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetSubscriptionPlans (CeceLearningPortal.Api)'
2025-07-30 17:01:38.055 +08:00 [INF] Route matched with {action = "GetUsers", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUsers(CeceLearningPortal.Api.DTOs.UserManagementFilterDto) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 17:01:38.055 +08:00 [INF] Route matched with {action = "GetSubscriptionPlans", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetSubscriptionPlans() on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 17:01:38.057 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
2025-07-30 17:01:38.057 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."CreatedAt", s."Description", s."DisplayOrder", s."Features", s."HasAnalytics", s."HasPrioritySupport", s."HasUnlimitedAccess", s."IsActive", s."IsRecommended", s."MaxCourseAccess", s."MaxCoursesCanCreate", s."MaxStudentsPerCourse", s."MonthlyPrice", s."Name", s."PlanType", s."TransactionFeePercentage", s."UpdatedAt", s."YearlyPrice", s0."Id", s0."BillingCycle", s0."CreatedAt", s0."EndDate", s0."NextBillingDate", s0."PlanName", s0."Price", s0."StartDate", s0."Status", s0."StripeSubscriptionId", s0."SubscriptionPlanId", s0."UpdatedAt", s0."UserId"
FROM "SubscriptionPlans" AS s
LEFT JOIN "Subscriptions" AS s0 ON s."Id" = s0."SubscriptionPlanId"
ORDER BY s."Id"
2025-07-30 17:01:38.057 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[CeceLearningPortal.Api.DTOs.SubscriptionPlanDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-30 17:01:38.057 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetSubscriptionPlans (CeceLearningPortal.Api) in 2.0184ms
2025-07-30 17:01:38.057 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetSubscriptionPlans (CeceLearningPortal.Api)'
2025-07-30 17:01:38.058 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/subscription-plans - 200 null application/json; charset=utf-8 3.8528ms
2025-07-30 17:01:38.058 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."UserName", a."Email", a."FullName", a."Role", a."Status", a."CreatedAt", a."LastLoginAt", a."EmailConfirmed"
FROM "AspNetUsers" AS a
ORDER BY a."CreatedAt" DESC
LIMIT @__p_1 OFFSET @__p_0
2025-07-30 17:01:38.058 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[CeceLearningPortal.Api.DTOs.UserManagementDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-30 17:01:38.058 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUsers (CeceLearningPortal.Api) in 2.4783ms
2025-07-30 17:01:38.058 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUsers (CeceLearningPortal.Api)'
2025-07-30 17:01:38.058 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users - 200 null application/json; charset=utf-8 4.3481ms
2025-07-30 17:01:38.060 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/b9030b04-2da7-449f-94de-d6d4814a8177/subscription - null null
2025-07-30 17:01:38.060 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:01:38.060 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/b9030b04-2da7-449f-94de-d6d4814a8177/subscription - 204 null null 0.1215ms
2025-07-30 17:01:38.060 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/efead752-f0b3-48ab-93b8-7ba31e7574ba/subscription - null null
2025-07-30 17:01:38.060 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:01:38.060 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/efead752-f0b3-48ab-93b8-7ba31e7574ba/subscription - 204 null null 0.1025ms
2025-07-30 17:01:38.061 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/e090c598-224f-4b4c-870a-3c3ef6303e0a/subscription - null null
2025-07-30 17:01:38.061 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:01:38.061 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/801dc698-62a8-49c3-b578-b7c1b05049a4/subscription - null null
2025-07-30 17:01:38.061 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/e090c598-224f-4b4c-870a-3c3ef6303e0a/subscription - 204 null null 0.0937ms
2025-07-30 17:01:38.061 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:01:38.061 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/28b8e854-738a-4e69-835c-71299a8f9b21/subscription - null null
2025-07-30 17:01:38.061 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/801dc698-62a8-49c3-b578-b7c1b05049a4/subscription - 204 null null 0.1254ms
2025-07-30 17:01:38.061 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:01:38.061 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/28b8e854-738a-4e69-835c-71299a8f9b21/subscription - 204 null null 0.1229ms
2025-07-30 17:01:38.061 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/f9f0e64e-3771-4aa9-8470-21e709677e44/subscription - null null
2025-07-30 17:01:38.061 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:01:38.061 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/f9f0e64e-3771-4aa9-8470-21e709677e44/subscription - 204 null null 0.0974ms
2025-07-30 17:01:38.062 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/b9030b04-2da7-449f-94de-d6d4814a8177/subscription - application/json null
2025-07-30 17:01:38.062 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:01:38.062 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/efead752-f0b3-48ab-93b8-7ba31e7574ba/subscription - application/json null
2025-07-30 17:01:38.062 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:01:38.062 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/801dc698-62a8-49c3-b578-b7c1b05049a4/subscription - application/json null
2025-07-30 17:01:38.062 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:01:38.062 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/28b8e854-738a-4e69-835c-71299a8f9b21/subscription - application/json null
2025-07-30 17:01:38.063 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:01:38.063 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/e090c598-224f-4b4c-870a-3c3ef6303e0a/subscription - application/json null
2025-07-30 17:01:38.063 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/f9f0e64e-3771-4aa9-8470-21e709677e44/subscription - application/json null
2025-07-30 17:01:38.063 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:01:38.063 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:01:38.063 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:01:38.063 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:01:38.063 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 17:01:38.063 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 17:01:38.063 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 17:01:38.063 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 17:01:38.063 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:01:38.063 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 17:01:38.063 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 17:01:38.063 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:01:38.063 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:01:38.063 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 17:01:38.063 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 17:01:38.064 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 17:01:38.064 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:01:38.064 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 17:01:38.064 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 17:01:38.064 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 17:01:38.064 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 17:01:38.064 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType83`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 17:01:38.064 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 17:01:38.064 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 0.8753ms
2025-07-30 17:01:38.064 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 17:01:38.064 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType83`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 17:01:38.064 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/efead752-f0b3-48ab-93b8-7ba31e7574ba/subscription - 200 null application/json; charset=utf-8 2.0209ms
2025-07-30 17:01:38.064 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 0.799ms
2025-07-30 17:01:38.064 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 17:01:38.064 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/801dc698-62a8-49c3-b578-b7c1b05049a4/subscription - 200 null application/json; charset=utf-8 2.0471ms
2025-07-30 17:01:38.065 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 17:01:38.065 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType83`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 17:01:38.065 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 1.1129ms
2025-07-30 17:01:38.065 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 17:01:38.065 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/e090c598-224f-4b4c-870a-3c3ef6303e0a/subscription - 200 null application/json; charset=utf-8 2.3138ms
2025-07-30 17:01:38.065 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 17:01:38.065 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType83`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 17:01:38.065 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 17:01:38.065 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 17:01:38.065 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType83`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 17:01:38.065 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 1.7475ms
2025-07-30 17:01:38.065 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType83`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 17:01:38.065 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 1.6327ms
2025-07-30 17:01:38.065 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 2.4174ms
2025-07-30 17:01:38.065 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 17:01:38.065 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 17:01:38.065 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 17:01:38.066 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/f9f0e64e-3771-4aa9-8470-21e709677e44/subscription - 200 null application/json; charset=utf-8 3.0054ms
2025-07-30 17:01:38.066 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/28b8e854-738a-4e69-835c-71299a8f9b21/subscription - 200 null application/json; charset=utf-8 3.2964ms
2025-07-30 17:01:38.066 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/b9030b04-2da7-449f-94de-d6d4814a8177/subscription - 200 null application/json; charset=utf-8 3.7494ms
2025-07-30 17:01:45.052 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/subscription-plans - null null
2025-07-30 17:01:45.052 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users - null null
2025-07-30 17:01:45.052 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:01:45.052 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:01:45.052 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users - 204 null null 0.2285ms
2025-07-30 17:01:45.052 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/subscription-plans - 204 null null 0.2285ms
2025-07-30 17:01:45.053 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users - application/json null
2025-07-30 17:01:45.053 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/subscription-plans - application/json null
2025-07-30 17:01:45.053 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:01:45.053 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:01:45.054 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:01:45.054 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:01:45.054 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetSubscriptionPlans (CeceLearningPortal.Api)'
2025-07-30 17:01:45.054 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUsers (CeceLearningPortal.Api)'
2025-07-30 17:01:45.054 +08:00 [INF] Route matched with {action = "GetUsers", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUsers(CeceLearningPortal.Api.DTOs.UserManagementFilterDto) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 17:01:45.054 +08:00 [INF] Route matched with {action = "GetSubscriptionPlans", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetSubscriptionPlans() on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 17:01:45.055 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."CreatedAt", s."Description", s."DisplayOrder", s."Features", s."HasAnalytics", s."HasPrioritySupport", s."HasUnlimitedAccess", s."IsActive", s."IsRecommended", s."MaxCourseAccess", s."MaxCoursesCanCreate", s."MaxStudentsPerCourse", s."MonthlyPrice", s."Name", s."PlanType", s."TransactionFeePercentage", s."UpdatedAt", s."YearlyPrice", s0."Id", s0."BillingCycle", s0."CreatedAt", s0."EndDate", s0."NextBillingDate", s0."PlanName", s0."Price", s0."StartDate", s0."Status", s0."StripeSubscriptionId", s0."SubscriptionPlanId", s0."UpdatedAt", s0."UserId"
FROM "SubscriptionPlans" AS s
LEFT JOIN "Subscriptions" AS s0 ON s."Id" = s0."SubscriptionPlanId"
ORDER BY s."Id"
2025-07-30 17:01:45.055 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
2025-07-30 17:01:45.055 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[CeceLearningPortal.Api.DTOs.SubscriptionPlanDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-30 17:01:45.055 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetSubscriptionPlans (CeceLearningPortal.Api) in 0.992ms
2025-07-30 17:01:45.055 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetSubscriptionPlans (CeceLearningPortal.Api)'
2025-07-30 17:01:45.055 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/subscription-plans - 200 null application/json; charset=utf-8 2.7411ms
2025-07-30 17:01:45.056 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."UserName", a."Email", a."FullName", a."Role", a."Status", a."CreatedAt", a."LastLoginAt", a."EmailConfirmed"
FROM "AspNetUsers" AS a
ORDER BY a."CreatedAt" DESC
LIMIT @__p_1 OFFSET @__p_0
2025-07-30 17:01:45.056 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[CeceLearningPortal.Api.DTOs.UserManagementDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-30 17:01:45.056 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUsers (CeceLearningPortal.Api) in 1.4432ms
2025-07-30 17:01:45.056 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUsers (CeceLearningPortal.Api)'
2025-07-30 17:01:45.056 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users - 200 null application/json; charset=utf-8 3.2154ms
2025-07-30 17:01:45.057 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/b9030b04-2da7-449f-94de-d6d4814a8177/subscription - null null
2025-07-30 17:01:45.057 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:01:45.057 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/b9030b04-2da7-449f-94de-d6d4814a8177/subscription - 204 null null 0.0947ms
2025-07-30 17:01:45.057 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/efead752-f0b3-48ab-93b8-7ba31e7574ba/subscription - null null
2025-07-30 17:01:45.057 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:01:45.057 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/efead752-f0b3-48ab-93b8-7ba31e7574ba/subscription - 204 null null 0.0886ms
2025-07-30 17:01:45.058 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/e090c598-224f-4b4c-870a-3c3ef6303e0a/subscription - null null
2025-07-30 17:01:45.058 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:01:45.058 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/e090c598-224f-4b4c-870a-3c3ef6303e0a/subscription - 204 null null 0.1038ms
2025-07-30 17:01:45.058 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/801dc698-62a8-49c3-b578-b7c1b05049a4/subscription - null null
2025-07-30 17:01:45.058 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/28b8e854-738a-4e69-835c-71299a8f9b21/subscription - null null
2025-07-30 17:01:45.058 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:01:45.058 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:01:45.058 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/801dc698-62a8-49c3-b578-b7c1b05049a4/subscription - 204 null null 0.156ms
2025-07-30 17:01:45.058 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/28b8e854-738a-4e69-835c-71299a8f9b21/subscription - 204 null null 0.1388ms
2025-07-30 17:01:45.058 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/f9f0e64e-3771-4aa9-8470-21e709677e44/subscription - null null
2025-07-30 17:01:45.058 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:01:45.058 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/f9f0e64e-3771-4aa9-8470-21e709677e44/subscription - 204 null null 0.0915ms
2025-07-30 17:01:45.059 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/b9030b04-2da7-449f-94de-d6d4814a8177/subscription - application/json null
2025-07-30 17:01:45.059 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:01:45.059 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/efead752-f0b3-48ab-93b8-7ba31e7574ba/subscription - application/json null
2025-07-30 17:01:45.059 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:01:45.059 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/e090c598-224f-4b4c-870a-3c3ef6303e0a/subscription - application/json null
2025-07-30 17:01:45.060 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:01:45.060 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/28b8e854-738a-4e69-835c-71299a8f9b21/subscription - application/json null
2025-07-30 17:01:45.060 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:01:45.060 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/801dc698-62a8-49c3-b578-b7c1b05049a4/subscription - application/json null
2025-07-30 17:01:45.060 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/f9f0e64e-3771-4aa9-8470-21e709677e44/subscription - application/json null
2025-07-30 17:01:45.060 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:01:45.060 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:01:45.060 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:01:45.060 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:01:45.060 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:01:45.060 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 17:01:45.060 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 17:01:45.060 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 17:01:45.060 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:01:45.060 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:01:45.060 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 17:01:45.060 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 17:01:45.060 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 17:01:45.060 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 17:01:45.060 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 17:01:45.060 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 17:01:45.061 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:01:45.061 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 17:01:45.061 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 17:01:45.061 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 17:01:45.061 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 17:01:45.061 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 17:01:45.061 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 17:01:45.061 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType83`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 17:01:45.061 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType83`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 17:01:45.061 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType83`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 17:01:45.061 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 0.9575ms
2025-07-30 17:01:45.061 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 17:01:45.061 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 17:01:45.061 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType83`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 17:01:45.061 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 17:01:45.061 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 0.7112ms
2025-07-30 17:01:45.061 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 0.8006ms
2025-07-30 17:01:45.061 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 0.7715ms
2025-07-30 17:01:45.061 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType83`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 17:01:45.061 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/b9030b04-2da7-449f-94de-d6d4814a8177/subscription - 200 null application/json; charset=utf-8 2.2612ms
2025-07-30 17:01:45.062 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 1.148ms
2025-07-30 17:01:45.061 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 17:01:45.062 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 17:01:45.062 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/801dc698-62a8-49c3-b578-b7c1b05049a4/subscription - 200 null application/json; charset=utf-8 2.0506ms
2025-07-30 17:01:45.062 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 17:01:45.062 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 17:01:45.062 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/f9f0e64e-3771-4aa9-8470-21e709677e44/subscription - 200 null application/json; charset=utf-8 2.1087ms
2025-07-30 17:01:45.062 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/efead752-f0b3-48ab-93b8-7ba31e7574ba/subscription - 200 null application/json; charset=utf-8 2.4605ms
2025-07-30 17:01:45.062 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType83`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 17:01:45.062 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 17:01:45.062 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 1.2428ms
2025-07-30 17:01:45.062 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/e090c598-224f-4b4c-870a-3c3ef6303e0a/subscription - 200 null application/json; charset=utf-8 2.4977ms
2025-07-30 17:01:45.062 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 17:01:45.062 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/28b8e854-738a-4e69-835c-71299a8f9b21/subscription - 200 null application/json; charset=utf-8 2.489ms
2025-07-30 17:01:58.057 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users - null null
2025-07-30 17:01:58.058 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:01:58.058 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users - 204 null null 0.2045ms
2025-07-30 17:01:58.058 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/subscription-plans - null null
2025-07-30 17:01:58.058 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:01:58.058 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/subscription-plans - 204 null null 0.1253ms
2025-07-30 17:01:58.059 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users - application/json null
2025-07-30 17:01:58.059 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:01:58.059 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/subscription-plans - application/json null
2025-07-30 17:01:58.059 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:01:58.060 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:01:58.060 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUsers (CeceLearningPortal.Api)'
2025-07-30 17:01:58.060 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:01:58.060 +08:00 [INF] Route matched with {action = "GetUsers", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUsers(CeceLearningPortal.Api.DTOs.UserManagementFilterDto) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 17:01:58.060 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetSubscriptionPlans (CeceLearningPortal.Api)'
2025-07-30 17:01:58.060 +08:00 [INF] Route matched with {action = "GetSubscriptionPlans", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetSubscriptionPlans() on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 17:01:58.061 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
2025-07-30 17:01:58.061 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."CreatedAt", s."Description", s."DisplayOrder", s."Features", s."HasAnalytics", s."HasPrioritySupport", s."HasUnlimitedAccess", s."IsActive", s."IsRecommended", s."MaxCourseAccess", s."MaxCoursesCanCreate", s."MaxStudentsPerCourse", s."MonthlyPrice", s."Name", s."PlanType", s."TransactionFeePercentage", s."UpdatedAt", s."YearlyPrice", s0."Id", s0."BillingCycle", s0."CreatedAt", s0."EndDate", s0."NextBillingDate", s0."PlanName", s0."Price", s0."StartDate", s0."Status", s0."StripeSubscriptionId", s0."SubscriptionPlanId", s0."UpdatedAt", s0."UserId"
FROM "SubscriptionPlans" AS s
LEFT JOIN "Subscriptions" AS s0 ON s."Id" = s0."SubscriptionPlanId"
ORDER BY s."Id"
2025-07-30 17:01:58.061 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[CeceLearningPortal.Api.DTOs.SubscriptionPlanDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-30 17:01:58.061 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetSubscriptionPlans (CeceLearningPortal.Api) in 0.8705ms
2025-07-30 17:01:58.061 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetSubscriptionPlans (CeceLearningPortal.Api)'
2025-07-30 17:01:58.061 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/subscription-plans - 200 null application/json; charset=utf-8 2.3865ms
2025-07-30 17:01:58.061 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."UserName", a."Email", a."FullName", a."Role", a."Status", a."CreatedAt", a."LastLoginAt", a."EmailConfirmed"
FROM "AspNetUsers" AS a
ORDER BY a."CreatedAt" DESC
LIMIT @__p_1 OFFSET @__p_0
2025-07-30 17:01:58.062 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[CeceLearningPortal.Api.DTOs.UserManagementDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-30 17:01:58.062 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUsers (CeceLearningPortal.Api) in 1.4489ms
2025-07-30 17:01:58.062 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUsers (CeceLearningPortal.Api)'
2025-07-30 17:01:58.062 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users - 200 null application/json; charset=utf-8 3.0047ms
2025-07-30 17:01:58.063 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/b9030b04-2da7-449f-94de-d6d4814a8177/subscription - null null
2025-07-30 17:01:58.063 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:01:58.063 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/b9030b04-2da7-449f-94de-d6d4814a8177/subscription - 204 null null 0.1036ms
2025-07-30 17:01:58.063 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/efead752-f0b3-48ab-93b8-7ba31e7574ba/subscription - null null
2025-07-30 17:01:58.063 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:01:58.063 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/efead752-f0b3-48ab-93b8-7ba31e7574ba/subscription - 204 null null 0.0876ms
2025-07-30 17:01:58.064 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/e090c598-224f-4b4c-870a-3c3ef6303e0a/subscription - null null
2025-07-30 17:01:58.064 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:01:58.064 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/801dc698-62a8-49c3-b578-b7c1b05049a4/subscription - null null
2025-07-30 17:01:58.064 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/e090c598-224f-4b4c-870a-3c3ef6303e0a/subscription - 204 null null 0.0712ms
2025-07-30 17:01:58.064 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:01:58.064 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/801dc698-62a8-49c3-b578-b7c1b05049a4/subscription - 204 null null 0.1247ms
2025-07-30 17:01:58.064 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/28b8e854-738a-4e69-835c-71299a8f9b21/subscription - null null
2025-07-30 17:01:58.064 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:01:58.064 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/f9f0e64e-3771-4aa9-8470-21e709677e44/subscription - null null
2025-07-30 17:01:58.064 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/28b8e854-738a-4e69-835c-71299a8f9b21/subscription - 204 null null 0.0838ms
2025-07-30 17:01:58.064 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:01:58.064 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/f9f0e64e-3771-4aa9-8470-21e709677e44/subscription - 204 null null 0.1082ms
2025-07-30 17:01:58.065 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/b9030b04-2da7-449f-94de-d6d4814a8177/subscription - application/json null
2025-07-30 17:01:58.065 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:01:58.065 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/efead752-f0b3-48ab-93b8-7ba31e7574ba/subscription - application/json null
2025-07-30 17:01:58.065 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:01:58.065 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/e090c598-224f-4b4c-870a-3c3ef6303e0a/subscription - application/json null
2025-07-30 17:01:58.065 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/801dc698-62a8-49c3-b578-b7c1b05049a4/subscription - application/json null
2025-07-30 17:01:58.065 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:01:58.066 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/f9f0e64e-3771-4aa9-8470-21e709677e44/subscription - application/json null
2025-07-30 17:01:58.066 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:01:58.066 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/28b8e854-738a-4e69-835c-71299a8f9b21/subscription - application/json null
2025-07-30 17:01:58.066 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:01:58.066 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:01:58.066 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:01:58.066 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:01:58.066 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 17:01:58.066 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:01:58.066 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:01:58.066 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 17:01:58.066 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 17:01:58.066 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 17:01:58.066 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 17:01:58.066 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 17:01:58.066 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:01:58.066 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:01:58.066 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 17:01:58.066 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 17:01:58.066 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 17:01:58.066 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 17:01:58.066 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 17:01:58.067 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 17:01:58.067 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 17:01:58.067 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 17:01:58.067 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 17:01:58.067 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType83`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 17:01:58.067 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType83`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 17:01:58.067 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 17:01:58.067 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 17:01:58.067 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType83`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 17:01:58.067 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 17:01:58.067 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType83`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 17:01:58.067 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType83`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 17:01:58.067 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 0.8917ms
2025-07-30 17:01:58.067 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 0.8331ms
2025-07-30 17:01:58.067 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 0.9208ms
2025-07-30 17:01:58.067 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType83`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 17:01:58.068 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 17:01:58.068 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 0.9968ms
2025-07-30 17:01:58.067 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 17:01:58.067 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 17:01:58.068 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/b9030b04-2da7-449f-94de-d6d4814a8177/subscription - 200 null application/json; charset=utf-8 2.5206ms
2025-07-30 17:01:58.068 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/f9f0e64e-3771-4aa9-8470-21e709677e44/subscription - 200 null application/json; charset=utf-8 2.1721ms
2025-07-30 17:01:58.067 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 0.8479ms
2025-07-30 17:01:58.068 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/e090c598-224f-4b4c-870a-3c3ef6303e0a/subscription - 200 null application/json; charset=utf-8 2.2148ms
2025-07-30 17:01:58.068 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 17:01:58.068 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 1.2612ms
2025-07-30 17:01:58.068 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/28b8e854-738a-4e69-835c-71299a8f9b21/subscription - 200 null application/json; charset=utf-8 2.2595ms
2025-07-30 17:01:58.068 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 17:01:58.068 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 17:01:58.068 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/801dc698-62a8-49c3-b578-b7c1b05049a4/subscription - 200 null application/json; charset=utf-8 2.4584ms
2025-07-30 17:01:58.068 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/efead752-f0b3-48ab-93b8-7ba31e7574ba/subscription - 200 null application/json; charset=utf-8 2.6277ms
2025-07-30 17:02:13.173 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users - null null
2025-07-30 17:02:13.173 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:02:13.174 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users - 204 null null 0.2006ms
2025-07-30 17:02:13.174 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/subscription-plans - null null
2025-07-30 17:02:13.174 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:02:13.174 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/subscription-plans - 204 null null 0.2413ms
2025-07-30 17:02:13.174 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users - application/json null
2025-07-30 17:02:13.175 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/subscription-plans - application/json null
2025-07-30 17:02:13.175 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:02:13.175 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:02:13.176 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:02:13.176 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:02:13.176 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetSubscriptionPlans (CeceLearningPortal.Api)'
2025-07-30 17:02:13.176 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUsers (CeceLearningPortal.Api)'
2025-07-30 17:02:13.176 +08:00 [INF] Route matched with {action = "GetSubscriptionPlans", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetSubscriptionPlans() on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 17:02:13.176 +08:00 [INF] Route matched with {action = "GetUsers", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUsers(CeceLearningPortal.Api.DTOs.UserManagementFilterDto) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 17:02:13.177 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."CreatedAt", s."Description", s."DisplayOrder", s."Features", s."HasAnalytics", s."HasPrioritySupport", s."HasUnlimitedAccess", s."IsActive", s."IsRecommended", s."MaxCourseAccess", s."MaxCoursesCanCreate", s."MaxStudentsPerCourse", s."MonthlyPrice", s."Name", s."PlanType", s."TransactionFeePercentage", s."UpdatedAt", s."YearlyPrice", s0."Id", s0."BillingCycle", s0."CreatedAt", s0."EndDate", s0."NextBillingDate", s0."PlanName", s0."Price", s0."StartDate", s0."Status", s0."StripeSubscriptionId", s0."SubscriptionPlanId", s0."UpdatedAt", s0."UserId"
FROM "SubscriptionPlans" AS s
LEFT JOIN "Subscriptions" AS s0 ON s."Id" = s0."SubscriptionPlanId"
ORDER BY s."Id"
2025-07-30 17:02:13.177 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[CeceLearningPortal.Api.DTOs.SubscriptionPlanDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-30 17:02:13.177 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetSubscriptionPlans (CeceLearningPortal.Api) in 0.9834ms
2025-07-30 17:02:13.177 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetSubscriptionPlans (CeceLearningPortal.Api)'
2025-07-30 17:02:13.177 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/subscription-plans - 200 null application/json; charset=utf-8 2.7303ms
2025-07-30 17:02:13.177 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
2025-07-30 17:02:13.178 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."UserName", a."Email", a."FullName", a."Role", a."Status", a."CreatedAt", a."LastLoginAt", a."EmailConfirmed"
FROM "AspNetUsers" AS a
ORDER BY a."CreatedAt" DESC
LIMIT @__p_1 OFFSET @__p_0
2025-07-30 17:02:13.178 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[CeceLearningPortal.Api.DTOs.UserManagementDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-30 17:02:13.178 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUsers (CeceLearningPortal.Api) in 1.967ms
2025-07-30 17:02:13.178 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUsers (CeceLearningPortal.Api)'
2025-07-30 17:02:13.178 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users - 200 null application/json; charset=utf-8 3.7931ms
2025-07-30 17:02:13.180 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/b9030b04-2da7-449f-94de-d6d4814a8177/subscription - null null
2025-07-30 17:02:13.180 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:02:13.180 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/b9030b04-2da7-449f-94de-d6d4814a8177/subscription - 204 null null 0.1345ms
2025-07-30 17:02:13.180 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/efead752-f0b3-48ab-93b8-7ba31e7574ba/subscription - null null
2025-07-30 17:02:13.180 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:02:13.180 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/efead752-f0b3-48ab-93b8-7ba31e7574ba/subscription - 204 null null 0.0963ms
2025-07-30 17:02:13.181 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/e090c598-224f-4b4c-870a-3c3ef6303e0a/subscription - null null
2025-07-30 17:02:13.181 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:02:13.181 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/801dc698-62a8-49c3-b578-b7c1b05049a4/subscription - null null
2025-07-30 17:02:13.181 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/e090c598-224f-4b4c-870a-3c3ef6303e0a/subscription - 204 null null 0.0748ms
2025-07-30 17:02:13.181 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:02:13.181 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/801dc698-62a8-49c3-b578-b7c1b05049a4/subscription - 204 null null 0.1387ms
2025-07-30 17:02:13.181 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/28b8e854-738a-4e69-835c-71299a8f9b21/subscription - null null
2025-07-30 17:02:13.181 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:02:13.181 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/28b8e854-738a-4e69-835c-71299a8f9b21/subscription - 204 null null 0.0847ms
2025-07-30 17:02:13.181 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/f9f0e64e-3771-4aa9-8470-21e709677e44/subscription - null null
2025-07-30 17:02:13.181 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:02:13.181 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/f9f0e64e-3771-4aa9-8470-21e709677e44/subscription - 204 null null 0.0767ms
2025-07-30 17:02:13.182 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/b9030b04-2da7-449f-94de-d6d4814a8177/subscription - application/json null
2025-07-30 17:02:13.182 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:02:13.182 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/efead752-f0b3-48ab-93b8-7ba31e7574ba/subscription - application/json null
2025-07-30 17:02:13.182 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:02:13.182 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/e090c598-224f-4b4c-870a-3c3ef6303e0a/subscription - application/json null
2025-07-30 17:02:13.183 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/28b8e854-738a-4e69-835c-71299a8f9b21/subscription - application/json null
2025-07-30 17:02:13.183 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:02:13.183 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:02:13.182 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/801dc698-62a8-49c3-b578-b7c1b05049a4/subscription - application/json null
2025-07-30 17:02:13.183 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/f9f0e64e-3771-4aa9-8470-21e709677e44/subscription - application/json null
2025-07-30 17:02:13.183 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:02:13.183 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:02:13.183 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:02:13.183 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:02:13.183 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 17:02:13.183 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 17:02:13.183 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 17:02:13.183 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 17:02:13.183 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:02:13.183 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:02:13.183 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:02:13.183 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:02:13.184 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 17:02:13.183 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 17:02:13.184 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 17:02:13.184 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 17:02:13.184 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 17:02:13.184 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 17:02:13.184 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 17:02:13.184 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 17:02:13.184 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 17:02:13.184 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 17:02:13.184 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType83`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 17:02:13.184 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType83`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 17:02:13.184 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 17:02:13.184 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 17:02:13.185 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType83`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 17:02:13.185 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 17:02:13.185 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 0.892ms
2025-07-30 17:02:13.184 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 17:02:13.184 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 1.039ms
2025-07-30 17:02:13.184 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 1.0222ms
2025-07-30 17:02:13.185 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType83`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 17:02:13.185 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType83`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 17:02:13.185 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 1.0547ms
2025-07-30 17:02:13.185 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 17:02:13.185 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType83`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 17:02:13.185 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 17:02:13.185 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 17:02:13.185 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 0.9707ms
2025-07-30 17:02:13.185 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 17:02:13.185 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/e090c598-224f-4b4c-870a-3c3ef6303e0a/subscription - 200 null application/json; charset=utf-8 2.4578ms
2025-07-30 17:02:13.185 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/801dc698-62a8-49c3-b578-b7c1b05049a4/subscription - 200 null application/json; charset=utf-8 2.6014ms
2025-07-30 17:02:13.185 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/efead752-f0b3-48ab-93b8-7ba31e7574ba/subscription - 200 null application/json; charset=utf-8 2.6064ms
2025-07-30 17:02:13.185 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/b9030b04-2da7-449f-94de-d6d4814a8177/subscription - 200 null application/json; charset=utf-8 2.7997ms
2025-07-30 17:02:13.185 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 17:02:13.185 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 1.1672ms
2025-07-30 17:02:13.185 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/f9f0e64e-3771-4aa9-8470-21e709677e44/subscription - 200 null application/json; charset=utf-8 2.6288ms
2025-07-30 17:02:13.185 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 17:02:13.185 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/28b8e854-738a-4e69-835c-71299a8f9b21/subscription - 200 null application/json; charset=utf-8 2.7642ms
2025-07-30 17:02:20.057 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users - null null
2025-07-30 17:02:20.057 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:02:20.057 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users - 204 null null 0.1938ms
2025-07-30 17:02:20.057 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/subscription-plans - null null
2025-07-30 17:02:20.058 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:02:20.058 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/subscription-plans - 204 null null 0.0996ms
2025-07-30 17:02:20.059 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users - application/json null
2025-07-30 17:02:20.059 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/subscription-plans - application/json null
2025-07-30 17:02:20.059 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:02:20.059 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:02:20.060 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:02:20.060 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:02:20.060 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetSubscriptionPlans (CeceLearningPortal.Api)'
2025-07-30 17:02:20.060 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUsers (CeceLearningPortal.Api)'
2025-07-30 17:02:20.060 +08:00 [INF] Route matched with {action = "GetSubscriptionPlans", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetSubscriptionPlans() on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 17:02:20.060 +08:00 [INF] Route matched with {action = "GetUsers", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUsers(CeceLearningPortal.Api.DTOs.UserManagementFilterDto) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 17:02:20.061 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
2025-07-30 17:02:20.061 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."UserName", a."Email", a."FullName", a."Role", a."Status", a."CreatedAt", a."LastLoginAt", a."EmailConfirmed"
FROM "AspNetUsers" AS a
ORDER BY a."CreatedAt" DESC
LIMIT @__p_1 OFFSET @__p_0
2025-07-30 17:02:20.061 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[CeceLearningPortal.Api.DTOs.UserManagementDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-30 17:02:20.061 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."CreatedAt", s."Description", s."DisplayOrder", s."Features", s."HasAnalytics", s."HasPrioritySupport", s."HasUnlimitedAccess", s."IsActive", s."IsRecommended", s."MaxCourseAccess", s."MaxCoursesCanCreate", s."MaxStudentsPerCourse", s."MonthlyPrice", s."Name", s."PlanType", s."TransactionFeePercentage", s."UpdatedAt", s."YearlyPrice", s0."Id", s0."BillingCycle", s0."CreatedAt", s0."EndDate", s0."NextBillingDate", s0."PlanName", s0."Price", s0."StartDate", s0."Status", s0."StripeSubscriptionId", s0."SubscriptionPlanId", s0."UpdatedAt", s0."UserId"
FROM "SubscriptionPlans" AS s
LEFT JOIN "Subscriptions" AS s0 ON s."Id" = s0."SubscriptionPlanId"
ORDER BY s."Id"
2025-07-30 17:02:20.061 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUsers (CeceLearningPortal.Api) in 1.1266ms
2025-07-30 17:02:20.061 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[CeceLearningPortal.Api.DTOs.SubscriptionPlanDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-30 17:02:20.061 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUsers (CeceLearningPortal.Api)'
2025-07-30 17:02:20.061 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetSubscriptionPlans (CeceLearningPortal.Api) in 1.269ms
2025-07-30 17:02:20.061 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetSubscriptionPlans (CeceLearningPortal.Api)'
2025-07-30 17:02:20.061 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users - 200 null application/json; charset=utf-8 2.6155ms
2025-07-30 17:02:20.061 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/subscription-plans - 200 null application/json; charset=utf-8 2.6389ms
2025-07-30 17:02:20.063 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/b9030b04-2da7-449f-94de-d6d4814a8177/subscription - null null
2025-07-30 17:02:20.063 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:02:20.063 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/b9030b04-2da7-449f-94de-d6d4814a8177/subscription - 204 null null 0.0823ms
2025-07-30 17:02:20.063 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/efead752-f0b3-48ab-93b8-7ba31e7574ba/subscription - null null
2025-07-30 17:02:20.063 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:02:20.063 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/efead752-f0b3-48ab-93b8-7ba31e7574ba/subscription - 204 null null 0.0848ms
2025-07-30 17:02:20.063 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/e090c598-224f-4b4c-870a-3c3ef6303e0a/subscription - null null
2025-07-30 17:02:20.063 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:02:20.063 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/801dc698-62a8-49c3-b578-b7c1b05049a4/subscription - null null
2025-07-30 17:02:20.063 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/e090c598-224f-4b4c-870a-3c3ef6303e0a/subscription - 204 null null 0.0726ms
2025-07-30 17:02:20.063 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:02:20.064 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/801dc698-62a8-49c3-b578-b7c1b05049a4/subscription - 204 null null 0.1269ms
2025-07-30 17:02:20.064 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/28b8e854-738a-4e69-835c-71299a8f9b21/subscription - null null
2025-07-30 17:02:20.064 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:02:20.064 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/f9f0e64e-3771-4aa9-8470-21e709677e44/subscription - null null
2025-07-30 17:02:20.064 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/28b8e854-738a-4e69-835c-71299a8f9b21/subscription - 204 null null 0.0841ms
2025-07-30 17:02:20.064 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:02:20.064 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/f9f0e64e-3771-4aa9-8470-21e709677e44/subscription - 204 null null 0.1334ms
2025-07-30 17:02:20.065 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/b9030b04-2da7-449f-94de-d6d4814a8177/subscription - application/json null
2025-07-30 17:02:20.065 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:02:20.065 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/efead752-f0b3-48ab-93b8-7ba31e7574ba/subscription - application/json null
2025-07-30 17:02:20.065 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:02:20.065 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/e090c598-224f-4b4c-870a-3c3ef6303e0a/subscription - application/json null
2025-07-30 17:02:20.065 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/801dc698-62a8-49c3-b578-b7c1b05049a4/subscription - application/json null
2025-07-30 17:02:20.065 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/28b8e854-738a-4e69-835c-71299a8f9b21/subscription - application/json null
2025-07-30 17:02:20.065 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/f9f0e64e-3771-4aa9-8470-21e709677e44/subscription - application/json null
2025-07-30 17:02:20.065 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:02:20.065 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:02:20.065 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:02:20.065 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:02:20.065 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:02:20.066 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:02:20.066 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 17:02:20.066 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 17:02:20.066 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 17:02:20.066 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 17:02:20.066 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:02:20.066 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:02:20.066 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 17:02:20.066 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 17:02:20.066 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 17:02:20.066 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 17:02:20.066 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:02:20.066 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:02:20.066 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 17:02:20.066 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 17:02:20.066 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 17:02:20.066 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 17:02:20.066 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 17:02:20.066 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType83`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 17:02:20.066 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType83`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 17:02:20.067 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 17:02:20.067 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 0.9043ms
2025-07-30 17:02:20.067 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 0.9416ms
2025-07-30 17:02:20.067 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 17:02:20.067 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 17:02:20.067 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType83`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 17:02:20.067 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/efead752-f0b3-48ab-93b8-7ba31e7574ba/subscription - 200 null application/json; charset=utf-8 1.8326ms
2025-07-30 17:02:20.067 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 17:02:20.067 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 17:02:20.067 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 0.7301ms
2025-07-30 17:02:20.067 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/b9030b04-2da7-449f-94de-d6d4814a8177/subscription - 200 null application/json; charset=utf-8 2.1087ms
2025-07-30 17:02:20.067 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType83`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 17:02:20.067 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 17:02:20.067 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 17:02:20.067 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/e090c598-224f-4b4c-870a-3c3ef6303e0a/subscription - 200 null application/json; charset=utf-8 1.9609ms
2025-07-30 17:02:20.067 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType83`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 17:02:20.067 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 0.8954ms
2025-07-30 17:02:20.067 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 17:02:20.067 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 0.7551ms
2025-07-30 17:02:20.067 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/801dc698-62a8-49c3-b578-b7c1b05049a4/subscription - 200 null application/json; charset=utf-8 2.1575ms
2025-07-30 17:02:20.067 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 17:02:20.067 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 17:02:20.067 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType83`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 17:02:20.067 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/f9f0e64e-3771-4aa9-8470-21e709677e44/subscription - 200 null application/json; charset=utf-8 2.2073ms
2025-07-30 17:02:20.067 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 0.7822ms
2025-07-30 17:02:20.067 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 17:02:20.067 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/28b8e854-738a-4e69-835c-71299a8f9b21/subscription - 200 null application/json; charset=utf-8 2.2584ms
2025-07-30 17:02:35.051 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users - null null
2025-07-30 17:02:35.052 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:02:35.052 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users - 204 null null 0.1956ms
2025-07-30 17:02:35.052 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/subscription-plans - null null
2025-07-30 17:02:35.052 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:02:35.052 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/subscription-plans - 204 null null 0.1039ms
2025-07-30 17:02:35.052 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users - application/json null
2025-07-30 17:02:35.053 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:02:35.053 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/subscription-plans - application/json null
2025-07-30 17:02:35.053 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:02:35.054 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:02:35.054 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:02:35.054 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUsers (CeceLearningPortal.Api)'
2025-07-30 17:02:35.054 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetSubscriptionPlans (CeceLearningPortal.Api)'
2025-07-30 17:02:35.054 +08:00 [INF] Route matched with {action = "GetUsers", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUsers(CeceLearningPortal.Api.DTOs.UserManagementFilterDto) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 17:02:35.054 +08:00 [INF] Route matched with {action = "GetSubscriptionPlans", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetSubscriptionPlans() on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 17:02:35.054 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
2025-07-30 17:02:35.055 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."UserName", a."Email", a."FullName", a."Role", a."Status", a."CreatedAt", a."LastLoginAt", a."EmailConfirmed"
FROM "AspNetUsers" AS a
ORDER BY a."CreatedAt" DESC
LIMIT @__p_1 OFFSET @__p_0
2025-07-30 17:02:35.055 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."CreatedAt", s."Description", s."DisplayOrder", s."Features", s."HasAnalytics", s."HasPrioritySupport", s."HasUnlimitedAccess", s."IsActive", s."IsRecommended", s."MaxCourseAccess", s."MaxCoursesCanCreate", s."MaxStudentsPerCourse", s."MonthlyPrice", s."Name", s."PlanType", s."TransactionFeePercentage", s."UpdatedAt", s."YearlyPrice", s0."Id", s0."BillingCycle", s0."CreatedAt", s0."EndDate", s0."NextBillingDate", s0."PlanName", s0."Price", s0."StartDate", s0."Status", s0."StripeSubscriptionId", s0."SubscriptionPlanId", s0."UpdatedAt", s0."UserId"
FROM "SubscriptionPlans" AS s
LEFT JOIN "Subscriptions" AS s0 ON s."Id" = s0."SubscriptionPlanId"
ORDER BY s."Id"
2025-07-30 17:02:35.055 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[CeceLearningPortal.Api.DTOs.UserManagementDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-30 17:02:35.055 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[CeceLearningPortal.Api.DTOs.SubscriptionPlanDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-30 17:02:35.055 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUsers (CeceLearningPortal.Api) in 1.2341ms
2025-07-30 17:02:35.055 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetSubscriptionPlans (CeceLearningPortal.Api) in 1.2159ms
2025-07-30 17:02:35.055 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUsers (CeceLearningPortal.Api)'
2025-07-30 17:02:35.055 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetSubscriptionPlans (CeceLearningPortal.Api)'
2025-07-30 17:02:35.055 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users - 200 null application/json; charset=utf-8 2.7481ms
2025-07-30 17:02:35.055 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/subscription-plans - 200 null application/json; charset=utf-8 2.6746ms
2025-07-30 17:02:35.057 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/b9030b04-2da7-449f-94de-d6d4814a8177/subscription - null null
2025-07-30 17:02:35.057 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:02:35.057 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/b9030b04-2da7-449f-94de-d6d4814a8177/subscription - 204 null null 0.0875ms
2025-07-30 17:02:35.057 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/efead752-f0b3-48ab-93b8-7ba31e7574ba/subscription - null null
2025-07-30 17:02:35.058 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:02:35.058 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/efead752-f0b3-48ab-93b8-7ba31e7574ba/subscription - 204 null null 0.0856ms
2025-07-30 17:02:35.058 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/e090c598-224f-4b4c-870a-3c3ef6303e0a/subscription - null null
2025-07-30 17:02:35.058 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:02:35.058 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/801dc698-62a8-49c3-b578-b7c1b05049a4/subscription - null null
2025-07-30 17:02:35.058 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/e090c598-224f-4b4c-870a-3c3ef6303e0a/subscription - 204 null null 0.0727ms
2025-07-30 17:02:35.058 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:02:35.058 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/801dc698-62a8-49c3-b578-b7c1b05049a4/subscription - 204 null null 0.1065ms
2025-07-30 17:02:35.058 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/28b8e854-738a-4e69-835c-71299a8f9b21/subscription - null null
2025-07-30 17:02:35.058 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:02:35.058 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/f9f0e64e-3771-4aa9-8470-21e709677e44/subscription - null null
2025-07-30 17:02:35.058 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/28b8e854-738a-4e69-835c-71299a8f9b21/subscription - 204 null null 0.0763ms
2025-07-30 17:02:35.058 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:02:35.058 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/f9f0e64e-3771-4aa9-8470-21e709677e44/subscription - 204 null null 0.1125ms
2025-07-30 17:02:35.059 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/b9030b04-2da7-449f-94de-d6d4814a8177/subscription - application/json null
2025-07-30 17:02:35.059 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:02:35.059 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/efead752-f0b3-48ab-93b8-7ba31e7574ba/subscription - application/json null
2025-07-30 17:02:35.060 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:02:35.060 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/e090c598-224f-4b4c-870a-3c3ef6303e0a/subscription - application/json null
2025-07-30 17:02:35.060 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:02:35.060 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/f9f0e64e-3771-4aa9-8470-21e709677e44/subscription - application/json null
2025-07-30 17:02:35.060 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/801dc698-62a8-49c3-b578-b7c1b05049a4/subscription - application/json null
2025-07-30 17:02:35.060 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:02:35.060 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/28b8e854-738a-4e69-835c-71299a8f9b21/subscription - application/json null
2025-07-30 17:02:35.060 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:02:35.060 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:02:35.060 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:02:35.060 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 17:02:35.060 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 17:02:35.060 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:02:35.060 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 17:02:35.060 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:02:35.060 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 17:02:35.060 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 17:02:35.060 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:02:35.060 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 17:02:35.060 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:02:35.061 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:02:35.061 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 17:02:35.061 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 17:02:35.061 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 17:02:35.061 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 17:02:35.061 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 17:02:35.061 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 17:02:35.061 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 17:02:35.061 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType83`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 17:02:35.061 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 0.7986ms
2025-07-30 17:02:35.061 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 17:02:35.061 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 17:02:35.061 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/efead752-f0b3-48ab-93b8-7ba31e7574ba/subscription - 200 null application/json; charset=utf-8 1.6415ms
2025-07-30 17:02:35.061 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType83`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 17:02:35.061 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 17:02:35.061 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 0.7611ms
2025-07-30 17:02:35.061 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType83`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 17:02:35.061 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 17:02:35.061 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 0.7675ms
2025-07-30 17:02:35.061 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 17:02:35.061 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 17:02:35.061 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/b9030b04-2da7-449f-94de-d6d4814a8177/subscription - 200 null application/json; charset=utf-8 2.0109ms
2025-07-30 17:02:35.061 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 17:02:35.061 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType83`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 17:02:35.061 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType83`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 17:02:35.062 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/f9f0e64e-3771-4aa9-8470-21e709677e44/subscription - 200 null application/json; charset=utf-8 1.8455ms
2025-07-30 17:02:35.062 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 0.8689ms
2025-07-30 17:02:35.062 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 0.7922ms
2025-07-30 17:02:35.062 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 17:02:35.062 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 17:02:35.062 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 17:02:35.062 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType83`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 17:02:35.062 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/801dc698-62a8-49c3-b578-b7c1b05049a4/subscription - 200 null application/json; charset=utf-8 2.1288ms
2025-07-30 17:02:35.062 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/28b8e854-738a-4e69-835c-71299a8f9b21/subscription - 200 null application/json; charset=utf-8 1.9712ms
2025-07-30 17:02:35.062 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 1.0027ms
2025-07-30 17:02:35.062 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 17:02:35.062 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/e090c598-224f-4b4c-870a-3c3ef6303e0a/subscription - 200 null application/json; charset=utf-8 2.4516ms
2025-07-30 17:02:45.060 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users - null null
2025-07-30 17:02:45.060 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:02:45.060 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users - 204 null null 0.1982ms
2025-07-30 17:02:45.060 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/subscription-plans - null null
2025-07-30 17:02:45.060 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:02:45.060 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/subscription-plans - 204 null null 0.1555ms
2025-07-30 17:02:45.061 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users - application/json null
2025-07-30 17:02:45.061 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:02:45.061 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/subscription-plans - application/json null
2025-07-30 17:02:45.061 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:02:45.062 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:02:45.062 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:02:45.062 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetSubscriptionPlans (CeceLearningPortal.Api)'
2025-07-30 17:02:45.062 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUsers (CeceLearningPortal.Api)'
2025-07-30 17:02:45.062 +08:00 [INF] Route matched with {action = "GetSubscriptionPlans", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetSubscriptionPlans() on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 17:02:45.062 +08:00 [INF] Route matched with {action = "GetUsers", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUsers(CeceLearningPortal.Api.DTOs.UserManagementFilterDto) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 17:02:45.063 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."CreatedAt", s."Description", s."DisplayOrder", s."Features", s."HasAnalytics", s."HasPrioritySupport", s."HasUnlimitedAccess", s."IsActive", s."IsRecommended", s."MaxCourseAccess", s."MaxCoursesCanCreate", s."MaxStudentsPerCourse", s."MonthlyPrice", s."Name", s."PlanType", s."TransactionFeePercentage", s."UpdatedAt", s."YearlyPrice", s0."Id", s0."BillingCycle", s0."CreatedAt", s0."EndDate", s0."NextBillingDate", s0."PlanName", s0."Price", s0."StartDate", s0."Status", s0."StripeSubscriptionId", s0."SubscriptionPlanId", s0."UpdatedAt", s0."UserId"
FROM "SubscriptionPlans" AS s
LEFT JOIN "Subscriptions" AS s0 ON s."Id" = s0."SubscriptionPlanId"
ORDER BY s."Id"
2025-07-30 17:02:45.063 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[CeceLearningPortal.Api.DTOs.SubscriptionPlanDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-30 17:02:45.063 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetSubscriptionPlans (CeceLearningPortal.Api) in 0.6957ms
2025-07-30 17:02:45.063 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetSubscriptionPlans (CeceLearningPortal.Api)'
2025-07-30 17:02:45.063 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
2025-07-30 17:02:45.063 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/subscription-plans - 200 null application/json; charset=utf-8 1.7721ms
2025-07-30 17:02:45.063 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."UserName", a."Email", a."FullName", a."Role", a."Status", a."CreatedAt", a."LastLoginAt", a."EmailConfirmed"
FROM "AspNetUsers" AS a
ORDER BY a."CreatedAt" DESC
LIMIT @__p_1 OFFSET @__p_0
2025-07-30 17:02:45.063 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[CeceLearningPortal.Api.DTOs.UserManagementDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-30 17:02:45.064 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUsers (CeceLearningPortal.Api) in 1.3989ms
2025-07-30 17:02:45.064 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUsers (CeceLearningPortal.Api)'
2025-07-30 17:02:45.064 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users - 200 null application/json; charset=utf-8 2.6001ms
2025-07-30 17:02:45.065 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/b9030b04-2da7-449f-94de-d6d4814a8177/subscription - null null
2025-07-30 17:02:45.065 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:02:45.065 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/b9030b04-2da7-449f-94de-d6d4814a8177/subscription - 204 null null 0.0941ms
2025-07-30 17:02:45.065 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/efead752-f0b3-48ab-93b8-7ba31e7574ba/subscription - null null
2025-07-30 17:02:45.065 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:02:45.065 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/efead752-f0b3-48ab-93b8-7ba31e7574ba/subscription - 204 null null 0.0849ms
2025-07-30 17:02:45.065 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/e090c598-224f-4b4c-870a-3c3ef6303e0a/subscription - null null
2025-07-30 17:02:45.066 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:02:45.066 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/801dc698-62a8-49c3-b578-b7c1b05049a4/subscription - null null
2025-07-30 17:02:45.066 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/e090c598-224f-4b4c-870a-3c3ef6303e0a/subscription - 204 null null 0.0864ms
2025-07-30 17:02:45.066 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:02:45.066 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/801dc698-62a8-49c3-b578-b7c1b05049a4/subscription - 204 null null 0.0845ms
2025-07-30 17:02:45.066 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/28b8e854-738a-4e69-835c-71299a8f9b21/subscription - null null
2025-07-30 17:02:45.066 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:02:45.066 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/f9f0e64e-3771-4aa9-8470-21e709677e44/subscription - null null
2025-07-30 17:02:45.066 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/28b8e854-738a-4e69-835c-71299a8f9b21/subscription - 204 null null 0.0753ms
2025-07-30 17:02:45.066 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:02:45.066 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/f9f0e64e-3771-4aa9-8470-21e709677e44/subscription - 204 null null 0.1023ms
2025-07-30 17:02:45.067 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/b9030b04-2da7-449f-94de-d6d4814a8177/subscription - application/json null
2025-07-30 17:02:45.067 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:02:45.067 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/efead752-f0b3-48ab-93b8-7ba31e7574ba/subscription - application/json null
2025-07-30 17:02:45.067 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:02:45.067 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/e090c598-224f-4b4c-870a-3c3ef6303e0a/subscription - application/json null
2025-07-30 17:02:45.067 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:02:45.067 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/f9f0e64e-3771-4aa9-8470-21e709677e44/subscription - application/json null
2025-07-30 17:02:45.067 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/801dc698-62a8-49c3-b578-b7c1b05049a4/subscription - application/json null
2025-07-30 17:02:45.067 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/28b8e854-738a-4e69-835c-71299a8f9b21/subscription - application/json null
2025-07-30 17:02:45.067 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:02:45.067 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:02:45.067 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:02:45.068 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:02:45.068 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 17:02:45.068 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:02:45.068 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 17:02:45.068 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 17:02:45.068 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 17:02:45.068 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:02:45.068 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:02:45.068 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:02:45.068 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 17:02:45.068 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 17:02:45.068 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 17:02:45.068 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 17:02:45.068 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 17:02:45.068 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 17:02:45.068 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:02:45.068 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 17:02:45.068 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 17:02:45.068 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 17:02:45.068 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType83`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 17:02:45.069 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 0.7842ms
2025-07-30 17:02:45.069 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 17:02:45.069 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 17:02:45.069 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/b9030b04-2da7-449f-94de-d6d4814a8177/subscription - 200 null application/json; charset=utf-8 1.6898ms
2025-07-30 17:02:45.069 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType83`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 17:02:45.069 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 0.8266ms
2025-07-30 17:02:45.069 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 17:02:45.069 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 17:02:45.069 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/efead752-f0b3-48ab-93b8-7ba31e7574ba/subscription - 200 null application/json; charset=utf-8 1.7303ms
2025-07-30 17:02:45.069 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 17:02:45.069 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 17:02:45.069 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType83`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 17:02:45.069 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType83`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 17:02:45.069 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 17:02:45.069 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 0.8232ms
2025-07-30 17:02:45.069 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType83`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 17:02:45.069 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 0.8419ms
2025-07-30 17:02:45.069 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 0.9802ms
2025-07-30 17:02:45.069 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType83`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 17:02:45.069 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 17:02:45.069 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 0.7798ms
2025-07-30 17:02:45.069 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/28b8e854-738a-4e69-835c-71299a8f9b21/subscription - 200 null application/json; charset=utf-8 1.8789ms
2025-07-30 17:02:45.069 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 17:02:45.069 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 17:02:45.069 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 17:02:45.069 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/e090c598-224f-4b4c-870a-3c3ef6303e0a/subscription - 200 null application/json; charset=utf-8 2.2399ms
2025-07-30 17:02:45.069 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/801dc698-62a8-49c3-b578-b7c1b05049a4/subscription - 200 null application/json; charset=utf-8 2.112ms
2025-07-30 17:02:45.069 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/f9f0e64e-3771-4aa9-8470-21e709677e44/subscription - 200 null application/json; charset=utf-8 2.0534ms
2025-07-30 17:02:51.055 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users - null null
2025-07-30 17:02:51.056 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:02:51.056 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users - 204 null null 0.1937ms
2025-07-30 17:02:51.056 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/subscription-plans - null null
2025-07-30 17:02:51.056 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:02:51.056 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/subscription-plans - 204 null null 0.1211ms
2025-07-30 17:02:51.056 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users - application/json null
2025-07-30 17:02:51.057 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:02:51.057 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/subscription-plans - application/json null
2025-07-30 17:02:51.057 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:02:51.058 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:02:51.058 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:02:51.058 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUsers (CeceLearningPortal.Api)'
2025-07-30 17:02:51.058 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetSubscriptionPlans (CeceLearningPortal.Api)'
2025-07-30 17:02:51.058 +08:00 [INF] Route matched with {action = "GetUsers", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUsers(CeceLearningPortal.Api.DTOs.UserManagementFilterDto) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 17:02:51.058 +08:00 [INF] Route matched with {action = "GetSubscriptionPlans", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetSubscriptionPlans() on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 17:02:51.058 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
2025-07-30 17:02:51.059 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."CreatedAt", s."Description", s."DisplayOrder", s."Features", s."HasAnalytics", s."HasPrioritySupport", s."HasUnlimitedAccess", s."IsActive", s."IsRecommended", s."MaxCourseAccess", s."MaxCoursesCanCreate", s."MaxStudentsPerCourse", s."MonthlyPrice", s."Name", s."PlanType", s."TransactionFeePercentage", s."UpdatedAt", s."YearlyPrice", s0."Id", s0."BillingCycle", s0."CreatedAt", s0."EndDate", s0."NextBillingDate", s0."PlanName", s0."Price", s0."StartDate", s0."Status", s0."StripeSubscriptionId", s0."SubscriptionPlanId", s0."UpdatedAt", s0."UserId"
FROM "SubscriptionPlans" AS s
LEFT JOIN "Subscriptions" AS s0 ON s."Id" = s0."SubscriptionPlanId"
ORDER BY s."Id"
2025-07-30 17:02:51.059 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."UserName", a."Email", a."FullName", a."Role", a."Status", a."CreatedAt", a."LastLoginAt", a."EmailConfirmed"
FROM "AspNetUsers" AS a
ORDER BY a."CreatedAt" DESC
LIMIT @__p_1 OFFSET @__p_0
2025-07-30 17:02:51.059 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[CeceLearningPortal.Api.DTOs.SubscriptionPlanDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-30 17:02:51.059 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[CeceLearningPortal.Api.DTOs.UserManagementDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-30 17:02:51.059 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetSubscriptionPlans (CeceLearningPortal.Api) in 1.2812ms
2025-07-30 17:02:51.059 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUsers (CeceLearningPortal.Api) in 1.3756ms
2025-07-30 17:02:51.059 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetSubscriptionPlans (CeceLearningPortal.Api)'
2025-07-30 17:02:51.059 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUsers (CeceLearningPortal.Api)'
2025-07-30 17:02:51.059 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/subscription-plans - 200 null application/json; charset=utf-8 2.6626ms
2025-07-30 17:02:51.059 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users - 200 null application/json; charset=utf-8 2.7903ms
2025-07-30 17:02:51.060 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/b9030b04-2da7-449f-94de-d6d4814a8177/subscription - null null
2025-07-30 17:02:51.061 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:02:51.061 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/b9030b04-2da7-449f-94de-d6d4814a8177/subscription - 204 null null 0.101ms
2025-07-30 17:02:51.061 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/efead752-f0b3-48ab-93b8-7ba31e7574ba/subscription - null null
2025-07-30 17:02:51.061 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:02:51.061 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/efead752-f0b3-48ab-93b8-7ba31e7574ba/subscription - 204 null null 0.0895ms
2025-07-30 17:02:51.061 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/e090c598-224f-4b4c-870a-3c3ef6303e0a/subscription - null null
2025-07-30 17:02:51.061 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:02:51.061 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/e090c598-224f-4b4c-870a-3c3ef6303e0a/subscription - 204 null null 0.0922ms
2025-07-30 17:02:51.062 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/801dc698-62a8-49c3-b578-b7c1b05049a4/subscription - null null
2025-07-30 17:02:51.062 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:02:51.062 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/28b8e854-738a-4e69-835c-71299a8f9b21/subscription - null null
2025-07-30 17:02:51.062 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/801dc698-62a8-49c3-b578-b7c1b05049a4/subscription - 204 null null 0.0778ms
2025-07-30 17:02:51.062 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:02:51.062 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/28b8e854-738a-4e69-835c-71299a8f9b21/subscription - 204 null null 0.1246ms
2025-07-30 17:02:51.062 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/f9f0e64e-3771-4aa9-8470-21e709677e44/subscription - null null
2025-07-30 17:02:51.062 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:02:51.062 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/f9f0e64e-3771-4aa9-8470-21e709677e44/subscription - 204 null null 0.0751ms
2025-07-30 17:02:51.063 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/b9030b04-2da7-449f-94de-d6d4814a8177/subscription - application/json null
2025-07-30 17:02:51.063 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:02:51.063 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/efead752-f0b3-48ab-93b8-7ba31e7574ba/subscription - application/json null
2025-07-30 17:02:51.063 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:02:51.063 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/e090c598-224f-4b4c-870a-3c3ef6303e0a/subscription - application/json null
2025-07-30 17:02:51.063 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/28b8e854-738a-4e69-835c-71299a8f9b21/subscription - application/json null
2025-07-30 17:02:51.063 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:02:51.063 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/801dc698-62a8-49c3-b578-b7c1b05049a4/subscription - application/json null
2025-07-30 17:02:51.063 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:02:51.063 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:02:51.063 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/f9f0e64e-3771-4aa9-8470-21e709677e44/subscription - application/json null
2025-07-30 17:02:51.063 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:02:51.063 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:02:51.064 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 17:02:51.064 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 17:02:51.064 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:02:51.064 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 17:02:51.064 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:02:51.064 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 17:02:51.064 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:02:51.064 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 17:02:51.064 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:02:51.064 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 17:02:51.064 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 17:02:51.064 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:02:51.064 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 17:02:51.064 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 17:02:51.064 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 17:02:51.064 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 17:02:51.064 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 17:02:51.064 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 17:02:51.064 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 17:02:51.064 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType83`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 17:02:51.064 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType83`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 17:02:51.064 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 17:02:51.065 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 0.8816ms
2025-07-30 17:02:51.065 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 0.756ms
2025-07-30 17:02:51.065 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType83`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 17:02:51.065 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 17:02:51.065 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 17:02:51.065 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 17:02:51.065 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 0.7772ms
2025-07-30 17:02:51.065 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/efead752-f0b3-48ab-93b8-7ba31e7574ba/subscription - 200 null application/json; charset=utf-8 2.0088ms
2025-07-30 17:02:51.065 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 17:02:51.065 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/b9030b04-2da7-449f-94de-d6d4814a8177/subscription - 200 null application/json; charset=utf-8 2.0468ms
2025-07-30 17:02:51.065 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 17:02:51.065 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType83`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 17:02:51.065 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType83`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 17:02:51.065 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 0.9114ms
2025-07-30 17:02:51.065 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 0.9511ms
2025-07-30 17:02:51.065 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType83`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 17:02:51.065 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 17:02:51.065 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 0.9739ms
2025-07-30 17:02:51.065 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/28b8e854-738a-4e69-835c-71299a8f9b21/subscription - 200 null application/json; charset=utf-8 2.1426ms
2025-07-30 17:02:51.065 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 17:02:51.065 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 17:02:51.065 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 17:02:51.065 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/801dc698-62a8-49c3-b578-b7c1b05049a4/subscription - 200 null application/json; charset=utf-8 2.1037ms
2025-07-30 17:02:51.065 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/e090c598-224f-4b4c-870a-3c3ef6303e0a/subscription - 200 null application/json; charset=utf-8 2.2965ms
2025-07-30 17:02:51.065 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/f9f0e64e-3771-4aa9-8470-21e709677e44/subscription - 200 null application/json; charset=utf-8 2.0598ms
2025-07-30 17:03:01.059 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users - null null
2025-07-30 17:03:01.059 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:03:01.060 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users - 204 null null 0.2227ms
2025-07-30 17:03:01.060 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/subscription-plans - null null
2025-07-30 17:03:01.060 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:03:01.060 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/subscription-plans - 204 null null 0.136ms
2025-07-30 17:03:01.060 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users - application/json null
2025-07-30 17:03:01.060 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/subscription-plans - application/json null
2025-07-30 17:03:01.060 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:03:01.060 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:03:01.061 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:03:01.061 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:03:01.062 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetSubscriptionPlans (CeceLearningPortal.Api)'
2025-07-30 17:03:01.062 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUsers (CeceLearningPortal.Api)'
2025-07-30 17:03:01.062 +08:00 [INF] Route matched with {action = "GetSubscriptionPlans", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetSubscriptionPlans() on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 17:03:01.062 +08:00 [INF] Route matched with {action = "GetUsers", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUsers(CeceLearningPortal.Api.DTOs.UserManagementFilterDto) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 17:03:01.062 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
2025-07-30 17:03:01.062 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."CreatedAt", s."Description", s."DisplayOrder", s."Features", s."HasAnalytics", s."HasPrioritySupport", s."HasUnlimitedAccess", s."IsActive", s."IsRecommended", s."MaxCourseAccess", s."MaxCoursesCanCreate", s."MaxStudentsPerCourse", s."MonthlyPrice", s."Name", s."PlanType", s."TransactionFeePercentage", s."UpdatedAt", s."YearlyPrice", s0."Id", s0."BillingCycle", s0."CreatedAt", s0."EndDate", s0."NextBillingDate", s0."PlanName", s0."Price", s0."StartDate", s0."Status", s0."StripeSubscriptionId", s0."SubscriptionPlanId", s0."UpdatedAt", s0."UserId"
FROM "SubscriptionPlans" AS s
LEFT JOIN "Subscriptions" AS s0 ON s."Id" = s0."SubscriptionPlanId"
ORDER BY s."Id"
2025-07-30 17:03:01.062 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[CeceLearningPortal.Api.DTOs.SubscriptionPlanDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-30 17:03:01.062 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetSubscriptionPlans (CeceLearningPortal.Api) in 0.6857ms
2025-07-30 17:03:01.062 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetSubscriptionPlans (CeceLearningPortal.Api)'
2025-07-30 17:03:01.062 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/subscription-plans - 200 null application/json; charset=utf-8 1.9217ms
2025-07-30 17:03:01.063 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."UserName", a."Email", a."FullName", a."Role", a."Status", a."CreatedAt", a."LastLoginAt", a."EmailConfirmed"
FROM "AspNetUsers" AS a
ORDER BY a."CreatedAt" DESC
LIMIT @__p_1 OFFSET @__p_0
2025-07-30 17:03:01.063 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[CeceLearningPortal.Api.DTOs.UserManagementDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-30 17:03:01.063 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUsers (CeceLearningPortal.Api) in 1.2337ms
2025-07-30 17:03:01.063 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUsers (CeceLearningPortal.Api)'
2025-07-30 17:03:01.063 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users - 200 null application/json; charset=utf-8 2.583ms
2025-07-30 17:03:01.064 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/b9030b04-2da7-449f-94de-d6d4814a8177/subscription - null null
2025-07-30 17:03:01.064 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:03:01.064 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/b9030b04-2da7-449f-94de-d6d4814a8177/subscription - 204 null null 0.0884ms
2025-07-30 17:03:01.064 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/efead752-f0b3-48ab-93b8-7ba31e7574ba/subscription - null null
2025-07-30 17:03:01.064 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:03:01.064 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/efead752-f0b3-48ab-93b8-7ba31e7574ba/subscription - 204 null null 0.0837ms
2025-07-30 17:03:01.065 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/e090c598-224f-4b4c-870a-3c3ef6303e0a/subscription - null null
2025-07-30 17:03:01.065 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:03:01.065 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/801dc698-62a8-49c3-b578-b7c1b05049a4/subscription - null null
2025-07-30 17:03:01.065 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/e090c598-224f-4b4c-870a-3c3ef6303e0a/subscription - 204 null null 0.0736ms
2025-07-30 17:03:01.065 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:03:01.065 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/801dc698-62a8-49c3-b578-b7c1b05049a4/subscription - 204 null null 0.1132ms
2025-07-30 17:03:01.065 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/28b8e854-738a-4e69-835c-71299a8f9b21/subscription - null null
2025-07-30 17:03:01.065 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:03:01.065 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/f9f0e64e-3771-4aa9-8470-21e709677e44/subscription - null null
2025-07-30 17:03:01.065 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/28b8e854-738a-4e69-835c-71299a8f9b21/subscription - 204 null null 0.0802ms
2025-07-30 17:03:01.065 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:03:01.065 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/f9f0e64e-3771-4aa9-8470-21e709677e44/subscription - 204 null null 0.1166ms
2025-07-30 17:03:01.066 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/b9030b04-2da7-449f-94de-d6d4814a8177/subscription - application/json null
2025-07-30 17:03:01.066 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:03:01.066 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/efead752-f0b3-48ab-93b8-7ba31e7574ba/subscription - application/json null
2025-07-30 17:03:01.066 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:03:01.066 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/e090c598-224f-4b4c-870a-3c3ef6303e0a/subscription - application/json null
2025-07-30 17:03:01.066 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:03:01.067 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/f9f0e64e-3771-4aa9-8470-21e709677e44/subscription - application/json null
2025-07-30 17:03:01.067 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/801dc698-62a8-49c3-b578-b7c1b05049a4/subscription - application/json null
2025-07-30 17:03:01.067 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/28b8e854-738a-4e69-835c-71299a8f9b21/subscription - application/json null
2025-07-30 17:03:01.067 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:03:01.067 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:03:01.067 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:03:01.067 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:03:01.067 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 17:03:01.067 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 17:03:01.067 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:03:01.067 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:03:01.067 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 17:03:01.067 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 17:03:01.067 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:03:01.067 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 17:03:01.067 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:03:01.067 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 17:03:01.067 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 17:03:01.067 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:03:01.067 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 17:03:01.067 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 17:03:01.067 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 17:03:01.067 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 17:03:01.068 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 17:03:01.068 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 17:03:01.068 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType83`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 17:03:01.068 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 0.7649ms
2025-07-30 17:03:01.068 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 17:03:01.068 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/b9030b04-2da7-449f-94de-d6d4814a8177/subscription - 200 null application/json; charset=utf-8 1.6914ms
2025-07-30 17:03:01.068 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 17:03:01.068 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 17:03:01.068 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType83`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 17:03:01.068 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType83`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 17:03:01.068 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 0.7939ms
2025-07-30 17:03:01.068 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 0.7569ms
2025-07-30 17:03:01.068 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 17:03:01.068 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 17:03:01.068 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType83`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 17:03:01.068 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 17:03:01.068 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 17:03:01.068 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/e090c598-224f-4b4c-870a-3c3ef6303e0a/subscription - 200 null application/json; charset=utf-8 1.8677ms
2025-07-30 17:03:01.068 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType83`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 17:03:01.068 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 17:03:01.068 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 0.7629ms
2025-07-30 17:03:01.068 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType83`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 17:03:01.068 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/efead752-f0b3-48ab-93b8-7ba31e7574ba/subscription - 200 null application/json; charset=utf-8 2.0071ms
2025-07-30 17:03:01.068 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 0.814ms
2025-07-30 17:03:01.068 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 17:03:01.069 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 0.9292ms
2025-07-30 17:03:01.069 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/801dc698-62a8-49c3-b578-b7c1b05049a4/subscription - 200 null application/json; charset=utf-8 2.0769ms
2025-07-30 17:03:01.069 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 17:03:01.069 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 17:03:01.069 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/28b8e854-738a-4e69-835c-71299a8f9b21/subscription - 200 null application/json; charset=utf-8 2.113ms
2025-07-30 17:03:01.069 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/f9f0e64e-3771-4aa9-8470-21e709677e44/subscription - 200 null application/json; charset=utf-8 2.1904ms
2025-07-30 17:03:35.910 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/platform - null null
2025-07-30 17:03:35.910 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:03:35.910 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/platform - 204 null null 0.5513ms
2025-07-30 17:03:35.911 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/platform - application/json null
2025-07-30 17:03:35.912 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:03:35.913 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:03:35.914 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-07-30 17:03:35.915 +08:00 [INF] Route matched with {action = "GetPlatformAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPlatformAnalytics() on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-30 17:03:35.917 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
2025-07-30 17:03:35.921 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
2025-07-30 17:03:35.929 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."Status" = 'Completed'
2025-07-30 17:03:35.934 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
2025-07-30 17:03:35.958 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id" AS "instructorId", a."FullName" AS "instructorName", (
    SELECT count(*)::int
    FROM "Courses" AS c0
    WHERE c0."InstructorId" = a."Id") AS "totalCourses", (
    SELECT count(*)::int
    FROM "Enrollments" AS e
    INNER JOIN "Courses" AS c1 ON e."CourseId" = c1."Id"
    WHERE c1."InstructorId" = a."Id") AS "totalStudents", (
    SELECT COALESCE(sum(p0."Amount"), 0.0)
    FROM "Payments" AS p0
    LEFT JOIN "Courses" AS c2 ON p0."CourseId" = c2."Id"
    WHERE c2."InstructorId" = a."Id" AND p0."Status" = 'Completed') AS "totalRevenue", COALESCE((
    SELECT avg(r."Rating"::double precision)
    FROM "Reviews" AS r
    INNER JOIN "Courses" AS c3 ON r."CourseId" = c3."Id"
    WHERE c3."InstructorId" = a."Id"), 0.0) AS "averageRating"
FROM "AspNetUsers" AS a
WHERE a."Role" = 'Instructor'
ORDER BY (
    SELECT COALESCE(sum(p."Amount"), 0.0)
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
    WHERE c."InstructorId" = a."Id" AND p."Status" = 'Completed') DESC
LIMIT @__p_0
2025-07-30 17:03:35.978 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT c."Category" AS category, count(*)::int AS "courseCount", COALESCE(sum((
    SELECT count(*)::int
    FROM "Enrollments" AS e
    WHERE c."Id" = e."CourseId")), 0)::int AS "enrollmentCount", (
    SELECT COALESCE(sum(p."Amount"), 0.0)
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c0 ON p."CourseId" = c0."Id"
    WHERE c0."Category" = c."Category" AND p."Status" = 'Completed') AS revenue
FROM "Courses" AS c
GROUP BY c."Category"
ORDER BY COALESCE(sum((
    SELECT count(*)::int
    FROM "Enrollments" AS e
    WHERE c."Id" = e."CourseId")), 0)::int DESC
2025-07-30 17:03:35.987 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT p0."Year", p0."Month", COALESCE(sum(p0."Amount"), 0.0) AS "Revenue", count(*)::int AS "TransactionCount"
FROM (
    SELECT p."Amount", date_part('year', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "Payments" AS p
    WHERE p."Status" = 'Completed' AND p."CreatedAt" >= @__sixMonthsAgo_0
) AS p0
GROUP BY p0."Year", p0."Month"
2025-07-30 17:03:35.991 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT a0."Year", a0."Month", count(*)::int AS "NewUsers"
FROM (
    SELECT date_part('year', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "AspNetUsers" AS a
    WHERE a."CreatedAt" >= @__sixMonthsAgo_0
) AS a0
GROUP BY a0."Year", a0."Month"
2025-07-30 17:03:35.996 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Subscriptions" AS s
WHERE s."Status" = 'Active'
2025-07-30 17:03:36.001 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s."PlanName" AS plan, count(*)::int AS count, COALESCE(sum(s."Price"), 0.0) AS "monthlyRevenue"
FROM "Subscriptions" AS s
WHERE s."Status" = 'Active'
GROUP BY s."PlanName"
2025-07-30 17:03:36.002 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType20`6[[<>f__AnonymousType21`5[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 17:03:36.010 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api) in 94.2212ms
2025-07-30 17:03:36.010 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-07-30 17:03:36.010 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/platform - 200 null application/json; charset=utf-8 98.5389ms
2025-07-30 17:03:36.011 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/course-completions - null null
2025-07-30 17:03:36.011 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:03:36.012 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/course-completions - 204 null null 0.1265ms
2025-07-30 17:03:36.012 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/course-completions - application/json null
2025-07-30 17:03:36.012 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:03:36.013 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:03:36.013 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetCourseCompletions (CeceLearningPortal.Api)'
2025-07-30 17:03:36.015 +08:00 [INF] Route matched with {action = "GetCourseCompletions", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourseCompletions(Int32) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 17:03:36.026 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT e0."Id", a."FullName", a."Avatar", a."Email", c."Title", e0."CourseId"::text, e0."CompletedAt", COALESCE(e0."AverageQuizScore", 0.0), e0."CertificateIssued", e0."CertificateUrl"
FROM (
    SELECT e."Id", e."AverageQuizScore", e."CertificateIssued", e."CertificateUrl", e."CompletedAt", e."CourseId", e."StudentId"
    FROM "Enrollments" AS e
    WHERE e."CompletedAt" IS NOT NULL
    ORDER BY e."CompletedAt" DESC
    LIMIT @__p_0
) AS e0
INNER JOIN "AspNetUsers" AS a ON e0."StudentId" = a."Id"
INNER JOIN "Courses" AS c ON e0."CourseId" = c."Id"
ORDER BY e0."CompletedAt" DESC
2025-07-30 17:03:36.026 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType9`10[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-30 17:03:36.027 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetCourseCompletions (CeceLearningPortal.Api) in 12.1902ms
2025-07-30 17:03:36.027 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetCourseCompletions (CeceLearningPortal.Api)'
2025-07-30 17:03:36.027 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/course-completions - 200 null application/json; charset=utf-8 15.2568ms
2025-07-30 17:03:38.272 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/auth/login - null null
2025-07-30 17:03:38.272 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:03:38.272 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/auth/login - 204 null null 0.1943ms
2025-07-30 17:03:38.273 +08:00 [INF] Request starting HTTP/1.1 POST http://localhost:5295/api/auth/login - application/json 51
2025-07-30 17:03:38.273 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:03:38.275 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:03:38.275 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AuthController.Login (CeceLearningPortal.Api)'
2025-07-30 17:03:38.277 +08:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(CeceLearningPortal.Api.DTOs.LoginDto) on controller CeceLearningPortal.Api.Controllers.AuthController (CeceLearningPortal.Api).
2025-07-30 17:03:38.294 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__normalizedEmail_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."NormalizedEmail" = @__normalizedEmail_0
LIMIT 2
2025-07-30 17:03:38.368 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@p1='?', @p2='?', @p0='?' (DbType = DateTime), @p3='?' (DbType = DateTime), @p4='?', @p5='?' (DbType = DateTime), @p6='?', @p7='?' (DbType = DateTime), @p8='?', @p9='?', @p10='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE "AspNetUsers" SET "LastLoginAt" = @p0
WHERE "Id" = @p1 AND "ConcurrencyStamp" = @p2;
INSERT INTO "RefreshTokens" ("CreatedAt", "CreatedByIp", "ExpiresAt", "ReplacedByToken", "RevokedAt", "RevokedByIp", "Token", "UserId")
VALUES (@p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10)
RETURNING "Id";
2025-07-30 17:03:38.374 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.AuthResponseDto'.
2025-07-30 17:03:38.375 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AuthController.Login (CeceLearningPortal.Api) in 98.034ms
2025-07-30 17:03:38.375 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AuthController.Login (CeceLearningPortal.Api)'
2025-07-30 17:03:38.375 +08:00 [INF] Request finished HTTP/1.1 POST http://localhost:5295/api/auth/login - 200 null application/json; charset=utf-8 102.2856ms
2025-07-30 17:03:38.395 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/courses - null null
2025-07-30 17:03:38.396 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:03:38.396 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/courses - 204 null null 0.2036ms
2025-07-30 17:03:38.396 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/platform - application/json null
2025-07-30 17:03:38.396 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:03:38.396 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses - application/json null
2025-07-30 17:03:38.396 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:03:38.397 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:03:38.397 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:03:38.397 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-30 17:03:38.397 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-07-30 17:03:38.397 +08:00 [INF] Route matched with {action = "GetPlatformAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPlatformAnalytics() on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-30 17:03:38.398 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
2025-07-30 17:03:38.399 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
2025-07-30 17:03:38.401 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."Status" = 'Completed'
2025-07-30 17:03:38.401 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-30 17:03:38.402 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
2025-07-30 17:03:38.406 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id" AS "instructorId", a."FullName" AS "instructorName", (
    SELECT count(*)::int
    FROM "Courses" AS c0
    WHERE c0."InstructorId" = a."Id") AS "totalCourses", (
    SELECT count(*)::int
    FROM "Enrollments" AS e
    INNER JOIN "Courses" AS c1 ON e."CourseId" = c1."Id"
    WHERE c1."InstructorId" = a."Id") AS "totalStudents", (
    SELECT COALESCE(sum(p0."Amount"), 0.0)
    FROM "Payments" AS p0
    LEFT JOIN "Courses" AS c2 ON p0."CourseId" = c2."Id"
    WHERE c2."InstructorId" = a."Id" AND p0."Status" = 'Completed') AS "totalRevenue", COALESCE((
    SELECT avg(r."Rating"::double precision)
    FROM "Reviews" AS r
    INNER JOIN "Courses" AS c3 ON r."CourseId" = c3."Id"
    WHERE c3."InstructorId" = a."Id"), 0.0) AS "averageRating"
FROM "AspNetUsers" AS a
WHERE a."Role" = 'Instructor'
ORDER BY (
    SELECT COALESCE(sum(p."Amount"), 0.0)
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
    WHERE c."InstructorId" = a."Id" AND p."Status" = 'Completed') DESC
LIMIT @__p_0
2025-07-30 17:03:38.407 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT c."Category" AS category, count(*)::int AS "courseCount", COALESCE(sum((
    SELECT count(*)::int
    FROM "Enrollments" AS e
    WHERE c."Id" = e."CourseId")), 0)::int AS "enrollmentCount", (
    SELECT COALESCE(sum(p."Amount"), 0.0)
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c0 ON p."CourseId" = c0."Id"
    WHERE c0."Category" = c."Category" AND p."Status" = 'Completed') AS revenue
FROM "Courses" AS c
GROUP BY c."Category"
ORDER BY COALESCE(sum((
    SELECT count(*)::int
    FROM "Enrollments" AS e
    WHERE c."Id" = e."CourseId")), 0)::int DESC
2025-07-30 17:03:38.408 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT p0."Year", p0."Month", COALESCE(sum(p0."Amount"), 0.0) AS "Revenue", count(*)::int AS "TransactionCount"
FROM (
    SELECT p."Amount", date_part('year', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "Payments" AS p
    WHERE p."Status" = 'Completed' AND p."CreatedAt" >= @__sixMonthsAgo_0
) AS p0
GROUP BY p0."Year", p0."Month"
2025-07-30 17:03:38.408 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT a0."Year", a0."Month", count(*)::int AS "NewUsers"
FROM (
    SELECT date_part('year', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "AspNetUsers" AS a
    WHERE a."CreatedAt" >= @__sixMonthsAgo_0
) AS a0
GROUP BY a0."Year", a0."Month"
2025-07-30 17:03:38.409 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Subscriptions" AS s
WHERE s."Status" = 'Active'
2025-07-30 17:03:38.409 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s."PlanName" AS plan, count(*)::int AS count, COALESCE(sum(s."Price"), 0.0) AS "monthlyRevenue"
FROM "Subscriptions" AS s
WHERE s."Status" = 'Active'
GROUP BY s."PlanName"
2025-07-30 17:03:38.409 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType20`6[[<>f__AnonymousType21`5[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 17:03:38.410 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api) in 12.1506ms
2025-07-30 17:03:38.410 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-07-30 17:03:38.410 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/platform - 200 null application/json; charset=utf-8 13.5941ms
2025-07-30 17:03:38.418 +08:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2025-07-30 17:03:38.447 +08:00 [ERR] Failed executing DbCommand (2ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."IsPublished", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."PublishedAt", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."IsFlagged", r."Rating", r."Status", r."StudentId", e."Id", e."AverageQuizScore", e."CertificateIssued", e."CertificateUrl", e."CompletedAt", e."CompletedLessons", e."CourseId", e."EnrolledAt", e."LastAccessedDate", e."ProgressPercentage", e."QuizCount", e."StudentId", e."TotalTimeSpent"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."IsPublished", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."PublishedAt", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-30 17:03:38.451 +08:00 [ERR] An exception occurred while iterating over the results of a query for context type 'CeceLearningPortal.Api.Data.ApplicationDbContext'.
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 1526
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 1526
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 1526
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 1526
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 17:03:38.452 +08:00 [ERR] Error retrieving courses
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 1526
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at CeceLearningPortal.Api.Services.CourseService.GetAllCoursesAsync(CourseFilterDto filter) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Services\CourseService.cs:line 95
   at CeceLearningPortal.Api.Controllers.CoursesController.GetCourses(CourseFilterDto filter) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Controllers\CoursesController.cs:line 26
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 1526
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 17:03:38.746 +08:00 [INF] Executing ObjectResult, writing value of type '<>f__AnonymousType0`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 17:03:38.746 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 344.9903ms
2025-07-30 17:03:38.746 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-30 17:03:38.746 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses - 500 null application/json; charset=utf-8 349.4344ms
2025-07-30 17:03:39.956 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/platform - application/json null
2025-07-30 17:03:39.956 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:03:39.957 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:03:39.958 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-07-30 17:03:39.958 +08:00 [INF] Route matched with {action = "GetPlatformAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPlatformAnalytics() on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-30 17:03:39.958 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
2025-07-30 17:03:39.959 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
2025-07-30 17:03:39.959 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."Status" = 'Completed'
2025-07-30 17:03:39.959 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
2025-07-30 17:03:39.961 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id" AS "instructorId", a."FullName" AS "instructorName", (
    SELECT count(*)::int
    FROM "Courses" AS c0
    WHERE c0."InstructorId" = a."Id") AS "totalCourses", (
    SELECT count(*)::int
    FROM "Enrollments" AS e
    INNER JOIN "Courses" AS c1 ON e."CourseId" = c1."Id"
    WHERE c1."InstructorId" = a."Id") AS "totalStudents", (
    SELECT COALESCE(sum(p0."Amount"), 0.0)
    FROM "Payments" AS p0
    LEFT JOIN "Courses" AS c2 ON p0."CourseId" = c2."Id"
    WHERE c2."InstructorId" = a."Id" AND p0."Status" = 'Completed') AS "totalRevenue", COALESCE((
    SELECT avg(r."Rating"::double precision)
    FROM "Reviews" AS r
    INNER JOIN "Courses" AS c3 ON r."CourseId" = c3."Id"
    WHERE c3."InstructorId" = a."Id"), 0.0) AS "averageRating"
FROM "AspNetUsers" AS a
WHERE a."Role" = 'Instructor'
ORDER BY (
    SELECT COALESCE(sum(p."Amount"), 0.0)
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
    WHERE c."InstructorId" = a."Id" AND p."Status" = 'Completed') DESC
LIMIT @__p_0
2025-07-30 17:03:39.962 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT c."Category" AS category, count(*)::int AS "courseCount", COALESCE(sum((
    SELECT count(*)::int
    FROM "Enrollments" AS e
    WHERE c."Id" = e."CourseId")), 0)::int AS "enrollmentCount", (
    SELECT COALESCE(sum(p."Amount"), 0.0)
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c0 ON p."CourseId" = c0."Id"
    WHERE c0."Category" = c."Category" AND p."Status" = 'Completed') AS revenue
FROM "Courses" AS c
GROUP BY c."Category"
ORDER BY COALESCE(sum((
    SELECT count(*)::int
    FROM "Enrollments" AS e
    WHERE c."Id" = e."CourseId")), 0)::int DESC
2025-07-30 17:03:39.963 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT p0."Year", p0."Month", COALESCE(sum(p0."Amount"), 0.0) AS "Revenue", count(*)::int AS "TransactionCount"
FROM (
    SELECT p."Amount", date_part('year', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "Payments" AS p
    WHERE p."Status" = 'Completed' AND p."CreatedAt" >= @__sixMonthsAgo_0
) AS p0
GROUP BY p0."Year", p0."Month"
2025-07-30 17:03:39.963 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT a0."Year", a0."Month", count(*)::int AS "NewUsers"
FROM (
    SELECT date_part('year', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "AspNetUsers" AS a
    WHERE a."CreatedAt" >= @__sixMonthsAgo_0
) AS a0
GROUP BY a0."Year", a0."Month"
2025-07-30 17:03:39.963 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Subscriptions" AS s
WHERE s."Status" = 'Active'
2025-07-30 17:03:39.964 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s."PlanName" AS plan, count(*)::int AS count, COALESCE(sum(s."Price"), 0.0) AS "monthlyRevenue"
FROM "Subscriptions" AS s
WHERE s."Status" = 'Active'
GROUP BY s."PlanName"
2025-07-30 17:03:39.964 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType20`6[[<>f__AnonymousType21`5[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 17:03:39.964 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api) in 6.452ms
2025-07-30 17:03:39.964 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-07-30 17:03:39.964 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/platform - 200 null application/json; charset=utf-8 7.9186ms
2025-07-30 17:03:39.968 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/course-completions - application/json null
2025-07-30 17:03:39.968 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:03:39.969 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:03:39.969 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetCourseCompletions (CeceLearningPortal.Api)'
2025-07-30 17:03:39.969 +08:00 [INF] Route matched with {action = "GetCourseCompletions", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourseCompletions(Int32) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 17:03:39.970 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT e0."Id", a."FullName", a."Avatar", a."Email", c."Title", e0."CourseId"::text, e0."CompletedAt", COALESCE(e0."AverageQuizScore", 0.0), e0."CertificateIssued", e0."CertificateUrl"
FROM (
    SELECT e."Id", e."AverageQuizScore", e."CertificateIssued", e."CertificateUrl", e."CompletedAt", e."CourseId", e."StudentId"
    FROM "Enrollments" AS e
    WHERE e."CompletedAt" IS NOT NULL
    ORDER BY e."CompletedAt" DESC
    LIMIT @__p_0
) AS e0
INNER JOIN "AspNetUsers" AS a ON e0."StudentId" = a."Id"
INNER JOIN "Courses" AS c ON e0."CourseId" = c."Id"
ORDER BY e0."CompletedAt" DESC
2025-07-30 17:03:39.971 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType9`10[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-30 17:03:39.971 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetCourseCompletions (CeceLearningPortal.Api) in 1.3225ms
2025-07-30 17:03:39.971 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetCourseCompletions (CeceLearningPortal.Api)'
2025-07-30 17:03:39.971 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/course-completions - 200 null application/json; charset=utf-8 2.6146ms
2025-07-30 17:03:40.999 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users - null null
2025-07-30 17:03:41.000 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:03:41.000 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users - 204 null null 0.2239ms
2025-07-30 17:03:41.000 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/subscription-plans - null null
2025-07-30 17:03:41.000 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:03:41.000 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/subscription-plans - 204 null null 0.1231ms
2025-07-30 17:03:41.001 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users - application/json null
2025-07-30 17:03:41.001 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/subscription-plans - application/json null
2025-07-30 17:03:41.001 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:03:41.001 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:03:41.002 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:03:41.002 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:03:41.002 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUsers (CeceLearningPortal.Api)'
2025-07-30 17:03:41.002 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetSubscriptionPlans (CeceLearningPortal.Api)'
2025-07-30 17:03:41.002 +08:00 [INF] Route matched with {action = "GetUsers", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUsers(CeceLearningPortal.Api.DTOs.UserManagementFilterDto) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 17:03:41.002 +08:00 [INF] Route matched with {action = "GetSubscriptionPlans", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetSubscriptionPlans() on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 17:03:41.003 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
2025-07-30 17:03:41.003 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."UserName", a."Email", a."FullName", a."Role", a."Status", a."CreatedAt", a."LastLoginAt", a."EmailConfirmed"
FROM "AspNetUsers" AS a
ORDER BY a."CreatedAt" DESC
LIMIT @__p_1 OFFSET @__p_0
2025-07-30 17:03:41.003 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."CreatedAt", s."Description", s."DisplayOrder", s."Features", s."HasAnalytics", s."HasPrioritySupport", s."HasUnlimitedAccess", s."IsActive", s."IsRecommended", s."MaxCourseAccess", s."MaxCoursesCanCreate", s."MaxStudentsPerCourse", s."MonthlyPrice", s."Name", s."PlanType", s."TransactionFeePercentage", s."UpdatedAt", s."YearlyPrice", s0."Id", s0."BillingCycle", s0."CreatedAt", s0."EndDate", s0."NextBillingDate", s0."PlanName", s0."Price", s0."StartDate", s0."Status", s0."StripeSubscriptionId", s0."SubscriptionPlanId", s0."UpdatedAt", s0."UserId"
FROM "SubscriptionPlans" AS s
LEFT JOIN "Subscriptions" AS s0 ON s."Id" = s0."SubscriptionPlanId"
ORDER BY s."Id"
2025-07-30 17:03:41.003 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[CeceLearningPortal.Api.DTOs.UserManagementDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-30 17:03:41.003 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[CeceLearningPortal.Api.DTOs.SubscriptionPlanDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-30 17:03:41.003 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetSubscriptionPlans (CeceLearningPortal.Api) in 1.2667ms
2025-07-30 17:03:41.003 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUsers (CeceLearningPortal.Api) in 1.2853ms
2025-07-30 17:03:41.003 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetSubscriptionPlans (CeceLearningPortal.Api)'
2025-07-30 17:03:41.003 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUsers (CeceLearningPortal.Api)'
2025-07-30 17:03:41.003 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/subscription-plans - 200 null application/json; charset=utf-8 2.6016ms
2025-07-30 17:03:41.003 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users - 200 null application/json; charset=utf-8 2.6863ms
2025-07-30 17:03:41.005 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/b9030b04-2da7-449f-94de-d6d4814a8177/subscription - null null
2025-07-30 17:03:41.005 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:03:41.005 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/b9030b04-2da7-449f-94de-d6d4814a8177/subscription - 204 null null 0.0978ms
2025-07-30 17:03:41.006 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/efead752-f0b3-48ab-93b8-7ba31e7574ba/subscription - null null
2025-07-30 17:03:41.006 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:03:41.006 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/efead752-f0b3-48ab-93b8-7ba31e7574ba/subscription - 204 null null 0.0801ms
2025-07-30 17:03:41.006 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/e090c598-224f-4b4c-870a-3c3ef6303e0a/subscription - null null
2025-07-30 17:03:41.006 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:03:41.006 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/e090c598-224f-4b4c-870a-3c3ef6303e0a/subscription - 204 null null 0.071ms
2025-07-30 17:03:41.006 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/801dc698-62a8-49c3-b578-b7c1b05049a4/subscription - null null
2025-07-30 17:03:41.006 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:03:41.006 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/801dc698-62a8-49c3-b578-b7c1b05049a4/subscription - 204 null null 0.1154ms
2025-07-30 17:03:41.006 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/28b8e854-738a-4e69-835c-71299a8f9b21/subscription - null null
2025-07-30 17:03:41.006 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:03:41.006 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/f9f0e64e-3771-4aa9-8470-21e709677e44/subscription - null null
2025-07-30 17:03:41.006 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/28b8e854-738a-4e69-835c-71299a8f9b21/subscription - 204 null null 0.0741ms
2025-07-30 17:03:41.006 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:03:41.007 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/f9f0e64e-3771-4aa9-8470-21e709677e44/subscription - 204 null null 0.1167ms
2025-07-30 17:03:41.007 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/b9030b04-2da7-449f-94de-d6d4814a8177/subscription - application/json null
2025-07-30 17:03:41.008 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:03:41.008 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/efead752-f0b3-48ab-93b8-7ba31e7574ba/subscription - application/json null
2025-07-30 17:03:41.008 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:03:41.008 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/e090c598-224f-4b4c-870a-3c3ef6303e0a/subscription - application/json null
2025-07-30 17:03:41.008 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:03:41.008 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/801dc698-62a8-49c3-b578-b7c1b05049a4/subscription - application/json null
2025-07-30 17:03:41.008 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/f9f0e64e-3771-4aa9-8470-21e709677e44/subscription - application/json null
2025-07-30 17:03:41.008 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:03:41.008 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:03:41.008 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/28b8e854-738a-4e69-835c-71299a8f9b21/subscription - application/json null
2025-07-30 17:03:41.008 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:03:41.008 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:03:41.008 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:03:41.008 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 17:03:41.008 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 17:03:41.008 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 17:03:41.008 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 17:03:41.008 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:03:41.009 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:03:41.009 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:03:41.009 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 17:03:41.009 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 17:03:41.009 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 17:03:41.009 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 17:03:41.009 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 17:03:41.009 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:03:41.009 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 17:03:41.009 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 17:03:41.009 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 17:03:41.009 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 17:03:41.009 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 17:03:41.009 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType83`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 17:03:41.009 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType83`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 17:03:41.009 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 0.8548ms
2025-07-30 17:03:41.009 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 0.8566ms
2025-07-30 17:03:41.009 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 17:03:41.009 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 17:03:41.010 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 17:03:41.010 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/e090c598-224f-4b4c-870a-3c3ef6303e0a/subscription - 200 null application/json; charset=utf-8 1.7826ms
2025-07-30 17:03:41.010 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/efead752-f0b3-48ab-93b8-7ba31e7574ba/subscription - 200 null application/json; charset=utf-8 1.874ms
2025-07-30 17:03:41.010 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 17:03:41.010 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType83`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 17:03:41.010 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 17:03:41.010 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 0.8112ms
2025-07-30 17:03:41.010 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType83`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 17:03:41.010 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 17:03:41.010 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType83`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 17:03:41.010 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 17:03:41.010 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 0.8085ms
2025-07-30 17:03:41.010 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType83`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 17:03:41.010 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 1.0303ms
2025-07-30 17:03:41.010 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/b9030b04-2da7-449f-94de-d6d4814a8177/subscription - 200 null application/json; charset=utf-8 2.5069ms
2025-07-30 17:03:41.010 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 17:03:41.010 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 0.9988ms
2025-07-30 17:03:41.010 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/801dc698-62a8-49c3-b578-b7c1b05049a4/subscription - 200 null application/json; charset=utf-8 2.2373ms
2025-07-30 17:03:41.010 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 17:03:41.010 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 17:03:41.010 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/f9f0e64e-3771-4aa9-8470-21e709677e44/subscription - 200 null application/json; charset=utf-8 2.3023ms
2025-07-30 17:03:41.010 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/28b8e854-738a-4e69-835c-71299a8f9b21/subscription - 200 null application/json; charset=utf-8 2.1777ms
2025-07-30 17:04:06.172 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/auth/logout - null null
2025-07-30 17:04:06.172 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:04:06.172 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/auth/logout - 204 null null 0.2028ms
2025-07-30 17:04:06.172 +08:00 [INF] Request starting HTTP/1.1 POST http://localhost:5295/api/auth/logout - application/json 0
2025-07-30 17:04:06.173 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:04:06.173 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:04:06.174 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AuthController.Logout (CeceLearningPortal.Api)'
2025-07-30 17:04:06.175 +08:00 [INF] Route matched with {action = "Logout", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Logout() on controller CeceLearningPortal.Api.Controllers.AuthController (CeceLearningPortal.Api).
2025-07-30 17:04:06.186 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a0."Id", a0."AccessFailedCount", a0."Avatar", a0."ConcurrencyStamp", a0."CreatedAt", a0."Email", a0."EmailConfirmed", a0."FullName", a0."LastLoginAt", a0."LockoutEnabled", a0."LockoutEnd", a0."NormalizedEmail", a0."NormalizedUserName", a0."NotificationPreferences", a0."PasswordHash", a0."PhoneNumber", a0."PhoneNumberConfirmed", a0."RefreshToken", a0."RefreshTokenExpiryTime", a0."Role", a0."SecurityStamp", a0."Status", a0."TwoFactorEnabled", a0."UserName", r."Id", r."CreatedAt", r."CreatedByIp", r."ExpiresAt", r."ReplacedByToken", r."RevokedAt", r."RevokedByIp", r."Token", r."UserId"
FROM (
    SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM "AspNetUsers" AS a
    WHERE a."Id" = @__userId_0
    LIMIT 1
) AS a0
LEFT JOIN "RefreshTokens" AS r ON a0."Id" = r."UserId"
ORDER BY a0."Id"
2025-07-30 17:04:06.194 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@p1='?' (DbType = Int32), @p0='?' (DbType = DateTime), @p3='?' (DbType = Int32), @p2='?' (DbType = DateTime), @p5='?' (DbType = Int32), @p4='?' (DbType = DateTime), @p7='?' (DbType = Int32), @p6='?' (DbType = DateTime), @p9='?' (DbType = Int32), @p8='?' (DbType = DateTime), @p11='?' (DbType = Int32), @p10='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
UPDATE "RefreshTokens" SET "RevokedAt" = @p0
WHERE "Id" = @p1;
UPDATE "RefreshTokens" SET "RevokedAt" = @p2
WHERE "Id" = @p3;
UPDATE "RefreshTokens" SET "RevokedAt" = @p4
WHERE "Id" = @p5;
UPDATE "RefreshTokens" SET "RevokedAt" = @p6
WHERE "Id" = @p7;
UPDATE "RefreshTokens" SET "RevokedAt" = @p8
WHERE "Id" = @p9;
UPDATE "RefreshTokens" SET "RevokedAt" = @p10
WHERE "Id" = @p11;
2025-07-30 17:04:06.194 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType0`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 17:04:06.194 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AuthController.Logout (CeceLearningPortal.Api) in 19.2461ms
2025-07-30 17:04:06.194 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AuthController.Logout (CeceLearningPortal.Api)'
2025-07-30 17:04:06.195 +08:00 [INF] Request finished HTTP/1.1 POST http://localhost:5295/api/auth/logout - 200 null application/json; charset=utf-8 22.0614ms
2025-07-30 17:04:07.888 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/auth/login - null null
2025-07-30 17:04:07.888 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:04:07.888 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/auth/login - 204 null null 0.1701ms
2025-07-30 17:04:07.889 +08:00 [INF] Request starting HTTP/1.1 POST http://localhost:5295/api/auth/login - application/json 51
2025-07-30 17:04:07.889 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:04:07.889 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AuthController.Login (CeceLearningPortal.Api)'
2025-07-30 17:04:07.889 +08:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(CeceLearningPortal.Api.DTOs.LoginDto) on controller CeceLearningPortal.Api.Controllers.AuthController (CeceLearningPortal.Api).
2025-07-30 17:04:07.892 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__normalizedEmail_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."NormalizedEmail" = @__normalizedEmail_0
LIMIT 2
2025-07-30 17:04:07.939 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@p1='?', @p2='?', @p0='?' (DbType = DateTime), @p3='?' (DbType = DateTime), @p4='?', @p5='?' (DbType = DateTime), @p6='?', @p7='?' (DbType = DateTime), @p8='?', @p9='?', @p10='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE "AspNetUsers" SET "LastLoginAt" = @p0
WHERE "Id" = @p1 AND "ConcurrencyStamp" = @p2;
INSERT INTO "RefreshTokens" ("CreatedAt", "CreatedByIp", "ExpiresAt", "ReplacedByToken", "RevokedAt", "RevokedByIp", "Token", "UserId")
VALUES (@p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10)
RETURNING "Id";
2025-07-30 17:04:07.939 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.AuthResponseDto'.
2025-07-30 17:04:07.939 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AuthController.Login (CeceLearningPortal.Api) in 50.1668ms
2025-07-30 17:04:07.939 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AuthController.Login (CeceLearningPortal.Api)'
2025-07-30 17:04:07.939 +08:00 [INF] Request finished HTTP/1.1 POST http://localhost:5295/api/auth/login - 200 null application/json; charset=utf-8 50.6459ms
2025-07-30 17:04:07.952 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/courses - null null
2025-07-30 17:04:07.952 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:04:07.952 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/courses - 204 null null 0.1878ms
2025-07-30 17:04:07.952 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/platform - null null
2025-07-30 17:04:07.952 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:04:07.952 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/platform - 204 null null 0.0792ms
2025-07-30 17:04:07.953 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses - application/json null
2025-07-30 17:04:07.953 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:04:07.953 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/platform - application/json null
2025-07-30 17:04:07.953 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:04:07.954 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:04:07.954 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:04:07.954 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-07-30 17:04:07.954 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-30 17:04:07.954 +08:00 [INF] Route matched with {action = "GetPlatformAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPlatformAnalytics() on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-30 17:04:07.955 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-30 17:04:07.955 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
2025-07-30 17:04:07.955 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
2025-07-30 17:04:07.956 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."Status" = 'Completed'
2025-07-30 17:04:07.956 +08:00 [ERR] Failed executing DbCommand (1ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."IsPublished", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."PublishedAt", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."IsFlagged", r."Rating", r."Status", r."StudentId", e."Id", e."AverageQuizScore", e."CertificateIssued", e."CertificateUrl", e."CompletedAt", e."CompletedLessons", e."CourseId", e."EnrolledAt", e."LastAccessedDate", e."ProgressPercentage", e."QuizCount", e."StudentId", e."TotalTimeSpent"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."IsPublished", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."PublishedAt", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-30 17:04:07.957 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
2025-07-30 17:04:07.957 +08:00 [ERR] An exception occurred while iterating over the results of a query for context type 'CeceLearningPortal.Api.Data.ApplicationDbContext'.
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 1526
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 1526
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 1526
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 1526
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 17:04:07.958 +08:00 [ERR] Error retrieving courses
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 1526
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at CeceLearningPortal.Api.Services.CourseService.GetAllCoursesAsync(CourseFilterDto filter) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Services\CourseService.cs:line 95
   at CeceLearningPortal.Api.Controllers.CoursesController.GetCourses(CourseFilterDto filter) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Controllers\CoursesController.cs:line 26
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 1526
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 17:04:07.959 +08:00 [INF] Executing ObjectResult, writing value of type '<>f__AnonymousType0`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 17:04:07.959 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 4.9343ms
2025-07-30 17:04:07.960 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-30 17:04:07.960 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id" AS "instructorId", a."FullName" AS "instructorName", (
    SELECT count(*)::int
    FROM "Courses" AS c0
    WHERE c0."InstructorId" = a."Id") AS "totalCourses", (
    SELECT count(*)::int
    FROM "Enrollments" AS e
    INNER JOIN "Courses" AS c1 ON e."CourseId" = c1."Id"
    WHERE c1."InstructorId" = a."Id") AS "totalStudents", (
    SELECT COALESCE(sum(p0."Amount"), 0.0)
    FROM "Payments" AS p0
    LEFT JOIN "Courses" AS c2 ON p0."CourseId" = c2."Id"
    WHERE c2."InstructorId" = a."Id" AND p0."Status" = 'Completed') AS "totalRevenue", COALESCE((
    SELECT avg(r."Rating"::double precision)
    FROM "Reviews" AS r
    INNER JOIN "Courses" AS c3 ON r."CourseId" = c3."Id"
    WHERE c3."InstructorId" = a."Id"), 0.0) AS "averageRating"
FROM "AspNetUsers" AS a
WHERE a."Role" = 'Instructor'
ORDER BY (
    SELECT COALESCE(sum(p."Amount"), 0.0)
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
    WHERE c."InstructorId" = a."Id" AND p."Status" = 'Completed') DESC
LIMIT @__p_0
2025-07-30 17:04:07.960 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses - 500 null application/json; charset=utf-8 6.5466ms
2025-07-30 17:04:07.961 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT c."Category" AS category, count(*)::int AS "courseCount", COALESCE(sum((
    SELECT count(*)::int
    FROM "Enrollments" AS e
    WHERE c."Id" = e."CourseId")), 0)::int AS "enrollmentCount", (
    SELECT COALESCE(sum(p."Amount"), 0.0)
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c0 ON p."CourseId" = c0."Id"
    WHERE c0."Category" = c."Category" AND p."Status" = 'Completed') AS revenue
FROM "Courses" AS c
GROUP BY c."Category"
ORDER BY COALESCE(sum((
    SELECT count(*)::int
    FROM "Enrollments" AS e
    WHERE c."Id" = e."CourseId")), 0)::int DESC
2025-07-30 17:04:07.961 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT p0."Year", p0."Month", COALESCE(sum(p0."Amount"), 0.0) AS "Revenue", count(*)::int AS "TransactionCount"
FROM (
    SELECT p."Amount", date_part('year', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "Payments" AS p
    WHERE p."Status" = 'Completed' AND p."CreatedAt" >= @__sixMonthsAgo_0
) AS p0
GROUP BY p0."Year", p0."Month"
2025-07-30 17:04:07.962 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT a0."Year", a0."Month", count(*)::int AS "NewUsers"
FROM (
    SELECT date_part('year', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "AspNetUsers" AS a
    WHERE a."CreatedAt" >= @__sixMonthsAgo_0
) AS a0
GROUP BY a0."Year", a0."Month"
2025-07-30 17:04:07.962 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Subscriptions" AS s
WHERE s."Status" = 'Active'
2025-07-30 17:04:07.963 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s."PlanName" AS plan, count(*)::int AS count, COALESCE(sum(s."Price"), 0.0) AS "monthlyRevenue"
FROM "Subscriptions" AS s
WHERE s."Status" = 'Active'
GROUP BY s."PlanName"
2025-07-30 17:04:07.963 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType20`6[[<>f__AnonymousType21`5[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 17:04:07.963 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api) in 8.5035ms
2025-07-30 17:04:07.963 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-07-30 17:04:07.963 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/platform - 200 null application/json; charset=utf-8 10.0166ms
2025-07-30 17:04:09.487 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/platform - application/json null
2025-07-30 17:04:09.488 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:04:09.489 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:04:09.489 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-07-30 17:04:09.489 +08:00 [INF] Route matched with {action = "GetPlatformAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPlatformAnalytics() on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-30 17:04:09.489 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
2025-07-30 17:04:09.490 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
2025-07-30 17:04:09.490 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."Status" = 'Completed'
2025-07-30 17:04:09.490 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
2025-07-30 17:04:09.493 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id" AS "instructorId", a."FullName" AS "instructorName", (
    SELECT count(*)::int
    FROM "Courses" AS c0
    WHERE c0."InstructorId" = a."Id") AS "totalCourses", (
    SELECT count(*)::int
    FROM "Enrollments" AS e
    INNER JOIN "Courses" AS c1 ON e."CourseId" = c1."Id"
    WHERE c1."InstructorId" = a."Id") AS "totalStudents", (
    SELECT COALESCE(sum(p0."Amount"), 0.0)
    FROM "Payments" AS p0
    LEFT JOIN "Courses" AS c2 ON p0."CourseId" = c2."Id"
    WHERE c2."InstructorId" = a."Id" AND p0."Status" = 'Completed') AS "totalRevenue", COALESCE((
    SELECT avg(r."Rating"::double precision)
    FROM "Reviews" AS r
    INNER JOIN "Courses" AS c3 ON r."CourseId" = c3."Id"
    WHERE c3."InstructorId" = a."Id"), 0.0) AS "averageRating"
FROM "AspNetUsers" AS a
WHERE a."Role" = 'Instructor'
ORDER BY (
    SELECT COALESCE(sum(p."Amount"), 0.0)
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
    WHERE c."InstructorId" = a."Id" AND p."Status" = 'Completed') DESC
LIMIT @__p_0
2025-07-30 17:04:09.494 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT c."Category" AS category, count(*)::int AS "courseCount", COALESCE(sum((
    SELECT count(*)::int
    FROM "Enrollments" AS e
    WHERE c."Id" = e."CourseId")), 0)::int AS "enrollmentCount", (
    SELECT COALESCE(sum(p."Amount"), 0.0)
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c0 ON p."CourseId" = c0."Id"
    WHERE c0."Category" = c."Category" AND p."Status" = 'Completed') AS revenue
FROM "Courses" AS c
GROUP BY c."Category"
ORDER BY COALESCE(sum((
    SELECT count(*)::int
    FROM "Enrollments" AS e
    WHERE c."Id" = e."CourseId")), 0)::int DESC
2025-07-30 17:04:09.494 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT p0."Year", p0."Month", COALESCE(sum(p0."Amount"), 0.0) AS "Revenue", count(*)::int AS "TransactionCount"
FROM (
    SELECT p."Amount", date_part('year', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "Payments" AS p
    WHERE p."Status" = 'Completed' AND p."CreatedAt" >= @__sixMonthsAgo_0
) AS p0
GROUP BY p0."Year", p0."Month"
2025-07-30 17:04:09.495 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT a0."Year", a0."Month", count(*)::int AS "NewUsers"
FROM (
    SELECT date_part('year', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "AspNetUsers" AS a
    WHERE a."CreatedAt" >= @__sixMonthsAgo_0
) AS a0
GROUP BY a0."Year", a0."Month"
2025-07-30 17:04:09.495 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Subscriptions" AS s
WHERE s."Status" = 'Active'
2025-07-30 17:04:09.495 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s."PlanName" AS plan, count(*)::int AS count, COALESCE(sum(s."Price"), 0.0) AS "monthlyRevenue"
FROM "Subscriptions" AS s
WHERE s."Status" = 'Active'
GROUP BY s."PlanName"
2025-07-30 17:04:09.495 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType20`6[[<>f__AnonymousType21`5[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 17:04:09.496 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api) in 6.7923ms
2025-07-30 17:04:09.496 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-07-30 17:04:09.496 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/platform - 200 null application/json; charset=utf-8 8.2117ms
2025-07-30 17:04:09.498 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/course-completions - null null
2025-07-30 17:04:09.498 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:04:09.498 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/course-completions - 204 null null 0.2141ms
2025-07-30 17:04:09.498 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/course-completions - application/json null
2025-07-30 17:04:09.499 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:04:09.500 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:04:09.500 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetCourseCompletions (CeceLearningPortal.Api)'
2025-07-30 17:04:09.500 +08:00 [INF] Route matched with {action = "GetCourseCompletions", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourseCompletions(Int32) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 17:04:09.501 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT e0."Id", a."FullName", a."Avatar", a."Email", c."Title", e0."CourseId"::text, e0."CompletedAt", COALESCE(e0."AverageQuizScore", 0.0), e0."CertificateIssued", e0."CertificateUrl"
FROM (
    SELECT e."Id", e."AverageQuizScore", e."CertificateIssued", e."CertificateUrl", e."CompletedAt", e."CourseId", e."StudentId"
    FROM "Enrollments" AS e
    WHERE e."CompletedAt" IS NOT NULL
    ORDER BY e."CompletedAt" DESC
    LIMIT @__p_0
) AS e0
INNER JOIN "AspNetUsers" AS a ON e0."StudentId" = a."Id"
INNER JOIN "Courses" AS c ON e0."CourseId" = c."Id"
ORDER BY e0."CompletedAt" DESC
2025-07-30 17:04:09.501 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType9`10[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-30 17:04:09.501 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetCourseCompletions (CeceLearningPortal.Api) in 1.307ms
2025-07-30 17:04:09.501 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetCourseCompletions (CeceLearningPortal.Api)'
2025-07-30 17:04:09.501 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/course-completions - 200 null application/json; charset=utf-8 2.6685ms
2025-07-30 17:04:10.762 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users - null null
2025-07-30 17:04:10.762 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:04:10.762 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users - 204 null null 0.21ms
2025-07-30 17:04:10.762 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/subscription-plans - null null
2025-07-30 17:04:10.762 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:04:10.763 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/subscription-plans - 204 null null 0.0669ms
2025-07-30 17:04:10.763 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users - application/json null
2025-07-30 17:04:10.763 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/subscription-plans - application/json null
2025-07-30 17:04:10.763 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:04:10.763 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:04:10.764 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:04:10.764 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:04:10.765 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUsers (CeceLearningPortal.Api)'
2025-07-30 17:04:10.765 +08:00 [INF] Route matched with {action = "GetUsers", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUsers(CeceLearningPortal.Api.DTOs.UserManagementFilterDto) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 17:04:10.765 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetSubscriptionPlans (CeceLearningPortal.Api)'
2025-07-30 17:04:10.765 +08:00 [INF] Route matched with {action = "GetSubscriptionPlans", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetSubscriptionPlans() on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 17:04:10.765 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
2025-07-30 17:04:10.765 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."CreatedAt", s."Description", s."DisplayOrder", s."Features", s."HasAnalytics", s."HasPrioritySupport", s."HasUnlimitedAccess", s."IsActive", s."IsRecommended", s."MaxCourseAccess", s."MaxCoursesCanCreate", s."MaxStudentsPerCourse", s."MonthlyPrice", s."Name", s."PlanType", s."TransactionFeePercentage", s."UpdatedAt", s."YearlyPrice", s0."Id", s0."BillingCycle", s0."CreatedAt", s0."EndDate", s0."NextBillingDate", s0."PlanName", s0."Price", s0."StartDate", s0."Status", s0."StripeSubscriptionId", s0."SubscriptionPlanId", s0."UpdatedAt", s0."UserId"
FROM "SubscriptionPlans" AS s
LEFT JOIN "Subscriptions" AS s0 ON s."Id" = s0."SubscriptionPlanId"
ORDER BY s."Id"
2025-07-30 17:04:10.765 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[CeceLearningPortal.Api.DTOs.SubscriptionPlanDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-30 17:04:10.765 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetSubscriptionPlans (CeceLearningPortal.Api) in 0.6702ms
2025-07-30 17:04:10.765 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetSubscriptionPlans (CeceLearningPortal.Api)'
2025-07-30 17:04:10.765 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/subscription-plans - 200 null application/json; charset=utf-8 2.0657ms
2025-07-30 17:04:10.766 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."UserName", a."Email", a."FullName", a."Role", a."Status", a."CreatedAt", a."LastLoginAt", a."EmailConfirmed"
FROM "AspNetUsers" AS a
ORDER BY a."CreatedAt" DESC
LIMIT @__p_1 OFFSET @__p_0
2025-07-30 17:04:10.766 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[CeceLearningPortal.Api.DTOs.UserManagementDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-30 17:04:10.766 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUsers (CeceLearningPortal.Api) in 1.0772ms
2025-07-30 17:04:10.766 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUsers (CeceLearningPortal.Api)'
2025-07-30 17:04:10.766 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users - 200 null application/json; charset=utf-8 2.4331ms
2025-07-30 17:04:10.767 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/b9030b04-2da7-449f-94de-d6d4814a8177/subscription - null null
2025-07-30 17:04:10.767 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:04:10.767 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/b9030b04-2da7-449f-94de-d6d4814a8177/subscription - 204 null null 0.0938ms
2025-07-30 17:04:10.767 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/efead752-f0b3-48ab-93b8-7ba31e7574ba/subscription - null null
2025-07-30 17:04:10.767 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:04:10.767 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/efead752-f0b3-48ab-93b8-7ba31e7574ba/subscription - 204 null null 0.0865ms
2025-07-30 17:04:10.768 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/e090c598-224f-4b4c-870a-3c3ef6303e0a/subscription - null null
2025-07-30 17:04:10.768 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:04:10.768 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/801dc698-62a8-49c3-b578-b7c1b05049a4/subscription - null null
2025-07-30 17:04:10.768 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/e090c598-224f-4b4c-870a-3c3ef6303e0a/subscription - 204 null null 0.0823ms
2025-07-30 17:04:10.768 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:04:10.768 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/801dc698-62a8-49c3-b578-b7c1b05049a4/subscription - 204 null null 0.0906ms
2025-07-30 17:04:10.768 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/28b8e854-738a-4e69-835c-71299a8f9b21/subscription - null null
2025-07-30 17:04:10.768 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:04:10.768 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/f9f0e64e-3771-4aa9-8470-21e709677e44/subscription - null null
2025-07-30 17:04:10.768 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/28b8e854-738a-4e69-835c-71299a8f9b21/subscription - 204 null null 0.0845ms
2025-07-30 17:04:10.768 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:04:10.768 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/f9f0e64e-3771-4aa9-8470-21e709677e44/subscription - 204 null null 0.0878ms
2025-07-30 17:04:10.769 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/b9030b04-2da7-449f-94de-d6d4814a8177/subscription - application/json null
2025-07-30 17:04:10.769 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:04:10.769 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/efead752-f0b3-48ab-93b8-7ba31e7574ba/subscription - application/json null
2025-07-30 17:04:10.769 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:04:10.769 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/e090c598-224f-4b4c-870a-3c3ef6303e0a/subscription - application/json null
2025-07-30 17:04:10.769 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:04:10.770 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/f9f0e64e-3771-4aa9-8470-21e709677e44/subscription - application/json null
2025-07-30 17:04:10.770 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/28b8e854-738a-4e69-835c-71299a8f9b21/subscription - application/json null
2025-07-30 17:04:10.770 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/801dc698-62a8-49c3-b578-b7c1b05049a4/subscription - application/json null
2025-07-30 17:04:10.770 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:04:10.770 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:04:10.770 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:04:10.770 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:04:10.770 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:04:10.770 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 17:04:10.770 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 17:04:10.770 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 17:04:10.770 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 17:04:10.770 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:04:10.770 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 17:04:10.770 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 17:04:10.770 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:04:10.770 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:04:10.770 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 17:04:10.770 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:04:10.770 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 17:04:10.770 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 17:04:10.770 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 17:04:10.770 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 17:04:10.770 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 17:04:10.771 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 17:04:10.771 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 17:04:10.771 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType83`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 17:04:10.771 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 17:04:10.771 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 0.8303ms
2025-07-30 17:04:10.771 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType83`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 17:04:10.771 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType83`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 17:04:10.771 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 0.7717ms
2025-07-30 17:04:10.771 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 0.9237ms
2025-07-30 17:04:10.771 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 17:04:10.771 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 17:04:10.771 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 17:04:10.771 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/b9030b04-2da7-449f-94de-d6d4814a8177/subscription - 200 null application/json; charset=utf-8 1.9916ms
2025-07-30 17:04:10.771 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 17:04:10.771 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 17:04:10.771 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/e090c598-224f-4b4c-870a-3c3ef6303e0a/subscription - 200 null application/json; charset=utf-8 1.6442ms
2025-07-30 17:04:10.771 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType83`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 17:04:10.771 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 17:04:10.771 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/efead752-f0b3-48ab-93b8-7ba31e7574ba/subscription - 200 null application/json; charset=utf-8 2.0172ms
2025-07-30 17:04:10.771 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType83`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 17:04:10.771 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType83`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 17:04:10.771 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 0.8081ms
2025-07-30 17:04:10.771 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 0.9232ms
2025-07-30 17:04:10.771 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 0.9944ms
2025-07-30 17:04:10.771 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 17:04:10.771 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 17:04:10.772 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/f9f0e64e-3771-4aa9-8470-21e709677e44/subscription - 200 null application/json; charset=utf-8 1.9972ms
2025-07-30 17:04:10.772 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/801dc698-62a8-49c3-b578-b7c1b05049a4/subscription - 200 null application/json; charset=utf-8 2.0253ms
2025-07-30 17:04:10.771 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 17:04:10.772 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/28b8e854-738a-4e69-835c-71299a8f9b21/subscription - 200 null application/json; charset=utf-8 2.1182ms
2025-07-30 17:05:25.304 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/subscription-plans - null null
2025-07-30 17:05:25.304 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:05:25.304 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/subscription-plans - 204 null null 0.2255ms
2025-07-30 17:05:25.305 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/subscription-plans - application/json null
2025-07-30 17:05:25.305 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:05:25.306 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:05:25.306 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetSubscriptionPlans (CeceLearningPortal.Api)'
2025-07-30 17:05:25.306 +08:00 [INF] Route matched with {action = "GetSubscriptionPlans", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetSubscriptionPlans() on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 17:05:25.307 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."CreatedAt", s."Description", s."DisplayOrder", s."Features", s."HasAnalytics", s."HasPrioritySupport", s."HasUnlimitedAccess", s."IsActive", s."IsRecommended", s."MaxCourseAccess", s."MaxCoursesCanCreate", s."MaxStudentsPerCourse", s."MonthlyPrice", s."Name", s."PlanType", s."TransactionFeePercentage", s."UpdatedAt", s."YearlyPrice", s0."Id", s0."BillingCycle", s0."CreatedAt", s0."EndDate", s0."NextBillingDate", s0."PlanName", s0."Price", s0."StartDate", s0."Status", s0."StripeSubscriptionId", s0."SubscriptionPlanId", s0."UpdatedAt", s0."UserId"
FROM "SubscriptionPlans" AS s
LEFT JOIN "Subscriptions" AS s0 ON s."Id" = s0."SubscriptionPlanId"
ORDER BY s."Id"
2025-07-30 17:05:25.307 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[CeceLearningPortal.Api.DTOs.SubscriptionPlanDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-30 17:05:25.307 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetSubscriptionPlans (CeceLearningPortal.Api) in 0.9254ms
2025-07-30 17:05:25.307 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetSubscriptionPlans (CeceLearningPortal.Api)'
2025-07-30 17:05:25.307 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/subscription-plans - 200 null application/json; charset=utf-8 2.4057ms
2025-07-30 17:06:15.143 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/subscription-plans - null null
2025-07-30 17:06:15.143 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:06:15.143 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/subscription-plans - 204 null null 0.1697ms
2025-07-30 17:06:15.144 +08:00 [INF] Request starting HTTP/1.1 POST http://localhost:5295/api/admin/subscription-plans - application/json 211
2025-07-30 17:06:15.144 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:06:15.186 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:06:15.186 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.CreateSubscriptionPlan (CeceLearningPortal.Api)'
2025-07-30 17:06:15.188 +08:00 [INF] Route matched with {action = "CreateSubscriptionPlan", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CreateSubscriptionPlan(CeceLearningPortal.Api.DTOs.CreateSubscriptionPlanDto) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 17:06:15.206 +08:00 [INF] Executing BadRequestObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ValidationProblemDetails'.
2025-07-30 17:06:15.211 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.CreateSubscriptionPlan (CeceLearningPortal.Api) in 23.6893ms
2025-07-30 17:06:15.211 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.CreateSubscriptionPlan (CeceLearningPortal.Api)'
2025-07-30 17:06:15.212 +08:00 [INF] Request finished HTTP/1.1 POST http://localhost:5295/api/admin/subscription-plans - 400 null application/problem+json; charset=utf-8 67.3197ms
2025-07-30 17:06:18.523 +08:00 [INF] Request starting HTTP/1.1 POST http://localhost:5295/api/admin/subscription-plans - application/json 211
2025-07-30 17:06:18.523 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:06:18.524 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:06:18.524 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.CreateSubscriptionPlan (CeceLearningPortal.Api)'
2025-07-30 17:06:18.524 +08:00 [INF] Route matched with {action = "CreateSubscriptionPlan", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CreateSubscriptionPlan(CeceLearningPortal.Api.DTOs.CreateSubscriptionPlanDto) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 17:06:18.525 +08:00 [INF] Executing BadRequestObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ValidationProblemDetails'.
2025-07-30 17:06:18.525 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.CreateSubscriptionPlan (CeceLearningPortal.Api) in 0.5453ms
2025-07-30 17:06:18.525 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.CreateSubscriptionPlan (CeceLearningPortal.Api)'
2025-07-30 17:06:18.525 +08:00 [INF] Request finished HTTP/1.1 POST http://localhost:5295/api/admin/subscription-plans - 400 null application/problem+json; charset=utf-8 1.8722ms
2025-07-30 17:06:18.897 +08:00 [INF] Request starting HTTP/1.1 POST http://localhost:5295/api/admin/subscription-plans - application/json 211
2025-07-30 17:06:18.898 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:06:18.898 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:06:18.898 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.CreateSubscriptionPlan (CeceLearningPortal.Api)'
2025-07-30 17:06:18.899 +08:00 [INF] Route matched with {action = "CreateSubscriptionPlan", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CreateSubscriptionPlan(CeceLearningPortal.Api.DTOs.CreateSubscriptionPlanDto) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 17:06:18.899 +08:00 [INF] Executing BadRequestObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ValidationProblemDetails'.
2025-07-30 17:06:18.899 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.CreateSubscriptionPlan (CeceLearningPortal.Api) in 0.4412ms
2025-07-30 17:06:18.899 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.CreateSubscriptionPlan (CeceLearningPortal.Api)'
2025-07-30 17:06:18.899 +08:00 [INF] Request finished HTTP/1.1 POST http://localhost:5295/api/admin/subscription-plans - 400 null application/problem+json; charset=utf-8 1.7242ms
2025-07-30 17:06:19.109 +08:00 [INF] Request starting HTTP/1.1 POST http://localhost:5295/api/admin/subscription-plans - application/json 211
2025-07-30 17:06:19.109 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:06:19.110 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:06:19.110 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.CreateSubscriptionPlan (CeceLearningPortal.Api)'
2025-07-30 17:06:19.110 +08:00 [INF] Route matched with {action = "CreateSubscriptionPlan", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CreateSubscriptionPlan(CeceLearningPortal.Api.DTOs.CreateSubscriptionPlanDto) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 17:06:19.111 +08:00 [INF] Executing BadRequestObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ValidationProblemDetails'.
2025-07-30 17:06:19.111 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.CreateSubscriptionPlan (CeceLearningPortal.Api) in 0.5586ms
2025-07-30 17:06:19.111 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.CreateSubscriptionPlan (CeceLearningPortal.Api)'
2025-07-30 17:06:19.111 +08:00 [INF] Request finished HTTP/1.1 POST http://localhost:5295/api/admin/subscription-plans - 400 null application/problem+json; charset=utf-8 1.8958ms
2025-07-30 17:08:31.046 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/subscription-plans - null null
2025-07-30 17:08:31.046 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:08:31.046 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/subscription-plans - 204 null null 0.2258ms
2025-07-30 17:08:31.047 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/subscription-plans - application/json null
2025-07-30 17:08:31.047 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:08:31.048 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:08:31.048 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetSubscriptionPlans (CeceLearningPortal.Api)'
2025-07-30 17:08:31.048 +08:00 [INF] Route matched with {action = "GetSubscriptionPlans", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetSubscriptionPlans() on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 17:08:31.050 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."CreatedAt", s."Description", s."DisplayOrder", s."Features", s."HasAnalytics", s."HasPrioritySupport", s."HasUnlimitedAccess", s."IsActive", s."IsRecommended", s."MaxCourseAccess", s."MaxCoursesCanCreate", s."MaxStudentsPerCourse", s."MonthlyPrice", s."Name", s."PlanType", s."TransactionFeePercentage", s."UpdatedAt", s."YearlyPrice", s0."Id", s0."BillingCycle", s0."CreatedAt", s0."EndDate", s0."NextBillingDate", s0."PlanName", s0."Price", s0."StartDate", s0."Status", s0."StripeSubscriptionId", s0."SubscriptionPlanId", s0."UpdatedAt", s0."UserId"
FROM "SubscriptionPlans" AS s
LEFT JOIN "Subscriptions" AS s0 ON s."Id" = s0."SubscriptionPlanId"
ORDER BY s."Id"
2025-07-30 17:08:31.050 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[CeceLearningPortal.Api.DTOs.SubscriptionPlanDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-30 17:08:31.050 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetSubscriptionPlans (CeceLearningPortal.Api) in 2.3593ms
2025-07-30 17:08:31.050 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetSubscriptionPlans (CeceLearningPortal.Api)'
2025-07-30 17:08:31.050 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/subscription-plans - 200 null application/json; charset=utf-8 3.6965ms
2025-07-30 17:08:49.053 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/subscription-plans - null null
2025-07-30 17:08:49.053 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:08:49.053 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/subscription-plans - 204 null null 0.1885ms
2025-07-30 17:08:49.053 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/subscription-plans - application/json null
2025-07-30 17:08:49.053 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:08:49.054 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:08:49.054 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetSubscriptionPlans (CeceLearningPortal.Api)'
2025-07-30 17:08:49.054 +08:00 [INF] Route matched with {action = "GetSubscriptionPlans", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetSubscriptionPlans() on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 17:08:49.055 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."CreatedAt", s."Description", s."DisplayOrder", s."Features", s."HasAnalytics", s."HasPrioritySupport", s."HasUnlimitedAccess", s."IsActive", s."IsRecommended", s."MaxCourseAccess", s."MaxCoursesCanCreate", s."MaxStudentsPerCourse", s."MonthlyPrice", s."Name", s."PlanType", s."TransactionFeePercentage", s."UpdatedAt", s."YearlyPrice", s0."Id", s0."BillingCycle", s0."CreatedAt", s0."EndDate", s0."NextBillingDate", s0."PlanName", s0."Price", s0."StartDate", s0."Status", s0."StripeSubscriptionId", s0."SubscriptionPlanId", s0."UpdatedAt", s0."UserId"
FROM "SubscriptionPlans" AS s
LEFT JOIN "Subscriptions" AS s0 ON s."Id" = s0."SubscriptionPlanId"
ORDER BY s."Id"
2025-07-30 17:08:49.055 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[CeceLearningPortal.Api.DTOs.SubscriptionPlanDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-30 17:08:49.055 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetSubscriptionPlans (CeceLearningPortal.Api) in 0.7165ms
2025-07-30 17:08:49.055 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetSubscriptionPlans (CeceLearningPortal.Api)'
2025-07-30 17:08:49.055 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/subscription-plans - 200 null application/json; charset=utf-8 1.9529ms
2025-07-30 17:09:45.908 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users - null null
2025-07-30 17:09:45.908 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/subscription-plans - null null
2025-07-30 17:09:45.909 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:09:45.909 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:09:45.909 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users - 204 null null 0.2676ms
2025-07-30 17:09:45.909 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/subscription-plans - 204 null null 0.4991ms
2025-07-30 17:09:45.910 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users - application/json null
2025-07-30 17:09:45.910 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/subscription-plans - application/json null
2025-07-30 17:09:45.910 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:09:45.910 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:09:45.911 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:09:45.911 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUsers (CeceLearningPortal.Api)'
2025-07-30 17:09:45.911 +08:00 [INF] Route matched with {action = "GetUsers", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUsers(CeceLearningPortal.Api.DTOs.UserManagementFilterDto) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 17:09:45.912 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
2025-07-30 17:09:45.913 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."UserName", a."Email", a."FullName", a."Role", a."Status", a."CreatedAt", a."LastLoginAt", a."EmailConfirmed"
FROM "AspNetUsers" AS a
ORDER BY a."CreatedAt" DESC
LIMIT @__p_1 OFFSET @__p_0
2025-07-30 17:09:45.913 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[CeceLearningPortal.Api.DTOs.UserManagementDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-30 17:09:45.913 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUsers (CeceLearningPortal.Api) in 2.0543ms
2025-07-30 17:09:45.913 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUsers (CeceLearningPortal.Api)'
2025-07-30 17:09:45.913 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users - 200 null application/json; charset=utf-8 3.4719ms
2025-07-30 17:09:45.915 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/b9030b04-2da7-449f-94de-d6d4814a8177/subscription - null null
2025-07-30 17:09:45.915 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:09:45.915 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/b9030b04-2da7-449f-94de-d6d4814a8177/subscription - 204 null null 0.1326ms
2025-07-30 17:09:45.918 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/efead752-f0b3-48ab-93b8-7ba31e7574ba/subscription - null null
2025-07-30 17:09:45.918 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/e090c598-224f-4b4c-870a-3c3ef6303e0a/subscription - null null
2025-07-30 17:09:45.918 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:09:45.918 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:09:45.918 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/efead752-f0b3-48ab-93b8-7ba31e7574ba/subscription - 204 null null 0.1861ms
2025-07-30 17:09:45.918 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/e090c598-224f-4b4c-870a-3c3ef6303e0a/subscription - 204 null null 0.1585ms
2025-07-30 17:09:45.918 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/28b8e854-738a-4e69-835c-71299a8f9b21/subscription - null null
2025-07-30 17:09:45.918 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/f9f0e64e-3771-4aa9-8470-21e709677e44/subscription - null null
2025-07-30 17:09:45.918 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/801dc698-62a8-49c3-b578-b7c1b05049a4/subscription - null null
2025-07-30 17:09:45.918 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:09:45.918 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:09:45.918 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:09:45.918 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/28b8e854-738a-4e69-835c-71299a8f9b21/subscription - 204 null null 0.1851ms
2025-07-30 17:09:45.918 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/801dc698-62a8-49c3-b578-b7c1b05049a4/subscription - 204 null null 0.3845ms
2025-07-30 17:09:45.918 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/f9f0e64e-3771-4aa9-8470-21e709677e44/subscription - 204 null null 0.2008ms
2025-07-30 17:09:45.919 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/b9030b04-2da7-449f-94de-d6d4814a8177/subscription - application/json null
2025-07-30 17:09:45.919 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:09:45.920 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/efead752-f0b3-48ab-93b8-7ba31e7574ba/subscription - application/json null
2025-07-30 17:09:45.920 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:09:45.920 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/e090c598-224f-4b4c-870a-3c3ef6303e0a/subscription - application/json null
2025-07-30 17:09:45.920 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:09:45.920 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/28b8e854-738a-4e69-835c-71299a8f9b21/subscription - application/json null
2025-07-30 17:09:45.920 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:09:45.920 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/f9f0e64e-3771-4aa9-8470-21e709677e44/subscription - application/json null
2025-07-30 17:09:45.920 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:09:45.920 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:09:45.920 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 17:09:45.920 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 17:09:45.921 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:09:45.921 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 17:09:45.921 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 17:09:45.922 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 17:09:45.922 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType83`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 17:09:45.922 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 0.9881ms
2025-07-30 17:09:45.922 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 17:09:45.922 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/28b8e854-738a-4e69-835c-71299a8f9b21/subscription - 200 null application/json; charset=utf-8 2.0916ms
2025-07-30 17:09:45.922 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/801dc698-62a8-49c3-b578-b7c1b05049a4/subscription - application/json null
2025-07-30 17:09:45.923 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:09:45.923 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:09:45.923 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 17:09:45.923 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 17:09:45.924 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 17:09:45.924 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType83`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 17:09:45.924 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 0.8034ms
2025-07-30 17:09:45.924 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 17:09:45.924 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/801dc698-62a8-49c3-b578-b7c1b05049a4/subscription - 200 null application/json; charset=utf-8 1.6501ms
2025-07-30 17:09:45.969 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:09:45.970 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 17:09:45.970 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 17:09:45.971 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 17:09:45.971 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType83`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 17:09:45.971 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 1.2333ms
2025-07-30 17:09:45.971 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 17:09:45.971 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/e090c598-224f-4b4c-870a-3c3ef6303e0a/subscription - 200 null application/json; charset=utf-8 51.3807ms
2025-07-30 17:09:45.975 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:09:45.975 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 17:09:45.975 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 17:09:45.978 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 17:09:45.978 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType83`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 17:09:45.978 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 2.4583ms
2025-07-30 17:09:45.978 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 17:09:45.978 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/efead752-f0b3-48ab-93b8-7ba31e7574ba/subscription - 200 null application/json; charset=utf-8 58.4323ms
2025-07-30 17:09:45.986 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 17:09:45.986 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType83`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 17:09:45.986 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 65.6846ms
2025-07-30 17:09:45.986 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 17:09:45.986 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/b9030b04-2da7-449f-94de-d6d4814a8177/subscription - 200 null application/json; charset=utf-8 66.9356ms
2025-07-30 17:09:46.068 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:09:46.068 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetSubscriptionPlans (CeceLearningPortal.Api)'
2025-07-30 17:09:46.068 +08:00 [INF] Route matched with {action = "GetSubscriptionPlans", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetSubscriptionPlans() on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 17:09:46.069 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."CreatedAt", s."Description", s."DisplayOrder", s."Features", s."HasAnalytics", s."HasPrioritySupport", s."HasUnlimitedAccess", s."IsActive", s."IsRecommended", s."MaxCourseAccess", s."MaxCoursesCanCreate", s."MaxStudentsPerCourse", s."MonthlyPrice", s."Name", s."PlanType", s."TransactionFeePercentage", s."UpdatedAt", s."YearlyPrice", s0."Id", s0."BillingCycle", s0."CreatedAt", s0."EndDate", s0."NextBillingDate", s0."PlanName", s0."Price", s0."StartDate", s0."Status", s0."StripeSubscriptionId", s0."SubscriptionPlanId", s0."UpdatedAt", s0."UserId"
FROM "SubscriptionPlans" AS s
LEFT JOIN "Subscriptions" AS s0 ON s."Id" = s0."SubscriptionPlanId"
ORDER BY s."Id"
2025-07-30 17:09:46.069 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[CeceLearningPortal.Api.DTOs.SubscriptionPlanDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-30 17:09:46.069 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetSubscriptionPlans (CeceLearningPortal.Api) in 1.2426ms
2025-07-30 17:09:46.069 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetSubscriptionPlans (CeceLearningPortal.Api)'
2025-07-30 17:09:46.070 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/subscription-plans - 200 null application/json; charset=utf-8 159.8753ms
2025-07-30 17:09:46.085 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:09:46.086 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 17:09:46.086 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 17:09:46.088 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 17:09:46.088 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType83`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 17:09:46.088 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 2.4622ms
2025-07-30 17:09:46.088 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 17:09:46.088 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/f9f0e64e-3771-4aa9-8470-21e709677e44/subscription - 200 null application/json; charset=utf-8 168.3793ms
2025-07-30 17:09:54.505 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/subscription-plans - null null
2025-07-30 17:09:54.506 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:09:54.506 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/subscription-plans - 204 null null 0.2372ms
2025-07-30 17:09:54.507 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/subscription-plans - application/json null
2025-07-30 17:09:54.507 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:09:54.508 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:09:54.508 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetSubscriptionPlans (CeceLearningPortal.Api)'
2025-07-30 17:09:54.508 +08:00 [INF] Route matched with {action = "GetSubscriptionPlans", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetSubscriptionPlans() on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 17:09:54.509 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."CreatedAt", s."Description", s."DisplayOrder", s."Features", s."HasAnalytics", s."HasPrioritySupport", s."HasUnlimitedAccess", s."IsActive", s."IsRecommended", s."MaxCourseAccess", s."MaxCoursesCanCreate", s."MaxStudentsPerCourse", s."MonthlyPrice", s."Name", s."PlanType", s."TransactionFeePercentage", s."UpdatedAt", s."YearlyPrice", s0."Id", s0."BillingCycle", s0."CreatedAt", s0."EndDate", s0."NextBillingDate", s0."PlanName", s0."Price", s0."StartDate", s0."Status", s0."StripeSubscriptionId", s0."SubscriptionPlanId", s0."UpdatedAt", s0."UserId"
FROM "SubscriptionPlans" AS s
LEFT JOIN "Subscriptions" AS s0 ON s."Id" = s0."SubscriptionPlanId"
ORDER BY s."Id"
2025-07-30 17:09:54.509 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[CeceLearningPortal.Api.DTOs.SubscriptionPlanDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-30 17:09:54.509 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetSubscriptionPlans (CeceLearningPortal.Api) in 1.4232ms
2025-07-30 17:09:54.509 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetSubscriptionPlans (CeceLearningPortal.Api)'
2025-07-30 17:09:54.509 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/subscription-plans - 200 null application/json; charset=utf-8 2.8714ms
2025-07-30 17:10:22.779 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/subscription-plans - null null
2025-07-30 17:10:22.779 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:10:22.779 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/subscription-plans - 204 null null 0.1834ms
2025-07-30 17:10:22.780 +08:00 [INF] Request starting HTTP/1.1 POST http://localhost:5295/api/admin/subscription-plans - application/json 421
2025-07-30 17:10:22.780 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:10:22.781 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:10:22.781 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.CreateSubscriptionPlan (CeceLearningPortal.Api)'
2025-07-30 17:10:22.781 +08:00 [INF] Route matched with {action = "CreateSubscriptionPlan", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CreateSubscriptionPlan(CeceLearningPortal.Api.DTOs.CreateSubscriptionPlanDto) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 17:10:22.782 +08:00 [INF] Executing BadRequestObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ValidationProblemDetails'.
2025-07-30 17:10:22.782 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.CreateSubscriptionPlan (CeceLearningPortal.Api) in 1.2333ms
2025-07-30 17:10:22.782 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.CreateSubscriptionPlan (CeceLearningPortal.Api)'
2025-07-30 17:10:22.782 +08:00 [INF] Request finished HTTP/1.1 POST http://localhost:5295/api/admin/subscription-plans - 400 null application/problem+json; charset=utf-8 2.498ms
2025-07-30 17:10:30.719 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/subscription-plans - null null
2025-07-30 17:10:30.721 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-07-30 17:10:30.723 +08:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-07-30 17:10:30.723 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/subscription-plans - 401 0 null 3.9768ms
2025-07-30 17:10:39.907 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/subscription-plans - null null
2025-07-30 17:10:39.907 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:10:39.907 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/subscription-plans - 204 null null 0.2181ms
2025-07-30 17:10:39.908 +08:00 [INF] Request starting HTTP/1.1 POST http://localhost:5295/api/admin/subscription-plans - application/json 421
2025-07-30 17:10:39.908 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:10:39.909 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:10:39.909 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.CreateSubscriptionPlan (CeceLearningPortal.Api)'
2025-07-30 17:10:39.909 +08:00 [INF] Route matched with {action = "CreateSubscriptionPlan", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CreateSubscriptionPlan(CeceLearningPortal.Api.DTOs.CreateSubscriptionPlanDto) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 17:10:39.910 +08:00 [INF] Executing BadRequestObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ValidationProblemDetails'.
2025-07-30 17:10:39.910 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.CreateSubscriptionPlan (CeceLearningPortal.Api) in 0.7196ms
2025-07-30 17:10:39.910 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.CreateSubscriptionPlan (CeceLearningPortal.Api)'
2025-07-30 17:10:39.910 +08:00 [INF] Request finished HTTP/1.1 POST http://localhost:5295/api/admin/subscription-plans - 400 null application/problem+json; charset=utf-8 2.0115ms
2025-07-30 17:11:33.063 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/subscription-plans - null null
2025-07-30 17:11:33.063 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:11:33.063 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/subscription-plans - 204 null null 0.2297ms
2025-07-30 17:11:33.064 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/subscription-plans - application/json null
2025-07-30 17:11:33.064 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:11:33.065 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:11:33.065 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetSubscriptionPlans (CeceLearningPortal.Api)'
2025-07-30 17:11:33.065 +08:00 [INF] Route matched with {action = "GetSubscriptionPlans", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetSubscriptionPlans() on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 17:11:33.066 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."CreatedAt", s."Description", s."DisplayOrder", s."Features", s."HasAnalytics", s."HasPrioritySupport", s."HasUnlimitedAccess", s."IsActive", s."IsRecommended", s."MaxCourseAccess", s."MaxCoursesCanCreate", s."MaxStudentsPerCourse", s."MonthlyPrice", s."Name", s."PlanType", s."TransactionFeePercentage", s."UpdatedAt", s."YearlyPrice", s0."Id", s0."BillingCycle", s0."CreatedAt", s0."EndDate", s0."NextBillingDate", s0."PlanName", s0."Price", s0."StartDate", s0."Status", s0."StripeSubscriptionId", s0."SubscriptionPlanId", s0."UpdatedAt", s0."UserId"
FROM "SubscriptionPlans" AS s
LEFT JOIN "Subscriptions" AS s0 ON s."Id" = s0."SubscriptionPlanId"
ORDER BY s."Id"
2025-07-30 17:11:33.067 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[CeceLearningPortal.Api.DTOs.SubscriptionPlanDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-30 17:11:33.067 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetSubscriptionPlans (CeceLearningPortal.Api) in 1.4626ms
2025-07-30 17:11:33.067 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetSubscriptionPlans (CeceLearningPortal.Api)'
2025-07-30 17:11:33.067 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/subscription-plans - 200 null application/json; charset=utf-8 2.8414ms
2025-07-30 17:11:50.055 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/subscription-plans - null null
2025-07-30 17:11:50.055 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:11:50.055 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/subscription-plans - 204 null null 0.244ms
2025-07-30 17:11:50.056 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/subscription-plans - application/json null
2025-07-30 17:11:50.056 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:11:50.058 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:11:50.058 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetSubscriptionPlans (CeceLearningPortal.Api)'
2025-07-30 17:11:50.058 +08:00 [INF] Route matched with {action = "GetSubscriptionPlans", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetSubscriptionPlans() on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 17:11:50.060 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."CreatedAt", s."Description", s."DisplayOrder", s."Features", s."HasAnalytics", s."HasPrioritySupport", s."HasUnlimitedAccess", s."IsActive", s."IsRecommended", s."MaxCourseAccess", s."MaxCoursesCanCreate", s."MaxStudentsPerCourse", s."MonthlyPrice", s."Name", s."PlanType", s."TransactionFeePercentage", s."UpdatedAt", s."YearlyPrice", s0."Id", s0."BillingCycle", s0."CreatedAt", s0."EndDate", s0."NextBillingDate", s0."PlanName", s0."Price", s0."StartDate", s0."Status", s0."StripeSubscriptionId", s0."SubscriptionPlanId", s0."UpdatedAt", s0."UserId"
FROM "SubscriptionPlans" AS s
LEFT JOIN "Subscriptions" AS s0 ON s."Id" = s0."SubscriptionPlanId"
ORDER BY s."Id"
2025-07-30 17:11:50.060 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[CeceLearningPortal.Api.DTOs.SubscriptionPlanDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-30 17:11:50.060 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetSubscriptionPlans (CeceLearningPortal.Api) in 2.0917ms
2025-07-30 17:11:50.060 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetSubscriptionPlans (CeceLearningPortal.Api)'
2025-07-30 17:11:50.060 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/subscription-plans - 200 null application/json; charset=utf-8 4.5854ms
2025-07-30 17:12:12.050 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/subscription-plans - null null
2025-07-30 17:12:12.050 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:12:12.050 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/subscription-plans - 204 null null 0.2231ms
2025-07-30 17:12:12.051 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/subscription-plans - application/json null
2025-07-30 17:12:12.051 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:12:12.052 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:12:12.052 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetSubscriptionPlans (CeceLearningPortal.Api)'
2025-07-30 17:12:12.052 +08:00 [INF] Route matched with {action = "GetSubscriptionPlans", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetSubscriptionPlans() on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 17:12:12.054 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."CreatedAt", s."Description", s."DisplayOrder", s."Features", s."HasAnalytics", s."HasPrioritySupport", s."HasUnlimitedAccess", s."IsActive", s."IsRecommended", s."MaxCourseAccess", s."MaxCoursesCanCreate", s."MaxStudentsPerCourse", s."MonthlyPrice", s."Name", s."PlanType", s."TransactionFeePercentage", s."UpdatedAt", s."YearlyPrice", s0."Id", s0."BillingCycle", s0."CreatedAt", s0."EndDate", s0."NextBillingDate", s0."PlanName", s0."Price", s0."StartDate", s0."Status", s0."StripeSubscriptionId", s0."SubscriptionPlanId", s0."UpdatedAt", s0."UserId"
FROM "SubscriptionPlans" AS s
LEFT JOIN "Subscriptions" AS s0 ON s."Id" = s0."SubscriptionPlanId"
ORDER BY s."Id"
2025-07-30 17:12:12.054 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[CeceLearningPortal.Api.DTOs.SubscriptionPlanDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-30 17:12:12.054 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetSubscriptionPlans (CeceLearningPortal.Api) in 1.872ms
2025-07-30 17:12:12.054 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetSubscriptionPlans (CeceLearningPortal.Api)'
2025-07-30 17:12:12.054 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/subscription-plans - 200 null application/json; charset=utf-8 3.2493ms
2025-07-30 17:12:20.047 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/subscription-plans - null null
2025-07-30 17:12:20.047 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:12:20.047 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/subscription-plans - 204 null null 0.1921ms
2025-07-30 17:12:20.048 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/subscription-plans - application/json null
2025-07-30 17:12:20.048 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:12:20.049 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:12:20.049 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetSubscriptionPlans (CeceLearningPortal.Api)'
2025-07-30 17:12:20.049 +08:00 [INF] Route matched with {action = "GetSubscriptionPlans", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetSubscriptionPlans() on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 17:12:20.050 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."CreatedAt", s."Description", s."DisplayOrder", s."Features", s."HasAnalytics", s."HasPrioritySupport", s."HasUnlimitedAccess", s."IsActive", s."IsRecommended", s."MaxCourseAccess", s."MaxCoursesCanCreate", s."MaxStudentsPerCourse", s."MonthlyPrice", s."Name", s."PlanType", s."TransactionFeePercentage", s."UpdatedAt", s."YearlyPrice", s0."Id", s0."BillingCycle", s0."CreatedAt", s0."EndDate", s0."NextBillingDate", s0."PlanName", s0."Price", s0."StartDate", s0."Status", s0."StripeSubscriptionId", s0."SubscriptionPlanId", s0."UpdatedAt", s0."UserId"
FROM "SubscriptionPlans" AS s
LEFT JOIN "Subscriptions" AS s0 ON s."Id" = s0."SubscriptionPlanId"
ORDER BY s."Id"
2025-07-30 17:12:20.050 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[CeceLearningPortal.Api.DTOs.SubscriptionPlanDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-30 17:12:20.050 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetSubscriptionPlans (CeceLearningPortal.Api) in 0.8024ms
2025-07-30 17:12:20.050 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetSubscriptionPlans (CeceLearningPortal.Api)'
2025-07-30 17:12:20.050 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/subscription-plans - 200 null application/json; charset=utf-8 2.1328ms
2025-07-30 17:13:41.076 +08:00 [INF] Checking database connection...
2025-07-30 17:13:41.786 +08:00 [INF] Database connection successful.
2025-07-30 17:13:41.787 +08:00 [INF] Attempting to apply migrations...
2025-07-30 17:13:41.990 +08:00 [INF] Executed DbCommand (12ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-07-30 17:13:42.281 +08:00 [WRN] Migration failed. This might be due to pending model changes. Continuing anyway...
System.InvalidOperationException: An error was generated for warning 'Microsoft.EntityFrameworkCore.Migrations.PendingModelChangesWarning': The model for context 'ApplicationDbContext' has pending changes. Add a new migration before updating the database. See https://aka.ms/efcore-docs-pending-changes. This exception can be suppressed or logged by passing event ID 'RelationalEventId.PendingModelChangesWarning' to the 'ConfigureWarnings' method in 'DbContext.OnConfiguring' or 'AddDbContext'.
   at Microsoft.EntityFrameworkCore.Diagnostics.EventDefinition`1.Log[TLoggerCategory](IDiagnosticsLogger`1 logger, TParam arg)
   at Microsoft.EntityFrameworkCore.Diagnostics.RelationalLoggerExtensions.PendingModelChangesWarning(IDiagnosticsLogger`1 diagnostics, Type contextType)
   at Microsoft.EntityFrameworkCore.Migrations.Internal.Migrator.ValidateMigrations(Boolean useTransaction, String targetMigration)
   at Microsoft.EntityFrameworkCore.Migrations.Internal.Migrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Program.cs:line 226
2025-07-30 17:13:42.291 +08:00 [INF] Starting data seeding...
2025-07-30 17:13:42.307 +08:00 [INF] User profile is available. Using 'C:\Users\User\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-07-30 17:13:42.436 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Courses" AS c)
2025-07-30 17:13:42.438 +08:00 [INF] Database already contains data. Skipping seed.
2025-07-30 17:13:42.438 +08:00 [INF] Data seeding completed.
2025-07-30 17:13:42.481 +08:00 [INF] Now listening on: http://localhost:5295
2025-07-30 17:13:42.481 +08:00 [INF] Application started. Press Ctrl+C to shut down.
2025-07-30 17:13:42.481 +08:00 [INF] Hosting environment: Development
2025-07-30 17:13:42.481 +08:00 [INF] Content root path: D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api
2025-07-30 17:14:41.519 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/subscription-plans - null null
2025-07-30 17:14:41.548 +08:00 [WRN] Failed to determine the https port for redirect.
2025-07-30 17:14:41.549 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:14:41.552 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/subscription-plans - 204 null null 34.0949ms
2025-07-30 17:14:41.555 +08:00 [INF] Request starting HTTP/1.1 POST http://localhost:5295/api/admin/subscription-plans - application/json 419
2025-07-30 17:14:41.559 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:14:41.659 +08:00 [INF] Executed DbCommand (5ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:14:41.663 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.CreateSubscriptionPlan (CeceLearningPortal.Api)'
2025-07-30 17:14:41.671 +08:00 [INF] Route matched with {action = "CreateSubscriptionPlan", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CreateSubscriptionPlan(CeceLearningPortal.Api.DTOs.CreateSubscriptionPlanDto) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 17:14:41.837 +08:00 [INF] Executed DbCommand (7ms) [Parameters=[@p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = Int32), @p3='?', @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?' (DbType = Boolean), @p7='?' (DbType = Boolean), @p8='?' (DbType = Boolean), @p9='?' (DbType = Int32), @p10='?' (DbType = Int32), @p11='?' (DbType = Int32), @p12='?' (DbType = Decimal), @p13='?', @p14='?' (DbType = Int32), @p15='?' (DbType = Decimal), @p16='?' (DbType = DateTime), @p17='?' (DbType = Decimal)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "SubscriptionPlans" ("CreatedAt", "Description", "DisplayOrder", "Features", "HasAnalytics", "HasPrioritySupport", "HasUnlimitedAccess", "IsActive", "IsRecommended", "MaxCourseAccess", "MaxCoursesCanCreate", "MaxStudentsPerCourse", "MonthlyPrice", "Name", "PlanType", "TransactionFeePercentage", "UpdatedAt", "YearlyPrice")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17)
RETURNING "Id";
2025-07-30 17:14:41.855 +08:00 [INF] Executing CreatedAtActionResult, writing value of type 'CeceLearningPortal.Api.DTOs.SubscriptionPlanDto'.
2025-07-30 17:14:41.876 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.CreateSubscriptionPlan (CeceLearningPortal.Api) in 202.6816ms
2025-07-30 17:14:41.876 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.CreateSubscriptionPlan (CeceLearningPortal.Api)'
2025-07-30 17:14:41.879 +08:00 [INF] Request finished HTTP/1.1 POST http://localhost:5295/api/admin/subscription-plans - 201 null application/json; charset=utf-8 323.2642ms
2025-07-30 17:14:41.879 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/subscription-plans - application/json null
2025-07-30 17:14:41.882 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:14:41.887 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:14:41.888 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetSubscriptionPlans (CeceLearningPortal.Api)'
2025-07-30 17:14:41.891 +08:00 [INF] Route matched with {action = "GetSubscriptionPlans", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetSubscriptionPlans() on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 17:14:41.966 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."CreatedAt", s."Description", s."DisplayOrder", s."Features", s."HasAnalytics", s."HasPrioritySupport", s."HasUnlimitedAccess", s."IsActive", s."IsRecommended", s."MaxCourseAccess", s."MaxCoursesCanCreate", s."MaxStudentsPerCourse", s."MonthlyPrice", s."Name", s."PlanType", s."TransactionFeePercentage", s."UpdatedAt", s."YearlyPrice", s0."Id", s0."BillingCycle", s0."CreatedAt", s0."EndDate", s0."NextBillingDate", s0."PlanName", s0."Price", s0."StartDate", s0."Status", s0."StripeSubscriptionId", s0."SubscriptionPlanId", s0."UpdatedAt", s0."UserId"
FROM "SubscriptionPlans" AS s
LEFT JOIN "Subscriptions" AS s0 ON s."Id" = s0."SubscriptionPlanId"
ORDER BY s."Id"
2025-07-30 17:14:41.975 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[CeceLearningPortal.Api.DTOs.SubscriptionPlanDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-30 17:14:41.976 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetSubscriptionPlans (CeceLearningPortal.Api) in 84.6755ms
2025-07-30 17:14:41.976 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetSubscriptionPlans (CeceLearningPortal.Api)'
2025-07-30 17:14:41.976 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/subscription-plans - 200 null application/json; charset=utf-8 97.2337ms
2025-07-30 17:14:57.539 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/subscription-plans/00000009-0000-0000-0000-000000000000 - null null
2025-07-30 17:14:57.539 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:14:57.540 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/subscription-plans/00000009-0000-0000-0000-000000000000 - 204 null null 0.634ms
2025-07-30 17:14:57.540 +08:00 [INF] Request starting HTTP/1.1 PUT http://localhost:5295/api/admin/subscription-plans/00000009-0000-0000-0000-000000000000 - application/json 471
2025-07-30 17:14:57.540 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:14:57.543 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:14:57.544 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.UpdateSubscriptionPlan (CeceLearningPortal.Api)'
2025-07-30 17:14:57.547 +08:00 [INF] Route matched with {action = "UpdateSubscriptionPlan", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] UpdateSubscriptionPlan(System.Guid, CeceLearningPortal.Api.DTOs.UpdateSubscriptionPlanDto) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 17:14:57.554 +08:00 [INF] Executing BadRequestObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ValidationProblemDetails'.
2025-07-30 17:14:57.560 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.UpdateSubscriptionPlan (CeceLearningPortal.Api) in 12.6448ms
2025-07-30 17:14:57.560 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.UpdateSubscriptionPlan (CeceLearningPortal.Api)'
2025-07-30 17:14:57.560 +08:00 [INF] Request finished HTTP/1.1 PUT http://localhost:5295/api/admin/subscription-plans/00000009-0000-0000-0000-000000000000 - 400 null application/problem+json; charset=utf-8 19.8485ms
2025-07-30 17:15:57.055 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/subscription-plans - null null
2025-07-30 17:15:57.056 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:15:57.056 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/subscription-plans - 204 null null 0.5067ms
2025-07-30 17:15:57.057 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/subscription-plans - application/json null
2025-07-30 17:15:57.057 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:15:57.059 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:15:57.059 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetSubscriptionPlans (CeceLearningPortal.Api)'
2025-07-30 17:15:57.060 +08:00 [INF] Route matched with {action = "GetSubscriptionPlans", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetSubscriptionPlans() on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 17:15:57.061 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."CreatedAt", s."Description", s."DisplayOrder", s."Features", s."HasAnalytics", s."HasPrioritySupport", s."HasUnlimitedAccess", s."IsActive", s."IsRecommended", s."MaxCourseAccess", s."MaxCoursesCanCreate", s."MaxStudentsPerCourse", s."MonthlyPrice", s."Name", s."PlanType", s."TransactionFeePercentage", s."UpdatedAt", s."YearlyPrice", s0."Id", s0."BillingCycle", s0."CreatedAt", s0."EndDate", s0."NextBillingDate", s0."PlanName", s0."Price", s0."StartDate", s0."Status", s0."StripeSubscriptionId", s0."SubscriptionPlanId", s0."UpdatedAt", s0."UserId"
FROM "SubscriptionPlans" AS s
LEFT JOIN "Subscriptions" AS s0 ON s."Id" = s0."SubscriptionPlanId"
ORDER BY s."Id"
2025-07-30 17:15:57.061 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[CeceLearningPortal.Api.DTOs.SubscriptionPlanDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-30 17:15:57.062 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetSubscriptionPlans (CeceLearningPortal.Api) in 1.9561ms
2025-07-30 17:15:57.062 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetSubscriptionPlans (CeceLearningPortal.Api)'
2025-07-30 17:15:57.062 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/subscription-plans - 200 null application/json; charset=utf-8 4.9357ms
2025-07-30 17:16:08.073 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/subscription-plans - null null
2025-07-30 17:16:08.073 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:16:08.074 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/subscription-plans - 204 null null 1.1994ms
2025-07-30 17:16:08.075 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/subscription-plans - application/json null
2025-07-30 17:16:08.075 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:16:08.077 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:16:08.077 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetSubscriptionPlans (CeceLearningPortal.Api)'
2025-07-30 17:16:08.078 +08:00 [INF] Route matched with {action = "GetSubscriptionPlans", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetSubscriptionPlans() on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 17:16:08.079 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."CreatedAt", s."Description", s."DisplayOrder", s."Features", s."HasAnalytics", s."HasPrioritySupport", s."HasUnlimitedAccess", s."IsActive", s."IsRecommended", s."MaxCourseAccess", s."MaxCoursesCanCreate", s."MaxStudentsPerCourse", s."MonthlyPrice", s."Name", s."PlanType", s."TransactionFeePercentage", s."UpdatedAt", s."YearlyPrice", s0."Id", s0."BillingCycle", s0."CreatedAt", s0."EndDate", s0."NextBillingDate", s0."PlanName", s0."Price", s0."StartDate", s0."Status", s0."StripeSubscriptionId", s0."SubscriptionPlanId", s0."UpdatedAt", s0."UserId"
FROM "SubscriptionPlans" AS s
LEFT JOIN "Subscriptions" AS s0 ON s."Id" = s0."SubscriptionPlanId"
ORDER BY s."Id"
2025-07-30 17:16:08.079 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[CeceLearningPortal.Api.DTOs.SubscriptionPlanDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-30 17:16:08.079 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetSubscriptionPlans (CeceLearningPortal.Api) in 1.9386ms
2025-07-30 17:16:08.080 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetSubscriptionPlans (CeceLearningPortal.Api)'
2025-07-30 17:16:08.080 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/subscription-plans - 200 null application/json; charset=utf-8 4.6739ms
2025-07-30 17:19:39.359 +08:00 [INF] Checking database connection...
2025-07-30 17:19:40.078 +08:00 [INF] Database connection successful.
2025-07-30 17:19:40.079 +08:00 [INF] Attempting to apply migrations...
2025-07-30 17:19:40.173 +08:00 [INF] Executed DbCommand (12ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-07-30 17:19:40.438 +08:00 [WRN] Migration failed. This might be due to pending model changes. Continuing anyway...
System.InvalidOperationException: An error was generated for warning 'Microsoft.EntityFrameworkCore.Migrations.PendingModelChangesWarning': The model for context 'ApplicationDbContext' has pending changes. Add a new migration before updating the database. See https://aka.ms/efcore-docs-pending-changes. This exception can be suppressed or logged by passing event ID 'RelationalEventId.PendingModelChangesWarning' to the 'ConfigureWarnings' method in 'DbContext.OnConfiguring' or 'AddDbContext'.
   at Microsoft.EntityFrameworkCore.Diagnostics.EventDefinition`1.Log[TLoggerCategory](IDiagnosticsLogger`1 logger, TParam arg)
   at Microsoft.EntityFrameworkCore.Diagnostics.RelationalLoggerExtensions.PendingModelChangesWarning(IDiagnosticsLogger`1 diagnostics, Type contextType)
   at Microsoft.EntityFrameworkCore.Migrations.Internal.Migrator.ValidateMigrations(Boolean useTransaction, String targetMigration)
   at Microsoft.EntityFrameworkCore.Migrations.Internal.Migrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Program.cs:line 226
2025-07-30 17:19:40.448 +08:00 [INF] Starting data seeding...
2025-07-30 17:19:40.463 +08:00 [INF] User profile is available. Using 'C:\Users\User\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-07-30 17:19:40.592 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Courses" AS c)
2025-07-30 17:19:40.595 +08:00 [INF] Database already contains data. Skipping seed.
2025-07-30 17:19:40.595 +08:00 [INF] Data seeding completed.
2025-07-30 17:19:40.639 +08:00 [INF] Now listening on: http://localhost:5295
2025-07-30 17:19:40.640 +08:00 [INF] Application started. Press Ctrl+C to shut down.
2025-07-30 17:19:40.640 +08:00 [INF] Hosting environment: Development
2025-07-30 17:19:40.640 +08:00 [INF] Content root path: D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api
2025-07-30 17:21:52.533 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/subscription-plans/00000009-0000-0000-0000-000000000000 - null null
2025-07-30 17:21:52.567 +08:00 [WRN] Failed to determine the https port for redirect.
2025-07-30 17:21:52.568 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:21:52.571 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/subscription-plans/00000009-0000-0000-0000-000000000000 - 204 null null 39.0822ms
2025-07-30 17:21:52.574 +08:00 [INF] Request starting HTTP/1.1 PUT http://localhost:5295/api/admin/subscription-plans/00000009-0000-0000-0000-000000000000 - application/json 427
2025-07-30 17:21:52.578 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:21:52.686 +08:00 [INF] Executed DbCommand (6ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:21:52.690 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.UpdateSubscriptionPlan (CeceLearningPortal.Api)'
2025-07-30 17:21:52.699 +08:00 [INF] Route matched with {action = "UpdateSubscriptionPlan", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] UpdateSubscriptionPlan(Int32, CeceLearningPortal.Api.DTOs.UpdateSubscriptionPlanDto) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 17:21:52.747 +08:00 [INF] Executing BadRequestObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ValidationProblemDetails'.
2025-07-30 17:21:52.758 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.UpdateSubscriptionPlan (CeceLearningPortal.Api) in 56.4956ms
2025-07-30 17:21:52.758 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.UpdateSubscriptionPlan (CeceLearningPortal.Api)'
2025-07-30 17:21:52.759 +08:00 [INF] Request finished HTTP/1.1 PUT http://localhost:5295/api/admin/subscription-plans/00000009-0000-0000-0000-000000000000 - 400 null application/problem+json; charset=utf-8 184.9414ms
2025-07-30 17:21:55.240 +08:00 [INF] Request starting HTTP/1.1 PUT http://localhost:5295/api/admin/subscription-plans/00000009-0000-0000-0000-000000000000 - application/json 427
2025-07-30 17:21:55.240 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:21:55.274 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:21:55.275 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.UpdateSubscriptionPlan (CeceLearningPortal.Api)'
2025-07-30 17:21:55.275 +08:00 [INF] Route matched with {action = "UpdateSubscriptionPlan", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] UpdateSubscriptionPlan(Int32, CeceLearningPortal.Api.DTOs.UpdateSubscriptionPlanDto) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 17:21:55.282 +08:00 [INF] Executing BadRequestObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ValidationProblemDetails'.
2025-07-30 17:21:55.283 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.UpdateSubscriptionPlan (CeceLearningPortal.Api) in 7.1109ms
2025-07-30 17:21:55.283 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.UpdateSubscriptionPlan (CeceLearningPortal.Api)'
2025-07-30 17:21:55.283 +08:00 [INF] Request finished HTTP/1.1 PUT http://localhost:5295/api/admin/subscription-plans/00000009-0000-0000-0000-000000000000 - 400 null application/problem+json; charset=utf-8 43.2467ms
2025-07-30 17:21:58.466 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/platform - null null
2025-07-30 17:21:58.467 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:21:58.467 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/platform - 204 null null 0.8206ms
2025-07-30 17:21:58.468 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/platform - application/json null
2025-07-30 17:21:58.472 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:21:58.475 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:21:58.477 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-07-30 17:21:58.480 +08:00 [INF] Route matched with {action = "GetPlatformAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPlatformAnalytics() on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-30 17:21:58.504 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
2025-07-30 17:21:58.510 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
2025-07-30 17:21:58.521 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."Status" = 'Completed'
2025-07-30 17:21:58.529 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
2025-07-30 17:21:58.600 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id" AS "instructorId", a."FullName" AS "instructorName", (
    SELECT count(*)::int
    FROM "Courses" AS c0
    WHERE c0."InstructorId" = a."Id") AS "totalCourses", (
    SELECT count(*)::int
    FROM "Enrollments" AS e
    INNER JOIN "Courses" AS c1 ON e."CourseId" = c1."Id"
    WHERE c1."InstructorId" = a."Id") AS "totalStudents", (
    SELECT COALESCE(sum(p0."Amount"), 0.0)
    FROM "Payments" AS p0
    LEFT JOIN "Courses" AS c2 ON p0."CourseId" = c2."Id"
    WHERE c2."InstructorId" = a."Id" AND p0."Status" = 'Completed') AS "totalRevenue", COALESCE((
    SELECT avg(r."Rating"::double precision)
    FROM "Reviews" AS r
    INNER JOIN "Courses" AS c3 ON r."CourseId" = c3."Id"
    WHERE c3."InstructorId" = a."Id"), 0.0) AS "averageRating"
FROM "AspNetUsers" AS a
WHERE a."Role" = 'Instructor'
ORDER BY (
    SELECT COALESCE(sum(p."Amount"), 0.0)
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
    WHERE c."InstructorId" = a."Id" AND p."Status" = 'Completed') DESC
LIMIT @__p_0
2025-07-30 17:21:58.624 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT c."Category" AS category, count(*)::int AS "courseCount", COALESCE(sum((
    SELECT count(*)::int
    FROM "Enrollments" AS e
    WHERE c."Id" = e."CourseId")), 0)::int AS "enrollmentCount", (
    SELECT COALESCE(sum(p."Amount"), 0.0)
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c0 ON p."CourseId" = c0."Id"
    WHERE c0."Category" = c."Category" AND p."Status" = 'Completed') AS revenue
FROM "Courses" AS c
GROUP BY c."Category"
ORDER BY COALESCE(sum((
    SELECT count(*)::int
    FROM "Enrollments" AS e
    WHERE c."Id" = e."CourseId")), 0)::int DESC
2025-07-30 17:21:58.637 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT p0."Year", p0."Month", COALESCE(sum(p0."Amount"), 0.0) AS "Revenue", count(*)::int AS "TransactionCount"
FROM (
    SELECT p."Amount", date_part('year', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "Payments" AS p
    WHERE p."Status" = 'Completed' AND p."CreatedAt" >= @__sixMonthsAgo_0
) AS p0
GROUP BY p0."Year", p0."Month"
2025-07-30 17:21:58.643 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT a0."Year", a0."Month", count(*)::int AS "NewUsers"
FROM (
    SELECT date_part('year', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "AspNetUsers" AS a
    WHERE a."CreatedAt" >= @__sixMonthsAgo_0
) AS a0
GROUP BY a0."Year", a0."Month"
2025-07-30 17:21:58.651 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Subscriptions" AS s
WHERE s."Status" = 'Active'
2025-07-30 17:21:58.657 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s."PlanName" AS plan, count(*)::int AS count, COALESCE(sum(s."Price"), 0.0) AS "monthlyRevenue"
FROM "Subscriptions" AS s
WHERE s."Status" = 'Active'
GROUP BY s."PlanName"
2025-07-30 17:21:58.659 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType20`6[[<>f__AnonymousType21`5[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 17:21:58.677 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api) in 196.6543ms
2025-07-30 17:21:58.678 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-07-30 17:21:58.680 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/platform - 200 null application/json; charset=utf-8 211.96ms
2025-07-30 17:21:58.690 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/course-completions - null null
2025-07-30 17:21:58.690 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:21:58.691 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/course-completions - 204 null null 0.9187ms
2025-07-30 17:21:58.693 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/course-completions - application/json null
2025-07-30 17:21:58.694 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:21:58.699 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:21:58.700 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetCourseCompletions (CeceLearningPortal.Api)'
2025-07-30 17:21:58.704 +08:00 [INF] Route matched with {action = "GetCourseCompletions", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourseCompletions(Int32) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 17:21:58.724 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT e0."Id", a."FullName", a."Avatar", a."Email", c."Title", e0."CourseId"::text, e0."CompletedAt", COALESCE(e0."AverageQuizScore", 0.0), e0."CertificateIssued", e0."CertificateUrl"
FROM (
    SELECT e."Id", e."AverageQuizScore", e."CertificateIssued", e."CertificateUrl", e."CompletedAt", e."CourseId", e."StudentId"
    FROM "Enrollments" AS e
    WHERE e."CompletedAt" IS NOT NULL
    ORDER BY e."CompletedAt" DESC
    LIMIT @__p_0
) AS e0
INNER JOIN "AspNetUsers" AS a ON e0."StudentId" = a."Id"
INNER JOIN "Courses" AS c ON e0."CourseId" = c."Id"
ORDER BY e0."CompletedAt" DESC
2025-07-30 17:21:58.725 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType9`10[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-30 17:21:58.727 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetCourseCompletions (CeceLearningPortal.Api) in 22.6069ms
2025-07-30 17:21:58.727 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetCourseCompletions (CeceLearningPortal.Api)'
2025-07-30 17:21:58.728 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/course-completions - 200 null application/json; charset=utf-8 35.1066ms
2025-07-30 17:22:00.522 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/auth/login - null null
2025-07-30 17:22:00.522 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:22:00.522 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/auth/login - 204 null null 0.5283ms
2025-07-30 17:22:00.523 +08:00 [INF] Request starting HTTP/1.1 POST http://localhost:5295/api/auth/login - application/json 51
2025-07-30 17:22:00.524 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:22:00.526 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:22:00.526 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AuthController.Login (CeceLearningPortal.Api)'
2025-07-30 17:22:00.528 +08:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(CeceLearningPortal.Api.DTOs.LoginDto) on controller CeceLearningPortal.Api.Controllers.AuthController (CeceLearningPortal.Api).
2025-07-30 17:22:00.571 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__normalizedEmail_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."NormalizedEmail" = @__normalizedEmail_0
LIMIT 2
2025-07-30 17:22:00.771 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@p1='?', @p2='?', @p0='?' (DbType = DateTime), @p3='?' (DbType = DateTime), @p4='?', @p5='?' (DbType = DateTime), @p6='?', @p7='?' (DbType = DateTime), @p8='?', @p9='?', @p10='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE "AspNetUsers" SET "LastLoginAt" = @p0
WHERE "Id" = @p1 AND "ConcurrencyStamp" = @p2;
INSERT INTO "RefreshTokens" ("CreatedAt", "CreatedByIp", "ExpiresAt", "ReplacedByToken", "RevokedAt", "RevokedByIp", "Token", "UserId")
VALUES (@p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10)
RETURNING "Id";
2025-07-30 17:22:00.787 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.AuthResponseDto'.
2025-07-30 17:22:00.790 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AuthController.Login (CeceLearningPortal.Api) in 261.3208ms
2025-07-30 17:22:00.790 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AuthController.Login (CeceLearningPortal.Api)'
2025-07-30 17:22:00.790 +08:00 [INF] Request finished HTTP/1.1 POST http://localhost:5295/api/auth/login - 200 null application/json; charset=utf-8 266.6951ms
2025-07-30 17:22:00.812 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/courses - null null
2025-07-30 17:22:00.812 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:22:00.813 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/courses - 204 null null 0.605ms
2025-07-30 17:22:00.813 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/platform - application/json null
2025-07-30 17:22:00.813 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses - application/json null
2025-07-30 17:22:00.814 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:22:00.814 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:22:00.816 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:22:00.816 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-07-30 17:22:00.816 +08:00 [INF] Route matched with {action = "GetPlatformAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPlatformAnalytics() on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-30 17:22:00.817 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
2025-07-30 17:22:00.818 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
2025-07-30 17:22:00.819 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."Status" = 'Completed'
2025-07-30 17:22:00.819 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
2025-07-30 17:22:00.822 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id" AS "instructorId", a."FullName" AS "instructorName", (
    SELECT count(*)::int
    FROM "Courses" AS c0
    WHERE c0."InstructorId" = a."Id") AS "totalCourses", (
    SELECT count(*)::int
    FROM "Enrollments" AS e
    INNER JOIN "Courses" AS c1 ON e."CourseId" = c1."Id"
    WHERE c1."InstructorId" = a."Id") AS "totalStudents", (
    SELECT COALESCE(sum(p0."Amount"), 0.0)
    FROM "Payments" AS p0
    LEFT JOIN "Courses" AS c2 ON p0."CourseId" = c2."Id"
    WHERE c2."InstructorId" = a."Id" AND p0."Status" = 'Completed') AS "totalRevenue", COALESCE((
    SELECT avg(r."Rating"::double precision)
    FROM "Reviews" AS r
    INNER JOIN "Courses" AS c3 ON r."CourseId" = c3."Id"
    WHERE c3."InstructorId" = a."Id"), 0.0) AS "averageRating"
FROM "AspNetUsers" AS a
WHERE a."Role" = 'Instructor'
ORDER BY (
    SELECT COALESCE(sum(p."Amount"), 0.0)
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
    WHERE c."InstructorId" = a."Id" AND p."Status" = 'Completed') DESC
LIMIT @__p_0
2025-07-30 17:22:00.824 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT c."Category" AS category, count(*)::int AS "courseCount", COALESCE(sum((
    SELECT count(*)::int
    FROM "Enrollments" AS e
    WHERE c."Id" = e."CourseId")), 0)::int AS "enrollmentCount", (
    SELECT COALESCE(sum(p."Amount"), 0.0)
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c0 ON p."CourseId" = c0."Id"
    WHERE c0."Category" = c."Category" AND p."Status" = 'Completed') AS revenue
FROM "Courses" AS c
GROUP BY c."Category"
ORDER BY COALESCE(sum((
    SELECT count(*)::int
    FROM "Enrollments" AS e
    WHERE c."Id" = e."CourseId")), 0)::int DESC
2025-07-30 17:22:00.825 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT p0."Year", p0."Month", COALESCE(sum(p0."Amount"), 0.0) AS "Revenue", count(*)::int AS "TransactionCount"
FROM (
    SELECT p."Amount", date_part('year', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "Payments" AS p
    WHERE p."Status" = 'Completed' AND p."CreatedAt" >= @__sixMonthsAgo_0
) AS p0
GROUP BY p0."Year", p0."Month"
2025-07-30 17:22:00.826 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT a0."Year", a0."Month", count(*)::int AS "NewUsers"
FROM (
    SELECT date_part('year', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "AspNetUsers" AS a
    WHERE a."CreatedAt" >= @__sixMonthsAgo_0
) AS a0
GROUP BY a0."Year", a0."Month"
2025-07-30 17:22:00.826 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Subscriptions" AS s
WHERE s."Status" = 'Active'
2025-07-30 17:22:00.827 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s."PlanName" AS plan, count(*)::int AS count, COALESCE(sum(s."Price"), 0.0) AS "monthlyRevenue"
FROM "Subscriptions" AS s
WHERE s."Status" = 'Active'
GROUP BY s."PlanName"
2025-07-30 17:22:00.827 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType20`6[[<>f__AnonymousType21`5[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 17:22:00.827 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api) in 11.1633ms
2025-07-30 17:22:00.827 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-07-30 17:22:00.828 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/platform - 200 null application/json; charset=utf-8 14.1772ms
2025-07-30 17:22:00.865 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:22:00.865 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-30 17:22:00.869 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-30 17:22:00.900 +08:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2025-07-30 17:22:00.925 +08:00 [ERR] Failed executing DbCommand (2ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."IsPublished", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."PublishedAt", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."IsFlagged", r."Rating", r."Status", r."StudentId", e."Id", e."AverageQuizScore", e."CertificateIssued", e."CertificateUrl", e."CompletedAt", e."CompletedLessons", e."CourseId", e."EnrolledAt", e."LastAccessedDate", e."ProgressPercentage", e."QuizCount", e."StudentId", e."TotalTimeSpent"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."IsPublished", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."PublishedAt", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-30 17:22:00.930 +08:00 [ERR] An exception occurred while iterating over the results of a query for context type 'CeceLearningPortal.Api.Data.ApplicationDbContext'.
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 1526
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 1526
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 1526
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 1526
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 17:22:00.931 +08:00 [ERR] Error retrieving courses
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 1526
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at CeceLearningPortal.Api.Services.CourseService.GetAllCoursesAsync(CourseFilterDto filter) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Services\CourseService.cs:line 95
   at CeceLearningPortal.Api.Controllers.CoursesController.GetCourses(CourseFilterDto filter) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Controllers\CoursesController.cs:line 26
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 1526
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 17:22:00.933 +08:00 [INF] Executing ObjectResult, writing value of type '<>f__AnonymousType0`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 17:22:00.934 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 64.4076ms
2025-07-30 17:22:00.934 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-30 17:22:00.934 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses - 500 null application/json; charset=utf-8 120.4126ms
2025-07-30 17:22:02.139 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/platform - application/json null
2025-07-30 17:22:02.140 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:22:02.142 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:22:02.142 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-07-30 17:22:02.142 +08:00 [INF] Route matched with {action = "GetPlatformAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPlatformAnalytics() on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-30 17:22:02.143 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
2025-07-30 17:22:02.144 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
2025-07-30 17:22:02.144 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."Status" = 'Completed'
2025-07-30 17:22:02.145 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
2025-07-30 17:22:02.147 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id" AS "instructorId", a."FullName" AS "instructorName", (
    SELECT count(*)::int
    FROM "Courses" AS c0
    WHERE c0."InstructorId" = a."Id") AS "totalCourses", (
    SELECT count(*)::int
    FROM "Enrollments" AS e
    INNER JOIN "Courses" AS c1 ON e."CourseId" = c1."Id"
    WHERE c1."InstructorId" = a."Id") AS "totalStudents", (
    SELECT COALESCE(sum(p0."Amount"), 0.0)
    FROM "Payments" AS p0
    LEFT JOIN "Courses" AS c2 ON p0."CourseId" = c2."Id"
    WHERE c2."InstructorId" = a."Id" AND p0."Status" = 'Completed') AS "totalRevenue", COALESCE((
    SELECT avg(r."Rating"::double precision)
    FROM "Reviews" AS r
    INNER JOIN "Courses" AS c3 ON r."CourseId" = c3."Id"
    WHERE c3."InstructorId" = a."Id"), 0.0) AS "averageRating"
FROM "AspNetUsers" AS a
WHERE a."Role" = 'Instructor'
ORDER BY (
    SELECT COALESCE(sum(p."Amount"), 0.0)
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
    WHERE c."InstructorId" = a."Id" AND p."Status" = 'Completed') DESC
LIMIT @__p_0
2025-07-30 17:22:02.149 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT c."Category" AS category, count(*)::int AS "courseCount", COALESCE(sum((
    SELECT count(*)::int
    FROM "Enrollments" AS e
    WHERE c."Id" = e."CourseId")), 0)::int AS "enrollmentCount", (
    SELECT COALESCE(sum(p."Amount"), 0.0)
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c0 ON p."CourseId" = c0."Id"
    WHERE c0."Category" = c."Category" AND p."Status" = 'Completed') AS revenue
FROM "Courses" AS c
GROUP BY c."Category"
ORDER BY COALESCE(sum((
    SELECT count(*)::int
    FROM "Enrollments" AS e
    WHERE c."Id" = e."CourseId")), 0)::int DESC
2025-07-30 17:22:02.150 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT p0."Year", p0."Month", COALESCE(sum(p0."Amount"), 0.0) AS "Revenue", count(*)::int AS "TransactionCount"
FROM (
    SELECT p."Amount", date_part('year', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "Payments" AS p
    WHERE p."Status" = 'Completed' AND p."CreatedAt" >= @__sixMonthsAgo_0
) AS p0
GROUP BY p0."Year", p0."Month"
2025-07-30 17:22:02.151 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT a0."Year", a0."Month", count(*)::int AS "NewUsers"
FROM (
    SELECT date_part('year', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "AspNetUsers" AS a
    WHERE a."CreatedAt" >= @__sixMonthsAgo_0
) AS a0
GROUP BY a0."Year", a0."Month"
2025-07-30 17:22:02.152 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Subscriptions" AS s
WHERE s."Status" = 'Active'
2025-07-30 17:22:02.152 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s."PlanName" AS plan, count(*)::int AS count, COALESCE(sum(s."Price"), 0.0) AS "monthlyRevenue"
FROM "Subscriptions" AS s
WHERE s."Status" = 'Active'
GROUP BY s."PlanName"
2025-07-30 17:22:02.153 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType20`6[[<>f__AnonymousType21`5[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 17:22:02.153 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api) in 10.8512ms
2025-07-30 17:22:02.153 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-07-30 17:22:02.153 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/platform - 200 null application/json; charset=utf-8 13.7736ms
2025-07-30 17:22:02.155 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/course-completions - application/json null
2025-07-30 17:22:02.155 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:22:02.156 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:22:02.156 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetCourseCompletions (CeceLearningPortal.Api)'
2025-07-30 17:22:02.156 +08:00 [INF] Route matched with {action = "GetCourseCompletions", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourseCompletions(Int32) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 17:22:02.158 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT e0."Id", a."FullName", a."Avatar", a."Email", c."Title", e0."CourseId"::text, e0."CompletedAt", COALESCE(e0."AverageQuizScore", 0.0), e0."CertificateIssued", e0."CertificateUrl"
FROM (
    SELECT e."Id", e."AverageQuizScore", e."CertificateIssued", e."CertificateUrl", e."CompletedAt", e."CourseId", e."StudentId"
    FROM "Enrollments" AS e
    WHERE e."CompletedAt" IS NOT NULL
    ORDER BY e."CompletedAt" DESC
    LIMIT @__p_0
) AS e0
INNER JOIN "AspNetUsers" AS a ON e0."StudentId" = a."Id"
INNER JOIN "Courses" AS c ON e0."CourseId" = c."Id"
ORDER BY e0."CompletedAt" DESC
2025-07-30 17:22:02.158 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType9`10[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-30 17:22:02.158 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetCourseCompletions (CeceLearningPortal.Api) in 1.6439ms
2025-07-30 17:22:02.158 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetCourseCompletions (CeceLearningPortal.Api)'
2025-07-30 17:22:02.158 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/course-completions - 200 null application/json; charset=utf-8 3.3672ms
2025-07-30 17:22:03.574 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/subscription-plans - null null
2025-07-30 17:22:03.574 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:22:03.574 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/subscription-plans - 204 null null 0.5381ms
2025-07-30 17:22:03.575 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/subscription-plans - application/json null
2025-07-30 17:22:03.576 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:22:03.577 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:22:03.577 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetSubscriptionPlans (CeceLearningPortal.Api)'
2025-07-30 17:22:03.579 +08:00 [INF] Route matched with {action = "GetSubscriptionPlans", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetSubscriptionPlans() on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 17:22:03.591 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."CreatedAt", s."Description", s."DisplayOrder", s."Features", s."HasAnalytics", s."HasPrioritySupport", s."HasUnlimitedAccess", s."IsActive", s."IsRecommended", s."MaxCourseAccess", s."MaxCoursesCanCreate", s."MaxStudentsPerCourse", s."MonthlyPrice", s."Name", s."PlanType", s."TransactionFeePercentage", s."UpdatedAt", s."YearlyPrice", s0."Id", s0."BillingCycle", s0."CreatedAt", s0."EndDate", s0."NextBillingDate", s0."PlanName", s0."Price", s0."StartDate", s0."Status", s0."StripeSubscriptionId", s0."SubscriptionPlanId", s0."UpdatedAt", s0."UserId"
FROM "SubscriptionPlans" AS s
LEFT JOIN "Subscriptions" AS s0 ON s."Id" = s0."SubscriptionPlanId"
ORDER BY s."Id"
2025-07-30 17:22:03.616 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[CeceLearningPortal.Api.DTOs.SubscriptionPlanDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-30 17:22:03.619 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetSubscriptionPlans (CeceLearningPortal.Api) in 39.6904ms
2025-07-30 17:22:03.619 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetSubscriptionPlans (CeceLearningPortal.Api)'
2025-07-30 17:22:03.619 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/subscription-plans - 200 null application/json; charset=utf-8 43.752ms
2025-07-30 17:22:09.060 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/subscription-plans/9 - null null
2025-07-30 17:22:09.060 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:22:09.060 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/subscription-plans/9 - 204 null null 0.3745ms
2025-07-30 17:22:09.061 +08:00 [INF] Request starting HTTP/1.1 PUT http://localhost:5295/api/admin/subscription-plans/9 - application/json 424
2025-07-30 17:22:09.061 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:22:09.062 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:22:09.063 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.UpdateSubscriptionPlan (CeceLearningPortal.Api)'
2025-07-30 17:22:09.063 +08:00 [INF] Route matched with {action = "UpdateSubscriptionPlan", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] UpdateSubscriptionPlan(Int32, CeceLearningPortal.Api.DTOs.UpdateSubscriptionPlanDto) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 17:22:09.070 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."CreatedAt", s."Description", s."DisplayOrder", s."Features", s."HasAnalytics", s."HasPrioritySupport", s."HasUnlimitedAccess", s."IsActive", s."IsRecommended", s."MaxCourseAccess", s."MaxCoursesCanCreate", s."MaxStudentsPerCourse", s."MonthlyPrice", s."Name", s."PlanType", s."TransactionFeePercentage", s."UpdatedAt", s."YearlyPrice"
FROM "SubscriptionPlans" AS s
WHERE s."Id" = @__id_0
LIMIT 1
2025-07-30 17:22:09.082 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@p1='?' (DbType = Int32), @p0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
UPDATE "SubscriptionPlans" SET "UpdatedAt" = @p0
WHERE "Id" = @p1;
2025-07-30 17:22:09.092 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__plan_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s1."Id", s1."CreatedAt", s1."Description", s1."DisplayOrder", s1."Features", s1."HasAnalytics", s1."HasPrioritySupport", s1."HasUnlimitedAccess", s1."IsActive", s1."IsRecommended", s1."MaxCourseAccess", s1."MaxCoursesCanCreate", s1."MaxStudentsPerCourse", s1."MonthlyPrice", s1."Name", s1."PlanType", s1."TransactionFeePercentage", s1."UpdatedAt", s1."YearlyPrice", s0."Id", s0."BillingCycle", s0."CreatedAt", s0."EndDate", s0."NextBillingDate", s0."PlanName", s0."Price", s0."StartDate", s0."Status", s0."StripeSubscriptionId", s0."SubscriptionPlanId", s0."UpdatedAt", s0."UserId"
FROM (
    SELECT s."Id", s."CreatedAt", s."Description", s."DisplayOrder", s."Features", s."HasAnalytics", s."HasPrioritySupport", s."HasUnlimitedAccess", s."IsActive", s."IsRecommended", s."MaxCourseAccess", s."MaxCoursesCanCreate", s."MaxStudentsPerCourse", s."MonthlyPrice", s."Name", s."PlanType", s."TransactionFeePercentage", s."UpdatedAt", s."YearlyPrice"
    FROM "SubscriptionPlans" AS s
    WHERE s."Id" = @__plan_Id_0
    LIMIT 1
) AS s1
LEFT JOIN "Subscriptions" AS s0 ON s1."Id" = s0."SubscriptionPlanId"
ORDER BY s1."Id"
2025-07-30 17:22:09.093 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.SubscriptionPlanDto'.
2025-07-30 17:22:09.093 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.UpdateSubscriptionPlan (CeceLearningPortal.Api) in 30.7895ms
2025-07-30 17:22:09.094 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.UpdateSubscriptionPlan (CeceLearningPortal.Api)'
2025-07-30 17:22:09.094 +08:00 [INF] Request finished HTTP/1.1 PUT http://localhost:5295/api/admin/subscription-plans/9 - 200 null application/json; charset=utf-8 32.8094ms
2025-07-30 17:22:09.095 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/subscription-plans - null null
2025-07-30 17:22:09.095 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:22:09.095 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/subscription-plans - 204 null null 0.1798ms
2025-07-30 17:22:09.096 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/subscription-plans - application/json null
2025-07-30 17:22:09.096 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:22:09.097 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:22:09.097 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetSubscriptionPlans (CeceLearningPortal.Api)'
2025-07-30 17:22:09.097 +08:00 [INF] Route matched with {action = "GetSubscriptionPlans", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetSubscriptionPlans() on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 17:22:09.098 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."CreatedAt", s."Description", s."DisplayOrder", s."Features", s."HasAnalytics", s."HasPrioritySupport", s."HasUnlimitedAccess", s."IsActive", s."IsRecommended", s."MaxCourseAccess", s."MaxCoursesCanCreate", s."MaxStudentsPerCourse", s."MonthlyPrice", s."Name", s."PlanType", s."TransactionFeePercentage", s."UpdatedAt", s."YearlyPrice", s0."Id", s0."BillingCycle", s0."CreatedAt", s0."EndDate", s0."NextBillingDate", s0."PlanName", s0."Price", s0."StartDate", s0."Status", s0."StripeSubscriptionId", s0."SubscriptionPlanId", s0."UpdatedAt", s0."UserId"
FROM "SubscriptionPlans" AS s
LEFT JOIN "Subscriptions" AS s0 ON s."Id" = s0."SubscriptionPlanId"
ORDER BY s."Id"
2025-07-30 17:22:09.099 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[CeceLearningPortal.Api.DTOs.SubscriptionPlanDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-30 17:22:09.099 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetSubscriptionPlans (CeceLearningPortal.Api) in 1.4164ms
2025-07-30 17:22:09.099 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetSubscriptionPlans (CeceLearningPortal.Api)'
2025-07-30 17:22:09.099 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/subscription-plans - 200 null application/json; charset=utf-8 3.1841ms
2025-07-30 17:22:12.733 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users - null null
2025-07-30 17:22:12.733 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:22:12.733 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users - 204 null null 0.5487ms
2025-07-30 17:22:12.733 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/subscription-plans - application/json null
2025-07-30 17:22:12.733 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:22:12.734 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users - application/json null
2025-07-30 17:22:12.734 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:22:12.735 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:22:12.736 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:22:12.736 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetSubscriptionPlans (CeceLearningPortal.Api)'
2025-07-30 17:22:12.736 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUsers (CeceLearningPortal.Api)'
2025-07-30 17:22:12.736 +08:00 [INF] Route matched with {action = "GetSubscriptionPlans", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetSubscriptionPlans() on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 17:22:12.737 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."CreatedAt", s."Description", s."DisplayOrder", s."Features", s."HasAnalytics", s."HasPrioritySupport", s."HasUnlimitedAccess", s."IsActive", s."IsRecommended", s."MaxCourseAccess", s."MaxCoursesCanCreate", s."MaxStudentsPerCourse", s."MonthlyPrice", s."Name", s."PlanType", s."TransactionFeePercentage", s."UpdatedAt", s."YearlyPrice", s0."Id", s0."BillingCycle", s0."CreatedAt", s0."EndDate", s0."NextBillingDate", s0."PlanName", s0."Price", s0."StartDate", s0."Status", s0."StripeSubscriptionId", s0."SubscriptionPlanId", s0."UpdatedAt", s0."UserId"
FROM "SubscriptionPlans" AS s
LEFT JOIN "Subscriptions" AS s0 ON s."Id" = s0."SubscriptionPlanId"
ORDER BY s."Id"
2025-07-30 17:22:12.737 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[CeceLearningPortal.Api.DTOs.SubscriptionPlanDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-30 17:22:12.737 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetSubscriptionPlans (CeceLearningPortal.Api) in 1.6021ms
2025-07-30 17:22:12.737 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetSubscriptionPlans (CeceLearningPortal.Api)'
2025-07-30 17:22:12.737 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/subscription-plans - 200 null application/json; charset=utf-8 4.4241ms
2025-07-30 17:22:12.739 +08:00 [INF] Route matched with {action = "GetUsers", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUsers(CeceLearningPortal.Api.DTOs.UserManagementFilterDto) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 17:22:12.743 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
2025-07-30 17:22:12.748 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."UserName", a."Email", a."FullName", a."Role", a."Status", a."CreatedAt", a."LastLoginAt", a."EmailConfirmed"
FROM "AspNetUsers" AS a
ORDER BY a."CreatedAt" DESC
LIMIT @__p_1 OFFSET @__p_0
2025-07-30 17:22:12.749 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[CeceLearningPortal.Api.DTOs.UserManagementDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-30 17:22:12.759 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUsers (CeceLearningPortal.Api) in 19.9109ms
2025-07-30 17:22:12.759 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUsers (CeceLearningPortal.Api)'
2025-07-30 17:22:12.760 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users - 200 null application/json; charset=utf-8 25.4992ms
2025-07-30 17:22:12.761 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/b9030b04-2da7-449f-94de-d6d4814a8177/subscription - null null
2025-07-30 17:22:12.762 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:22:12.762 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/b9030b04-2da7-449f-94de-d6d4814a8177/subscription - 204 null null 0.2019ms
2025-07-30 17:22:12.763 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/efead752-f0b3-48ab-93b8-7ba31e7574ba/subscription - null null
2025-07-30 17:22:12.764 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:22:12.764 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/efead752-f0b3-48ab-93b8-7ba31e7574ba/subscription - 204 null null 1.5176ms
2025-07-30 17:22:12.764 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/e090c598-224f-4b4c-870a-3c3ef6303e0a/subscription - null null
2025-07-30 17:22:12.764 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/801dc698-62a8-49c3-b578-b7c1b05049a4/subscription - null null
2025-07-30 17:22:12.764 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:22:12.765 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:22:12.765 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/e090c598-224f-4b4c-870a-3c3ef6303e0a/subscription - 204 null null 0.2753ms
2025-07-30 17:22:12.765 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/801dc698-62a8-49c3-b578-b7c1b05049a4/subscription - 204 null null 0.1638ms
2025-07-30 17:22:12.765 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/28b8e854-738a-4e69-835c-71299a8f9b21/subscription - null null
2025-07-30 17:22:12.765 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:22:12.765 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/f9f0e64e-3771-4aa9-8470-21e709677e44/subscription - null null
2025-07-30 17:22:12.765 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/28b8e854-738a-4e69-835c-71299a8f9b21/subscription - 204 null null 0.1508ms
2025-07-30 17:22:12.765 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:22:12.765 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/f9f0e64e-3771-4aa9-8470-21e709677e44/subscription - 204 null null 0.182ms
2025-07-30 17:22:12.766 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/b9030b04-2da7-449f-94de-d6d4814a8177/subscription - application/json null
2025-07-30 17:22:12.766 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:22:12.766 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/efead752-f0b3-48ab-93b8-7ba31e7574ba/subscription - application/json null
2025-07-30 17:22:12.766 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:22:12.766 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/e090c598-224f-4b4c-870a-3c3ef6303e0a/subscription - application/json null
2025-07-30 17:22:12.767 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:22:12.767 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/801dc698-62a8-49c3-b578-b7c1b05049a4/subscription - application/json null
2025-07-30 17:22:12.767 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:22:12.767 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/28b8e854-738a-4e69-835c-71299a8f9b21/subscription - application/json null
2025-07-30 17:22:12.767 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/f9f0e64e-3771-4aa9-8470-21e709677e44/subscription - application/json null
2025-07-30 17:22:12.767 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:22:12.767 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:22:12.767 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:22:12.767 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:22:12.768 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 17:22:12.768 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 17:22:12.768 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:22:12.768 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 17:22:12.768 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:22:12.768 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 17:22:12.770 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 17:22:12.770 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 17:22:12.770 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 17:22:12.770 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 17:22:12.780 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 17:22:12.780 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 17:22:12.780 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType83`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 17:22:12.780 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType83`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 17:22:12.782 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 11.8535ms
2025-07-30 17:22:12.782 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 11.5601ms
2025-07-30 17:22:12.782 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 17:22:12.782 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 17:22:12.782 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/efead752-f0b3-48ab-93b8-7ba31e7574ba/subscription - 200 null application/json; charset=utf-8 15.7343ms
2025-07-30 17:22:12.782 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/f9f0e64e-3771-4aa9-8470-21e709677e44/subscription - 200 null application/json; charset=utf-8 14.8856ms
2025-07-30 17:22:12.819 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:22:12.819 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 17:22:12.819 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 17:22:12.821 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 17:22:12.821 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType83`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 17:22:12.821 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 1.7182ms
2025-07-30 17:22:12.821 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 17:22:12.821 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/e090c598-224f-4b4c-870a-3c3ef6303e0a/subscription - 200 null application/json; charset=utf-8 54.8812ms
2025-07-30 17:22:12.826 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:22:12.826 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 17:22:12.826 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 17:22:12.828 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 17:22:12.828 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType83`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 17:22:12.828 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 1.5838ms
2025-07-30 17:22:12.828 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 17:22:12.828 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/801dc698-62a8-49c3-b578-b7c1b05049a4/subscription - 200 null application/json; charset=utf-8 61.3759ms
2025-07-30 17:22:12.834 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 17:22:12.834 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType83`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 17:22:12.834 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 64.5555ms
2025-07-30 17:22:12.834 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 17:22:12.834 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/28b8e854-738a-4e69-835c-71299a8f9b21/subscription - 200 null application/json; charset=utf-8 67.3939ms
2025-07-30 17:22:12.838 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 17:22:12.838 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType83`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 17:22:12.838 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 68.4987ms
2025-07-30 17:22:12.838 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 17:22:12.838 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/b9030b04-2da7-449f-94de-d6d4814a8177/subscription - 200 null application/json; charset=utf-8 72.5488ms
2025-07-30 17:22:22.867 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/b9030b04-2da7-449f-94de-d6d4814a8177/subscription - null null
2025-07-30 17:22:22.867 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:22:22.868 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/b9030b04-2da7-449f-94de-d6d4814a8177/subscription - 204 null null 0.3952ms
2025-07-30 17:22:22.868 +08:00 [INF] Request starting HTTP/1.1 PUT http://localhost:5295/api/admin/users/b9030b04-2da7-449f-94de-d6d4814a8177/subscription - application/json 37
2025-07-30 17:22:22.868 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:22:22.870 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:22:22.870 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.UpdateUserSubscription (CeceLearningPortal.Api)'
2025-07-30 17:22:22.872 +08:00 [INF] Route matched with {action = "UpdateUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] UpdateUserSubscription(System.String, CeceLearningPortal.Api.DTOs.UpdateUserSubscriptionDto) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 17:22:22.884 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."Id" = @__p_0
LIMIT 1
2025-07-30 17:22:22.889 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."CreatedAt", s."Description", s."DisplayOrder", s."Features", s."HasAnalytics", s."HasPrioritySupport", s."HasUnlimitedAccess", s."IsActive", s."IsRecommended", s."MaxCourseAccess", s."MaxCoursesCanCreate", s."MaxStudentsPerCourse", s."MonthlyPrice", s."Name", s."PlanType", s."TransactionFeePercentage", s."UpdatedAt", s."YearlyPrice"
FROM "SubscriptionPlans" AS s
WHERE s."Id" = @__p_0
LIMIT 1
2025-07-30 17:22:22.893 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId"
FROM "Subscriptions" AS s
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
2025-07-30 17:22:22.922 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[@p0='?', @p1='?' (DbType = DateTime), @p2='?' (DbType = DateTime), @p3='?' (DbType = DateTime), @p4='?', @p5='?' (DbType = Decimal), @p6='?' (DbType = DateTime), @p7='?', @p8='?', @p9='?' (DbType = Int32), @p10='?' (DbType = DateTime), @p11='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "Subscriptions" ("BillingCycle", "CreatedAt", "EndDate", "NextBillingDate", "PlanName", "Price", "StartDate", "Status", "StripeSubscriptionId", "SubscriptionPlanId", "UpdatedAt", "UserId")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11)
RETURNING "Id";
2025-07-30 17:22:22.924 +08:00 [INF] User b9030b04-2da7-449f-94de-d6d4814a8177 subscription updated to plan 9
2025-07-30 17:22:22.924 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType0`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 17:22:22.924 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.UpdateUserSubscription (CeceLearningPortal.Api) in 52.2659ms
2025-07-30 17:22:22.924 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.UpdateUserSubscription (CeceLearningPortal.Api)'
2025-07-30 17:22:22.925 +08:00 [INF] Request finished HTTP/1.1 PUT http://localhost:5295/api/admin/users/b9030b04-2da7-449f-94de-d6d4814a8177/subscription - 200 null application/json; charset=utf-8 56.2295ms
2025-07-30 17:22:22.926 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users - null null
2025-07-30 17:22:22.926 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:22:22.926 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users - 204 null null 0.1588ms
2025-07-30 17:22:22.927 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users - application/json null
2025-07-30 17:22:22.927 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:22:22.929 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:22:22.929 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUsers (CeceLearningPortal.Api)'
2025-07-30 17:22:22.929 +08:00 [INF] Route matched with {action = "GetUsers", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUsers(CeceLearningPortal.Api.DTOs.UserManagementFilterDto) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 17:22:22.931 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
2025-07-30 17:22:22.932 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."UserName", a."Email", a."FullName", a."Role", a."Status", a."CreatedAt", a."LastLoginAt", a."EmailConfirmed"
FROM "AspNetUsers" AS a
ORDER BY a."CreatedAt" DESC
LIMIT @__p_1 OFFSET @__p_0
2025-07-30 17:22:22.933 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[CeceLearningPortal.Api.DTOs.UserManagementDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-30 17:22:22.933 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUsers (CeceLearningPortal.Api) in 3.8366ms
2025-07-30 17:22:22.933 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUsers (CeceLearningPortal.Api)'
2025-07-30 17:22:22.933 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users - 200 null application/json; charset=utf-8 6.2844ms
2025-07-30 17:22:22.948 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/efead752-f0b3-48ab-93b8-7ba31e7574ba/subscription - null null
2025-07-30 17:22:22.948 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:22:22.948 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/efead752-f0b3-48ab-93b8-7ba31e7574ba/subscription - 204 null null 0.2733ms
2025-07-30 17:22:22.948 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/e090c598-224f-4b4c-870a-3c3ef6303e0a/subscription - null null
2025-07-30 17:22:22.948 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/801dc698-62a8-49c3-b578-b7c1b05049a4/subscription - null null
2025-07-30 17:22:22.948 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/b9030b04-2da7-449f-94de-d6d4814a8177/subscription - application/json null
2025-07-30 17:22:22.948 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:22:22.948 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:22:22.948 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:22:22.948 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/801dc698-62a8-49c3-b578-b7c1b05049a4/subscription - 204 null null 0.219ms
2025-07-30 17:22:22.949 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/e090c598-224f-4b4c-870a-3c3ef6303e0a/subscription - 204 null null 0.3328ms
2025-07-30 17:22:22.949 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/28b8e854-738a-4e69-835c-71299a8f9b21/subscription - null null
2025-07-30 17:22:22.949 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/f9f0e64e-3771-4aa9-8470-21e709677e44/subscription - null null
2025-07-30 17:22:22.949 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:22:22.949 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:22:22.949 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/28b8e854-738a-4e69-835c-71299a8f9b21/subscription - 204 null null 0.2559ms
2025-07-30 17:22:22.949 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users/f9f0e64e-3771-4aa9-8470-21e709677e44/subscription - 204 null null 0.1622ms
2025-07-30 17:22:22.950 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:22:22.951 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 17:22:22.951 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/efead752-f0b3-48ab-93b8-7ba31e7574ba/subscription - application/json null
2025-07-30 17:22:22.951 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 17:22:22.951 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:22:22.951 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/e090c598-224f-4b4c-870a-3c3ef6303e0a/subscription - application/json null
2025-07-30 17:22:22.951 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/801dc698-62a8-49c3-b578-b7c1b05049a4/subscription - application/json null
2025-07-30 17:22:22.951 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:22:22.951 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/28b8e854-738a-4e69-835c-71299a8f9b21/subscription - application/json null
2025-07-30 17:22:22.951 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:22:22.951 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:22:22.952 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users/f9f0e64e-3771-4aa9-8470-21e709677e44/subscription - application/json null
2025-07-30 17:22:22.952 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:22:22.952 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:22:22.952 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 17:22:22.952 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:22:22.952 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:22:22.952 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 17:22:22.953 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 17:22:22.953 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 17:22:22.953 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:22:22.953 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 17:22:22.953 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 17:22:22.953 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 17:22:22.953 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 17:22:22.953 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 17:22:22.954 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 17:22:22.954 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 17:22:22.954 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType83`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 17:22:22.954 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType83`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 17:22:22.954 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:22:22.954 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 1.2893ms
2025-07-30 17:22:22.954 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 1.0874ms
2025-07-30 17:22:22.954 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 17:22:22.954 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 17:22:22.954 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/efead752-f0b3-48ab-93b8-7ba31e7574ba/subscription - 200 null application/json; charset=utf-8 3.2874ms
2025-07-30 17:22:22.954 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 17:22:22.954 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-07-30 17:22:22.954 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/801dc698-62a8-49c3-b578-b7c1b05049a4/subscription - 200 null application/json; charset=utf-8 3.1402ms
2025-07-30 17:22:22.955 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 17:22:22.955 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType83`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 17:22:22.955 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 17:22:22.955 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 2.135ms
2025-07-30 17:22:22.955 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 17:22:22.955 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType83`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 17:22:22.955 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/28b8e854-738a-4e69-835c-71299a8f9b21/subscription - 200 null application/json; charset=utf-8 3.9391ms
2025-07-30 17:22:22.955 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 0.968ms
2025-07-30 17:22:22.955 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 17:22:22.955 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/e090c598-224f-4b4c-870a-3c3ef6303e0a/subscription - 200 null application/json; charset=utf-8 4.2427ms
2025-07-30 17:22:22.955 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "Subscriptions" AS s
INNER JOIN "AspNetUsers" AS a ON s."UserId" = a."Id"
WHERE s."UserId" = @__userId_0 AND s."Status" = 'Active'
ORDER BY s."CreatedAt" DESC
LIMIT 1
2025-07-30 17:22:22.956 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType83`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 17:22:22.956 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 2.6367ms
2025-07-30 17:22:22.956 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 17:22:22.956 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/f9f0e64e-3771-4aa9-8470-21e709677e44/subscription - 200 null application/json; charset=utf-8 3.9719ms
2025-07-30 17:22:22.961 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__subscription_SubscriptionPlanId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."CreatedAt", s."Description", s."DisplayOrder", s."Features", s."HasAnalytics", s."HasPrioritySupport", s."HasUnlimitedAccess", s."IsActive", s."IsRecommended", s."MaxCourseAccess", s."MaxCoursesCanCreate", s."MaxStudentsPerCourse", s."MonthlyPrice", s."Name", s."PlanType", s."TransactionFeePercentage", s."UpdatedAt", s."YearlyPrice"
FROM "SubscriptionPlans" AS s
WHERE s."Id" = @__subscription_SubscriptionPlanId_0
LIMIT 1
2025-07-30 17:22:22.962 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType84`2[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[<>f__AnonymousType85`9[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[CeceLearningPortal.Api.Models.SubscriptionStatus, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.DateTime, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Nullable`1[[System.DateTime, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Nullable`1[[System.DateTime, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-30 17:22:22.967 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 16.1836ms
2025-07-30 17:22:22.967 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-07-30 17:22:22.967 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users/b9030b04-2da7-449f-94de-d6d4814a8177/subscription - 200 null application/json; charset=utf-8 19.0119ms
2025-07-30 17:22:52.067 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/auth/logout - null null
2025-07-30 17:22:52.068 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:22:52.068 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/auth/logout - 204 null null 0.2948ms
2025-07-30 17:22:52.069 +08:00 [INF] Request starting HTTP/1.1 POST http://localhost:5295/api/auth/logout - application/json 0
2025-07-30 17:22:52.069 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:22:52.070 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:22:52.070 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AuthController.Logout (CeceLearningPortal.Api)'
2025-07-30 17:22:52.072 +08:00 [INF] Route matched with {action = "Logout", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Logout() on controller CeceLearningPortal.Api.Controllers.AuthController (CeceLearningPortal.Api).
2025-07-30 17:22:52.084 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a0."Id", a0."AccessFailedCount", a0."Avatar", a0."ConcurrencyStamp", a0."CreatedAt", a0."Email", a0."EmailConfirmed", a0."FullName", a0."LastLoginAt", a0."LockoutEnabled", a0."LockoutEnd", a0."NormalizedEmail", a0."NormalizedUserName", a0."NotificationPreferences", a0."PasswordHash", a0."PhoneNumber", a0."PhoneNumberConfirmed", a0."RefreshToken", a0."RefreshTokenExpiryTime", a0."Role", a0."SecurityStamp", a0."Status", a0."TwoFactorEnabled", a0."UserName", r."Id", r."CreatedAt", r."CreatedByIp", r."ExpiresAt", r."ReplacedByToken", r."RevokedAt", r."RevokedByIp", r."Token", r."UserId"
FROM (
    SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM "AspNetUsers" AS a
    WHERE a."Id" = @__userId_0
    LIMIT 1
) AS a0
LEFT JOIN "RefreshTokens" AS r ON a0."Id" = r."UserId"
ORDER BY a0."Id"
2025-07-30 17:22:52.089 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@p1='?' (DbType = Int32), @p0='?' (DbType = DateTime), @p3='?' (DbType = Int32), @p2='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
UPDATE "RefreshTokens" SET "RevokedAt" = @p0
WHERE "Id" = @p1;
UPDATE "RefreshTokens" SET "RevokedAt" = @p2
WHERE "Id" = @p3;
2025-07-30 17:22:52.090 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType0`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 17:22:52.090 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AuthController.Logout (CeceLearningPortal.Api) in 18.1926ms
2025-07-30 17:22:52.090 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AuthController.Logout (CeceLearningPortal.Api)'
2025-07-30 17:22:52.090 +08:00 [INF] Request finished HTTP/1.1 POST http://localhost:5295/api/auth/logout - 200 null application/json; charset=utf-8 21.7313ms
2025-07-30 17:22:59.250 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/auth/login - null null
2025-07-30 17:22:59.250 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:22:59.251 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/auth/login - 204 null null 0.3451ms
2025-07-30 17:22:59.251 +08:00 [INF] Request starting HTTP/1.1 POST http://localhost:5295/api/auth/login - application/json 67
2025-07-30 17:22:59.251 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:22:59.252 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AuthController.Login (CeceLearningPortal.Api)'
2025-07-30 17:22:59.252 +08:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(CeceLearningPortal.Api.DTOs.LoginDto) on controller CeceLearningPortal.Api.Controllers.AuthController (CeceLearningPortal.Api).
2025-07-30 17:22:59.256 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__normalizedEmail_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."NormalizedEmail" = @__normalizedEmail_0
LIMIT 2
2025-07-30 17:22:59.305 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@p1='?', @p2='?', @p0='?' (DbType = DateTime), @p3='?' (DbType = DateTime), @p4='?', @p5='?' (DbType = DateTime), @p6='?', @p7='?' (DbType = DateTime), @p8='?', @p9='?', @p10='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE "AspNetUsers" SET "LastLoginAt" = @p0
WHERE "Id" = @p1 AND "ConcurrencyStamp" = @p2;
INSERT INTO "RefreshTokens" ("CreatedAt", "CreatedByIp", "ExpiresAt", "ReplacedByToken", "RevokedAt", "RevokedByIp", "Token", "UserId")
VALUES (@p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10)
RETURNING "Id";
2025-07-30 17:22:59.306 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.AuthResponseDto'.
2025-07-30 17:22:59.306 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AuthController.Login (CeceLearningPortal.Api) in 54.0248ms
2025-07-30 17:22:59.306 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AuthController.Login (CeceLearningPortal.Api)'
2025-07-30 17:22:59.306 +08:00 [INF] Request finished HTTP/1.1 POST http://localhost:5295/api/auth/login - 200 null application/json; charset=utf-8 55.0897ms
2025-07-30 17:22:59.324 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/platform - null null
2025-07-30 17:22:59.324 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:22:59.325 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/platform - 204 null null 0.3854ms
2025-07-30 17:22:59.325 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/courses - null null
2025-07-30 17:22:59.325 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:22:59.325 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/courses - 204 null null 0.1505ms
2025-07-30 17:22:59.327 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/platform - application/json null
2025-07-30 17:22:59.327 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:22:59.327 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses - application/json null
2025-07-30 17:22:59.327 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:22:59.328 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:22:59.328 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:22:59.328 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-30 17:22:59.328 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-30 17:22:59.329 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-07-30 17:22:59.330 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-07-30 17:22:59.330 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/platform - 403 0 null 3.1916ms
2025-07-30 17:22:59.330 +08:00 [ERR] Failed executing DbCommand (1ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."IsPublished", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."PublishedAt", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."IsFlagged", r."Rating", r."Status", r."StudentId", e."Id", e."AverageQuizScore", e."CertificateIssued", e."CertificateUrl", e."CompletedAt", e."CompletedLessons", e."CourseId", e."EnrolledAt", e."LastAccessedDate", e."ProgressPercentage", e."QuizCount", e."StudentId", e."TotalTimeSpent"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."IsPublished", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."PublishedAt", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-30 17:22:59.332 +08:00 [ERR] An exception occurred while iterating over the results of a query for context type 'CeceLearningPortal.Api.Data.ApplicationDbContext'.
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 1526
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 1526
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 1526
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 1526
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 17:22:59.333 +08:00 [ERR] Error retrieving courses
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 1526
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at CeceLearningPortal.Api.Services.CourseService.GetAllCoursesAsync(CourseFilterDto filter) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Services\CourseService.cs:line 95
   at CeceLearningPortal.Api.Controllers.CoursesController.GetCourses(CourseFilterDto filter) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Controllers\CoursesController.cs:line 26
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 1526
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 17:22:59.335 +08:00 [INF] Executing ObjectResult, writing value of type '<>f__AnonymousType0`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 17:22:59.335 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 6.2847ms
2025-07-30 17:22:59.335 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-30 17:22:59.335 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses - 500 null application/json; charset=utf-8 7.9916ms
2025-07-30 17:22:59.339 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/users/b9030b04-2da7-449f-94de-d6d4814a8177/instructor-stats - null null
2025-07-30 17:22:59.339 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:22:59.339 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/users/b9030b04-2da7-449f-94de-d6d4814a8177/instructor-stats - 204 null null 0.2664ms
2025-07-30 17:22:59.340 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/users/b9030b04-2da7-449f-94de-d6d4814a8177/instructor-stats - application/json null
2025-07-30 17:22:59.341 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:22:59.342 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:22:59.342 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/users/b9030b04-2da7-449f-94de-d6d4814a8177/instructor-stats - 404 0 null 2.0354ms
2025-07-30 17:22:59.342 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5295/api/users/b9030b04-2da7-449f-94de-d6d4814a8177/instructor-stats, Response status code: 404
2025-07-30 17:22:59.345 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/courses?instructorId=b9030b04-2da7-449f-94de-d6d4814a8177 - null null
2025-07-30 17:22:59.345 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:22:59.345 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/courses?instructorId=b9030b04-2da7-449f-94de-d6d4814a8177 - 204 null null 0.1981ms
2025-07-30 17:22:59.346 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses?instructorId=b9030b04-2da7-449f-94de-d6d4814a8177 - application/json null
2025-07-30 17:22:59.346 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:22:59.349 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:22:59.349 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-30 17:22:59.349 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-30 17:22:59.352 +08:00 [ERR] Failed executing DbCommand (1ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."IsPublished", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."PublishedAt", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."IsFlagged", r."Rating", r."Status", r."StudentId", e."Id", e."AverageQuizScore", e."CertificateIssued", e."CertificateUrl", e."CompletedAt", e."CompletedLessons", e."CourseId", e."EnrolledAt", e."LastAccessedDate", e."ProgressPercentage", e."QuizCount", e."StudentId", e."TotalTimeSpent"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."IsPublished", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."PublishedAt", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-30 17:22:59.353 +08:00 [ERR] An exception occurred while iterating over the results of a query for context type 'CeceLearningPortal.Api.Data.ApplicationDbContext'.
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 1526
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 1526
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 1526
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 1526
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 17:22:59.354 +08:00 [ERR] Error retrieving courses
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 1526
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at CeceLearningPortal.Api.Services.CourseService.GetAllCoursesAsync(CourseFilterDto filter) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Services\CourseService.cs:line 95
   at CeceLearningPortal.Api.Controllers.CoursesController.GetCourses(CourseFilterDto filter) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Controllers\CoursesController.cs:line 26
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 1526
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 17:22:59.356 +08:00 [INF] Executing ObjectResult, writing value of type '<>f__AnonymousType0`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 17:22:59.356 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 6.434ms
2025-07-30 17:22:59.356 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-30 17:22:59.356 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses?instructorId=b9030b04-2da7-449f-94de-d6d4814a8177 - 500 null application/json; charset=utf-8 10.1984ms
2025-07-30 17:23:01.810 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users - null null
2025-07-30 17:23:01.811 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:23:01.811 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users - 204 null null 0.3527ms
2025-07-30 17:23:01.812 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users - application/json null
2025-07-30 17:23:01.812 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:23:01.813 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:23:01.814 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-07-30 17:23:01.814 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-07-30 17:23:01.814 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users - 403 0 null 2.4824ms
2025-07-30 17:23:01.817 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses - application/json null
2025-07-30 17:23:01.817 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:23:01.818 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:23:01.818 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-30 17:23:01.818 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-30 17:23:01.820 +08:00 [ERR] Failed executing DbCommand (1ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."IsPublished", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."PublishedAt", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."IsFlagged", r."Rating", r."Status", r."StudentId", e."Id", e."AverageQuizScore", e."CertificateIssued", e."CertificateUrl", e."CompletedAt", e."CompletedLessons", e."CourseId", e."EnrolledAt", e."LastAccessedDate", e."ProgressPercentage", e."QuizCount", e."StudentId", e."TotalTimeSpent"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."IsPublished", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."PublishedAt", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-30 17:23:01.820 +08:00 [ERR] An exception occurred while iterating over the results of a query for context type 'CeceLearningPortal.Api.Data.ApplicationDbContext'.
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 1526
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 1526
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 1526
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 1526
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 17:23:01.821 +08:00 [ERR] Error retrieving courses
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 1526
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at CeceLearningPortal.Api.Services.CourseService.GetAllCoursesAsync(CourseFilterDto filter) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Services\CourseService.cs:line 95
   at CeceLearningPortal.Api.Controllers.CoursesController.GetCourses(CourseFilterDto filter) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Controllers\CoursesController.cs:line 26
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 1526
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 17:23:01.823 +08:00 [INF] Executing ObjectResult, writing value of type '<>f__AnonymousType0`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 17:23:01.823 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 4.8246ms
2025-07-30 17:23:01.823 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-30 17:23:01.823 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses - 500 null application/json; charset=utf-8 6.7099ms
2025-07-30 17:23:01.825 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/platform - application/json null
2025-07-30 17:23:01.825 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:23:01.826 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:23:01.826 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-07-30 17:23:01.826 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-07-30 17:23:01.827 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/platform - 403 0 null 1.5638ms
2025-07-30 17:23:01.829 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/instructor/b9030b04-2da7-449f-94de-d6d4814a8177 - null null
2025-07-30 17:23:01.829 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:23:01.829 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/instructor/b9030b04-2da7-449f-94de-d6d4814a8177 - 204 null null 0.183ms
2025-07-30 17:23:01.829 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/revenue/instructor/b9030b04-2da7-449f-94de-d6d4814a8177 - null null
2025-07-30 17:23:01.829 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:23:01.830 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/revenue/instructor/b9030b04-2da7-449f-94de-d6d4814a8177 - 204 null null 0.1588ms
2025-07-30 17:23:01.830 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/revenue/instructor/b9030b04-2da7-449f-94de-d6d4814a8177 - application/json null
2025-07-30 17:23:01.831 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/b9030b04-2da7-449f-94de-d6d4814a8177 - application/json null
2025-07-30 17:23:01.831 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:23:01.831 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:23:01.832 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:23:01.832 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:23:01.832 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-07-30 17:23:01.832 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-30 17:23:01.834 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-30 17:23:01.834 +08:00 [INF] Route matched with {action = "GetInstructorRevenue", controller = "Revenue"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorRevenue(System.String) on controller CeceLearningPortal.Api.Controllers.RevenueController (CeceLearningPortal.Api).
2025-07-30 17:23:01.837 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."Id" = @__p_0
LIMIT 1
2025-07-30 17:23:01.841 +08:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2025-07-30 17:23:01.842 +08:00 [ERR] Failed executing DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."IsPublished", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."PublishedAt", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
FROM "Courses" AS c
WHERE c."InstructorId" = @__instructorId_0
2025-07-30 17:23:01.843 +08:00 [ERR] An exception occurred while iterating over the results of a query for context type 'CeceLearningPortal.Api.Data.ApplicationDbContext'.
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 160
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 160
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 160
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 160
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 17:23:01.844 +08:00 [ERR] Error calculating instructor revenue for b9030b04-2da7-449f-94de-d6d4814a8177
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 160
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at CeceLearningPortal.Api.Services.RevenueCalculationService.CalculateInstructorRevenueAsync(String instructorId) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Services\RevenueCalculationService.cs:line 25
   at CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue(String instructorId) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Controllers\RevenueController.cs:line 25
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 160
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 17:23:01.845 +08:00 [INF] Executing ObjectResult, writing value of type '<>f__AnonymousType0`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 17:23:01.845 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api) in 11.1781ms
2025-07-30 17:23:01.846 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-07-30 17:23:01.846 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/revenue/instructor/b9030b04-2da7-449f-94de-d6d4814a8177 - 500 null application/json; charset=utf-8 15.1664ms
2025-07-30 17:23:01.853 +08:00 [ERR] Failed executing DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."IsPublished", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."PublishedAt", c."Status", c."Thumbnail", c."Title", c."UpdatedAt", s."Id", s."AverageQuizScore", s."CertificateIssued", s."CertificateUrl", s."CompletedAt", s."CompletedLessons", s."CourseId", s."EnrolledAt", s."LastAccessedDate", s."ProgressPercentage", s."QuizCount", s."StudentId", s."TotalTimeSpent", s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."IsFlagged", r."Rating", r."Status", r."StudentId"
FROM "Courses" AS c
LEFT JOIN (
    SELECT e."Id", e."AverageQuizScore", e."CertificateIssued", e."CertificateUrl", e."CompletedAt", e."CompletedLessons", e."CourseId", e."EnrolledAt", e."LastAccessedDate", e."ProgressPercentage", e."QuizCount", e."StudentId", e."TotalTimeSpent", a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM "Enrollments" AS e
    INNER JOIN "AspNetUsers" AS a ON e."StudentId" = a."Id"
) AS s ON c."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c."Id" = r."CourseId"
WHERE c."InstructorId" = @__instructorId_0
ORDER BY c."Id", s."Id", s."Id0"
2025-07-30 17:23:01.854 +08:00 [ERR] An exception occurred while iterating over the results of a query for context type 'CeceLearningPortal.Api.Data.ApplicationDbContext'.
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 160
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 160
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 160
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 160
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 17:23:01.855 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 20.4841ms
2025-07-30 17:23:01.855 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-30 17:23:01.855 +08:00 [ERR] An unhandled exception has occurred while executing the request.
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 160
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics(String instructorId) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Controllers\AnalyticsController.cs:line 36
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at CeceLearningPortal.Api.Middleware.TokenBlacklistMiddleware.InvokeAsync(HttpContext context) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Middleware\TokenBlacklistMiddleware.cs:line 51
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 160
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 17:23:01.860 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/b9030b04-2da7-449f-94de-d6d4814a8177 - 500 null text/plain; charset=utf-8 29.6063ms
2025-07-30 17:23:03.228 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/b9030b04-2da7-449f-94de-d6d4814a8177 - application/json null
2025-07-30 17:23:03.229 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:23:03.230 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:23:03.230 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-30 17:23:03.230 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-30 17:23:03.232 +08:00 [ERR] Failed executing DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."IsPublished", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."PublishedAt", c."Status", c."Thumbnail", c."Title", c."UpdatedAt", s."Id", s."AverageQuizScore", s."CertificateIssued", s."CertificateUrl", s."CompletedAt", s."CompletedLessons", s."CourseId", s."EnrolledAt", s."LastAccessedDate", s."ProgressPercentage", s."QuizCount", s."StudentId", s."TotalTimeSpent", s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."IsFlagged", r."Rating", r."Status", r."StudentId"
FROM "Courses" AS c
LEFT JOIN (
    SELECT e."Id", e."AverageQuizScore", e."CertificateIssued", e."CertificateUrl", e."CompletedAt", e."CompletedLessons", e."CourseId", e."EnrolledAt", e."LastAccessedDate", e."ProgressPercentage", e."QuizCount", e."StudentId", e."TotalTimeSpent", a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM "Enrollments" AS e
    INNER JOIN "AspNetUsers" AS a ON e."StudentId" = a."Id"
) AS s ON c."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c."Id" = r."CourseId"
WHERE c."InstructorId" = @__instructorId_0
ORDER BY c."Id", s."Id", s."Id0"
2025-07-30 17:23:03.232 +08:00 [ERR] An exception occurred while iterating over the results of a query for context type 'CeceLearningPortal.Api.Data.ApplicationDbContext'.
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 160
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 160
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 160
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 160
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 17:23:03.234 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 3.2446ms
2025-07-30 17:23:03.234 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-30 17:23:03.234 +08:00 [ERR] An unhandled exception has occurred while executing the request.
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 160
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics(String instructorId) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Controllers\AnalyticsController.cs:line 36
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at CeceLearningPortal.Api.Middleware.TokenBlacklistMiddleware.InvokeAsync(HttpContext context) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Middleware\TokenBlacklistMiddleware.cs:line 51
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 160
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 17:23:03.237 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/b9030b04-2da7-449f-94de-d6d4814a8177 - 500 null text/plain; charset=utf-8 8.8727ms
2025-07-30 17:23:07.387 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/revenue/instructor/b9030b04-2da7-449f-94de-d6d4814a8177 - null null
2025-07-30 17:23:07.387 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:23:07.387 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/revenue/instructor/b9030b04-2da7-449f-94de-d6d4814a8177 - 204 null null 0.277ms
2025-07-30 17:23:07.388 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/revenue/instructor/b9030b04-2da7-449f-94de-d6d4814a8177 - application/json null
2025-07-30 17:23:07.388 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:23:07.389 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:23:07.389 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-07-30 17:23:07.389 +08:00 [INF] Route matched with {action = "GetInstructorRevenue", controller = "Revenue"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorRevenue(System.String) on controller CeceLearningPortal.Api.Controllers.RevenueController (CeceLearningPortal.Api).
2025-07-30 17:23:07.391 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."Id" = @__p_0
LIMIT 1
2025-07-30 17:23:07.391 +08:00 [ERR] Failed executing DbCommand (0ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."IsPublished", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."PublishedAt", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
FROM "Courses" AS c
WHERE c."InstructorId" = @__instructorId_0
2025-07-30 17:23:07.407 +08:00 [ERR] An exception occurred while iterating over the results of a query for context type 'CeceLearningPortal.Api.Data.ApplicationDbContext'.
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 160
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 160
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 160
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 160
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 17:23:07.408 +08:00 [ERR] Error calculating instructor revenue for b9030b04-2da7-449f-94de-d6d4814a8177
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 160
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at CeceLearningPortal.Api.Services.RevenueCalculationService.CalculateInstructorRevenueAsync(String instructorId) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Services\RevenueCalculationService.cs:line 25
   at CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue(String instructorId) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Controllers\RevenueController.cs:line 25
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 160
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 17:23:07.409 +08:00 [INF] Executing ObjectResult, writing value of type '<>f__AnonymousType0`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 17:23:07.409 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api) in 20.1074ms
2025-07-30 17:23:07.410 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-07-30 17:23:07.410 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/revenue/instructor/b9030b04-2da7-449f-94de-d6d4814a8177 - 500 null application/json; charset=utf-8 21.6315ms
2025-07-30 17:23:07.411 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/instructor/b9030b04-2da7-449f-94de-d6d4814a8177 - null null
2025-07-30 17:23:07.412 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:23:07.412 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/instructor/b9030b04-2da7-449f-94de-d6d4814a8177 - 204 null null 0.1509ms
2025-07-30 17:23:07.412 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/b9030b04-2da7-449f-94de-d6d4814a8177 - application/json null
2025-07-30 17:23:07.412 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:23:07.413 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:23:07.414 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-30 17:23:07.414 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-30 17:23:07.415 +08:00 [ERR] Failed executing DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."IsPublished", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."PublishedAt", c."Status", c."Thumbnail", c."Title", c."UpdatedAt", s."Id", s."AverageQuizScore", s."CertificateIssued", s."CertificateUrl", s."CompletedAt", s."CompletedLessons", s."CourseId", s."EnrolledAt", s."LastAccessedDate", s."ProgressPercentage", s."QuizCount", s."StudentId", s."TotalTimeSpent", s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."IsFlagged", r."Rating", r."Status", r."StudentId"
FROM "Courses" AS c
LEFT JOIN (
    SELECT e."Id", e."AverageQuizScore", e."CertificateIssued", e."CertificateUrl", e."CompletedAt", e."CompletedLessons", e."CourseId", e."EnrolledAt", e."LastAccessedDate", e."ProgressPercentage", e."QuizCount", e."StudentId", e."TotalTimeSpent", a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM "Enrollments" AS e
    INNER JOIN "AspNetUsers" AS a ON e."StudentId" = a."Id"
) AS s ON c."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c."Id" = r."CourseId"
WHERE c."InstructorId" = @__instructorId_0
ORDER BY c."Id", s."Id", s."Id0"
2025-07-30 17:23:07.416 +08:00 [ERR] An exception occurred while iterating over the results of a query for context type 'CeceLearningPortal.Api.Data.ApplicationDbContext'.
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 160
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 160
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 160
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 160
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 17:23:07.417 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 2.8013ms
2025-07-30 17:23:07.417 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-30 17:23:07.417 +08:00 [ERR] An unhandled exception has occurred while executing the request.
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 160
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics(String instructorId) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Controllers\AnalyticsController.cs:line 36
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at CeceLearningPortal.Api.Middleware.TokenBlacklistMiddleware.InvokeAsync(HttpContext context) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Middleware\TokenBlacklistMiddleware.cs:line 51
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 160
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 17:23:07.420 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/b9030b04-2da7-449f-94de-d6d4814a8177 - 500 null text/plain; charset=utf-8 7.7034ms
2025-07-30 17:23:08.822 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/b9030b04-2da7-449f-94de-d6d4814a8177 - application/json null
2025-07-30 17:23:08.822 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:23:08.823 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:23:08.824 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-30 17:23:08.824 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-30 17:23:08.825 +08:00 [ERR] Failed executing DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."IsPublished", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."PublishedAt", c."Status", c."Thumbnail", c."Title", c."UpdatedAt", s."Id", s."AverageQuizScore", s."CertificateIssued", s."CertificateUrl", s."CompletedAt", s."CompletedLessons", s."CourseId", s."EnrolledAt", s."LastAccessedDate", s."ProgressPercentage", s."QuizCount", s."StudentId", s."TotalTimeSpent", s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."IsFlagged", r."Rating", r."Status", r."StudentId"
FROM "Courses" AS c
LEFT JOIN (
    SELECT e."Id", e."AverageQuizScore", e."CertificateIssued", e."CertificateUrl", e."CompletedAt", e."CompletedLessons", e."CourseId", e."EnrolledAt", e."LastAccessedDate", e."ProgressPercentage", e."QuizCount", e."StudentId", e."TotalTimeSpent", a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM "Enrollments" AS e
    INNER JOIN "AspNetUsers" AS a ON e."StudentId" = a."Id"
) AS s ON c."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c."Id" = r."CourseId"
WHERE c."InstructorId" = @__instructorId_0
ORDER BY c."Id", s."Id", s."Id0"
2025-07-30 17:23:08.826 +08:00 [ERR] An exception occurred while iterating over the results of a query for context type 'CeceLearningPortal.Api.Data.ApplicationDbContext'.
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 160
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 160
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 160
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 160
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 17:23:08.826 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 2.8385ms
2025-07-30 17:23:08.827 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-30 17:23:08.827 +08:00 [ERR] An unhandled exception has occurred while executing the request.
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 160
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics(String instructorId) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Controllers\AnalyticsController.cs:line 36
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at CeceLearningPortal.Api.Middleware.TokenBlacklistMiddleware.InvokeAsync(HttpContext context) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Middleware\TokenBlacklistMiddleware.cs:line 51
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 160
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 17:23:08.829 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/b9030b04-2da7-449f-94de-d6d4814a8177 - 500 null text/plain; charset=utf-8 6.9636ms
2025-07-30 17:23:12.911 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/revenue/instructor/b9030b04-2da7-449f-94de-d6d4814a8177 - null null
2025-07-30 17:23:12.911 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:23:12.911 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/revenue/instructor/b9030b04-2da7-449f-94de-d6d4814a8177 - 204 null null 0.2124ms
2025-07-30 17:23:12.912 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/revenue/instructor/b9030b04-2da7-449f-94de-d6d4814a8177 - application/json null
2025-07-30 17:23:12.912 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:23:12.913 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:23:12.913 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-07-30 17:23:12.913 +08:00 [INF] Route matched with {action = "GetInstructorRevenue", controller = "Revenue"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorRevenue(System.String) on controller CeceLearningPortal.Api.Controllers.RevenueController (CeceLearningPortal.Api).
2025-07-30 17:23:12.915 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."Id" = @__p_0
LIMIT 1
2025-07-30 17:23:12.915 +08:00 [ERR] Failed executing DbCommand (0ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."IsPublished", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."PublishedAt", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
FROM "Courses" AS c
WHERE c."InstructorId" = @__instructorId_0
2025-07-30 17:23:12.916 +08:00 [ERR] An exception occurred while iterating over the results of a query for context type 'CeceLearningPortal.Api.Data.ApplicationDbContext'.
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 160
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 160
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 160
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 160
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 17:23:12.917 +08:00 [ERR] Error calculating instructor revenue for b9030b04-2da7-449f-94de-d6d4814a8177
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 160
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at CeceLearningPortal.Api.Services.RevenueCalculationService.CalculateInstructorRevenueAsync(String instructorId) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Services\RevenueCalculationService.cs:line 25
   at CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue(String instructorId) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Controllers\RevenueController.cs:line 25
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 160
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 17:23:12.918 +08:00 [INF] Executing ObjectResult, writing value of type '<>f__AnonymousType0`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 17:23:12.918 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api) in 4.9479ms
2025-07-30 17:23:12.918 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-07-30 17:23:12.918 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/revenue/instructor/b9030b04-2da7-449f-94de-d6d4814a8177 - 500 null application/json; charset=utf-8 6.456ms
2025-07-30 17:23:12.920 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/instructor/b9030b04-2da7-449f-94de-d6d4814a8177 - null null
2025-07-30 17:23:12.920 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:23:12.920 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/instructor/b9030b04-2da7-449f-94de-d6d4814a8177 - 204 null null 0.1159ms
2025-07-30 17:23:12.920 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/b9030b04-2da7-449f-94de-d6d4814a8177 - application/json null
2025-07-30 17:23:12.921 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:23:12.921 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:23:12.922 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-30 17:23:12.922 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-30 17:23:12.922 +08:00 [ERR] Failed executing DbCommand (0ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."IsPublished", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."PublishedAt", c."Status", c."Thumbnail", c."Title", c."UpdatedAt", s."Id", s."AverageQuizScore", s."CertificateIssued", s."CertificateUrl", s."CompletedAt", s."CompletedLessons", s."CourseId", s."EnrolledAt", s."LastAccessedDate", s."ProgressPercentage", s."QuizCount", s."StudentId", s."TotalTimeSpent", s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."IsFlagged", r."Rating", r."Status", r."StudentId"
FROM "Courses" AS c
LEFT JOIN (
    SELECT e."Id", e."AverageQuizScore", e."CertificateIssued", e."CertificateUrl", e."CompletedAt", e."CompletedLessons", e."CourseId", e."EnrolledAt", e."LastAccessedDate", e."ProgressPercentage", e."QuizCount", e."StudentId", e."TotalTimeSpent", a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM "Enrollments" AS e
    INNER JOIN "AspNetUsers" AS a ON e."StudentId" = a."Id"
) AS s ON c."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c."Id" = r."CourseId"
WHERE c."InstructorId" = @__instructorId_0
ORDER BY c."Id", s."Id", s."Id0"
2025-07-30 17:23:12.923 +08:00 [ERR] An exception occurred while iterating over the results of a query for context type 'CeceLearningPortal.Api.Data.ApplicationDbContext'.
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 160
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 160
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 160
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 160
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 17:23:12.924 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 2.239ms
2025-07-30 17:23:12.924 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-30 17:23:12.924 +08:00 [ERR] An unhandled exception has occurred while executing the request.
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 160
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics(String instructorId) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Controllers\AnalyticsController.cs:line 36
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at CeceLearningPortal.Api.Middleware.TokenBlacklistMiddleware.InvokeAsync(HttpContext context) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Middleware\TokenBlacklistMiddleware.cs:line 51
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 160
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 17:23:12.926 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/b9030b04-2da7-449f-94de-d6d4814a8177 - 500 null text/plain; charset=utf-8 5.9886ms
2025-07-30 17:23:14.220 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/b9030b04-2da7-449f-94de-d6d4814a8177 - application/json null
2025-07-30 17:23:14.220 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:23:14.221 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:23:14.222 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-30 17:23:14.222 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-30 17:23:14.223 +08:00 [ERR] Failed executing DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."IsPublished", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."PublishedAt", c."Status", c."Thumbnail", c."Title", c."UpdatedAt", s."Id", s."AverageQuizScore", s."CertificateIssued", s."CertificateUrl", s."CompletedAt", s."CompletedLessons", s."CourseId", s."EnrolledAt", s."LastAccessedDate", s."ProgressPercentage", s."QuizCount", s."StudentId", s."TotalTimeSpent", s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."IsFlagged", r."Rating", r."Status", r."StudentId"
FROM "Courses" AS c
LEFT JOIN (
    SELECT e."Id", e."AverageQuizScore", e."CertificateIssued", e."CertificateUrl", e."CompletedAt", e."CompletedLessons", e."CourseId", e."EnrolledAt", e."LastAccessedDate", e."ProgressPercentage", e."QuizCount", e."StudentId", e."TotalTimeSpent", a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM "Enrollments" AS e
    INNER JOIN "AspNetUsers" AS a ON e."StudentId" = a."Id"
) AS s ON c."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c."Id" = r."CourseId"
WHERE c."InstructorId" = @__instructorId_0
ORDER BY c."Id", s."Id", s."Id0"
2025-07-30 17:23:14.223 +08:00 [ERR] An exception occurred while iterating over the results of a query for context type 'CeceLearningPortal.Api.Data.ApplicationDbContext'.
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 160
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 160
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 160
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 160
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 17:23:14.224 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 2.6425ms
2025-07-30 17:23:14.224 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-30 17:23:14.224 +08:00 [ERR] An unhandled exception has occurred while executing the request.
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 160
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics(String instructorId) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Controllers\AnalyticsController.cs:line 36
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at CeceLearningPortal.Api.Middleware.TokenBlacklistMiddleware.InvokeAsync(HttpContext context) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Middleware\TokenBlacklistMiddleware.cs:line 51
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 160
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 17:23:14.227 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/b9030b04-2da7-449f-94de-d6d4814a8177 - 500 null text/plain; charset=utf-8 6.5434ms
2025-07-30 17:23:15.660 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/revenue/instructor/b9030b04-2da7-449f-94de-d6d4814a8177 - application/json null
2025-07-30 17:23:15.660 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:23:15.661 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:23:15.661 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-07-30 17:23:15.661 +08:00 [INF] Route matched with {action = "GetInstructorRevenue", controller = "Revenue"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorRevenue(System.String) on controller CeceLearningPortal.Api.Controllers.RevenueController (CeceLearningPortal.Api).
2025-07-30 17:23:15.662 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."Id" = @__p_0
LIMIT 1
2025-07-30 17:23:15.662 +08:00 [ERR] Failed executing DbCommand (0ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."IsPublished", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."PublishedAt", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
FROM "Courses" AS c
WHERE c."InstructorId" = @__instructorId_0
2025-07-30 17:23:15.663 +08:00 [ERR] An exception occurred while iterating over the results of a query for context type 'CeceLearningPortal.Api.Data.ApplicationDbContext'.
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 160
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 160
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 160
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 160
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 17:23:15.664 +08:00 [ERR] Error calculating instructor revenue for b9030b04-2da7-449f-94de-d6d4814a8177
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 160
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at CeceLearningPortal.Api.Services.RevenueCalculationService.CalculateInstructorRevenueAsync(String instructorId) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Services\RevenueCalculationService.cs:line 25
   at CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue(String instructorId) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Controllers\RevenueController.cs:line 25
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 160
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 17:23:15.665 +08:00 [INF] Executing ObjectResult, writing value of type '<>f__AnonymousType0`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 17:23:15.665 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api) in 4.329ms
2025-07-30 17:23:15.665 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-07-30 17:23:15.665 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/revenue/instructor/b9030b04-2da7-449f-94de-d6d4814a8177 - 500 null application/json; charset=utf-8 5.7886ms
2025-07-30 17:23:15.667 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/b9030b04-2da7-449f-94de-d6d4814a8177 - application/json null
2025-07-30 17:23:15.667 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:23:15.668 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:23:15.668 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-30 17:23:15.668 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-30 17:23:15.669 +08:00 [ERR] Failed executing DbCommand (0ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."IsPublished", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."PublishedAt", c."Status", c."Thumbnail", c."Title", c."UpdatedAt", s."Id", s."AverageQuizScore", s."CertificateIssued", s."CertificateUrl", s."CompletedAt", s."CompletedLessons", s."CourseId", s."EnrolledAt", s."LastAccessedDate", s."ProgressPercentage", s."QuizCount", s."StudentId", s."TotalTimeSpent", s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."IsFlagged", r."Rating", r."Status", r."StudentId"
FROM "Courses" AS c
LEFT JOIN (
    SELECT e."Id", e."AverageQuizScore", e."CertificateIssued", e."CertificateUrl", e."CompletedAt", e."CompletedLessons", e."CourseId", e."EnrolledAt", e."LastAccessedDate", e."ProgressPercentage", e."QuizCount", e."StudentId", e."TotalTimeSpent", a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM "Enrollments" AS e
    INNER JOIN "AspNetUsers" AS a ON e."StudentId" = a."Id"
) AS s ON c."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c."Id" = r."CourseId"
WHERE c."InstructorId" = @__instructorId_0
ORDER BY c."Id", s."Id", s."Id0"
2025-07-30 17:23:15.670 +08:00 [ERR] An exception occurred while iterating over the results of a query for context type 'CeceLearningPortal.Api.Data.ApplicationDbContext'.
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 160
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 160
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 160
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 160
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 17:23:15.671 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 2.4536ms
2025-07-30 17:23:15.671 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-30 17:23:15.671 +08:00 [ERR] An unhandled exception has occurred while executing the request.
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 160
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics(String instructorId) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Controllers\AnalyticsController.cs:line 36
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at CeceLearningPortal.Api.Middleware.TokenBlacklistMiddleware.InvokeAsync(HttpContext context) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Middleware\TokenBlacklistMiddleware.cs:line 51
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 160
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 17:23:15.673 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/b9030b04-2da7-449f-94de-d6d4814a8177 - 500 null text/plain; charset=utf-8 6.2543ms
2025-07-30 17:23:16.316 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/b9030b04-2da7-449f-94de-d6d4814a8177 - application/json null
2025-07-30 17:23:16.316 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:23:16.317 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:23:16.317 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-30 17:23:16.318 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-30 17:23:16.319 +08:00 [ERR] Failed executing DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."IsPublished", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."PublishedAt", c."Status", c."Thumbnail", c."Title", c."UpdatedAt", s."Id", s."AverageQuizScore", s."CertificateIssued", s."CertificateUrl", s."CompletedAt", s."CompletedLessons", s."CourseId", s."EnrolledAt", s."LastAccessedDate", s."ProgressPercentage", s."QuizCount", s."StudentId", s."TotalTimeSpent", s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."IsFlagged", r."Rating", r."Status", r."StudentId"
FROM "Courses" AS c
LEFT JOIN (
    SELECT e."Id", e."AverageQuizScore", e."CertificateIssued", e."CertificateUrl", e."CompletedAt", e."CompletedLessons", e."CourseId", e."EnrolledAt", e."LastAccessedDate", e."ProgressPercentage", e."QuizCount", e."StudentId", e."TotalTimeSpent", a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM "Enrollments" AS e
    INNER JOIN "AspNetUsers" AS a ON e."StudentId" = a."Id"
) AS s ON c."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c."Id" = r."CourseId"
WHERE c."InstructorId" = @__instructorId_0
ORDER BY c."Id", s."Id", s."Id0"
2025-07-30 17:23:16.319 +08:00 [ERR] An exception occurred while iterating over the results of a query for context type 'CeceLearningPortal.Api.Data.ApplicationDbContext'.
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 160
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 160
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 160
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 160
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 17:23:16.320 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 2.6227ms
2025-07-30 17:23:16.320 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-30 17:23:16.320 +08:00 [ERR] An unhandled exception has occurred while executing the request.
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 160
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics(String instructorId) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Controllers\AnalyticsController.cs:line 36
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at CeceLearningPortal.Api.Middleware.TokenBlacklistMiddleware.InvokeAsync(HttpContext context) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Middleware\TokenBlacklistMiddleware.cs:line 51
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 160
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 17:23:16.323 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/b9030b04-2da7-449f-94de-d6d4814a8177 - 500 null text/plain; charset=utf-8 6.841ms
2025-07-30 17:24:53.857 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/instructor/b9030b04-2da7-449f-94de-d6d4814a8177 - null null
2025-07-30 17:24:53.858 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:24:53.858 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/instructor/b9030b04-2da7-449f-94de-d6d4814a8177 - 204 null null 0.2817ms
2025-07-30 17:24:53.858 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users - null null
2025-07-30 17:24:53.858 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:24:53.858 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users - 204 null null 0.2028ms
2025-07-30 17:24:53.859 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/b9030b04-2da7-449f-94de-d6d4814a8177 - application/json null
2025-07-30 17:24:53.859 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:24:53.859 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users - application/json null
2025-07-30 17:24:53.859 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:24:53.860 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:24:53.860 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-30 17:24:53.860 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-30 17:24:53.861 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:24:53.861 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-07-30 17:24:53.861 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-07-30 17:24:53.861 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users - 403 0 null 1.494ms
2025-07-30 17:24:53.861 +08:00 [ERR] Failed executing DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."IsPublished", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."PublishedAt", c."Status", c."Thumbnail", c."Title", c."UpdatedAt", s."Id", s."AverageQuizScore", s."CertificateIssued", s."CertificateUrl", s."CompletedAt", s."CompletedLessons", s."CourseId", s."EnrolledAt", s."LastAccessedDate", s."ProgressPercentage", s."QuizCount", s."StudentId", s."TotalTimeSpent", s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."IsFlagged", r."Rating", r."Status", r."StudentId"
FROM "Courses" AS c
LEFT JOIN (
    SELECT e."Id", e."AverageQuizScore", e."CertificateIssued", e."CertificateUrl", e."CompletedAt", e."CompletedLessons", e."CourseId", e."EnrolledAt", e."LastAccessedDate", e."ProgressPercentage", e."QuizCount", e."StudentId", e."TotalTimeSpent", a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM "Enrollments" AS e
    INNER JOIN "AspNetUsers" AS a ON e."StudentId" = a."Id"
) AS s ON c."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c."Id" = r."CourseId"
WHERE c."InstructorId" = @__instructorId_0
ORDER BY c."Id", s."Id", s."Id0"
2025-07-30 17:24:53.863 +08:00 [ERR] An exception occurred while iterating over the results of a query for context type 'CeceLearningPortal.Api.Data.ApplicationDbContext'.
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 160
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 160
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 160
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 160
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 17:24:53.865 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 4.2608ms
2025-07-30 17:24:53.865 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-30 17:24:53.867 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/courses - null null
2025-07-30 17:24:53.867 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:24:53.867 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/courses - 204 null null 0.152ms
2025-07-30 17:24:53.865 +08:00 [ERR] An unhandled exception has occurred while executing the request.
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 160
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics(String instructorId) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Controllers\AnalyticsController.cs:line 36
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at CeceLearningPortal.Api.Middleware.TokenBlacklistMiddleware.InvokeAsync(HttpContext context) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Middleware\TokenBlacklistMiddleware.cs:line 51
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 160
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 17:24:53.867 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses - application/json null
2025-07-30 17:24:53.868 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:24:53.869 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/b9030b04-2da7-449f-94de-d6d4814a8177 - 500 null text/plain; charset=utf-8 9.9618ms
2025-07-30 17:24:53.869 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:24:53.869 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-30 17:24:53.869 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-30 17:24:53.870 +08:00 [ERR] Failed executing DbCommand (0ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."IsPublished", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."PublishedAt", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."IsFlagged", r."Rating", r."Status", r."StudentId", e."Id", e."AverageQuizScore", e."CertificateIssued", e."CertificateUrl", e."CompletedAt", e."CompletedLessons", e."CourseId", e."EnrolledAt", e."LastAccessedDate", e."ProgressPercentage", e."QuizCount", e."StudentId", e."TotalTimeSpent"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."IsPublished", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."PublishedAt", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-30 17:24:53.871 +08:00 [ERR] An exception occurred while iterating over the results of a query for context type 'CeceLearningPortal.Api.Data.ApplicationDbContext'.
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 1526
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 1526
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 1526
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 1526
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 17:24:53.872 +08:00 [ERR] Error retrieving courses
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 1526
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at CeceLearningPortal.Api.Services.CourseService.GetAllCoursesAsync(CourseFilterDto filter) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Services\CourseService.cs:line 95
   at CeceLearningPortal.Api.Controllers.CoursesController.GetCourses(CourseFilterDto filter) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Controllers\CoursesController.cs:line 26
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 1526
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 17:24:53.873 +08:00 [INF] Executing ObjectResult, writing value of type '<>f__AnonymousType0`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 17:24:53.873 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 3.7734ms
2025-07-30 17:24:53.873 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-30 17:24:53.873 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses - 500 null application/json; charset=utf-8 5.4826ms
2025-07-30 17:24:53.875 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/platform - null null
2025-07-30 17:24:53.875 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:24:53.875 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/platform - 204 null null 0.1695ms
2025-07-30 17:24:53.876 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/platform - application/json null
2025-07-30 17:24:53.876 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:24:53.877 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:24:53.877 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-07-30 17:24:53.877 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-07-30 17:24:53.877 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/platform - 403 0 null 1.6853ms
2025-07-30 17:24:53.881 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/revenue/instructor/b9030b04-2da7-449f-94de-d6d4814a8177 - null null
2025-07-30 17:24:53.881 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:24:53.881 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/revenue/instructor/b9030b04-2da7-449f-94de-d6d4814a8177 - 204 null null 0.126ms
2025-07-30 17:24:53.881 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/b9030b04-2da7-449f-94de-d6d4814a8177 - application/json null
2025-07-30 17:24:53.881 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:24:53.882 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/revenue/instructor/b9030b04-2da7-449f-94de-d6d4814a8177 - application/json null
2025-07-30 17:24:53.882 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:24:53.883 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:24:53.883 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-30 17:24:53.883 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-30 17:24:53.884 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:24:53.884 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-07-30 17:24:53.884 +08:00 [INF] Route matched with {action = "GetInstructorRevenue", controller = "Revenue"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorRevenue(System.String) on controller CeceLearningPortal.Api.Controllers.RevenueController (CeceLearningPortal.Api).
2025-07-30 17:24:53.884 +08:00 [ERR] Failed executing DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."IsPublished", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."PublishedAt", c."Status", c."Thumbnail", c."Title", c."UpdatedAt", s."Id", s."AverageQuizScore", s."CertificateIssued", s."CertificateUrl", s."CompletedAt", s."CompletedLessons", s."CourseId", s."EnrolledAt", s."LastAccessedDate", s."ProgressPercentage", s."QuizCount", s."StudentId", s."TotalTimeSpent", s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."IsFlagged", r."Rating", r."Status", r."StudentId"
FROM "Courses" AS c
LEFT JOIN (
    SELECT e."Id", e."AverageQuizScore", e."CertificateIssued", e."CertificateUrl", e."CompletedAt", e."CompletedLessons", e."CourseId", e."EnrolledAt", e."LastAccessedDate", e."ProgressPercentage", e."QuizCount", e."StudentId", e."TotalTimeSpent", a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM "Enrollments" AS e
    INNER JOIN "AspNetUsers" AS a ON e."StudentId" = a."Id"
) AS s ON c."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c."Id" = r."CourseId"
WHERE c."InstructorId" = @__instructorId_0
ORDER BY c."Id", s."Id", s."Id0"
2025-07-30 17:24:53.885 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."Id" = @__p_0
LIMIT 1
2025-07-30 17:24:53.885 +08:00 [ERR] An exception occurred while iterating over the results of a query for context type 'CeceLearningPortal.Api.Data.ApplicationDbContext'.
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 160
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 160
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 160
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 160
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 17:24:53.885 +08:00 [ERR] Failed executing DbCommand (0ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."IsPublished", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."PublishedAt", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
FROM "Courses" AS c
WHERE c."InstructorId" = @__instructorId_0
2025-07-30 17:24:53.886 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 2.7813ms
2025-07-30 17:24:53.886 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-30 17:24:53.886 +08:00 [ERR] An exception occurred while iterating over the results of a query for context type 'CeceLearningPortal.Api.Data.ApplicationDbContext'.
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 160
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 160
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 160
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 160
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 17:24:53.886 +08:00 [ERR] An unhandled exception has occurred while executing the request.
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 160
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics(String instructorId) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Controllers\AnalyticsController.cs:line 36
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at CeceLearningPortal.Api.Middleware.TokenBlacklistMiddleware.InvokeAsync(HttpContext context) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Middleware\TokenBlacklistMiddleware.cs:line 51
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 160
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 17:24:53.887 +08:00 [ERR] Error calculating instructor revenue for b9030b04-2da7-449f-94de-d6d4814a8177
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 160
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at CeceLearningPortal.Api.Services.RevenueCalculationService.CalculateInstructorRevenueAsync(String instructorId) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Services\RevenueCalculationService.cs:line 25
   at CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue(String instructorId) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Controllers\RevenueController.cs:line 25
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 160
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 17:24:53.889 +08:00 [INF] Executing ObjectResult, writing value of type '<>f__AnonymousType0`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 17:24:53.889 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api) in 5.1861ms
2025-07-30 17:24:53.889 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-07-30 17:24:53.889 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/b9030b04-2da7-449f-94de-d6d4814a8177 - 500 null text/plain; charset=utf-8 7.681ms
2025-07-30 17:24:53.889 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/revenue/instructor/b9030b04-2da7-449f-94de-d6d4814a8177 - 500 null application/json; charset=utf-8 7.0043ms
2025-07-30 17:25:07.689 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/instructor/b9030b04-2da7-449f-94de-d6d4814a8177 - null null
2025-07-30 17:25:07.690 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:25:07.690 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/instructor/b9030b04-2da7-449f-94de-d6d4814a8177 - 204 null null 0.2053ms
2025-07-30 17:25:07.690 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users - null null
2025-07-30 17:25:07.690 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:25:07.690 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/b9030b04-2da7-449f-94de-d6d4814a8177 - application/json null
2025-07-30 17:25:07.690 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users - 204 null null 0.1709ms
2025-07-30 17:25:07.691 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:25:07.691 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users - application/json null
2025-07-30 17:25:07.691 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:25:07.692 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:25:07.692 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-30 17:25:07.692 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-30 17:25:07.692 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:25:07.692 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-07-30 17:25:07.693 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-07-30 17:25:07.693 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users - 403 0 null 1.2926ms
2025-07-30 17:25:07.693 +08:00 [ERR] Failed executing DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."IsPublished", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."PublishedAt", c."Status", c."Thumbnail", c."Title", c."UpdatedAt", s."Id", s."AverageQuizScore", s."CertificateIssued", s."CertificateUrl", s."CompletedAt", s."CompletedLessons", s."CourseId", s."EnrolledAt", s."LastAccessedDate", s."ProgressPercentage", s."QuizCount", s."StudentId", s."TotalTimeSpent", s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."IsFlagged", r."Rating", r."Status", r."StudentId"
FROM "Courses" AS c
LEFT JOIN (
    SELECT e."Id", e."AverageQuizScore", e."CertificateIssued", e."CertificateUrl", e."CompletedAt", e."CompletedLessons", e."CourseId", e."EnrolledAt", e."LastAccessedDate", e."ProgressPercentage", e."QuizCount", e."StudentId", e."TotalTimeSpent", a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM "Enrollments" AS e
    INNER JOIN "AspNetUsers" AS a ON e."StudentId" = a."Id"
) AS s ON c."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c."Id" = r."CourseId"
WHERE c."InstructorId" = @__instructorId_0
ORDER BY c."Id", s."Id", s."Id0"
2025-07-30 17:25:07.694 +08:00 [ERR] An exception occurred while iterating over the results of a query for context type 'CeceLearningPortal.Api.Data.ApplicationDbContext'.
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 160
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 160
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 160
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 160
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 17:25:07.695 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 2.4704ms
2025-07-30 17:25:07.695 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-30 17:25:07.695 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/courses - null null
2025-07-30 17:25:07.695 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:25:07.695 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/courses - 204 null null 0.1147ms
2025-07-30 17:25:07.696 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses - application/json null
2025-07-30 17:25:07.696 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:25:07.695 +08:00 [ERR] An unhandled exception has occurred while executing the request.
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 160
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics(String instructorId) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Controllers\AnalyticsController.cs:line 36
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at CeceLearningPortal.Api.Middleware.TokenBlacklistMiddleware.InvokeAsync(HttpContext context) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Middleware\TokenBlacklistMiddleware.cs:line 51
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 160
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 17:25:07.696 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:25:07.697 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-30 17:25:07.697 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-30 17:25:07.697 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/b9030b04-2da7-449f-94de-d6d4814a8177 - 500 null text/plain; charset=utf-8 6.9525ms
2025-07-30 17:25:07.698 +08:00 [ERR] Failed executing DbCommand (0ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."IsPublished", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."PublishedAt", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."IsFlagged", r."Rating", r."Status", r."StudentId", e."Id", e."AverageQuizScore", e."CertificateIssued", e."CertificateUrl", e."CompletedAt", e."CompletedLessons", e."CourseId", e."EnrolledAt", e."LastAccessedDate", e."ProgressPercentage", e."QuizCount", e."StudentId", e."TotalTimeSpent"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."IsPublished", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."PublishedAt", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-30 17:25:07.698 +08:00 [ERR] An exception occurred while iterating over the results of a query for context type 'CeceLearningPortal.Api.Data.ApplicationDbContext'.
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 1526
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 1526
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 1526
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 1526
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 17:25:07.699 +08:00 [ERR] Error retrieving courses
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 1526
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at CeceLearningPortal.Api.Services.CourseService.GetAllCoursesAsync(CourseFilterDto filter) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Services\CourseService.cs:line 95
   at CeceLearningPortal.Api.Controllers.CoursesController.GetCourses(CourseFilterDto filter) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Controllers\CoursesController.cs:line 26
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 1526
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 17:25:07.700 +08:00 [INF] Executing ObjectResult, writing value of type '<>f__AnonymousType0`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 17:25:07.700 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 3.7565ms
2025-07-30 17:25:07.701 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-30 17:25:07.701 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses - 500 null application/json; charset=utf-8 4.999ms
2025-07-30 17:25:07.703 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/platform - null null
2025-07-30 17:25:07.703 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:25:07.703 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/platform - 204 null null 0.1813ms
2025-07-30 17:25:07.704 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/platform - application/json null
2025-07-30 17:25:07.704 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:25:07.705 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:25:07.705 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-07-30 17:25:07.705 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-07-30 17:25:07.705 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/platform - 403 0 null 1.6993ms
2025-07-30 17:25:07.707 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/revenue/instructor/b9030b04-2da7-449f-94de-d6d4814a8177 - null null
2025-07-30 17:25:07.707 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:25:07.707 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/revenue/instructor/b9030b04-2da7-449f-94de-d6d4814a8177 - 204 null null 0.1181ms
2025-07-30 17:25:07.708 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/b9030b04-2da7-449f-94de-d6d4814a8177 - application/json null
2025-07-30 17:25:07.708 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:25:07.708 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/revenue/instructor/b9030b04-2da7-449f-94de-d6d4814a8177 - application/json null
2025-07-30 17:25:07.708 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:25:07.709 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:25:07.709 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-30 17:25:07.709 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:25:07.709 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-30 17:25:07.709 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-07-30 17:25:07.709 +08:00 [INF] Route matched with {action = "GetInstructorRevenue", controller = "Revenue"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorRevenue(System.String) on controller CeceLearningPortal.Api.Controllers.RevenueController (CeceLearningPortal.Api).
2025-07-30 17:25:07.710 +08:00 [ERR] Failed executing DbCommand (0ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."IsPublished", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."PublishedAt", c."Status", c."Thumbnail", c."Title", c."UpdatedAt", s."Id", s."AverageQuizScore", s."CertificateIssued", s."CertificateUrl", s."CompletedAt", s."CompletedLessons", s."CourseId", s."EnrolledAt", s."LastAccessedDate", s."ProgressPercentage", s."QuizCount", s."StudentId", s."TotalTimeSpent", s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."IsFlagged", r."Rating", r."Status", r."StudentId"
FROM "Courses" AS c
LEFT JOIN (
    SELECT e."Id", e."AverageQuizScore", e."CertificateIssued", e."CertificateUrl", e."CompletedAt", e."CompletedLessons", e."CourseId", e."EnrolledAt", e."LastAccessedDate", e."ProgressPercentage", e."QuizCount", e."StudentId", e."TotalTimeSpent", a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM "Enrollments" AS e
    INNER JOIN "AspNetUsers" AS a ON e."StudentId" = a."Id"
) AS s ON c."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c."Id" = r."CourseId"
WHERE c."InstructorId" = @__instructorId_0
ORDER BY c."Id", s."Id", s."Id0"
2025-07-30 17:25:07.710 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."Id" = @__p_0
LIMIT 1
2025-07-30 17:25:07.711 +08:00 [ERR] Failed executing DbCommand (0ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."IsPublished", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."PublishedAt", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
FROM "Courses" AS c
WHERE c."InstructorId" = @__instructorId_0
2025-07-30 17:25:07.711 +08:00 [ERR] An exception occurred while iterating over the results of a query for context type 'CeceLearningPortal.Api.Data.ApplicationDbContext'.
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 160
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 160
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 160
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 160
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 17:25:07.712 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 2.4745ms
2025-07-30 17:25:07.711 +08:00 [ERR] An exception occurred while iterating over the results of a query for context type 'CeceLearningPortal.Api.Data.ApplicationDbContext'.
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 160
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 160
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 160
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 160
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 17:25:07.712 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-30 17:25:07.712 +08:00 [ERR] Error calculating instructor revenue for b9030b04-2da7-449f-94de-d6d4814a8177
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 160
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at CeceLearningPortal.Api.Services.RevenueCalculationService.CalculateInstructorRevenueAsync(String instructorId) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Services\RevenueCalculationService.cs:line 25
   at CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue(String instructorId) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Controllers\RevenueController.cs:line 25
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 160
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 17:25:07.712 +08:00 [ERR] An unhandled exception has occurred while executing the request.
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 160
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics(String instructorId) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Controllers\AnalyticsController.cs:line 36
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at CeceLearningPortal.Api.Middleware.TokenBlacklistMiddleware.InvokeAsync(HttpContext context) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Middleware\TokenBlacklistMiddleware.cs:line 51
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 160
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 17:25:07.713 +08:00 [INF] Executing ObjectResult, writing value of type '<>f__AnonymousType0`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 17:25:07.714 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api) in 5.0716ms
2025-07-30 17:25:07.714 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-07-30 17:25:07.714 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/revenue/instructor/b9030b04-2da7-449f-94de-d6d4814a8177 - 500 null application/json; charset=utf-8 6.1628ms
2025-07-30 17:25:07.715 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/b9030b04-2da7-449f-94de-d6d4814a8177 - 500 null text/plain; charset=utf-8 7.3387ms
2025-07-30 17:25:20.478 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/instructor/b9030b04-2da7-449f-94de-d6d4814a8177 - null null
2025-07-30 17:25:20.479 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:25:20.479 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/instructor/b9030b04-2da7-449f-94de-d6d4814a8177 - 204 null null 0.2295ms
2025-07-30 17:25:20.479 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users - null null
2025-07-30 17:25:20.480 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:25:20.480 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users - 204 null null 0.1229ms
2025-07-30 17:25:20.480 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/b9030b04-2da7-449f-94de-d6d4814a8177 - application/json null
2025-07-30 17:25:20.480 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:25:20.480 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users - application/json null
2025-07-30 17:25:20.480 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:25:20.481 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:25:20.481 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:25:20.481 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-07-30 17:25:20.481 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-30 17:25:20.481 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-07-30 17:25:20.481 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-30 17:25:20.481 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users - 403 0 null 1.293ms
2025-07-30 17:25:20.483 +08:00 [ERR] Failed executing DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."IsPublished", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."PublishedAt", c."Status", c."Thumbnail", c."Title", c."UpdatedAt", s."Id", s."AverageQuizScore", s."CertificateIssued", s."CertificateUrl", s."CompletedAt", s."CompletedLessons", s."CourseId", s."EnrolledAt", s."LastAccessedDate", s."ProgressPercentage", s."QuizCount", s."StudentId", s."TotalTimeSpent", s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."IsFlagged", r."Rating", r."Status", r."StudentId"
FROM "Courses" AS c
LEFT JOIN (
    SELECT e."Id", e."AverageQuizScore", e."CertificateIssued", e."CertificateUrl", e."CompletedAt", e."CompletedLessons", e."CourseId", e."EnrolledAt", e."LastAccessedDate", e."ProgressPercentage", e."QuizCount", e."StudentId", e."TotalTimeSpent", a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM "Enrollments" AS e
    INNER JOIN "AspNetUsers" AS a ON e."StudentId" = a."Id"
) AS s ON c."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c."Id" = r."CourseId"
WHERE c."InstructorId" = @__instructorId_0
ORDER BY c."Id", s."Id", s."Id0"
2025-07-30 17:25:20.483 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/courses - null null
2025-07-30 17:25:20.483 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:25:20.483 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/courses - 204 null null 0.1522ms
2025-07-30 17:25:20.483 +08:00 [ERR] An exception occurred while iterating over the results of a query for context type 'CeceLearningPortal.Api.Data.ApplicationDbContext'.
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 160
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 160
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 160
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 160
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 17:25:20.484 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses - application/json null
2025-07-30 17:25:20.484 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:25:20.484 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 2.8794ms
2025-07-30 17:25:20.485 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-30 17:25:20.485 +08:00 [ERR] An unhandled exception has occurred while executing the request.
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 160
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics(String instructorId) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Controllers\AnalyticsController.cs:line 36
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at CeceLearningPortal.Api.Middleware.TokenBlacklistMiddleware.InvokeAsync(HttpContext context) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Middleware\TokenBlacklistMiddleware.cs:line 51
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 160
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 17:25:20.486 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:25:20.487 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-30 17:25:20.487 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-30 17:25:20.488 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/b9030b04-2da7-449f-94de-d6d4814a8177 - 500 null text/plain; charset=utf-8 7.7682ms
2025-07-30 17:25:20.488 +08:00 [ERR] Failed executing DbCommand (0ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."IsPublished", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."PublishedAt", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."IsFlagged", r."Rating", r."Status", r."StudentId", e."Id", e."AverageQuizScore", e."CertificateIssued", e."CertificateUrl", e."CompletedAt", e."CompletedLessons", e."CourseId", e."EnrolledAt", e."LastAccessedDate", e."ProgressPercentage", e."QuizCount", e."StudentId", e."TotalTimeSpent"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."IsPublished", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."PublishedAt", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-30 17:25:20.489 +08:00 [ERR] An exception occurred while iterating over the results of a query for context type 'CeceLearningPortal.Api.Data.ApplicationDbContext'.
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 1526
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 1526
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 1526
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 1526
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 17:25:20.494 +08:00 [ERR] Error retrieving courses
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 1526
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at CeceLearningPortal.Api.Services.CourseService.GetAllCoursesAsync(CourseFilterDto filter) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Services\CourseService.cs:line 95
   at CeceLearningPortal.Api.Controllers.CoursesController.GetCourses(CourseFilterDto filter) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Controllers\CoursesController.cs:line 26
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 1526
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 17:25:20.495 +08:00 [INF] Executing ObjectResult, writing value of type '<>f__AnonymousType0`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 17:25:20.495 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 8.0374ms
2025-07-30 17:25:20.495 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-30 17:25:20.495 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses - 500 null application/json; charset=utf-8 10.9863ms
2025-07-30 17:25:20.496 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/platform - null null
2025-07-30 17:25:20.496 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:25:20.497 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/platform - 204 null null 0.1491ms
2025-07-30 17:25:20.497 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/platform - application/json null
2025-07-30 17:25:20.497 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:25:20.498 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:25:20.498 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-07-30 17:25:20.498 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-07-30 17:25:20.498 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/platform - 403 0 null 1.2638ms
2025-07-30 17:25:20.502 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/b9030b04-2da7-449f-94de-d6d4814a8177 - application/json null
2025-07-30 17:25:20.502 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/revenue/instructor/b9030b04-2da7-449f-94de-d6d4814a8177 - null null
2025-07-30 17:25:20.502 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:25:20.502 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:25:20.502 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/revenue/instructor/b9030b04-2da7-449f-94de-d6d4814a8177 - 204 null null 0.1677ms
2025-07-30 17:25:20.503 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/revenue/instructor/b9030b04-2da7-449f-94de-d6d4814a8177 - application/json null
2025-07-30 17:25:20.503 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:25:20.503 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:25:20.503 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-30 17:25:20.503 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-30 17:25:20.504 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:25:20.504 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-07-30 17:25:20.504 +08:00 [INF] Route matched with {action = "GetInstructorRevenue", controller = "Revenue"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorRevenue(System.String) on controller CeceLearningPortal.Api.Controllers.RevenueController (CeceLearningPortal.Api).
2025-07-30 17:25:20.504 +08:00 [ERR] Failed executing DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."IsPublished", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."PublishedAt", c."Status", c."Thumbnail", c."Title", c."UpdatedAt", s."Id", s."AverageQuizScore", s."CertificateIssued", s."CertificateUrl", s."CompletedAt", s."CompletedLessons", s."CourseId", s."EnrolledAt", s."LastAccessedDate", s."ProgressPercentage", s."QuizCount", s."StudentId", s."TotalTimeSpent", s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."IsFlagged", r."Rating", r."Status", r."StudentId"
FROM "Courses" AS c
LEFT JOIN (
    SELECT e."Id", e."AverageQuizScore", e."CertificateIssued", e."CertificateUrl", e."CompletedAt", e."CompletedLessons", e."CourseId", e."EnrolledAt", e."LastAccessedDate", e."ProgressPercentage", e."QuizCount", e."StudentId", e."TotalTimeSpent", a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM "Enrollments" AS e
    INNER JOIN "AspNetUsers" AS a ON e."StudentId" = a."Id"
) AS s ON c."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c."Id" = r."CourseId"
WHERE c."InstructorId" = @__instructorId_0
ORDER BY c."Id", s."Id", s."Id0"
2025-07-30 17:25:20.504 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."Id" = @__p_0
LIMIT 1
2025-07-30 17:25:20.505 +08:00 [ERR] Failed executing DbCommand (0ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."IsPublished", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."PublishedAt", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
FROM "Courses" AS c
WHERE c."InstructorId" = @__instructorId_0
2025-07-30 17:25:20.505 +08:00 [ERR] An exception occurred while iterating over the results of a query for context type 'CeceLearningPortal.Api.Data.ApplicationDbContext'.
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 160
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 160
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 160
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 160
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 17:25:20.506 +08:00 [ERR] An exception occurred while iterating over the results of a query for context type 'CeceLearningPortal.Api.Data.ApplicationDbContext'.
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 160
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 160
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 160
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 160
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 17:25:20.506 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 2.8213ms
2025-07-30 17:25:20.507 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-30 17:25:20.507 +08:00 [ERR] Error calculating instructor revenue for b9030b04-2da7-449f-94de-d6d4814a8177
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 160
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at CeceLearningPortal.Api.Services.RevenueCalculationService.CalculateInstructorRevenueAsync(String instructorId) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Services\RevenueCalculationService.cs:line 25
   at CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue(String instructorId) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Controllers\RevenueController.cs:line 25
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 160
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 17:25:20.507 +08:00 [ERR] An unhandled exception has occurred while executing the request.
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 160
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics(String instructorId) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Controllers\AnalyticsController.cs:line 36
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at CeceLearningPortal.Api.Middleware.TokenBlacklistMiddleware.InvokeAsync(HttpContext context) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Middleware\TokenBlacklistMiddleware.cs:line 51
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 160
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 17:25:20.508 +08:00 [INF] Executing ObjectResult, writing value of type '<>f__AnonymousType0`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 17:25:20.509 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api) in 5.2612ms
2025-07-30 17:25:20.509 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-07-30 17:25:20.509 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/revenue/instructor/b9030b04-2da7-449f-94de-d6d4814a8177 - 500 null application/json; charset=utf-8 6.5737ms
2025-07-30 17:25:20.510 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/b9030b04-2da7-449f-94de-d6d4814a8177 - 500 null text/plain; charset=utf-8 7.9564ms
2025-07-30 17:25:22.055 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/revenue/instructor/b9030b04-2da7-449f-94de-d6d4814a8177 - application/json null
2025-07-30 17:25:22.055 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:25:22.056 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:25:22.057 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-07-30 17:25:22.057 +08:00 [INF] Route matched with {action = "GetInstructorRevenue", controller = "Revenue"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorRevenue(System.String) on controller CeceLearningPortal.Api.Controllers.RevenueController (CeceLearningPortal.Api).
2025-07-30 17:25:22.058 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."Id" = @__p_0
LIMIT 1
2025-07-30 17:25:22.059 +08:00 [ERR] Failed executing DbCommand (0ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."IsPublished", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."PublishedAt", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
FROM "Courses" AS c
WHERE c."InstructorId" = @__instructorId_0
2025-07-30 17:25:22.059 +08:00 [ERR] An exception occurred while iterating over the results of a query for context type 'CeceLearningPortal.Api.Data.ApplicationDbContext'.
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 160
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 160
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 160
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 160
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 17:25:22.060 +08:00 [ERR] Error calculating instructor revenue for b9030b04-2da7-449f-94de-d6d4814a8177
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 160
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at CeceLearningPortal.Api.Services.RevenueCalculationService.CalculateInstructorRevenueAsync(String instructorId) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Services\RevenueCalculationService.cs:line 25
   at CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue(String instructorId) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Controllers\RevenueController.cs:line 25
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 160
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 17:25:22.062 +08:00 [INF] Executing ObjectResult, writing value of type '<>f__AnonymousType0`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 17:25:22.062 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api) in 4.9352ms
2025-07-30 17:25:22.062 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-07-30 17:25:22.062 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/revenue/instructor/b9030b04-2da7-449f-94de-d6d4814a8177 - 500 null application/json; charset=utf-8 6.7748ms
2025-07-30 17:25:22.064 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/b9030b04-2da7-449f-94de-d6d4814a8177 - application/json null
2025-07-30 17:25:22.064 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:25:22.065 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:25:22.065 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-30 17:25:22.065 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-30 17:25:22.066 +08:00 [ERR] Failed executing DbCommand (0ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."IsPublished", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."PublishedAt", c."Status", c."Thumbnail", c."Title", c."UpdatedAt", s."Id", s."AverageQuizScore", s."CertificateIssued", s."CertificateUrl", s."CompletedAt", s."CompletedLessons", s."CourseId", s."EnrolledAt", s."LastAccessedDate", s."ProgressPercentage", s."QuizCount", s."StudentId", s."TotalTimeSpent", s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."IsFlagged", r."Rating", r."Status", r."StudentId"
FROM "Courses" AS c
LEFT JOIN (
    SELECT e."Id", e."AverageQuizScore", e."CertificateIssued", e."CertificateUrl", e."CompletedAt", e."CompletedLessons", e."CourseId", e."EnrolledAt", e."LastAccessedDate", e."ProgressPercentage", e."QuizCount", e."StudentId", e."TotalTimeSpent", a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM "Enrollments" AS e
    INNER JOIN "AspNetUsers" AS a ON e."StudentId" = a."Id"
) AS s ON c."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c."Id" = r."CourseId"
WHERE c."InstructorId" = @__instructorId_0
ORDER BY c."Id", s."Id", s."Id0"
2025-07-30 17:25:22.067 +08:00 [ERR] An exception occurred while iterating over the results of a query for context type 'CeceLearningPortal.Api.Data.ApplicationDbContext'.
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 160
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 160
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 160
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 160
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 17:25:22.068 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 3.2789ms
2025-07-30 17:25:22.068 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-30 17:25:22.068 +08:00 [ERR] An unhandled exception has occurred while executing the request.
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 160
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics(String instructorId) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Controllers\AnalyticsController.cs:line 36
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at CeceLearningPortal.Api.Middleware.TokenBlacklistMiddleware.InvokeAsync(HttpContext context) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Middleware\TokenBlacklistMiddleware.cs:line 51
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 160
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 17:25:22.071 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/b9030b04-2da7-449f-94de-d6d4814a8177 - 500 null text/plain; charset=utf-8 7.392ms
2025-07-30 17:25:30.474 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/revenue/instructor/b9030b04-2da7-449f-94de-d6d4814a8177 - null null
2025-07-30 17:25:30.475 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:25:30.475 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/revenue/instructor/b9030b04-2da7-449f-94de-d6d4814a8177 - 204 null null 0.4417ms
2025-07-30 17:25:30.475 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users - null null
2025-07-30 17:25:30.475 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:25:30.475 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users - 204 null null 0.2509ms
2025-07-30 17:25:30.476 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/revenue/instructor/b9030b04-2da7-449f-94de-d6d4814a8177 - application/json null
2025-07-30 17:25:30.476 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users - application/json null
2025-07-30 17:25:30.476 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:25:30.476 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:25:30.477 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:25:30.477 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:25:30.478 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-07-30 17:25:30.478 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-07-30 17:25:30.478 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-07-30 17:25:30.478 +08:00 [INF] Route matched with {action = "GetInstructorRevenue", controller = "Revenue"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorRevenue(System.String) on controller CeceLearningPortal.Api.Controllers.RevenueController (CeceLearningPortal.Api).
2025-07-30 17:25:30.478 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users - 403 0 null 1.6901ms
2025-07-30 17:25:30.479 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."Id" = @__p_0
LIMIT 1
2025-07-30 17:25:30.480 +08:00 [ERR] Failed executing DbCommand (0ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."IsPublished", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."PublishedAt", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
FROM "Courses" AS c
WHERE c."InstructorId" = @__instructorId_0
2025-07-30 17:25:30.481 +08:00 [ERR] An exception occurred while iterating over the results of a query for context type 'CeceLearningPortal.Api.Data.ApplicationDbContext'.
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 160
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 160
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 160
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 160
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 17:25:30.482 +08:00 [ERR] Error calculating instructor revenue for b9030b04-2da7-449f-94de-d6d4814a8177
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 160
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at CeceLearningPortal.Api.Services.RevenueCalculationService.CalculateInstructorRevenueAsync(String instructorId) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Services\RevenueCalculationService.cs:line 25
   at CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue(String instructorId) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Controllers\RevenueController.cs:line 25
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 160
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 17:25:30.482 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/courses - null null
2025-07-30 17:25:30.483 +08:00 [INF] Executing ObjectResult, writing value of type '<>f__AnonymousType0`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 17:25:30.483 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:25:30.483 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api) in 5.1313ms
2025-07-30 17:25:30.483 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-07-30 17:25:30.483 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/revenue/instructor/b9030b04-2da7-449f-94de-d6d4814a8177 - 500 null application/json; charset=utf-8 7.0979ms
2025-07-30 17:25:30.483 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/courses - 204 null null 0.991ms
2025-07-30 17:25:30.484 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses - application/json null
2025-07-30 17:25:30.484 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:25:30.485 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/instructor/b9030b04-2da7-449f-94de-d6d4814a8177 - null null
2025-07-30 17:25:30.485 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:25:30.485 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:25:30.485 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-30 17:25:30.485 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/instructor/b9030b04-2da7-449f-94de-d6d4814a8177 - 204 null null 0.2115ms
2025-07-30 17:25:30.485 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-30 17:25:30.486 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/b9030b04-2da7-449f-94de-d6d4814a8177 - application/json null
2025-07-30 17:25:30.486 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:25:30.486 +08:00 [ERR] Failed executing DbCommand (0ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."IsPublished", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."PublishedAt", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."IsFlagged", r."Rating", r."Status", r."StudentId", e."Id", e."AverageQuizScore", e."CertificateIssued", e."CertificateUrl", e."CompletedAt", e."CompletedLessons", e."CourseId", e."EnrolledAt", e."LastAccessedDate", e."ProgressPercentage", e."QuizCount", e."StudentId", e."TotalTimeSpent"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."IsPublished", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."PublishedAt", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-30 17:25:30.487 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:25:30.487 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-30 17:25:30.487 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-30 17:25:30.487 +08:00 [ERR] An exception occurred while iterating over the results of a query for context type 'CeceLearningPortal.Api.Data.ApplicationDbContext'.
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 1526
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 1526
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 1526
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 1526
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 17:25:30.488 +08:00 [ERR] Failed executing DbCommand (0ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."IsPublished", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."PublishedAt", c."Status", c."Thumbnail", c."Title", c."UpdatedAt", s."Id", s."AverageQuizScore", s."CertificateIssued", s."CertificateUrl", s."CompletedAt", s."CompletedLessons", s."CourseId", s."EnrolledAt", s."LastAccessedDate", s."ProgressPercentage", s."QuizCount", s."StudentId", s."TotalTimeSpent", s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."IsFlagged", r."Rating", r."Status", r."StudentId"
FROM "Courses" AS c
LEFT JOIN (
    SELECT e."Id", e."AverageQuizScore", e."CertificateIssued", e."CertificateUrl", e."CompletedAt", e."CompletedLessons", e."CourseId", e."EnrolledAt", e."LastAccessedDate", e."ProgressPercentage", e."QuizCount", e."StudentId", e."TotalTimeSpent", a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM "Enrollments" AS e
    INNER JOIN "AspNetUsers" AS a ON e."StudentId" = a."Id"
) AS s ON c."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c."Id" = r."CourseId"
WHERE c."InstructorId" = @__instructorId_0
ORDER BY c."Id", s."Id", s."Id0"
2025-07-30 17:25:30.488 +08:00 [ERR] Error retrieving courses
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 1526
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at CeceLearningPortal.Api.Services.CourseService.GetAllCoursesAsync(CourseFilterDto filter) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Services\CourseService.cs:line 95
   at CeceLearningPortal.Api.Controllers.CoursesController.GetCourses(CourseFilterDto filter) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Controllers\CoursesController.cs:line 26
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 1526
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 17:25:30.488 +08:00 [ERR] An exception occurred while iterating over the results of a query for context type 'CeceLearningPortal.Api.Data.ApplicationDbContext'.
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 160
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 160
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 160
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 160
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 17:25:30.489 +08:00 [INF] Executing ObjectResult, writing value of type '<>f__AnonymousType0`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 17:25:30.490 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 4.0991ms
2025-07-30 17:25:30.490 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-30 17:25:30.490 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 2.624ms
2025-07-30 17:25:30.490 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses - 500 null application/json; charset=utf-8 5.5787ms
2025-07-30 17:25:30.490 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-30 17:25:30.490 +08:00 [ERR] An unhandled exception has occurred while executing the request.
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 160
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics(String instructorId) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Controllers\AnalyticsController.cs:line 36
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at CeceLearningPortal.Api.Middleware.TokenBlacklistMiddleware.InvokeAsync(HttpContext context) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Middleware\TokenBlacklistMiddleware.cs:line 51
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 160
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 17:25:30.491 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/platform - null null
2025-07-30 17:25:30.492 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:25:30.492 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/platform - 204 null null 0.6833ms
2025-07-30 17:25:30.492 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/platform - application/json null
2025-07-30 17:25:30.492 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:25:30.493 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/b9030b04-2da7-449f-94de-d6d4814a8177 - 500 null text/plain; charset=utf-8 6.4722ms
2025-07-30 17:25:30.493 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:25:30.493 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-07-30 17:25:30.493 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-07-30 17:25:30.493 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/platform - 403 0 null 1.0213ms
2025-07-30 17:25:30.497 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/b9030b04-2da7-449f-94de-d6d4814a8177 - application/json null
2025-07-30 17:25:30.497 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/revenue/instructor/b9030b04-2da7-449f-94de-d6d4814a8177 - application/json null
2025-07-30 17:25:30.497 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:25:30.497 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:25:30.498 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:25:30.498 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:25:30.498 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-30 17:25:30.498 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-07-30 17:25:30.498 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-30 17:25:30.498 +08:00 [INF] Route matched with {action = "GetInstructorRevenue", controller = "Revenue"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorRevenue(System.String) on controller CeceLearningPortal.Api.Controllers.RevenueController (CeceLearningPortal.Api).
2025-07-30 17:25:30.498 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."Id" = @__p_0
LIMIT 1
2025-07-30 17:25:30.499 +08:00 [ERR] Failed executing DbCommand (0ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."IsPublished", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."PublishedAt", c."Status", c."Thumbnail", c."Title", c."UpdatedAt", s."Id", s."AverageQuizScore", s."CertificateIssued", s."CertificateUrl", s."CompletedAt", s."CompletedLessons", s."CourseId", s."EnrolledAt", s."LastAccessedDate", s."ProgressPercentage", s."QuizCount", s."StudentId", s."TotalTimeSpent", s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."IsFlagged", r."Rating", r."Status", r."StudentId"
FROM "Courses" AS c
LEFT JOIN (
    SELECT e."Id", e."AverageQuizScore", e."CertificateIssued", e."CertificateUrl", e."CompletedAt", e."CompletedLessons", e."CourseId", e."EnrolledAt", e."LastAccessedDate", e."ProgressPercentage", e."QuizCount", e."StudentId", e."TotalTimeSpent", a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM "Enrollments" AS e
    INNER JOIN "AspNetUsers" AS a ON e."StudentId" = a."Id"
) AS s ON c."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c."Id" = r."CourseId"
WHERE c."InstructorId" = @__instructorId_0
ORDER BY c."Id", s."Id", s."Id0"
2025-07-30 17:25:30.499 +08:00 [ERR] Failed executing DbCommand (0ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."IsPublished", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."PublishedAt", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
FROM "Courses" AS c
WHERE c."InstructorId" = @__instructorId_0
2025-07-30 17:25:30.499 +08:00 [ERR] An exception occurred while iterating over the results of a query for context type 'CeceLearningPortal.Api.Data.ApplicationDbContext'.
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 160
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 160
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 160
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 160
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 17:25:30.499 +08:00 [ERR] An exception occurred while iterating over the results of a query for context type 'CeceLearningPortal.Api.Data.ApplicationDbContext'.
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 160
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 160
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 160
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 160
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 17:25:30.501 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 2.6967ms
2025-07-30 17:25:30.501 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-30 17:25:30.501 +08:00 [ERR] Error calculating instructor revenue for b9030b04-2da7-449f-94de-d6d4814a8177
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 160
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at CeceLearningPortal.Api.Services.RevenueCalculationService.CalculateInstructorRevenueAsync(String instructorId) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Services\RevenueCalculationService.cs:line 25
   at CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue(String instructorId) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Controllers\RevenueController.cs:line 25
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 160
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 17:25:30.501 +08:00 [ERR] An unhandled exception has occurred while executing the request.
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 160
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics(String instructorId) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Controllers\AnalyticsController.cs:line 36
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at CeceLearningPortal.Api.Middleware.TokenBlacklistMiddleware.InvokeAsync(HttpContext context) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Middleware\TokenBlacklistMiddleware.cs:line 51
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 160
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 17:25:30.503 +08:00 [INF] Executing ObjectResult, writing value of type '<>f__AnonymousType0`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 17:25:30.504 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api) in 5.8567ms
2025-07-30 17:25:30.504 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-07-30 17:25:30.504 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/revenue/instructor/b9030b04-2da7-449f-94de-d6d4814a8177 - 500 null application/json; charset=utf-8 7.1004ms
2025-07-30 17:25:30.505 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/b9030b04-2da7-449f-94de-d6d4814a8177 - 500 null text/plain; charset=utf-8 7.9066ms
2025-07-30 17:26:08.048 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/revenue/instructor/b9030b04-2da7-449f-94de-d6d4814a8177 - null null
2025-07-30 17:26:08.048 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:26:08.048 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/revenue/instructor/b9030b04-2da7-449f-94de-d6d4814a8177 - 204 null null 0.2183ms
2025-07-30 17:26:08.049 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/revenue/instructor/b9030b04-2da7-449f-94de-d6d4814a8177 - application/json null
2025-07-30 17:26:08.049 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:26:08.050 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:26:08.050 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-07-30 17:26:08.050 +08:00 [INF] Route matched with {action = "GetInstructorRevenue", controller = "Revenue"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorRevenue(System.String) on controller CeceLearningPortal.Api.Controllers.RevenueController (CeceLearningPortal.Api).
2025-07-30 17:26:08.052 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."Id" = @__p_0
LIMIT 1
2025-07-30 17:26:08.052 +08:00 [ERR] Failed executing DbCommand (0ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."IsPublished", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."PublishedAt", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
FROM "Courses" AS c
WHERE c."InstructorId" = @__instructorId_0
2025-07-30 17:26:08.053 +08:00 [ERR] An exception occurred while iterating over the results of a query for context type 'CeceLearningPortal.Api.Data.ApplicationDbContext'.
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 160
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 160
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 160
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 160
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 17:26:08.054 +08:00 [ERR] Error calculating instructor revenue for b9030b04-2da7-449f-94de-d6d4814a8177
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 160
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at CeceLearningPortal.Api.Services.RevenueCalculationService.CalculateInstructorRevenueAsync(String instructorId) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Services\RevenueCalculationService.cs:line 25
   at CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue(String instructorId) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Controllers\RevenueController.cs:line 25
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 160
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 17:26:08.055 +08:00 [INF] Executing ObjectResult, writing value of type '<>f__AnonymousType0`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 17:26:08.055 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api) in 4.7427ms
2025-07-30 17:26:08.055 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-07-30 17:26:08.055 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/revenue/instructor/b9030b04-2da7-449f-94de-d6d4814a8177 - 500 null application/json; charset=utf-8 6.4014ms
2025-07-30 17:26:08.057 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/instructor/b9030b04-2da7-449f-94de-d6d4814a8177 - null null
2025-07-30 17:26:08.057 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:26:08.057 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/instructor/b9030b04-2da7-449f-94de-d6d4814a8177 - 204 null null 0.1552ms
2025-07-30 17:26:08.058 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/b9030b04-2da7-449f-94de-d6d4814a8177 - application/json null
2025-07-30 17:26:08.058 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:26:08.059 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:26:08.059 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-30 17:26:08.059 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-30 17:26:08.060 +08:00 [ERR] Failed executing DbCommand (0ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."IsPublished", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."PublishedAt", c."Status", c."Thumbnail", c."Title", c."UpdatedAt", s."Id", s."AverageQuizScore", s."CertificateIssued", s."CertificateUrl", s."CompletedAt", s."CompletedLessons", s."CourseId", s."EnrolledAt", s."LastAccessedDate", s."ProgressPercentage", s."QuizCount", s."StudentId", s."TotalTimeSpent", s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."IsFlagged", r."Rating", r."Status", r."StudentId"
FROM "Courses" AS c
LEFT JOIN (
    SELECT e."Id", e."AverageQuizScore", e."CertificateIssued", e."CertificateUrl", e."CompletedAt", e."CompletedLessons", e."CourseId", e."EnrolledAt", e."LastAccessedDate", e."ProgressPercentage", e."QuizCount", e."StudentId", e."TotalTimeSpent", a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM "Enrollments" AS e
    INNER JOIN "AspNetUsers" AS a ON e."StudentId" = a."Id"
) AS s ON c."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c."Id" = r."CourseId"
WHERE c."InstructorId" = @__instructorId_0
ORDER BY c."Id", s."Id", s."Id0"
2025-07-30 17:26:08.061 +08:00 [ERR] An exception occurred while iterating over the results of a query for context type 'CeceLearningPortal.Api.Data.ApplicationDbContext'.
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 160
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 160
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 160
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 160
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 17:26:08.062 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 2.3405ms
2025-07-30 17:26:08.062 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-30 17:26:08.062 +08:00 [ERR] An unhandled exception has occurred while executing the request.
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 160
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics(String instructorId) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Controllers\AnalyticsController.cs:line 36
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at CeceLearningPortal.Api.Middleware.TokenBlacklistMiddleware.InvokeAsync(HttpContext context) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Middleware\TokenBlacklistMiddleware.cs:line 51
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 160
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 17:26:08.064 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/b9030b04-2da7-449f-94de-d6d4814a8177 - 500 null text/plain; charset=utf-8 6.1339ms
2025-07-30 17:27:54.820 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/platform - null null
2025-07-30 17:27:54.820 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:27:54.820 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/platform - 204 null null 0.2381ms
2025-07-30 17:27:54.821 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/courses - null null
2025-07-30 17:27:54.821 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:27:54.821 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/courses - 204 null null 0.2178ms
2025-07-30 17:27:54.823 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/platform - application/json null
2025-07-30 17:27:54.823 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:27:54.823 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses - application/json null
2025-07-30 17:27:54.823 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:27:54.824 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:27:54.824 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-07-30 17:27:54.824 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-07-30 17:27:54.824 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:27:54.824 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/platform - 403 0 null 1.7795ms
2025-07-30 17:27:54.824 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-30 17:27:54.825 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-30 17:27:54.826 +08:00 [ERR] Failed executing DbCommand (1ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."IsPublished", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."PublishedAt", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."IsFlagged", r."Rating", r."Status", r."StudentId", e."Id", e."AverageQuizScore", e."CertificateIssued", e."CertificateUrl", e."CompletedAt", e."CompletedLessons", e."CourseId", e."EnrolledAt", e."LastAccessedDate", e."ProgressPercentage", e."QuizCount", e."StudentId", e."TotalTimeSpent"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."IsPublished", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."PublishedAt", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-30 17:27:54.826 +08:00 [ERR] An exception occurred while iterating over the results of a query for context type 'CeceLearningPortal.Api.Data.ApplicationDbContext'.
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 1526
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 1526
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 1526
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 1526
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 17:27:54.827 +08:00 [ERR] Error retrieving courses
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 1526
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at CeceLearningPortal.Api.Services.CourseService.GetAllCoursesAsync(CourseFilterDto filter) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Services\CourseService.cs:line 95
   at CeceLearningPortal.Api.Controllers.CoursesController.GetCourses(CourseFilterDto filter) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Controllers\CoursesController.cs:line 26
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 1526
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 17:27:54.829 +08:00 [INF] Executing ObjectResult, writing value of type '<>f__AnonymousType0`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 17:27:54.829 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 3.972ms
2025-07-30 17:27:54.829 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-30 17:27:54.829 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses - 500 null application/json; charset=utf-8 5.4717ms
2025-07-30 17:27:54.830 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/users/b9030b04-2da7-449f-94de-d6d4814a8177/instructor-stats - null null
2025-07-30 17:27:54.830 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:27:54.830 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/users/b9030b04-2da7-449f-94de-d6d4814a8177/instructor-stats - 204 null null 0.1721ms
2025-07-30 17:27:54.831 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/users/b9030b04-2da7-449f-94de-d6d4814a8177/instructor-stats - application/json null
2025-07-30 17:27:54.831 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:27:54.833 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:27:54.833 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/users/b9030b04-2da7-449f-94de-d6d4814a8177/instructor-stats - 404 0 null 1.6241ms
2025-07-30 17:27:54.833 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5295/api/users/b9030b04-2da7-449f-94de-d6d4814a8177/instructor-stats, Response status code: 404
2025-07-30 17:27:54.837 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/courses?instructorId=b9030b04-2da7-449f-94de-d6d4814a8177 - null null
2025-07-30 17:27:54.838 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:27:54.838 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/courses?instructorId=b9030b04-2da7-449f-94de-d6d4814a8177 - 204 null null 0.2357ms
2025-07-30 17:27:54.839 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses?instructorId=b9030b04-2da7-449f-94de-d6d4814a8177 - application/json null
2025-07-30 17:27:54.839 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:27:54.840 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:27:54.840 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-30 17:27:54.840 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-30 17:27:54.842 +08:00 [ERR] Failed executing DbCommand (1ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."IsPublished", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."PublishedAt", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."IsFlagged", r."Rating", r."Status", r."StudentId", e."Id", e."AverageQuizScore", e."CertificateIssued", e."CertificateUrl", e."CompletedAt", e."CompletedLessons", e."CourseId", e."EnrolledAt", e."LastAccessedDate", e."ProgressPercentage", e."QuizCount", e."StudentId", e."TotalTimeSpent"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."IsPublished", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."PublishedAt", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-30 17:27:54.843 +08:00 [ERR] An exception occurred while iterating over the results of a query for context type 'CeceLearningPortal.Api.Data.ApplicationDbContext'.
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 1526
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 1526
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 1526
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 1526
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 17:27:54.843 +08:00 [ERR] Error retrieving courses
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 1526
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at CeceLearningPortal.Api.Services.CourseService.GetAllCoursesAsync(CourseFilterDto filter) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Services\CourseService.cs:line 95
   at CeceLearningPortal.Api.Controllers.CoursesController.GetCourses(CourseFilterDto filter) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Controllers\CoursesController.cs:line 26
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 1526
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 17:27:54.845 +08:00 [INF] Executing ObjectResult, writing value of type '<>f__AnonymousType0`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 17:27:54.845 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 4.231ms
2025-07-30 17:27:54.845 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-30 17:27:54.845 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses?instructorId=b9030b04-2da7-449f-94de-d6d4814a8177 - 500 null application/json; charset=utf-8 6.0386ms
2025-07-30 17:27:56.247 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users - null null
2025-07-30 17:27:56.247 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:27:56.247 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users - 204 null null 0.238ms
2025-07-30 17:27:56.248 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users - application/json null
2025-07-30 17:27:56.248 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:27:56.249 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:27:56.249 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-07-30 17:27:56.249 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-07-30 17:27:56.249 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users - 403 0 null 1.2203ms
2025-07-30 17:27:56.250 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses - application/json null
2025-07-30 17:27:56.250 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:27:56.251 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:27:56.251 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-30 17:27:56.251 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-30 17:27:56.252 +08:00 [ERR] Failed executing DbCommand (1ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."IsPublished", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."PublishedAt", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."IsFlagged", r."Rating", r."Status", r."StudentId", e."Id", e."AverageQuizScore", e."CertificateIssued", e."CertificateUrl", e."CompletedAt", e."CompletedLessons", e."CourseId", e."EnrolledAt", e."LastAccessedDate", e."ProgressPercentage", e."QuizCount", e."StudentId", e."TotalTimeSpent"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."IsPublished", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."PublishedAt", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-30 17:27:56.253 +08:00 [ERR] An exception occurred while iterating over the results of a query for context type 'CeceLearningPortal.Api.Data.ApplicationDbContext'.
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 1526
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 1526
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 1526
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 1526
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 17:27:56.254 +08:00 [ERR] Error retrieving courses
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 1526
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at CeceLearningPortal.Api.Services.CourseService.GetAllCoursesAsync(CourseFilterDto filter) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Services\CourseService.cs:line 95
   at CeceLearningPortal.Api.Controllers.CoursesController.GetCourses(CourseFilterDto filter) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Controllers\CoursesController.cs:line 26
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 1526
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 17:27:56.255 +08:00 [INF] Executing ObjectResult, writing value of type '<>f__AnonymousType0`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 17:27:56.255 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 3.9555ms
2025-07-30 17:27:56.255 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-30 17:27:56.255 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses - 500 null application/json; charset=utf-8 4.9027ms
2025-07-30 17:27:56.256 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/platform - application/json null
2025-07-30 17:27:56.257 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:27:56.257 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:27:56.257 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-07-30 17:27:56.258 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-07-30 17:27:56.258 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/platform - 403 0 null 1.0809ms
2025-07-30 17:27:56.259 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/instructor/b9030b04-2da7-449f-94de-d6d4814a8177 - null null
2025-07-30 17:27:56.259 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:27:56.259 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/instructor/b9030b04-2da7-449f-94de-d6d4814a8177 - 204 null null 0.1017ms
2025-07-30 17:27:56.259 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/revenue/instructor/b9030b04-2da7-449f-94de-d6d4814a8177 - null null
2025-07-30 17:27:56.260 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:27:56.260 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/revenue/instructor/b9030b04-2da7-449f-94de-d6d4814a8177 - 204 null null 0.0794ms
2025-07-30 17:27:56.260 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/b9030b04-2da7-449f-94de-d6d4814a8177 - application/json null
2025-07-30 17:27:56.260 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:27:56.260 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/revenue/instructor/b9030b04-2da7-449f-94de-d6d4814a8177 - application/json null
2025-07-30 17:27:56.260 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:27:56.261 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:27:56.261 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:27:56.261 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-30 17:27:56.261 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-07-30 17:27:56.261 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-30 17:27:56.261 +08:00 [INF] Route matched with {action = "GetInstructorRevenue", controller = "Revenue"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorRevenue(System.String) on controller CeceLearningPortal.Api.Controllers.RevenueController (CeceLearningPortal.Api).
2025-07-30 17:27:56.261 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."Id" = @__p_0
LIMIT 1
2025-07-30 17:27:56.262 +08:00 [ERR] Failed executing DbCommand (0ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."IsPublished", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."PublishedAt", c."Status", c."Thumbnail", c."Title", c."UpdatedAt", s."Id", s."AverageQuizScore", s."CertificateIssued", s."CertificateUrl", s."CompletedAt", s."CompletedLessons", s."CourseId", s."EnrolledAt", s."LastAccessedDate", s."ProgressPercentage", s."QuizCount", s."StudentId", s."TotalTimeSpent", s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."IsFlagged", r."Rating", r."Status", r."StudentId"
FROM "Courses" AS c
LEFT JOIN (
    SELECT e."Id", e."AverageQuizScore", e."CertificateIssued", e."CertificateUrl", e."CompletedAt", e."CompletedLessons", e."CourseId", e."EnrolledAt", e."LastAccessedDate", e."ProgressPercentage", e."QuizCount", e."StudentId", e."TotalTimeSpent", a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM "Enrollments" AS e
    INNER JOIN "AspNetUsers" AS a ON e."StudentId" = a."Id"
) AS s ON c."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c."Id" = r."CourseId"
WHERE c."InstructorId" = @__instructorId_0
ORDER BY c."Id", s."Id", s."Id0"
2025-07-30 17:27:56.262 +08:00 [ERR] Failed executing DbCommand (0ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."IsPublished", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."PublishedAt", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
FROM "Courses" AS c
WHERE c."InstructorId" = @__instructorId_0
2025-07-30 17:27:56.262 +08:00 [ERR] An exception occurred while iterating over the results of a query for context type 'CeceLearningPortal.Api.Data.ApplicationDbContext'.
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 160
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 160
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 160
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 160
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 17:27:56.263 +08:00 [ERR] An exception occurred while iterating over the results of a query for context type 'CeceLearningPortal.Api.Data.ApplicationDbContext'.
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 160
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 160
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 160
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 160
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 17:27:56.263 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 2.0383ms
2025-07-30 17:27:56.263 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-30 17:27:56.263 +08:00 [ERR] Error calculating instructor revenue for b9030b04-2da7-449f-94de-d6d4814a8177
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 160
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at CeceLearningPortal.Api.Services.RevenueCalculationService.CalculateInstructorRevenueAsync(String instructorId) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Services\RevenueCalculationService.cs:line 25
   at CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue(String instructorId) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Controllers\RevenueController.cs:line 25
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 160
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 17:27:56.264 +08:00 [ERR] An unhandled exception has occurred while executing the request.
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 160
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics(String instructorId) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Controllers\AnalyticsController.cs:line 36
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at CeceLearningPortal.Api.Middleware.TokenBlacklistMiddleware.InvokeAsync(HttpContext context) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Middleware\TokenBlacklistMiddleware.cs:line 51
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 160
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 17:27:56.265 +08:00 [INF] Executing ObjectResult, writing value of type '<>f__AnonymousType0`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 17:27:56.265 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api) in 4.4041ms
2025-07-30 17:27:56.265 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-07-30 17:27:56.265 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/revenue/instructor/b9030b04-2da7-449f-94de-d6d4814a8177 - 500 null application/json; charset=utf-8 5.2865ms
2025-07-30 17:27:56.266 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/b9030b04-2da7-449f-94de-d6d4814a8177 - 500 null text/plain; charset=utf-8 6.0479ms
2025-07-30 17:30:49.021 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/instructor/b9030b04-2da7-449f-94de-d6d4814a8177 - null null
2025-07-30 17:30:49.021 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:30:49.022 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/instructor/b9030b04-2da7-449f-94de-d6d4814a8177 - 204 null null 0.3074ms
2025-07-30 17:30:49.022 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/b9030b04-2da7-449f-94de-d6d4814a8177 - application/json null
2025-07-30 17:30:49.023 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:30:49.168 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:30:49.168 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-30 17:30:49.169 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-30 17:30:49.170 +08:00 [ERR] Failed executing DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."IsPublished", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."PublishedAt", c."Status", c."Thumbnail", c."Title", c."UpdatedAt", s."Id", s."AverageQuizScore", s."CertificateIssued", s."CertificateUrl", s."CompletedAt", s."CompletedLessons", s."CourseId", s."EnrolledAt", s."LastAccessedDate", s."ProgressPercentage", s."QuizCount", s."StudentId", s."TotalTimeSpent", s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."IsFlagged", r."Rating", r."Status", r."StudentId"
FROM "Courses" AS c
LEFT JOIN (
    SELECT e."Id", e."AverageQuizScore", e."CertificateIssued", e."CertificateUrl", e."CompletedAt", e."CompletedLessons", e."CourseId", e."EnrolledAt", e."LastAccessedDate", e."ProgressPercentage", e."QuizCount", e."StudentId", e."TotalTimeSpent", a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM "Enrollments" AS e
    INNER JOIN "AspNetUsers" AS a ON e."StudentId" = a."Id"
) AS s ON c."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c."Id" = r."CourseId"
WHERE c."InstructorId" = @__instructorId_0
ORDER BY c."Id", s."Id", s."Id0"
2025-07-30 17:30:49.171 +08:00 [ERR] An exception occurred while iterating over the results of a query for context type 'CeceLearningPortal.Api.Data.ApplicationDbContext'.
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 160
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 160
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 160
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 160
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 17:30:49.172 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 3.202ms
2025-07-30 17:30:49.172 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-30 17:30:49.172 +08:00 [ERR] An unhandled exception has occurred while executing the request.
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 160
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics(String instructorId) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Controllers\AnalyticsController.cs:line 36
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at CeceLearningPortal.Api.Middleware.TokenBlacklistMiddleware.InvokeAsync(HttpContext context) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Middleware\TokenBlacklistMiddleware.cs:line 51
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 160
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 17:30:49.175 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/b9030b04-2da7-449f-94de-d6d4814a8177 - 500 null text/plain; charset=utf-8 152.1677ms
2025-07-30 17:30:50.281 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/revenue/instructor/b9030b04-2da7-449f-94de-d6d4814a8177 - null null
2025-07-30 17:30:50.281 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:30:50.281 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/revenue/instructor/b9030b04-2da7-449f-94de-d6d4814a8177 - 204 null null 0.2346ms
2025-07-30 17:30:50.282 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/revenue/instructor/b9030b04-2da7-449f-94de-d6d4814a8177 - application/json null
2025-07-30 17:30:50.282 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:30:50.283 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:30:50.283 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-07-30 17:30:50.283 +08:00 [INF] Route matched with {action = "GetInstructorRevenue", controller = "Revenue"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorRevenue(System.String) on controller CeceLearningPortal.Api.Controllers.RevenueController (CeceLearningPortal.Api).
2025-07-30 17:30:50.285 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."Id" = @__p_0
LIMIT 1
2025-07-30 17:30:50.285 +08:00 [ERR] Failed executing DbCommand (0ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."IsPublished", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."PublishedAt", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
FROM "Courses" AS c
WHERE c."InstructorId" = @__instructorId_0
2025-07-30 17:30:50.286 +08:00 [ERR] An exception occurred while iterating over the results of a query for context type 'CeceLearningPortal.Api.Data.ApplicationDbContext'.
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 160
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 160
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 160
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 160
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 17:30:50.287 +08:00 [ERR] Error calculating instructor revenue for b9030b04-2da7-449f-94de-d6d4814a8177
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 160
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at CeceLearningPortal.Api.Services.RevenueCalculationService.CalculateInstructorRevenueAsync(String instructorId) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Services\RevenueCalculationService.cs:line 25
   at CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue(String instructorId) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Controllers\RevenueController.cs:line 25
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 160
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 17:30:50.288 +08:00 [INF] Executing ObjectResult, writing value of type '<>f__AnonymousType0`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 17:30:50.288 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api) in 4.5335ms
2025-07-30 17:30:50.288 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-07-30 17:30:50.288 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/revenue/instructor/b9030b04-2da7-449f-94de-d6d4814a8177 - 500 null application/json; charset=utf-8 6.0592ms
2025-07-30 17:30:50.290 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/b9030b04-2da7-449f-94de-d6d4814a8177 - application/json null
2025-07-30 17:30:50.290 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:30:50.291 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:30:50.291 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-30 17:30:50.291 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-30 17:30:50.292 +08:00 [ERR] Failed executing DbCommand (0ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."IsPublished", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."PublishedAt", c."Status", c."Thumbnail", c."Title", c."UpdatedAt", s."Id", s."AverageQuizScore", s."CertificateIssued", s."CertificateUrl", s."CompletedAt", s."CompletedLessons", s."CourseId", s."EnrolledAt", s."LastAccessedDate", s."ProgressPercentage", s."QuizCount", s."StudentId", s."TotalTimeSpent", s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."IsFlagged", r."Rating", r."Status", r."StudentId"
FROM "Courses" AS c
LEFT JOIN (
    SELECT e."Id", e."AverageQuizScore", e."CertificateIssued", e."CertificateUrl", e."CompletedAt", e."CompletedLessons", e."CourseId", e."EnrolledAt", e."LastAccessedDate", e."ProgressPercentage", e."QuizCount", e."StudentId", e."TotalTimeSpent", a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM "Enrollments" AS e
    INNER JOIN "AspNetUsers" AS a ON e."StudentId" = a."Id"
) AS s ON c."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c."Id" = r."CourseId"
WHERE c."InstructorId" = @__instructorId_0
ORDER BY c."Id", s."Id", s."Id0"
2025-07-30 17:30:50.293 +08:00 [ERR] An exception occurred while iterating over the results of a query for context type 'CeceLearningPortal.Api.Data.ApplicationDbContext'.
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 160
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 160
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 160
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 160
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 17:30:50.294 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 2.463ms
2025-07-30 17:30:50.294 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-30 17:30:50.294 +08:00 [ERR] An unhandled exception has occurred while executing the request.
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 160
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics(String instructorId) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Controllers\AnalyticsController.cs:line 36
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at CeceLearningPortal.Api.Middleware.TokenBlacklistMiddleware.InvokeAsync(HttpContext context) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Middleware\TokenBlacklistMiddleware.cs:line 51
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 160
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 17:30:50.318 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/b9030b04-2da7-449f-94de-d6d4814a8177 - 500 null text/plain; charset=utf-8 28.0881ms
2025-07-30 17:30:52.929 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/revenue/instructor/b9030b04-2da7-449f-94de-d6d4814a8177 - application/json null
2025-07-30 17:30:52.929 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:30:52.931 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:30:52.931 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-07-30 17:30:52.931 +08:00 [INF] Route matched with {action = "GetInstructorRevenue", controller = "Revenue"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorRevenue(System.String) on controller CeceLearningPortal.Api.Controllers.RevenueController (CeceLearningPortal.Api).
2025-07-30 17:30:52.931 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."Id" = @__p_0
LIMIT 1
2025-07-30 17:30:52.932 +08:00 [ERR] Failed executing DbCommand (0ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."IsPublished", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."PublishedAt", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
FROM "Courses" AS c
WHERE c."InstructorId" = @__instructorId_0
2025-07-30 17:30:52.933 +08:00 [ERR] An exception occurred while iterating over the results of a query for context type 'CeceLearningPortal.Api.Data.ApplicationDbContext'.
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 160
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 160
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 160
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 160
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 17:30:52.934 +08:00 [ERR] Error calculating instructor revenue for b9030b04-2da7-449f-94de-d6d4814a8177
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 160
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at CeceLearningPortal.Api.Services.RevenueCalculationService.CalculateInstructorRevenueAsync(String instructorId) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Services\RevenueCalculationService.cs:line 25
   at CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue(String instructorId) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Controllers\RevenueController.cs:line 25
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 160
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 17:30:52.935 +08:00 [INF] Executing ObjectResult, writing value of type '<>f__AnonymousType0`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 17:30:52.935 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api) in 4.1316ms
2025-07-30 17:30:52.935 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-07-30 17:30:52.935 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/revenue/instructor/b9030b04-2da7-449f-94de-d6d4814a8177 - 500 null application/json; charset=utf-8 5.6952ms
2025-07-30 17:30:52.937 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/b9030b04-2da7-449f-94de-d6d4814a8177 - application/json null
2025-07-30 17:30:52.937 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:30:52.938 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:30:52.938 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-30 17:30:52.938 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-30 17:30:52.939 +08:00 [ERR] Failed executing DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."IsPublished", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."PublishedAt", c."Status", c."Thumbnail", c."Title", c."UpdatedAt", s."Id", s."AverageQuizScore", s."CertificateIssued", s."CertificateUrl", s."CompletedAt", s."CompletedLessons", s."CourseId", s."EnrolledAt", s."LastAccessedDate", s."ProgressPercentage", s."QuizCount", s."StudentId", s."TotalTimeSpent", s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."IsFlagged", r."Rating", r."Status", r."StudentId"
FROM "Courses" AS c
LEFT JOIN (
    SELECT e."Id", e."AverageQuizScore", e."CertificateIssued", e."CertificateUrl", e."CompletedAt", e."CompletedLessons", e."CourseId", e."EnrolledAt", e."LastAccessedDate", e."ProgressPercentage", e."QuizCount", e."StudentId", e."TotalTimeSpent", a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM "Enrollments" AS e
    INNER JOIN "AspNetUsers" AS a ON e."StudentId" = a."Id"
) AS s ON c."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c."Id" = r."CourseId"
WHERE c."InstructorId" = @__instructorId_0
ORDER BY c."Id", s."Id", s."Id0"
2025-07-30 17:30:52.940 +08:00 [ERR] An exception occurred while iterating over the results of a query for context type 'CeceLearningPortal.Api.Data.ApplicationDbContext'.
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 160
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 160
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 160
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 160
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 17:30:52.941 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 2.816ms
2025-07-30 17:30:52.941 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-30 17:30:52.941 +08:00 [ERR] An unhandled exception has occurred while executing the request.
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 160
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics(String instructorId) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Controllers\AnalyticsController.cs:line 36
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at CeceLearningPortal.Api.Middleware.TokenBlacklistMiddleware.InvokeAsync(HttpContext context) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Middleware\TokenBlacklistMiddleware.cs:line 51
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 160
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 17:30:52.944 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/b9030b04-2da7-449f-94de-d6d4814a8177 - 500 null text/plain; charset=utf-8 6.8138ms
2025-07-30 17:30:59.971 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/instructor/b9030b04-2da7-449f-94de-d6d4814a8177 - null null
2025-07-30 17:30:59.971 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:30:59.971 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/instructor/b9030b04-2da7-449f-94de-d6d4814a8177 - 204 null null 0.2452ms
2025-07-30 17:30:59.973 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/b9030b04-2da7-449f-94de-d6d4814a8177 - application/json null
2025-07-30 17:30:59.973 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:30:59.974 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:30:59.974 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-30 17:30:59.974 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-30 17:30:59.975 +08:00 [ERR] Failed executing DbCommand (0ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."IsPublished", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."PublishedAt", c."Status", c."Thumbnail", c."Title", c."UpdatedAt", s."Id", s."AverageQuizScore", s."CertificateIssued", s."CertificateUrl", s."CompletedAt", s."CompletedLessons", s."CourseId", s."EnrolledAt", s."LastAccessedDate", s."ProgressPercentage", s."QuizCount", s."StudentId", s."TotalTimeSpent", s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."IsFlagged", r."Rating", r."Status", r."StudentId"
FROM "Courses" AS c
LEFT JOIN (
    SELECT e."Id", e."AverageQuizScore", e."CertificateIssued", e."CertificateUrl", e."CompletedAt", e."CompletedLessons", e."CourseId", e."EnrolledAt", e."LastAccessedDate", e."ProgressPercentage", e."QuizCount", e."StudentId", e."TotalTimeSpent", a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM "Enrollments" AS e
    INNER JOIN "AspNetUsers" AS a ON e."StudentId" = a."Id"
) AS s ON c."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c."Id" = r."CourseId"
WHERE c."InstructorId" = @__instructorId_0
ORDER BY c."Id", s."Id", s."Id0"
2025-07-30 17:30:59.976 +08:00 [ERR] An exception occurred while iterating over the results of a query for context type 'CeceLearningPortal.Api.Data.ApplicationDbContext'.
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 160
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 160
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 160
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 160
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 17:30:59.977 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 2.5851ms
2025-07-30 17:30:59.977 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-30 17:30:59.977 +08:00 [ERR] An unhandled exception has occurred while executing the request.
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 160
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics(String instructorId) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Controllers\AnalyticsController.cs:line 36
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at CeceLearningPortal.Api.Middleware.TokenBlacklistMiddleware.InvokeAsync(HttpContext context) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Middleware\TokenBlacklistMiddleware.cs:line 51
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 160
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 17:30:59.979 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/b9030b04-2da7-449f-94de-d6d4814a8177 - 500 null text/plain; charset=utf-8 6.7058ms
2025-07-30 17:32:39.132 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users - null null
2025-07-30 17:32:39.132 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:32:39.132 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users - 204 null null 0.3149ms
2025-07-30 17:32:39.133 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users - application/json null
2025-07-30 17:32:39.133 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:32:39.135 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:32:39.135 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-07-30 17:32:39.135 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-07-30 17:32:39.135 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users - 403 0 null 1.8966ms
2025-07-30 17:32:39.151 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users - application/json null
2025-07-30 17:32:39.152 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:32:39.153 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:32:39.153 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-07-30 17:32:39.153 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-07-30 17:32:39.153 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users - 403 0 null 1.6018ms
2025-07-30 17:32:39.159 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/courses - null null
2025-07-30 17:32:39.160 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:32:39.160 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/courses - 204 null null 0.1855ms
2025-07-30 17:32:39.160 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses - application/json null
2025-07-30 17:32:39.160 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:32:39.161 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:32:39.162 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-30 17:32:39.162 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-30 17:32:39.163 +08:00 [ERR] Failed executing DbCommand (0ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."IsPublished", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."PublishedAt", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."IsFlagged", r."Rating", r."Status", r."StudentId", e."Id", e."AverageQuizScore", e."CertificateIssued", e."CertificateUrl", e."CompletedAt", e."CompletedLessons", e."CourseId", e."EnrolledAt", e."LastAccessedDate", e."ProgressPercentage", e."QuizCount", e."StudentId", e."TotalTimeSpent"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."IsPublished", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."PublishedAt", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-30 17:32:39.163 +08:00 [ERR] An exception occurred while iterating over the results of a query for context type 'CeceLearningPortal.Api.Data.ApplicationDbContext'.
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 1526
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 1526
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 1526
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 1526
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 17:32:39.164 +08:00 [ERR] Error retrieving courses
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 1526
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at CeceLearningPortal.Api.Services.CourseService.GetAllCoursesAsync(CourseFilterDto filter) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Services\CourseService.cs:line 95
   at CeceLearningPortal.Api.Controllers.CoursesController.GetCourses(CourseFilterDto filter) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Controllers\CoursesController.cs:line 26
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 1526
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 17:32:39.165 +08:00 [INF] Executing ObjectResult, writing value of type '<>f__AnonymousType0`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 17:32:39.166 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 3.8794ms
2025-07-30 17:32:39.166 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-30 17:32:39.166 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses - 500 null application/json; charset=utf-8 5.3481ms
2025-07-30 17:32:39.166 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses - application/json null
2025-07-30 17:32:39.167 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:32:39.167 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:32:39.167 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-30 17:32:39.168 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-30 17:32:39.168 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/platform - null null
2025-07-30 17:32:39.168 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:32:39.168 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/platform - 204 null null 0.1278ms
2025-07-30 17:32:39.168 +08:00 [ERR] Failed executing DbCommand (0ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."IsPublished", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."PublishedAt", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."IsFlagged", r."Rating", r."Status", r."StudentId", e."Id", e."AverageQuizScore", e."CertificateIssued", e."CertificateUrl", e."CompletedAt", e."CompletedLessons", e."CourseId", e."EnrolledAt", e."LastAccessedDate", e."ProgressPercentage", e."QuizCount", e."StudentId", e."TotalTimeSpent"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."IsPublished", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."PublishedAt", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-30 17:32:39.169 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/platform - application/json null
2025-07-30 17:32:39.169 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:32:39.169 +08:00 [ERR] An exception occurred while iterating over the results of a query for context type 'CeceLearningPortal.Api.Data.ApplicationDbContext'.
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 1526
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 1526
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 1526
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 1526
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 17:32:39.170 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:32:39.170 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-07-30 17:32:39.170 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-07-30 17:32:39.170 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/platform - 403 0 null 1.0243ms
2025-07-30 17:32:39.170 +08:00 [ERR] Error retrieving courses
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 1526
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at CeceLearningPortal.Api.Services.CourseService.GetAllCoursesAsync(CourseFilterDto filter) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Services\CourseService.cs:line 95
   at CeceLearningPortal.Api.Controllers.CoursesController.GetCourses(CourseFilterDto filter) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Controllers\CoursesController.cs:line 26
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 1526
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 17:32:39.171 +08:00 [INF] Executing ObjectResult, writing value of type '<>f__AnonymousType0`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 17:32:39.171 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 3.6985ms
2025-07-30 17:32:39.171 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-30 17:32:39.171 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses - 500 null application/json; charset=utf-8 4.9083ms
2025-07-30 17:32:39.176 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/platform - application/json null
2025-07-30 17:32:39.176 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:32:39.177 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:32:39.177 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-07-30 17:32:39.177 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-07-30 17:32:39.177 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/platform - 403 0 null 1.2127ms
2025-07-30 17:32:39.180 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/instructor/b9030b04-2da7-449f-94de-d6d4814a8177 - null null
2025-07-30 17:32:39.180 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:32:39.181 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/instructor/b9030b04-2da7-449f-94de-d6d4814a8177 - 204 null null 0.1142ms
2025-07-30 17:32:39.181 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/revenue/instructor/b9030b04-2da7-449f-94de-d6d4814a8177 - null null
2025-07-30 17:32:39.181 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:32:39.181 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/revenue/instructor/b9030b04-2da7-449f-94de-d6d4814a8177 - 204 null null 0.0912ms
2025-07-30 17:32:39.181 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/b9030b04-2da7-449f-94de-d6d4814a8177 - application/json null
2025-07-30 17:32:39.181 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:32:39.181 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/revenue/instructor/b9030b04-2da7-449f-94de-d6d4814a8177 - application/json null
2025-07-30 17:32:39.181 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:32:39.182 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:32:39.182 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-30 17:32:39.182 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-30 17:32:39.183 +08:00 [ERR] Failed executing DbCommand (0ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."IsPublished", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."PublishedAt", c."Status", c."Thumbnail", c."Title", c."UpdatedAt", s."Id", s."AverageQuizScore", s."CertificateIssued", s."CertificateUrl", s."CompletedAt", s."CompletedLessons", s."CourseId", s."EnrolledAt", s."LastAccessedDate", s."ProgressPercentage", s."QuizCount", s."StudentId", s."TotalTimeSpent", s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."IsFlagged", r."Rating", r."Status", r."StudentId"
FROM "Courses" AS c
LEFT JOIN (
    SELECT e."Id", e."AverageQuizScore", e."CertificateIssued", e."CertificateUrl", e."CompletedAt", e."CompletedLessons", e."CourseId", e."EnrolledAt", e."LastAccessedDate", e."ProgressPercentage", e."QuizCount", e."StudentId", e."TotalTimeSpent", a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM "Enrollments" AS e
    INNER JOIN "AspNetUsers" AS a ON e."StudentId" = a."Id"
) AS s ON c."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c."Id" = r."CourseId"
WHERE c."InstructorId" = @__instructorId_0
ORDER BY c."Id", s."Id", s."Id0"
2025-07-30 17:32:39.184 +08:00 [ERR] An exception occurred while iterating over the results of a query for context type 'CeceLearningPortal.Api.Data.ApplicationDbContext'.
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 160
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 160
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 160
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 160
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 17:32:39.185 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 2.4015ms
2025-07-30 17:32:39.185 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-30 17:32:39.185 +08:00 [ERR] An unhandled exception has occurred while executing the request.
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 160
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics(String instructorId) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Controllers\AnalyticsController.cs:line 36
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at CeceLearningPortal.Api.Middleware.TokenBlacklistMiddleware.InvokeAsync(HttpContext context) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Middleware\TokenBlacklistMiddleware.cs:line 51
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 160
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 17:32:39.188 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/b9030b04-2da7-449f-94de-d6d4814a8177 - 500 null text/plain; charset=utf-8 6.3441ms
2025-07-30 17:32:39.228 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:32:39.228 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-07-30 17:32:39.228 +08:00 [INF] Route matched with {action = "GetInstructorRevenue", controller = "Revenue"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorRevenue(System.String) on controller CeceLearningPortal.Api.Controllers.RevenueController (CeceLearningPortal.Api).
2025-07-30 17:32:39.229 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."Id" = @__p_0
LIMIT 1
2025-07-30 17:32:39.230 +08:00 [ERR] Failed executing DbCommand (0ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."IsPublished", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."PublishedAt", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
FROM "Courses" AS c
WHERE c."InstructorId" = @__instructorId_0
2025-07-30 17:32:39.230 +08:00 [ERR] An exception occurred while iterating over the results of a query for context type 'CeceLearningPortal.Api.Data.ApplicationDbContext'.
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 160
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 160
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 160
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 160
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 17:32:39.231 +08:00 [ERR] Error calculating instructor revenue for b9030b04-2da7-449f-94de-d6d4814a8177
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 160
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at CeceLearningPortal.Api.Services.RevenueCalculationService.CalculateInstructorRevenueAsync(String instructorId) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Services\RevenueCalculationService.cs:line 25
   at CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue(String instructorId) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Controllers\RevenueController.cs:line 25
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 160
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 17:32:39.232 +08:00 [INF] Executing ObjectResult, writing value of type '<>f__AnonymousType0`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 17:32:39.233 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api) in 4.4824ms
2025-07-30 17:32:39.233 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-07-30 17:32:39.233 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/revenue/instructor/b9030b04-2da7-449f-94de-d6d4814a8177 - 500 null application/json; charset=utf-8 51.1651ms
2025-07-30 17:32:45.690 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users - null null
2025-07-30 17:32:45.690 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:32:45.690 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users - 204 null null 0.2197ms
2025-07-30 17:32:45.691 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users - application/json null
2025-07-30 17:32:45.691 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:32:45.692 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:32:45.692 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-07-30 17:32:45.693 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-07-30 17:32:45.693 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users - 403 0 null 1.7343ms
2025-07-30 17:32:45.694 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/courses - null null
2025-07-30 17:32:45.694 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:32:45.694 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/courses - 204 null null 0.1468ms
2025-07-30 17:32:45.695 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses - application/json null
2025-07-30 17:32:45.695 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:32:45.696 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:32:45.696 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-30 17:32:45.696 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-30 17:32:45.697 +08:00 [ERR] Failed executing DbCommand (0ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."IsPublished", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."PublishedAt", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."IsFlagged", r."Rating", r."Status", r."StudentId", e."Id", e."AverageQuizScore", e."CertificateIssued", e."CertificateUrl", e."CompletedAt", e."CompletedLessons", e."CourseId", e."EnrolledAt", e."LastAccessedDate", e."ProgressPercentage", e."QuizCount", e."StudentId", e."TotalTimeSpent"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."IsPublished", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."PublishedAt", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-30 17:32:45.697 +08:00 [ERR] An exception occurred while iterating over the results of a query for context type 'CeceLearningPortal.Api.Data.ApplicationDbContext'.
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 1526
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 1526
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 1526
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 1526
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 17:32:45.698 +08:00 [ERR] Error retrieving courses
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 1526
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at CeceLearningPortal.Api.Services.CourseService.GetAllCoursesAsync(CourseFilterDto filter) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Services\CourseService.cs:line 95
   at CeceLearningPortal.Api.Controllers.CoursesController.GetCourses(CourseFilterDto filter) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Controllers\CoursesController.cs:line 26
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 1526
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 17:32:45.700 +08:00 [INF] Executing ObjectResult, writing value of type '<>f__AnonymousType0`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 17:32:45.700 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 3.663ms
2025-07-30 17:32:45.700 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-30 17:32:45.700 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses - 500 null application/json; charset=utf-8 4.8985ms
2025-07-30 17:32:45.701 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/platform - null null
2025-07-30 17:32:45.701 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:32:45.701 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/platform - 204 null null 0.1062ms
2025-07-30 17:32:45.702 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/platform - application/json null
2025-07-30 17:32:45.702 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:32:45.703 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:32:45.703 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-07-30 17:32:45.703 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-07-30 17:32:45.703 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/platform - 403 0 null 1.0406ms
2025-07-30 17:32:45.706 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/instructor/b9030b04-2da7-449f-94de-d6d4814a8177 - null null
2025-07-30 17:32:45.706 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:32:45.706 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/instructor/b9030b04-2da7-449f-94de-d6d4814a8177 - 204 null null 0.104ms
2025-07-30 17:32:45.706 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/revenue/instructor/b9030b04-2da7-449f-94de-d6d4814a8177 - null null
2025-07-30 17:32:45.706 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:32:45.706 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/revenue/instructor/b9030b04-2da7-449f-94de-d6d4814a8177 - 204 null null 0.0728ms
2025-07-30 17:32:45.706 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/b9030b04-2da7-449f-94de-d6d4814a8177 - application/json null
2025-07-30 17:32:45.707 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:32:45.707 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/revenue/instructor/b9030b04-2da7-449f-94de-d6d4814a8177 - application/json null
2025-07-30 17:32:45.707 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:32:45.707 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:32:45.707 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:32:45.708 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-30 17:32:45.708 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-07-30 17:32:45.708 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-30 17:32:45.708 +08:00 [INF] Route matched with {action = "GetInstructorRevenue", controller = "Revenue"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorRevenue(System.String) on controller CeceLearningPortal.Api.Controllers.RevenueController (CeceLearningPortal.Api).
2025-07-30 17:32:45.709 +08:00 [ERR] Failed executing DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."IsPublished", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."PublishedAt", c."Status", c."Thumbnail", c."Title", c."UpdatedAt", s."Id", s."AverageQuizScore", s."CertificateIssued", s."CertificateUrl", s."CompletedAt", s."CompletedLessons", s."CourseId", s."EnrolledAt", s."LastAccessedDate", s."ProgressPercentage", s."QuizCount", s."StudentId", s."TotalTimeSpent", s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."IsFlagged", r."Rating", r."Status", r."StudentId"
FROM "Courses" AS c
LEFT JOIN (
    SELECT e."Id", e."AverageQuizScore", e."CertificateIssued", e."CertificateUrl", e."CompletedAt", e."CompletedLessons", e."CourseId", e."EnrolledAt", e."LastAccessedDate", e."ProgressPercentage", e."QuizCount", e."StudentId", e."TotalTimeSpent", a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM "Enrollments" AS e
    INNER JOIN "AspNetUsers" AS a ON e."StudentId" = a."Id"
) AS s ON c."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c."Id" = r."CourseId"
WHERE c."InstructorId" = @__instructorId_0
ORDER BY c."Id", s."Id", s."Id0"
2025-07-30 17:32:45.709 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."Id" = @__p_0
LIMIT 1
2025-07-30 17:32:45.709 +08:00 [ERR] An exception occurred while iterating over the results of a query for context type 'CeceLearningPortal.Api.Data.ApplicationDbContext'.
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 160
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 160
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 160
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 160
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 17:32:45.710 +08:00 [ERR] Failed executing DbCommand (0ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."IsPublished", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."PublishedAt", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
FROM "Courses" AS c
WHERE c."InstructorId" = @__instructorId_0
2025-07-30 17:32:45.710 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 2.7051ms
2025-07-30 17:32:45.710 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-30 17:32:45.711 +08:00 [ERR] An exception occurred while iterating over the results of a query for context type 'CeceLearningPortal.Api.Data.ApplicationDbContext'.
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 160
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 160
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 160
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 160
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 17:32:45.711 +08:00 [ERR] An unhandled exception has occurred while executing the request.
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 160
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics(String instructorId) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Controllers\AnalyticsController.cs:line 36
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at CeceLearningPortal.Api.Middleware.TokenBlacklistMiddleware.InvokeAsync(HttpContext context) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Middleware\TokenBlacklistMiddleware.cs:line 51
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 160
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 17:32:45.712 +08:00 [ERR] Error calculating instructor revenue for b9030b04-2da7-449f-94de-d6d4814a8177
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 160
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at CeceLearningPortal.Api.Services.RevenueCalculationService.CalculateInstructorRevenueAsync(String instructorId) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Services\RevenueCalculationService.cs:line 25
   at CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue(String instructorId) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Controllers\RevenueController.cs:line 25
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 160
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 17:32:45.714 +08:00 [INF] Executing ObjectResult, writing value of type '<>f__AnonymousType0`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 17:32:45.714 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api) in 6.2798ms
2025-07-30 17:32:45.714 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-07-30 17:32:45.714 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/revenue/instructor/b9030b04-2da7-449f-94de-d6d4814a8177 - 500 null application/json; charset=utf-8 7.4949ms
2025-07-30 17:32:45.714 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/b9030b04-2da7-449f-94de-d6d4814a8177 - 500 null text/plain; charset=utf-8 7.9075ms
2025-07-30 17:33:06.605 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users - null null
2025-07-30 17:33:06.605 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:33:06.605 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users - 204 null null 0.1881ms
2025-07-30 17:33:06.606 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users - application/json null
2025-07-30 17:33:06.606 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:33:06.607 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:33:06.607 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-07-30 17:33:06.607 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-07-30 17:33:06.607 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users - 403 0 null 1.4736ms
2025-07-30 17:33:06.609 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/courses - null null
2025-07-30 17:33:06.609 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:33:06.609 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/courses - 204 null null 0.1218ms
2025-07-30 17:33:06.610 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses - application/json null
2025-07-30 17:33:06.610 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:33:06.611 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:33:06.611 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-30 17:33:06.611 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-30 17:33:06.612 +08:00 [ERR] Failed executing DbCommand (0ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."IsPublished", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."PublishedAt", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."IsFlagged", r."Rating", r."Status", r."StudentId", e."Id", e."AverageQuizScore", e."CertificateIssued", e."CertificateUrl", e."CompletedAt", e."CompletedLessons", e."CourseId", e."EnrolledAt", e."LastAccessedDate", e."ProgressPercentage", e."QuizCount", e."StudentId", e."TotalTimeSpent"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."IsPublished", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."PublishedAt", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-30 17:33:06.612 +08:00 [ERR] An exception occurred while iterating over the results of a query for context type 'CeceLearningPortal.Api.Data.ApplicationDbContext'.
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 1526
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 1526
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 1526
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 1526
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 17:33:06.613 +08:00 [ERR] Error retrieving courses
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 1526
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at CeceLearningPortal.Api.Services.CourseService.GetAllCoursesAsync(CourseFilterDto filter) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Services\CourseService.cs:line 95
   at CeceLearningPortal.Api.Controllers.CoursesController.GetCourses(CourseFilterDto filter) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Controllers\CoursesController.cs:line 26
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 1526
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 17:33:06.614 +08:00 [INF] Executing ObjectResult, writing value of type '<>f__AnonymousType0`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 17:33:06.614 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 3.5721ms
2025-07-30 17:33:06.615 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-30 17:33:06.615 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses - 500 null application/json; charset=utf-8 4.8608ms
2025-07-30 17:33:06.616 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/platform - null null
2025-07-30 17:33:06.616 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:33:06.616 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/platform - 204 null null 0.1041ms
2025-07-30 17:33:06.617 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/platform - application/json null
2025-07-30 17:33:06.617 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:33:06.618 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:33:06.618 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-07-30 17:33:06.618 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-07-30 17:33:06.618 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/platform - 403 0 null 0.9847ms
2025-07-30 17:33:06.619 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/instructor/b9030b04-2da7-449f-94de-d6d4814a8177 - null null
2025-07-30 17:33:06.619 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:33:06.619 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/instructor/b9030b04-2da7-449f-94de-d6d4814a8177 - 204 null null 0.1039ms
2025-07-30 17:33:06.620 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/revenue/instructor/b9030b04-2da7-449f-94de-d6d4814a8177 - null null
2025-07-30 17:33:06.620 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:33:06.620 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/revenue/instructor/b9030b04-2da7-449f-94de-d6d4814a8177 - 204 null null 0.0825ms
2025-07-30 17:33:06.620 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/b9030b04-2da7-449f-94de-d6d4814a8177 - application/json null
2025-07-30 17:33:06.620 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:33:06.621 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/revenue/instructor/b9030b04-2da7-449f-94de-d6d4814a8177 - application/json null
2025-07-30 17:33:06.621 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:33:06.621 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:33:06.621 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-30 17:33:06.621 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:33:06.621 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-30 17:33:06.621 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-07-30 17:33:06.621 +08:00 [INF] Route matched with {action = "GetInstructorRevenue", controller = "Revenue"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorRevenue(System.String) on controller CeceLearningPortal.Api.Controllers.RevenueController (CeceLearningPortal.Api).
2025-07-30 17:33:06.622 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."Id" = @__p_0
LIMIT 1
2025-07-30 17:33:06.622 +08:00 [ERR] Failed executing DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."IsPublished", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."PublishedAt", c."Status", c."Thumbnail", c."Title", c."UpdatedAt", s."Id", s."AverageQuizScore", s."CertificateIssued", s."CertificateUrl", s."CompletedAt", s."CompletedLessons", s."CourseId", s."EnrolledAt", s."LastAccessedDate", s."ProgressPercentage", s."QuizCount", s."StudentId", s."TotalTimeSpent", s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."IsFlagged", r."Rating", r."Status", r."StudentId"
FROM "Courses" AS c
LEFT JOIN (
    SELECT e."Id", e."AverageQuizScore", e."CertificateIssued", e."CertificateUrl", e."CompletedAt", e."CompletedLessons", e."CourseId", e."EnrolledAt", e."LastAccessedDate", e."ProgressPercentage", e."QuizCount", e."StudentId", e."TotalTimeSpent", a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM "Enrollments" AS e
    INNER JOIN "AspNetUsers" AS a ON e."StudentId" = a."Id"
) AS s ON c."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c."Id" = r."CourseId"
WHERE c."InstructorId" = @__instructorId_0
ORDER BY c."Id", s."Id", s."Id0"
2025-07-30 17:33:06.622 +08:00 [ERR] Failed executing DbCommand (0ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."IsPublished", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."PublishedAt", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
FROM "Courses" AS c
WHERE c."InstructorId" = @__instructorId_0
2025-07-30 17:33:06.623 +08:00 [ERR] An exception occurred while iterating over the results of a query for context type 'CeceLearningPortal.Api.Data.ApplicationDbContext'.
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 160
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 160
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 160
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 160
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 17:33:06.623 +08:00 [ERR] An exception occurred while iterating over the results of a query for context type 'CeceLearningPortal.Api.Data.ApplicationDbContext'.
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 160
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 160
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 160
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 160
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 17:33:06.624 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 2.6385ms
2025-07-30 17:33:06.624 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-30 17:33:06.624 +08:00 [ERR] Error calculating instructor revenue for b9030b04-2da7-449f-94de-d6d4814a8177
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 160
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at CeceLearningPortal.Api.Services.RevenueCalculationService.CalculateInstructorRevenueAsync(String instructorId) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Services\RevenueCalculationService.cs:line 25
   at CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue(String instructorId) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Controllers\RevenueController.cs:line 25
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 160
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 17:33:06.624 +08:00 [ERR] An unhandled exception has occurred while executing the request.
Npgsql.PostgresException (0x80004005): 42703: column c.IsPublished does not exist

POSITION: 160
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics(String instructorId) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Controllers\AnalyticsController.cs:line 36
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at CeceLearningPortal.Api.Middleware.TokenBlacklistMiddleware.InvokeAsync(HttpContext context) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Middleware\TokenBlacklistMiddleware.cs:line 51
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.IsPublished does not exist
    Position: 160
    File: parse_relation.c
    Line: 3721
    Routine: errorMissingColumn
2025-07-30 17:33:06.625 +08:00 [INF] Executing ObjectResult, writing value of type '<>f__AnonymousType0`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 17:33:06.626 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api) in 5.1346ms
2025-07-30 17:33:06.627 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-07-30 17:33:06.627 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/revenue/instructor/b9030b04-2da7-449f-94de-d6d4814a8177 - 500 null application/json; charset=utf-8 6.3577ms
2025-07-30 17:33:06.627 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/b9030b04-2da7-449f-94de-d6d4814a8177 - 500 null text/plain; charset=utf-8 7.0389ms
2025-07-30 17:36:40.523 +08:00 [FTL] Application start-up failed
Microsoft.Extensions.Hosting.HostAbortedException: The host was aborted.
   at Microsoft.Extensions.Hosting.HostFactoryResolver.HostingListener.ThrowHostAborted()
   at Microsoft.Extensions.Hosting.HostFactoryResolver.HostingListener.OnNext(KeyValuePair`2 value)
   at System.Diagnostics.DiagnosticListener.Write(String name, Object value)
   at Microsoft.Extensions.Hosting.HostBuilder.ResolveHost(IServiceProvider serviceProvider, DiagnosticListener diagnosticListener)
   at Microsoft.Extensions.Hosting.HostApplicationBuilder.Build()
   at Microsoft.AspNetCore.Builder.WebApplicationBuilder.Build()
   at Program.<Main>$(String[] args) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Program.cs:line 186
2025-07-30 17:36:49.756 +08:00 [FTL] Application start-up failed
Microsoft.Extensions.Hosting.HostAbortedException: The host was aborted.
   at Microsoft.Extensions.Hosting.HostFactoryResolver.HostingListener.ThrowHostAborted()
   at Microsoft.Extensions.Hosting.HostFactoryResolver.HostingListener.OnNext(KeyValuePair`2 value)
   at System.Diagnostics.DiagnosticListener.Write(String name, Object value)
   at Microsoft.Extensions.Hosting.HostBuilder.ResolveHost(IServiceProvider serviceProvider, DiagnosticListener diagnosticListener)
   at Microsoft.Extensions.Hosting.HostApplicationBuilder.Build()
   at Microsoft.AspNetCore.Builder.WebApplicationBuilder.Build()
   at Program.<Main>$(String[] args) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Program.cs:line 186
2025-07-30 17:37:02.188 +08:00 [FTL] Application start-up failed
Microsoft.Extensions.Hosting.HostAbortedException: The host was aborted.
   at Microsoft.Extensions.Hosting.HostFactoryResolver.HostingListener.ThrowHostAborted()
   at Microsoft.Extensions.Hosting.HostFactoryResolver.HostingListener.OnNext(KeyValuePair`2 value)
   at System.Diagnostics.DiagnosticListener.Write(String name, Object value)
   at Microsoft.Extensions.Hosting.HostBuilder.ResolveHost(IServiceProvider serviceProvider, DiagnosticListener diagnosticListener)
   at Microsoft.Extensions.Hosting.HostApplicationBuilder.Build()
   at Microsoft.AspNetCore.Builder.WebApplicationBuilder.Build()
   at Program.<Main>$(String[] args) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Program.cs:line 186
2025-07-30 17:37:11.963 +08:00 [INF] Checking database connection...
2025-07-30 17:37:12.653 +08:00 [INF] Database connection successful.
2025-07-30 17:37:12.653 +08:00 [INF] Attempting to apply migrations...
2025-07-30 17:37:12.854 +08:00 [INF] Executed DbCommand (12ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-07-30 17:37:13.212 +08:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE IF NOT EXISTS "__EFMigrationsHistory" (
    "MigrationId" character varying(150) NOT NULL,
    "ProductVersion" character varying(32) NOT NULL,
    CONSTRAINT "PK___EFMigrationsHistory" PRIMARY KEY ("MigrationId")
);
2025-07-30 17:37:13.222 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
LOCK TABLE "__EFMigrationsHistory" IN ACCESS EXCLUSIVE MODE
2025-07-30 17:37:13.223 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-07-30 17:37:13.226 +08:00 [INF] No migrations were applied. The database is already up to date.
2025-07-30 17:37:13.232 +08:00 [INF] Migrations applied successfully.
2025-07-30 17:37:13.232 +08:00 [INF] Starting data seeding...
2025-07-30 17:37:13.254 +08:00 [INF] User profile is available. Using 'C:\Users\User\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-07-30 17:37:13.383 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Courses" AS c)
2025-07-30 17:37:13.385 +08:00 [INF] Database already contains data. Skipping seed.
2025-07-30 17:37:13.385 +08:00 [INF] Data seeding completed.
2025-07-30 17:37:13.433 +08:00 [INF] Now listening on: http://localhost:5295
2025-07-30 17:37:13.433 +08:00 [INF] Application started. Press Ctrl+C to shut down.
2025-07-30 17:37:13.433 +08:00 [INF] Hosting environment: Development
2025-07-30 17:37:13.433 +08:00 [INF] Content root path: D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api
2025-07-30 17:39:07.798 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/auth/logout - null null
2025-07-30 17:39:07.827 +08:00 [WRN] Failed to determine the https port for redirect.
2025-07-30 17:39:07.827 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:39:07.831 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/auth/logout - 204 null null 33.7802ms
2025-07-30 17:39:07.834 +08:00 [INF] Request starting HTTP/1.1 POST http://localhost:5295/api/auth/logout - application/json 0
2025-07-30 17:39:07.837 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:39:07.938 +08:00 [INF] Executed DbCommand (6ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:39:07.942 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AuthController.Logout (CeceLearningPortal.Api)'
2025-07-30 17:39:07.948 +08:00 [INF] Route matched with {action = "Logout", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Logout() on controller CeceLearningPortal.Api.Controllers.AuthController (CeceLearningPortal.Api).
2025-07-30 17:39:08.051 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a0."Id", a0."AccessFailedCount", a0."Avatar", a0."ConcurrencyStamp", a0."CreatedAt", a0."Email", a0."EmailConfirmed", a0."FullName", a0."LastLoginAt", a0."LockoutEnabled", a0."LockoutEnd", a0."NormalizedEmail", a0."NormalizedUserName", a0."NotificationPreferences", a0."PasswordHash", a0."PhoneNumber", a0."PhoneNumberConfirmed", a0."RefreshToken", a0."RefreshTokenExpiryTime", a0."Role", a0."SecurityStamp", a0."Status", a0."TwoFactorEnabled", a0."UserName", r."Id", r."CreatedAt", r."CreatedByIp", r."ExpiresAt", r."ReplacedByToken", r."RevokedAt", r."RevokedByIp", r."Token", r."UserId"
FROM (
    SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM "AspNetUsers" AS a
    WHERE a."Id" = @__userId_0
    LIMIT 1
) AS a0
LEFT JOIN "RefreshTokens" AS r ON a0."Id" = r."UserId"
ORDER BY a0."Id"
2025-07-30 17:39:08.195 +08:00 [INF] Executed DbCommand (12ms) [Parameters=[@p1='?' (DbType = Int32), @p0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
UPDATE "RefreshTokens" SET "RevokedAt" = @p0
WHERE "Id" = @p1;
2025-07-30 17:39:08.204 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType0`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 17:39:08.211 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AuthController.Logout (CeceLearningPortal.Api) in 261.0655ms
2025-07-30 17:39:08.212 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AuthController.Logout (CeceLearningPortal.Api)'
2025-07-30 17:39:08.214 +08:00 [INF] Request finished HTTP/1.1 POST http://localhost:5295/api/auth/logout - 200 null application/json; charset=utf-8 380.2463ms
2025-07-30 17:39:08.229 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users - null null
2025-07-30 17:39:08.230 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:39:08.231 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users - 204 null null 1.2459ms
2025-07-30 17:39:08.232 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users - application/json null
2025-07-30 17:39:08.237 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:39:08.240 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-07-30 17:39:08.242 +08:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-07-30 17:39:08.242 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users - 401 0 null 10.1978ms
2025-07-30 17:39:08.245 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/courses - null null
2025-07-30 17:39:08.246 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:39:08.246 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/courses - 204 null null 0.4592ms
2025-07-30 17:39:08.247 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses - application/json null
2025-07-30 17:39:08.247 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:39:08.248 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-30 17:39:08.257 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-30 17:39:08.295 +08:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2025-07-30 17:39:08.331 +08:00 [INF] Executed DbCommand (6ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0."Category", c0."CourseType", c0."CreatedAt", c0."Currency", c0."Description", c0."Discount", c0."DripContent", c0."DripScheduleJson", c0."Duration", c0."EnrollmentLimit", c0."EnrollmentType", c0."Features", c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0."InstructorId", c0."IsBestseller", c0."IsPublished", c0."Language", c0."Level", c0."OriginalPrice", c0."PaymentPlanDetailsJson", c0."PreviewUrl", c0."Price", c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0."Status", c0."SubscriptionPeriod", c0."Thumbnail", c0."ThumbnailUrl", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."IsFlagged", r."Rating", r."Status", r."StudentId", e."Id", e."AverageQuizScore", e."CertificateIssued", e."CertificateUrl", e."CompletedAt", e."CompletedLessons", e."CourseId", e."EnrolledAt", e."LastAccessedDate", e."ProgressPercentage", e."QuizCount", e."StudentId", e."TotalTimeSpent"
FROM (
    SELECT c."Id", c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c."Category", c."CourseType", c."CreatedAt", c."Currency", c."Description", c."Discount", c."DripContent", c."DripScheduleJson", c."Duration", c."EnrollmentLimit", c."EnrollmentType", c."Features", c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c."InstructorId", c."IsBestseller", c."IsPublished", c."Language", c."Level", c."OriginalPrice", c."PaymentPlanDetailsJson", c."PreviewUrl", c."Price", c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c."Status", c."SubscriptionPeriod", c."Thumbnail", c."ThumbnailUrl", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-30 17:39:08.436 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-30 17:39:08.455 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 197.8788ms
2025-07-30 17:39:08.456 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-30 17:39:08.456 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses - 200 null application/json; charset=utf-8 209.0003ms
2025-07-30 17:39:08.458 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/platform - null null
2025-07-30 17:39:08.459 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:39:08.459 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/platform - 204 null null 0.3881ms
2025-07-30 17:39:08.460 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/platform - application/json null
2025-07-30 17:39:08.460 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:39:08.462 +08:00 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-07-30 17:39:08.462 +08:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-07-30 17:39:08.462 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/platform - 401 0 null 2.0975ms
2025-07-30 17:39:11.266 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/auth/login - null null
2025-07-30 17:39:11.266 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:39:11.266 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/auth/login - 204 null null 0.5466ms
2025-07-30 17:39:11.267 +08:00 [INF] Request starting HTTP/1.1 POST http://localhost:5295/api/auth/login - application/json 61
2025-07-30 17:39:11.267 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:39:11.268 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AuthController.Login (CeceLearningPortal.Api)'
2025-07-30 17:39:11.271 +08:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(CeceLearningPortal.Api.DTOs.LoginDto) on controller CeceLearningPortal.Api.Controllers.AuthController (CeceLearningPortal.Api).
2025-07-30 17:39:11.289 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__normalizedEmail_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."NormalizedEmail" = @__normalizedEmail_0
LIMIT 2
2025-07-30 17:39:11.366 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@p1='?', @p2='?', @p0='?' (DbType = DateTime), @p3='?' (DbType = DateTime), @p4='?', @p5='?' (DbType = DateTime), @p6='?', @p7='?' (DbType = DateTime), @p8='?', @p9='?', @p10='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE "AspNetUsers" SET "LastLoginAt" = @p0
WHERE "Id" = @p1 AND "ConcurrencyStamp" = @p2;
INSERT INTO "RefreshTokens" ("CreatedAt", "CreatedByIp", "ExpiresAt", "ReplacedByToken", "RevokedAt", "RevokedByIp", "Token", "UserId")
VALUES (@p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10)
RETURNING "Id";
2025-07-30 17:39:11.374 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.AuthResponseDto'.
2025-07-30 17:39:11.375 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AuthController.Login (CeceLearningPortal.Api) in 104.1059ms
2025-07-30 17:39:11.375 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AuthController.Login (CeceLearningPortal.Api)'
2025-07-30 17:39:11.375 +08:00 [INF] Request finished HTTP/1.1 POST http://localhost:5295/api/auth/login - 200 null application/json; charset=utf-8 107.9748ms
2025-07-30 17:39:11.397 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/platform - null null
2025-07-30 17:39:11.397 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:39:11.397 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/platform - 204 null null 0.5715ms
2025-07-30 17:39:11.398 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/courses - null null
2025-07-30 17:39:11.398 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:39:11.398 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/courses - 204 null null 0.3038ms
2025-07-30 17:39:11.398 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/platform - application/json null
2025-07-30 17:39:11.398 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:39:11.399 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses - application/json null
2025-07-30 17:39:11.399 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:39:11.403 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:39:11.404 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-30 17:39:11.404 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-30 17:39:11.408 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0."Category", c0."CourseType", c0."CreatedAt", c0."Currency", c0."Description", c0."Discount", c0."DripContent", c0."DripScheduleJson", c0."Duration", c0."EnrollmentLimit", c0."EnrollmentType", c0."Features", c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0."InstructorId", c0."IsBestseller", c0."IsPublished", c0."Language", c0."Level", c0."OriginalPrice", c0."PaymentPlanDetailsJson", c0."PreviewUrl", c0."Price", c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0."Status", c0."SubscriptionPeriod", c0."Thumbnail", c0."ThumbnailUrl", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."IsFlagged", r."Rating", r."Status", r."StudentId", e."Id", e."AverageQuizScore", e."CertificateIssued", e."CertificateUrl", e."CompletedAt", e."CompletedLessons", e."CourseId", e."EnrolledAt", e."LastAccessedDate", e."ProgressPercentage", e."QuizCount", e."StudentId", e."TotalTimeSpent"
FROM (
    SELECT c."Id", c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c."Category", c."CourseType", c."CreatedAt", c."Currency", c."Description", c."Discount", c."DripContent", c."DripScheduleJson", c."Duration", c."EnrollmentLimit", c."EnrollmentType", c."Features", c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c."InstructorId", c."IsBestseller", c."IsPublished", c."Language", c."Level", c."OriginalPrice", c."PaymentPlanDetailsJson", c."PreviewUrl", c."Price", c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c."Status", c."SubscriptionPeriod", c."Thumbnail", c."ThumbnailUrl", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-30 17:39:11.413 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-30 17:39:11.414 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 9.9136ms
2025-07-30 17:39:11.414 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-30 17:39:11.414 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses - 200 null application/json; charset=utf-8 15.2245ms
2025-07-30 17:39:11.417 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/users/f9f0e64e-3771-4aa9-8470-21e709677e44/instructor-stats - null null
2025-07-30 17:39:11.417 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:39:11.417 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/users/f9f0e64e-3771-4aa9-8470-21e709677e44/instructor-stats - 204 null null 0.3524ms
2025-07-30 17:39:11.418 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/users/f9f0e64e-3771-4aa9-8470-21e709677e44/instructor-stats - application/json null
2025-07-30 17:39:11.419 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:39:11.421 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:39:11.421 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/users/f9f0e64e-3771-4aa9-8470-21e709677e44/instructor-stats - 404 0 null 3.4565ms
2025-07-30 17:39:11.422 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5295/api/users/f9f0e64e-3771-4aa9-8470-21e709677e44/instructor-stats, Response status code: 404
2025-07-30 17:39:11.429 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - null null
2025-07-30 17:39:11.429 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:39:11.429 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - 204 null null 0.3601ms
2025-07-30 17:39:11.430 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - application/json null
2025-07-30 17:39:11.430 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:39:11.433 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:39:11.434 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-30 17:39:11.434 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-30 17:39:11.438 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0."Category", c0."CourseType", c0."CreatedAt", c0."Currency", c0."Description", c0."Discount", c0."DripContent", c0."DripScheduleJson", c0."Duration", c0."EnrollmentLimit", c0."EnrollmentType", c0."Features", c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0."InstructorId", c0."IsBestseller", c0."IsPublished", c0."Language", c0."Level", c0."OriginalPrice", c0."PaymentPlanDetailsJson", c0."PreviewUrl", c0."Price", c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0."Status", c0."SubscriptionPeriod", c0."Thumbnail", c0."ThumbnailUrl", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."IsFlagged", r."Rating", r."Status", r."StudentId", e."Id", e."AverageQuizScore", e."CertificateIssued", e."CertificateUrl", e."CompletedAt", e."CompletedLessons", e."CourseId", e."EnrolledAt", e."LastAccessedDate", e."ProgressPercentage", e."QuizCount", e."StudentId", e."TotalTimeSpent"
FROM (
    SELECT c."Id", c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c."Category", c."CourseType", c."CreatedAt", c."Currency", c."Description", c."Discount", c."DripContent", c."DripScheduleJson", c."Duration", c."EnrollmentLimit", c."EnrollmentType", c."Features", c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c."InstructorId", c."IsBestseller", c."IsPublished", c."Language", c."Level", c."OriginalPrice", c."PaymentPlanDetailsJson", c."PreviewUrl", c."Price", c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c."Status", c."SubscriptionPeriod", c."Thumbnail", c."ThumbnailUrl", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-30 17:39:11.441 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-30 17:39:11.442 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 7.7686ms
2025-07-30 17:39:11.442 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-30 17:39:11.442 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - 200 null application/json; charset=utf-8 12.2036ms
2025-07-30 17:39:11.451 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:39:11.452 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-07-30 17:39:11.453 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-07-30 17:39:11.453 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/platform - 403 0 null 55.1624ms
2025-07-30 17:39:12.810 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users - null null
2025-07-30 17:39:12.810 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:39:12.810 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users - 204 null null 0.6574ms
2025-07-30 17:39:12.811 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users - application/json null
2025-07-30 17:39:12.811 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:39:12.813 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:39:12.813 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-07-30 17:39:12.813 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-07-30 17:39:12.813 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users - 403 0 null 2.3808ms
2025-07-30 17:39:12.816 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses - application/json null
2025-07-30 17:39:12.816 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:39:12.817 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:39:12.818 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-30 17:39:12.818 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-30 17:39:12.820 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0."Category", c0."CourseType", c0."CreatedAt", c0."Currency", c0."Description", c0."Discount", c0."DripContent", c0."DripScheduleJson", c0."Duration", c0."EnrollmentLimit", c0."EnrollmentType", c0."Features", c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0."InstructorId", c0."IsBestseller", c0."IsPublished", c0."Language", c0."Level", c0."OriginalPrice", c0."PaymentPlanDetailsJson", c0."PreviewUrl", c0."Price", c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0."Status", c0."SubscriptionPeriod", c0."Thumbnail", c0."ThumbnailUrl", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."IsFlagged", r."Rating", r."Status", r."StudentId", e."Id", e."AverageQuizScore", e."CertificateIssued", e."CertificateUrl", e."CompletedAt", e."CompletedLessons", e."CourseId", e."EnrolledAt", e."LastAccessedDate", e."ProgressPercentage", e."QuizCount", e."StudentId", e."TotalTimeSpent"
FROM (
    SELECT c."Id", c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c."Category", c."CourseType", c."CreatedAt", c."Currency", c."Description", c."Discount", c."DripContent", c."DripScheduleJson", c."Duration", c."EnrollmentLimit", c."EnrollmentType", c."Features", c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c."InstructorId", c."IsBestseller", c."IsPublished", c."Language", c."Level", c."OriginalPrice", c."PaymentPlanDetailsJson", c."PreviewUrl", c."Price", c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c."Status", c."SubscriptionPeriod", c."Thumbnail", c."ThumbnailUrl", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-30 17:39:12.823 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-30 17:39:12.823 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 5.2668ms
2025-07-30 17:39:12.823 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-30 17:39:12.823 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses - 200 null application/json; charset=utf-8 7.3565ms
2025-07-30 17:39:12.825 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/platform - application/json null
2025-07-30 17:39:12.825 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:39:12.826 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:39:12.826 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-07-30 17:39:12.826 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-07-30 17:39:12.826 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/platform - 403 0 null 1.5669ms
2025-07-30 17:39:12.835 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/platform - application/json null
2025-07-30 17:39:12.835 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:39:12.837 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:39:12.837 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-07-30 17:39:12.837 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-07-30 17:39:12.837 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/platform - 403 0 null 2.3064ms
2025-07-30 17:39:12.840 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - null null
2025-07-30 17:39:12.840 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:39:12.840 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/revenue/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - null null
2025-07-30 17:39:12.840 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - 204 null null 0.2885ms
2025-07-30 17:39:12.840 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:39:12.840 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/revenue/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - 204 null null 0.2105ms
2025-07-30 17:39:12.841 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - application/json null
2025-07-30 17:39:12.841 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/revenue/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - application/json null
2025-07-30 17:39:12.842 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:39:12.842 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:39:12.843 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:39:12.843 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:39:12.844 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-07-30 17:39:12.844 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-30 17:39:12.846 +08:00 [INF] Route matched with {action = "GetInstructorRevenue", controller = "Revenue"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorRevenue(System.String) on controller CeceLearningPortal.Api.Controllers.RevenueController (CeceLearningPortal.Api).
2025-07-30 17:39:12.846 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-30 17:39:12.855 +08:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2025-07-30 17:39:12.858 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."Id" = @__p_0
LIMIT 1
2025-07-30 17:39:12.864 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c."Category", c."CourseType", c."CreatedAt", c."Currency", c."Description", c."Discount", c."DripContent", c."DripScheduleJson", c."Duration", c."EnrollmentLimit", c."EnrollmentType", c."Features", c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c."InstructorId", c."IsBestseller", c."IsPublished", c."Language", c."Level", c."OriginalPrice", c."PaymentPlanDetailsJson", c."PreviewUrl", c."Price", c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c."Status", c."SubscriptionPeriod", c."Thumbnail", c."ThumbnailUrl", c."Title", c."UpdatedAt"
FROM "Courses" AS c
WHERE c."InstructorId" = @__instructorId_0
2025-07-30 17:39:12.876 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0
2025-07-30 17:39:12.876 +08:00 [INF] Executed DbCommand (8ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c."Category", c."CourseType", c."CreatedAt", c."Currency", c."Description", c."Discount", c."DripContent", c."DripScheduleJson", c."Duration", c."EnrollmentLimit", c."EnrollmentType", c."Features", c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c."InstructorId", c."IsBestseller", c."IsPublished", c."Language", c."Level", c."OriginalPrice", c."PaymentPlanDetailsJson", c."PreviewUrl", c."Price", c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c."Status", c."SubscriptionPeriod", c."Thumbnail", c."ThumbnailUrl", c."Title", c."UpdatedAt", s."Id", s."AverageQuizScore", s."CertificateIssued", s."CertificateUrl", s."CompletedAt", s."CompletedLessons", s."CourseId", s."EnrolledAt", s."LastAccessedDate", s."ProgressPercentage", s."QuizCount", s."StudentId", s."TotalTimeSpent", s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."IsFlagged", r."Rating", r."Status", r."StudentId"
FROM "Courses" AS c
LEFT JOIN (
    SELECT e."Id", e."AverageQuizScore", e."CertificateIssued", e."CertificateUrl", e."CompletedAt", e."CompletedLessons", e."CourseId", e."EnrolledAt", e."LastAccessedDate", e."ProgressPercentage", e."QuizCount", e."StudentId", e."TotalTimeSpent", a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM "Enrollments" AS e
    INNER JOIN "AspNetUsers" AS a ON e."StudentId" = a."Id"
) AS s ON c."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c."Id" = r."CourseId"
WHERE c."InstructorId" = @__instructorId_0
ORDER BY c."Id", s."Id", s."Id0"
2025-07-30 17:39:12.882 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = e."StudentId" AND s."Status" = 'Active' AND s."StartDate" <= e."EnrolledAt")
2025-07-30 17:39:12.886 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = e."StudentId" AND s."Status" = 'Active' AND s."StartDate" <= e."EnrolledAt")
2025-07-30 17:39:12.887 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0
2025-07-30 17:39:12.888 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = e."StudentId" AND s."Status" = 'Active' AND s."StartDate" <= e."EnrolledAt")
2025-07-30 17:39:12.889 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = e."StudentId" AND s."Status" = 'Active' AND s."StartDate" <= e."EnrolledAt")
2025-07-30 17:39:12.889 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0
2025-07-30 17:39:12.889 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = e."StudentId" AND s."Status" = 'Active' AND s."StartDate" <= e."EnrolledAt")
2025-07-30 17:39:12.890 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = e."StudentId" AND s."Status" = 'Active' AND s."StartDate" <= e."EnrolledAt")
2025-07-30 17:39:12.890 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0
2025-07-30 17:39:12.891 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed'
2025-07-30 17:39:12.891 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = e."StudentId" AND s."Status" = 'Active' AND s."StartDate" <= e."EnrolledAt")
2025-07-30 17:39:12.891 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = e."StudentId" AND s."Status" = 'Active' AND s."StartDate" <= e."EnrolledAt")
2025-07-30 17:39:12.892 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0
2025-07-30 17:39:12.892 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = e."StudentId" AND s."Status" = 'Active' AND s."StartDate" <= e."EnrolledAt")
2025-07-30 17:39:12.893 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = e."StudentId" AND s."Status" = 'Active' AND s."StartDate" <= e."EnrolledAt")
2025-07-30 17:39:12.893 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.InstructorRevenueDto'.
2025-07-30 17:39:12.896 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api) in 49.72ms
2025-07-30 17:39:12.896 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-07-30 17:39:12.896 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/revenue/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - 200 null application/json; charset=utf-8 54.3212ms
2025-07-30 17:39:12.911 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__instructorId_0='?', @__twelveMonthsAgo_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Year", s."Month", COALESCE(sum(s."Amount"), 0.0) AS "Revenue"
FROM (
    SELECT p."Amount", date_part('year', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed' AND p."CreatedAt" >= @__twelveMonthsAgo_1
) AS s
GROUP BY s."Year", s."Month"
ORDER BY s."Year", s."Month"
2025-07-30 17:39:12.917 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-30 17:39:12.919 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-30 17:39:12.919 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-30 17:39:12.920 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-30 17:39:12.920 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-30 17:39:12.943 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."EnrolledAt"
FROM (
    SELECT e."EnrolledAt", e."StudentId", c."Title"
    FROM "Enrollments" AS e
    INNER JOIN "Courses" AS c ON e."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY e."EnrolledAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."EnrolledAt" DESC
2025-07-30 17:39:12.948 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."CreatedAt", s."Rating"
FROM (
    SELECT r."CreatedAt", r."Rating", r."StudentId", c."Title"
    FROM "Reviews" AS r
    INNER JOIN "Courses" AS c ON r."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY r."CreatedAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."CreatedAt" DESC
2025-07-30 17:39:12.949 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType18`5[[<>f__AnonymousType19`6[[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 17:39:12.955 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 109.4395ms
2025-07-30 17:39:12.955 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-30 17:39:12.955 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - 200 null application/json; charset=utf-8 114.1018ms
2025-07-30 17:39:15.028 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - application/json null
2025-07-30 17:39:15.028 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:39:15.030 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:39:15.030 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-30 17:39:15.030 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-30 17:39:15.032 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c."Category", c."CourseType", c."CreatedAt", c."Currency", c."Description", c."Discount", c."DripContent", c."DripScheduleJson", c."Duration", c."EnrollmentLimit", c."EnrollmentType", c."Features", c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c."InstructorId", c."IsBestseller", c."IsPublished", c."Language", c."Level", c."OriginalPrice", c."PaymentPlanDetailsJson", c."PreviewUrl", c."Price", c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c."Status", c."SubscriptionPeriod", c."Thumbnail", c."ThumbnailUrl", c."Title", c."UpdatedAt", s."Id", s."AverageQuizScore", s."CertificateIssued", s."CertificateUrl", s."CompletedAt", s."CompletedLessons", s."CourseId", s."EnrolledAt", s."LastAccessedDate", s."ProgressPercentage", s."QuizCount", s."StudentId", s."TotalTimeSpent", s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."IsFlagged", r."Rating", r."Status", r."StudentId"
FROM "Courses" AS c
LEFT JOIN (
    SELECT e."Id", e."AverageQuizScore", e."CertificateIssued", e."CertificateUrl", e."CompletedAt", e."CompletedLessons", e."CourseId", e."EnrolledAt", e."LastAccessedDate", e."ProgressPercentage", e."QuizCount", e."StudentId", e."TotalTimeSpent", a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM "Enrollments" AS e
    INNER JOIN "AspNetUsers" AS a ON e."StudentId" = a."Id"
) AS s ON c."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c."Id" = r."CourseId"
WHERE c."InstructorId" = @__instructorId_0
ORDER BY c."Id", s."Id", s."Id0"
2025-07-30 17:39:15.034 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed'
2025-07-30 17:39:15.035 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?', @__twelveMonthsAgo_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Year", s."Month", COALESCE(sum(s."Amount"), 0.0) AS "Revenue"
FROM (
    SELECT p."Amount", date_part('year', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed' AND p."CreatedAt" >= @__twelveMonthsAgo_1
) AS s
GROUP BY s."Year", s."Month"
ORDER BY s."Year", s."Month"
2025-07-30 17:39:15.036 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-30 17:39:15.036 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-30 17:39:15.037 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-30 17:39:15.037 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-30 17:39:15.037 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-30 17:39:15.038 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."EnrolledAt"
FROM (
    SELECT e."EnrolledAt", e."StudentId", c."Title"
    FROM "Enrollments" AS e
    INNER JOIN "Courses" AS c ON e."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY e."EnrolledAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."EnrolledAt" DESC
2025-07-30 17:39:15.039 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."CreatedAt", s."Rating"
FROM (
    SELECT r."CreatedAt", r."Rating", r."StudentId", c."Title"
    FROM "Reviews" AS r
    INNER JOIN "Courses" AS c ON r."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY r."CreatedAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."CreatedAt" DESC
2025-07-30 17:39:15.039 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType18`5[[<>f__AnonymousType19`6[[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 17:39:15.039 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 9.0215ms
2025-07-30 17:39:15.039 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-30 17:39:15.039 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - 200 null application/json; charset=utf-8 11.6564ms
2025-07-30 17:39:15.935 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/revenue/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - application/json null
2025-07-30 17:39:15.936 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:39:15.937 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:39:15.937 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-07-30 17:39:15.937 +08:00 [INF] Route matched with {action = "GetInstructorRevenue", controller = "Revenue"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorRevenue(System.String) on controller CeceLearningPortal.Api.Controllers.RevenueController (CeceLearningPortal.Api).
2025-07-30 17:39:15.939 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."Id" = @__p_0
LIMIT 1
2025-07-30 17:39:15.940 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c."Category", c."CourseType", c."CreatedAt", c."Currency", c."Description", c."Discount", c."DripContent", c."DripScheduleJson", c."Duration", c."EnrollmentLimit", c."EnrollmentType", c."Features", c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c."InstructorId", c."IsBestseller", c."IsPublished", c."Language", c."Level", c."OriginalPrice", c."PaymentPlanDetailsJson", c."PreviewUrl", c."Price", c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c."Status", c."SubscriptionPeriod", c."Thumbnail", c."ThumbnailUrl", c."Title", c."UpdatedAt"
FROM "Courses" AS c
WHERE c."InstructorId" = @__instructorId_0
2025-07-30 17:39:15.941 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0
2025-07-30 17:39:15.941 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = e."StudentId" AND s."Status" = 'Active' AND s."StartDate" <= e."EnrolledAt")
2025-07-30 17:39:15.942 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = e."StudentId" AND s."Status" = 'Active' AND s."StartDate" <= e."EnrolledAt")
2025-07-30 17:39:15.942 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0
2025-07-30 17:39:15.943 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = e."StudentId" AND s."Status" = 'Active' AND s."StartDate" <= e."EnrolledAt")
2025-07-30 17:39:15.943 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = e."StudentId" AND s."Status" = 'Active' AND s."StartDate" <= e."EnrolledAt")
2025-07-30 17:39:15.943 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0
2025-07-30 17:39:15.944 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = e."StudentId" AND s."Status" = 'Active' AND s."StartDate" <= e."EnrolledAt")
2025-07-30 17:39:15.944 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = e."StudentId" AND s."Status" = 'Active' AND s."StartDate" <= e."EnrolledAt")
2025-07-30 17:39:15.945 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0
2025-07-30 17:39:15.945 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = e."StudentId" AND s."Status" = 'Active' AND s."StartDate" <= e."EnrolledAt")
2025-07-30 17:39:15.946 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = e."StudentId" AND s."Status" = 'Active' AND s."StartDate" <= e."EnrolledAt")
2025-07-30 17:39:15.946 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0
2025-07-30 17:39:15.946 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = e."StudentId" AND s."Status" = 'Active' AND s."StartDate" <= e."EnrolledAt")
2025-07-30 17:39:15.947 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = e."StudentId" AND s."Status" = 'Active' AND s."StartDate" <= e."EnrolledAt")
2025-07-30 17:39:15.947 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.InstructorRevenueDto'.
2025-07-30 17:39:15.947 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api) in 9.8751ms
2025-07-30 17:39:15.947 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-07-30 17:39:15.947 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/revenue/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - 200 null application/json; charset=utf-8 12.1302ms
2025-07-30 17:39:15.950 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - application/json null
2025-07-30 17:39:15.950 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:39:15.951 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:39:15.951 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-30 17:39:15.951 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-30 17:39:15.953 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c."Category", c."CourseType", c."CreatedAt", c."Currency", c."Description", c."Discount", c."DripContent", c."DripScheduleJson", c."Duration", c."EnrollmentLimit", c."EnrollmentType", c."Features", c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c."InstructorId", c."IsBestseller", c."IsPublished", c."Language", c."Level", c."OriginalPrice", c."PaymentPlanDetailsJson", c."PreviewUrl", c."Price", c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c."Status", c."SubscriptionPeriod", c."Thumbnail", c."ThumbnailUrl", c."Title", c."UpdatedAt", s."Id", s."AverageQuizScore", s."CertificateIssued", s."CertificateUrl", s."CompletedAt", s."CompletedLessons", s."CourseId", s."EnrolledAt", s."LastAccessedDate", s."ProgressPercentage", s."QuizCount", s."StudentId", s."TotalTimeSpent", s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."IsFlagged", r."Rating", r."Status", r."StudentId"
FROM "Courses" AS c
LEFT JOIN (
    SELECT e."Id", e."AverageQuizScore", e."CertificateIssued", e."CertificateUrl", e."CompletedAt", e."CompletedLessons", e."CourseId", e."EnrolledAt", e."LastAccessedDate", e."ProgressPercentage", e."QuizCount", e."StudentId", e."TotalTimeSpent", a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM "Enrollments" AS e
    INNER JOIN "AspNetUsers" AS a ON e."StudentId" = a."Id"
) AS s ON c."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c."Id" = r."CourseId"
WHERE c."InstructorId" = @__instructorId_0
ORDER BY c."Id", s."Id", s."Id0"
2025-07-30 17:39:15.954 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed'
2025-07-30 17:39:15.955 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__twelveMonthsAgo_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Year", s."Month", COALESCE(sum(s."Amount"), 0.0) AS "Revenue"
FROM (
    SELECT p."Amount", date_part('year', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed' AND p."CreatedAt" >= @__twelveMonthsAgo_1
) AS s
GROUP BY s."Year", s."Month"
ORDER BY s."Year", s."Month"
2025-07-30 17:39:15.955 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-30 17:39:15.956 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-30 17:39:15.956 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-30 17:39:15.956 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-30 17:39:15.957 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-30 17:39:15.957 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."EnrolledAt"
FROM (
    SELECT e."EnrolledAt", e."StudentId", c."Title"
    FROM "Enrollments" AS e
    INNER JOIN "Courses" AS c ON e."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY e."EnrolledAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."EnrolledAt" DESC
2025-07-30 17:39:15.958 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."CreatedAt", s."Rating"
FROM (
    SELECT r."CreatedAt", r."Rating", r."StudentId", c."Title"
    FROM "Reviews" AS r
    INNER JOIN "Courses" AS c ON r."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY r."CreatedAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."CreatedAt" DESC
2025-07-30 17:39:15.958 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType18`5[[<>f__AnonymousType19`6[[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 17:39:15.958 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 7.0963ms
2025-07-30 17:39:15.958 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-30 17:39:15.959 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - 200 null application/json; charset=utf-8 8.9571ms
2025-07-30 17:39:17.658 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - application/json null
2025-07-30 17:39:17.659 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:39:17.660 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:39:17.660 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-30 17:39:17.661 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-30 17:39:17.662 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c."Category", c."CourseType", c."CreatedAt", c."Currency", c."Description", c."Discount", c."DripContent", c."DripScheduleJson", c."Duration", c."EnrollmentLimit", c."EnrollmentType", c."Features", c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c."InstructorId", c."IsBestseller", c."IsPublished", c."Language", c."Level", c."OriginalPrice", c."PaymentPlanDetailsJson", c."PreviewUrl", c."Price", c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c."Status", c."SubscriptionPeriod", c."Thumbnail", c."ThumbnailUrl", c."Title", c."UpdatedAt", s."Id", s."AverageQuizScore", s."CertificateIssued", s."CertificateUrl", s."CompletedAt", s."CompletedLessons", s."CourseId", s."EnrolledAt", s."LastAccessedDate", s."ProgressPercentage", s."QuizCount", s."StudentId", s."TotalTimeSpent", s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."IsFlagged", r."Rating", r."Status", r."StudentId"
FROM "Courses" AS c
LEFT JOIN (
    SELECT e."Id", e."AverageQuizScore", e."CertificateIssued", e."CertificateUrl", e."CompletedAt", e."CompletedLessons", e."CourseId", e."EnrolledAt", e."LastAccessedDate", e."ProgressPercentage", e."QuizCount", e."StudentId", e."TotalTimeSpent", a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM "Enrollments" AS e
    INNER JOIN "AspNetUsers" AS a ON e."StudentId" = a."Id"
) AS s ON c."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c."Id" = r."CourseId"
WHERE c."InstructorId" = @__instructorId_0
ORDER BY c."Id", s."Id", s."Id0"
2025-07-30 17:39:17.663 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed'
2025-07-30 17:39:17.664 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__twelveMonthsAgo_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Year", s."Month", COALESCE(sum(s."Amount"), 0.0) AS "Revenue"
FROM (
    SELECT p."Amount", date_part('year', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed' AND p."CreatedAt" >= @__twelveMonthsAgo_1
) AS s
GROUP BY s."Year", s."Month"
ORDER BY s."Year", s."Month"
2025-07-30 17:39:17.664 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-30 17:39:17.665 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-30 17:39:17.665 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-30 17:39:17.665 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-30 17:39:17.666 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-30 17:39:17.666 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."EnrolledAt"
FROM (
    SELECT e."EnrolledAt", e."StudentId", c."Title"
    FROM "Enrollments" AS e
    INNER JOIN "Courses" AS c ON e."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY e."EnrolledAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."EnrolledAt" DESC
2025-07-30 17:39:17.667 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."CreatedAt", s."Rating"
FROM (
    SELECT r."CreatedAt", r."Rating", r."StudentId", c."Title"
    FROM "Reviews" AS r
    INNER JOIN "Courses" AS c ON r."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY r."CreatedAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."CreatedAt" DESC
2025-07-30 17:39:17.667 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType18`5[[<>f__AnonymousType19`6[[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 17:39:17.667 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 6.6239ms
2025-07-30 17:39:17.667 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-30 17:39:17.667 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - 200 null application/json; charset=utf-8 8.9339ms
2025-07-30 17:39:20.000 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/revenue/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - null null
2025-07-30 17:39:20.000 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:39:20.000 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/revenue/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - 204 null null 0.4315ms
2025-07-30 17:39:20.001 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/revenue/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - application/json null
2025-07-30 17:39:20.001 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:39:20.003 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:39:20.003 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-07-30 17:39:20.003 +08:00 [INF] Route matched with {action = "GetInstructorRevenue", controller = "Revenue"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorRevenue(System.String) on controller CeceLearningPortal.Api.Controllers.RevenueController (CeceLearningPortal.Api).
2025-07-30 17:39:20.004 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."Id" = @__p_0
LIMIT 1
2025-07-30 17:39:20.005 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c."Category", c."CourseType", c."CreatedAt", c."Currency", c."Description", c."Discount", c."DripContent", c."DripScheduleJson", c."Duration", c."EnrollmentLimit", c."EnrollmentType", c."Features", c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c."InstructorId", c."IsBestseller", c."IsPublished", c."Language", c."Level", c."OriginalPrice", c."PaymentPlanDetailsJson", c."PreviewUrl", c."Price", c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c."Status", c."SubscriptionPeriod", c."Thumbnail", c."ThumbnailUrl", c."Title", c."UpdatedAt"
FROM "Courses" AS c
WHERE c."InstructorId" = @__instructorId_0
2025-07-30 17:39:20.006 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0
2025-07-30 17:39:20.006 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = e."StudentId" AND s."Status" = 'Active' AND s."StartDate" <= e."EnrolledAt")
2025-07-30 17:39:20.007 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = e."StudentId" AND s."Status" = 'Active' AND s."StartDate" <= e."EnrolledAt")
2025-07-30 17:39:20.007 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0
2025-07-30 17:39:20.007 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = e."StudentId" AND s."Status" = 'Active' AND s."StartDate" <= e."EnrolledAt")
2025-07-30 17:39:20.008 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = e."StudentId" AND s."Status" = 'Active' AND s."StartDate" <= e."EnrolledAt")
2025-07-30 17:39:20.008 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0
2025-07-30 17:39:20.009 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = e."StudentId" AND s."Status" = 'Active' AND s."StartDate" <= e."EnrolledAt")
2025-07-30 17:39:20.009 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = e."StudentId" AND s."Status" = 'Active' AND s."StartDate" <= e."EnrolledAt")
2025-07-30 17:39:20.009 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0
2025-07-30 17:39:20.010 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = e."StudentId" AND s."Status" = 'Active' AND s."StartDate" <= e."EnrolledAt")
2025-07-30 17:39:20.031 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = e."StudentId" AND s."Status" = 'Active' AND s."StartDate" <= e."EnrolledAt")
2025-07-30 17:39:20.032 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0
2025-07-30 17:39:20.032 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = e."StudentId" AND s."Status" = 'Active' AND s."StartDate" <= e."EnrolledAt")
2025-07-30 17:39:20.033 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = e."StudentId" AND s."Status" = 'Active' AND s."StartDate" <= e."EnrolledAt")
2025-07-30 17:39:20.033 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.InstructorRevenueDto'.
2025-07-30 17:39:20.033 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api) in 30.0694ms
2025-07-30 17:39:20.033 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-07-30 17:39:20.033 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/revenue/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - 200 null application/json; charset=utf-8 31.946ms
2025-07-30 17:39:20.035 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - null null
2025-07-30 17:39:20.035 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:39:20.035 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - 204 null null 0.1737ms
2025-07-30 17:39:20.035 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - application/json null
2025-07-30 17:39:20.035 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:39:20.037 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:39:20.037 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-30 17:39:20.037 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-30 17:39:20.038 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c."Category", c."CourseType", c."CreatedAt", c."Currency", c."Description", c."Discount", c."DripContent", c."DripScheduleJson", c."Duration", c."EnrollmentLimit", c."EnrollmentType", c."Features", c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c."InstructorId", c."IsBestseller", c."IsPublished", c."Language", c."Level", c."OriginalPrice", c."PaymentPlanDetailsJson", c."PreviewUrl", c."Price", c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c."Status", c."SubscriptionPeriod", c."Thumbnail", c."ThumbnailUrl", c."Title", c."UpdatedAt", s."Id", s."AverageQuizScore", s."CertificateIssued", s."CertificateUrl", s."CompletedAt", s."CompletedLessons", s."CourseId", s."EnrolledAt", s."LastAccessedDate", s."ProgressPercentage", s."QuizCount", s."StudentId", s."TotalTimeSpent", s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."IsFlagged", r."Rating", r."Status", r."StudentId"
FROM "Courses" AS c
LEFT JOIN (
    SELECT e."Id", e."AverageQuizScore", e."CertificateIssued", e."CertificateUrl", e."CompletedAt", e."CompletedLessons", e."CourseId", e."EnrolledAt", e."LastAccessedDate", e."ProgressPercentage", e."QuizCount", e."StudentId", e."TotalTimeSpent", a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM "Enrollments" AS e
    INNER JOIN "AspNetUsers" AS a ON e."StudentId" = a."Id"
) AS s ON c."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c."Id" = r."CourseId"
WHERE c."InstructorId" = @__instructorId_0
ORDER BY c."Id", s."Id", s."Id0"
2025-07-30 17:39:20.039 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed'
2025-07-30 17:39:20.040 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__twelveMonthsAgo_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Year", s."Month", COALESCE(sum(s."Amount"), 0.0) AS "Revenue"
FROM (
    SELECT p."Amount", date_part('year', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed' AND p."CreatedAt" >= @__twelveMonthsAgo_1
) AS s
GROUP BY s."Year", s."Month"
ORDER BY s."Year", s."Month"
2025-07-30 17:39:20.040 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-30 17:39:20.040 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-30 17:39:20.041 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-30 17:39:20.041 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-30 17:39:20.041 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-30 17:39:20.042 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."EnrolledAt"
FROM (
    SELECT e."EnrolledAt", e."StudentId", c."Title"
    FROM "Enrollments" AS e
    INNER JOIN "Courses" AS c ON e."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY e."EnrolledAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."EnrolledAt" DESC
2025-07-30 17:39:20.042 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."CreatedAt", s."Rating"
FROM (
    SELECT r."CreatedAt", r."Rating", r."StudentId", c."Title"
    FROM "Reviews" AS r
    INNER JOIN "Courses" AS c ON r."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY r."CreatedAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."CreatedAt" DESC
2025-07-30 17:39:20.043 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType18`5[[<>f__AnonymousType19`6[[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 17:39:20.043 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 6.0663ms
2025-07-30 17:39:20.043 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-30 17:39:20.043 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - 200 null application/json; charset=utf-8 7.6211ms
2025-07-30 17:40:07.656 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/platform - null null
2025-07-30 17:40:07.657 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:40:07.657 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/courses - null null
2025-07-30 17:40:07.657 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/platform - 204 null null 0.4106ms
2025-07-30 17:40:07.657 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:40:07.657 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/courses - 204 null null 0.4149ms
2025-07-30 17:40:07.658 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses - application/json null
2025-07-30 17:40:07.658 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/platform - application/json null
2025-07-30 17:40:07.658 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:40:07.658 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:40:07.660 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:40:07.660 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:40:07.660 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-30 17:40:07.660 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-30 17:40:07.660 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-07-30 17:40:07.660 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-07-30 17:40:07.660 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/platform - 403 0 null 2.2376ms
2025-07-30 17:40:07.664 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0."Category", c0."CourseType", c0."CreatedAt", c0."Currency", c0."Description", c0."Discount", c0."DripContent", c0."DripScheduleJson", c0."Duration", c0."EnrollmentLimit", c0."EnrollmentType", c0."Features", c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0."InstructorId", c0."IsBestseller", c0."IsPublished", c0."Language", c0."Level", c0."OriginalPrice", c0."PaymentPlanDetailsJson", c0."PreviewUrl", c0."Price", c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0."Status", c0."SubscriptionPeriod", c0."Thumbnail", c0."ThumbnailUrl", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."IsFlagged", r."Rating", r."Status", r."StudentId", e."Id", e."AverageQuizScore", e."CertificateIssued", e."CertificateUrl", e."CompletedAt", e."CompletedLessons", e."CourseId", e."EnrolledAt", e."LastAccessedDate", e."ProgressPercentage", e."QuizCount", e."StudentId", e."TotalTimeSpent"
FROM (
    SELECT c."Id", c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c."Category", c."CourseType", c."CreatedAt", c."Currency", c."Description", c."Discount", c."DripContent", c."DripScheduleJson", c."Duration", c."EnrollmentLimit", c."EnrollmentType", c."Features", c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c."InstructorId", c."IsBestseller", c."IsPublished", c."Language", c."Level", c."OriginalPrice", c."PaymentPlanDetailsJson", c."PreviewUrl", c."Price", c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c."Status", c."SubscriptionPeriod", c."Thumbnail", c."ThumbnailUrl", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-30 17:40:07.665 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-30 17:40:07.665 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 4.8039ms
2025-07-30 17:40:07.665 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-30 17:40:07.665 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses - 200 null application/json; charset=utf-8 7.0551ms
2025-07-30 17:40:07.668 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/users/f9f0e64e-3771-4aa9-8470-21e709677e44/instructor-stats - null null
2025-07-30 17:40:07.668 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:40:07.668 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/users/f9f0e64e-3771-4aa9-8470-21e709677e44/instructor-stats - 204 null null 0.238ms
2025-07-30 17:40:07.669 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/users/f9f0e64e-3771-4aa9-8470-21e709677e44/instructor-stats - application/json null
2025-07-30 17:40:07.669 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:40:07.670 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:40:07.670 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/users/f9f0e64e-3771-4aa9-8470-21e709677e44/instructor-stats - 404 0 null 1.6444ms
2025-07-30 17:40:07.670 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5295/api/users/f9f0e64e-3771-4aa9-8470-21e709677e44/instructor-stats, Response status code: 404
2025-07-30 17:40:07.677 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - null null
2025-07-30 17:40:07.678 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:40:07.678 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - 204 null null 0.2684ms
2025-07-30 17:40:07.678 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - application/json null
2025-07-30 17:40:07.678 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:40:07.680 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:40:07.680 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-30 17:40:07.680 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-30 17:40:07.683 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0."Category", c0."CourseType", c0."CreatedAt", c0."Currency", c0."Description", c0."Discount", c0."DripContent", c0."DripScheduleJson", c0."Duration", c0."EnrollmentLimit", c0."EnrollmentType", c0."Features", c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0."InstructorId", c0."IsBestseller", c0."IsPublished", c0."Language", c0."Level", c0."OriginalPrice", c0."PaymentPlanDetailsJson", c0."PreviewUrl", c0."Price", c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0."Status", c0."SubscriptionPeriod", c0."Thumbnail", c0."ThumbnailUrl", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."IsFlagged", r."Rating", r."Status", r."StudentId", e."Id", e."AverageQuizScore", e."CertificateIssued", e."CertificateUrl", e."CompletedAt", e."CompletedLessons", e."CourseId", e."EnrolledAt", e."LastAccessedDate", e."ProgressPercentage", e."QuizCount", e."StudentId", e."TotalTimeSpent"
FROM (
    SELECT c."Id", c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c."Category", c."CourseType", c."CreatedAt", c."Currency", c."Description", c."Discount", c."DripContent", c."DripScheduleJson", c."Duration", c."EnrollmentLimit", c."EnrollmentType", c."Features", c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c."InstructorId", c."IsBestseller", c."IsPublished", c."Language", c."Level", c."OriginalPrice", c."PaymentPlanDetailsJson", c."PreviewUrl", c."Price", c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c."Status", c."SubscriptionPeriod", c."Thumbnail", c."ThumbnailUrl", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-30 17:40:07.684 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-30 17:40:07.684 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 3.7895ms
2025-07-30 17:40:07.684 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-30 17:40:07.684 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - 200 null application/json; charset=utf-8 5.6411ms
2025-07-30 17:40:14.503 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - null null
2025-07-30 17:40:14.503 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:40:14.504 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - 204 null null 0.3385ms
2025-07-30 17:40:14.504 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - application/json null
2025-07-30 17:40:14.504 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:40:14.506 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:40:14.506 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-30 17:40:14.506 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-30 17:40:14.508 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c."Category", c."CourseType", c."CreatedAt", c."Currency", c."Description", c."Discount", c."DripContent", c."DripScheduleJson", c."Duration", c."EnrollmentLimit", c."EnrollmentType", c."Features", c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c."InstructorId", c."IsBestseller", c."IsPublished", c."Language", c."Level", c."OriginalPrice", c."PaymentPlanDetailsJson", c."PreviewUrl", c."Price", c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c."Status", c."SubscriptionPeriod", c."Thumbnail", c."ThumbnailUrl", c."Title", c."UpdatedAt", s."Id", s."AverageQuizScore", s."CertificateIssued", s."CertificateUrl", s."CompletedAt", s."CompletedLessons", s."CourseId", s."EnrolledAt", s."LastAccessedDate", s."ProgressPercentage", s."QuizCount", s."StudentId", s."TotalTimeSpent", s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."IsFlagged", r."Rating", r."Status", r."StudentId"
FROM "Courses" AS c
LEFT JOIN (
    SELECT e."Id", e."AverageQuizScore", e."CertificateIssued", e."CertificateUrl", e."CompletedAt", e."CompletedLessons", e."CourseId", e."EnrolledAt", e."LastAccessedDate", e."ProgressPercentage", e."QuizCount", e."StudentId", e."TotalTimeSpent", a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM "Enrollments" AS e
    INNER JOIN "AspNetUsers" AS a ON e."StudentId" = a."Id"
) AS s ON c."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c."Id" = r."CourseId"
WHERE c."InstructorId" = @__instructorId_0
ORDER BY c."Id", s."Id", s."Id0"
2025-07-30 17:40:14.509 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed'
2025-07-30 17:40:14.510 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__twelveMonthsAgo_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Year", s."Month", COALESCE(sum(s."Amount"), 0.0) AS "Revenue"
FROM (
    SELECT p."Amount", date_part('year', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed' AND p."CreatedAt" >= @__twelveMonthsAgo_1
) AS s
GROUP BY s."Year", s."Month"
ORDER BY s."Year", s."Month"
2025-07-30 17:40:14.510 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-30 17:40:14.511 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-30 17:40:14.511 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-30 17:40:14.511 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-30 17:40:14.512 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-30 17:40:14.512 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."EnrolledAt"
FROM (
    SELECT e."EnrolledAt", e."StudentId", c."Title"
    FROM "Enrollments" AS e
    INNER JOIN "Courses" AS c ON e."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY e."EnrolledAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."EnrolledAt" DESC
2025-07-30 17:40:14.513 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."CreatedAt", s."Rating"
FROM (
    SELECT r."CreatedAt", r."Rating", r."StudentId", c."Title"
    FROM "Reviews" AS r
    INNER JOIN "Courses" AS c ON r."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY r."CreatedAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."CreatedAt" DESC
2025-07-30 17:40:14.513 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType18`5[[<>f__AnonymousType19`6[[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 17:40:14.513 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 7.1838ms
2025-07-30 17:40:14.513 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-30 17:40:14.514 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - 200 null application/json; charset=utf-8 9.2136ms
2025-07-30 17:40:15.580 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users - null null
2025-07-30 17:40:15.580 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:40:15.580 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users - 204 null null 0.2954ms
2025-07-30 17:40:15.581 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users - application/json null
2025-07-30 17:40:15.581 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:40:15.582 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:40:15.582 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-07-30 17:40:15.582 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-07-30 17:40:15.582 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users - 403 0 null 1.7701ms
2025-07-30 17:40:15.584 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/courses - null null
2025-07-30 17:40:15.584 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:40:15.584 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/courses - 204 null null 0.1385ms
2025-07-30 17:40:15.584 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses - application/json null
2025-07-30 17:40:15.585 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:40:15.586 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:40:15.586 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-30 17:40:15.586 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-30 17:40:15.588 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0."Category", c0."CourseType", c0."CreatedAt", c0."Currency", c0."Description", c0."Discount", c0."DripContent", c0."DripScheduleJson", c0."Duration", c0."EnrollmentLimit", c0."EnrollmentType", c0."Features", c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0."InstructorId", c0."IsBestseller", c0."IsPublished", c0."Language", c0."Level", c0."OriginalPrice", c0."PaymentPlanDetailsJson", c0."PreviewUrl", c0."Price", c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0."Status", c0."SubscriptionPeriod", c0."Thumbnail", c0."ThumbnailUrl", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."IsFlagged", r."Rating", r."Status", r."StudentId", e."Id", e."AverageQuizScore", e."CertificateIssued", e."CertificateUrl", e."CompletedAt", e."CompletedLessons", e."CourseId", e."EnrolledAt", e."LastAccessedDate", e."ProgressPercentage", e."QuizCount", e."StudentId", e."TotalTimeSpent"
FROM (
    SELECT c."Id", c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c."Category", c."CourseType", c."CreatedAt", c."Currency", c."Description", c."Discount", c."DripContent", c."DripScheduleJson", c."Duration", c."EnrollmentLimit", c."EnrollmentType", c."Features", c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c."InstructorId", c."IsBestseller", c."IsPublished", c."Language", c."Level", c."OriginalPrice", c."PaymentPlanDetailsJson", c."PreviewUrl", c."Price", c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c."Status", c."SubscriptionPeriod", c."Thumbnail", c."ThumbnailUrl", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-30 17:40:15.589 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-30 17:40:15.589 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 3.3429ms
2025-07-30 17:40:15.589 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-30 17:40:15.589 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses - 200 null application/json; charset=utf-8 4.8415ms
2025-07-30 17:40:15.591 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/platform - null null
2025-07-30 17:40:15.591 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:40:15.591 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/platform - 204 null null 0.1515ms
2025-07-30 17:40:15.592 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/platform - application/json null
2025-07-30 17:40:15.592 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:40:15.593 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:40:15.593 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-07-30 17:40:15.593 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-07-30 17:40:15.593 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/platform - 403 0 null 1.3728ms
2025-07-30 17:40:15.603 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/platform - application/json null
2025-07-30 17:40:15.603 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:40:15.604 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:40:15.604 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-07-30 17:40:15.604 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-07-30 17:40:15.604 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/platform - 403 0 null 1.7061ms
2025-07-30 17:40:15.608 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/revenue/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - null null
2025-07-30 17:40:15.608 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - application/json null
2025-07-30 17:40:15.608 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:40:15.608 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:40:15.608 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/revenue/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - 204 null null 0.2983ms
2025-07-30 17:40:15.609 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/revenue/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - application/json null
2025-07-30 17:40:15.609 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:40:15.610 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:40:15.610 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-30 17:40:15.610 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-30 17:40:15.610 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:40:15.610 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-07-30 17:40:15.610 +08:00 [INF] Route matched with {action = "GetInstructorRevenue", controller = "Revenue"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorRevenue(System.String) on controller CeceLearningPortal.Api.Controllers.RevenueController (CeceLearningPortal.Api).
2025-07-30 17:40:15.611 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."Id" = @__p_0
LIMIT 1
2025-07-30 17:40:15.612 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c."Category", c."CourseType", c."CreatedAt", c."Currency", c."Description", c."Discount", c."DripContent", c."DripScheduleJson", c."Duration", c."EnrollmentLimit", c."EnrollmentType", c."Features", c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c."InstructorId", c."IsBestseller", c."IsPublished", c."Language", c."Level", c."OriginalPrice", c."PaymentPlanDetailsJson", c."PreviewUrl", c."Price", c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c."Status", c."SubscriptionPeriod", c."Thumbnail", c."ThumbnailUrl", c."Title", c."UpdatedAt"
FROM "Courses" AS c
WHERE c."InstructorId" = @__instructorId_0
2025-07-30 17:40:15.612 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c."Category", c."CourseType", c."CreatedAt", c."Currency", c."Description", c."Discount", c."DripContent", c."DripScheduleJson", c."Duration", c."EnrollmentLimit", c."EnrollmentType", c."Features", c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c."InstructorId", c."IsBestseller", c."IsPublished", c."Language", c."Level", c."OriginalPrice", c."PaymentPlanDetailsJson", c."PreviewUrl", c."Price", c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c."Status", c."SubscriptionPeriod", c."Thumbnail", c."ThumbnailUrl", c."Title", c."UpdatedAt", s."Id", s."AverageQuizScore", s."CertificateIssued", s."CertificateUrl", s."CompletedAt", s."CompletedLessons", s."CourseId", s."EnrolledAt", s."LastAccessedDate", s."ProgressPercentage", s."QuizCount", s."StudentId", s."TotalTimeSpent", s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."IsFlagged", r."Rating", r."Status", r."StudentId"
FROM "Courses" AS c
LEFT JOIN (
    SELECT e."Id", e."AverageQuizScore", e."CertificateIssued", e."CertificateUrl", e."CompletedAt", e."CompletedLessons", e."CourseId", e."EnrolledAt", e."LastAccessedDate", e."ProgressPercentage", e."QuizCount", e."StudentId", e."TotalTimeSpent", a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM "Enrollments" AS e
    INNER JOIN "AspNetUsers" AS a ON e."StudentId" = a."Id"
) AS s ON c."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c."Id" = r."CourseId"
WHERE c."InstructorId" = @__instructorId_0
ORDER BY c."Id", s."Id", s."Id0"
2025-07-30 17:40:15.612 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0
2025-07-30 17:40:15.613 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = e."StudentId" AND s."Status" = 'Active' AND s."StartDate" <= e."EnrolledAt")
2025-07-30 17:40:15.613 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed'
2025-07-30 17:40:15.613 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = e."StudentId" AND s."Status" = 'Active' AND s."StartDate" <= e."EnrolledAt")
2025-07-30 17:40:15.613 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0
2025-07-30 17:40:15.614 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?', @__twelveMonthsAgo_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Year", s."Month", COALESCE(sum(s."Amount"), 0.0) AS "Revenue"
FROM (
    SELECT p."Amount", date_part('year', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed' AND p."CreatedAt" >= @__twelveMonthsAgo_1
) AS s
GROUP BY s."Year", s."Month"
ORDER BY s."Year", s."Month"
2025-07-30 17:40:15.614 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = e."StudentId" AND s."Status" = 'Active' AND s."StartDate" <= e."EnrolledAt")
2025-07-30 17:40:15.614 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-30 17:40:15.614 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = e."StudentId" AND s."Status" = 'Active' AND s."StartDate" <= e."EnrolledAt")
2025-07-30 17:40:15.614 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-30 17:40:15.614 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0
2025-07-30 17:40:15.615 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-30 17:40:15.615 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = e."StudentId" AND s."Status" = 'Active' AND s."StartDate" <= e."EnrolledAt")
2025-07-30 17:40:15.615 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-30 17:40:15.615 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = e."StudentId" AND s."Status" = 'Active' AND s."StartDate" <= e."EnrolledAt")
2025-07-30 17:40:15.615 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-30 17:40:15.616 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0
2025-07-30 17:40:15.616 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = e."StudentId" AND s."Status" = 'Active' AND s."StartDate" <= e."EnrolledAt")
2025-07-30 17:40:15.616 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."EnrolledAt"
FROM (
    SELECT e."EnrolledAt", e."StudentId", c."Title"
    FROM "Enrollments" AS e
    INNER JOIN "Courses" AS c ON e."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY e."EnrolledAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."EnrolledAt" DESC
2025-07-30 17:40:15.616 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = e."StudentId" AND s."Status" = 'Active' AND s."StartDate" <= e."EnrolledAt")
2025-07-30 17:40:15.617 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0
2025-07-30 17:40:15.617 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."CreatedAt", s."Rating"
FROM (
    SELECT r."CreatedAt", r."Rating", r."StudentId", c."Title"
    FROM "Reviews" AS r
    INNER JOIN "Courses" AS c ON r."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY r."CreatedAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."CreatedAt" DESC
2025-07-30 17:40:15.617 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType18`5[[<>f__AnonymousType19`6[[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 17:40:15.617 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = e."StudentId" AND s."Status" = 'Active' AND s."StartDate" <= e."EnrolledAt")
2025-07-30 17:40:15.617 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 7.1026ms
2025-07-30 17:40:15.617 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-30 17:40:15.617 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - 200 null application/json; charset=utf-8 9.0864ms
2025-07-30 17:40:15.618 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = e."StudentId" AND s."Status" = 'Active' AND s."StartDate" <= e."EnrolledAt")
2025-07-30 17:40:15.618 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.InstructorRevenueDto'.
2025-07-30 17:40:15.618 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api) in 7.6132ms
2025-07-30 17:40:15.618 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-07-30 17:40:15.618 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/revenue/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - 200 null application/json; charset=utf-8 8.788ms
2025-07-30 17:41:19.853 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/auth/logout - null null
2025-07-30 17:41:19.853 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:41:19.853 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/auth/logout - 204 null null 0.2816ms
2025-07-30 17:41:19.854 +08:00 [INF] Request starting HTTP/1.1 POST http://localhost:5295/api/auth/logout - application/json 0
2025-07-30 17:41:19.855 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:41:19.856 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:41:19.856 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AuthController.Logout (CeceLearningPortal.Api)'
2025-07-30 17:41:19.856 +08:00 [INF] Route matched with {action = "Logout", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Logout() on controller CeceLearningPortal.Api.Controllers.AuthController (CeceLearningPortal.Api).
2025-07-30 17:41:19.865 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a0."Id", a0."AccessFailedCount", a0."Avatar", a0."ConcurrencyStamp", a0."CreatedAt", a0."Email", a0."EmailConfirmed", a0."FullName", a0."LastLoginAt", a0."LockoutEnabled", a0."LockoutEnd", a0."NormalizedEmail", a0."NormalizedUserName", a0."NotificationPreferences", a0."PasswordHash", a0."PhoneNumber", a0."PhoneNumberConfirmed", a0."RefreshToken", a0."RefreshTokenExpiryTime", a0."Role", a0."SecurityStamp", a0."Status", a0."TwoFactorEnabled", a0."UserName", r."Id", r."CreatedAt", r."CreatedByIp", r."ExpiresAt", r."ReplacedByToken", r."RevokedAt", r."RevokedByIp", r."Token", r."UserId"
FROM (
    SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM "AspNetUsers" AS a
    WHERE a."Id" = @__userId_0
    LIMIT 1
) AS a0
LEFT JOIN "RefreshTokens" AS r ON a0."Id" = r."UserId"
ORDER BY a0."Id"
2025-07-30 17:41:19.876 +08:00 [INF] Executed DbCommand (10ms) [Parameters=[@p1='?' (DbType = Int32), @p0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
UPDATE "RefreshTokens" SET "RevokedAt" = @p0
WHERE "Id" = @p1;
2025-07-30 17:41:19.877 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType0`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 17:41:19.877 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AuthController.Logout (CeceLearningPortal.Api) in 20.1862ms
2025-07-30 17:41:19.877 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AuthController.Logout (CeceLearningPortal.Api)'
2025-07-30 17:41:19.877 +08:00 [INF] Request finished HTTP/1.1 POST http://localhost:5295/api/auth/logout - 200 null application/json; charset=utf-8 22.3919ms
2025-07-30 17:41:19.889 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users - null null
2025-07-30 17:41:19.889 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:41:19.889 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users - 204 null null 0.3341ms
2025-07-30 17:41:19.890 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users - application/json null
2025-07-30 17:41:19.891 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:41:19.891 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-07-30 17:41:19.891 +08:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-07-30 17:41:19.891 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users - 401 0 null 0.578ms
2025-07-30 17:41:19.900 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/courses - null null
2025-07-30 17:41:19.900 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:41:19.900 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/courses - 204 null null 0.245ms
2025-07-30 17:41:19.901 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses - application/json null
2025-07-30 17:41:19.901 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:41:19.901 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-30 17:41:19.901 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-30 17:41:19.904 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0."Category", c0."CourseType", c0."CreatedAt", c0."Currency", c0."Description", c0."Discount", c0."DripContent", c0."DripScheduleJson", c0."Duration", c0."EnrollmentLimit", c0."EnrollmentType", c0."Features", c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0."InstructorId", c0."IsBestseller", c0."IsPublished", c0."Language", c0."Level", c0."OriginalPrice", c0."PaymentPlanDetailsJson", c0."PreviewUrl", c0."Price", c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0."Status", c0."SubscriptionPeriod", c0."Thumbnail", c0."ThumbnailUrl", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."IsFlagged", r."Rating", r."Status", r."StudentId", e."Id", e."AverageQuizScore", e."CertificateIssued", e."CertificateUrl", e."CompletedAt", e."CompletedLessons", e."CourseId", e."EnrolledAt", e."LastAccessedDate", e."ProgressPercentage", e."QuizCount", e."StudentId", e."TotalTimeSpent"
FROM (
    SELECT c."Id", c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c."Category", c."CourseType", c."CreatedAt", c."Currency", c."Description", c."Discount", c."DripContent", c."DripScheduleJson", c."Duration", c."EnrollmentLimit", c."EnrollmentType", c."Features", c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c."InstructorId", c."IsBestseller", c."IsPublished", c."Language", c."Level", c."OriginalPrice", c."PaymentPlanDetailsJson", c."PreviewUrl", c."Price", c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c."Status", c."SubscriptionPeriod", c."Thumbnail", c."ThumbnailUrl", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-30 17:41:19.906 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-30 17:41:19.906 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 4.9133ms
2025-07-30 17:41:19.906 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-30 17:41:19.906 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses - 200 null application/json; charset=utf-8 5.5765ms
2025-07-30 17:41:19.908 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/platform - null null
2025-07-30 17:41:19.908 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:41:19.908 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/platform - 204 null null 0.1671ms
2025-07-30 17:41:19.909 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/platform - application/json null
2025-07-30 17:41:19.909 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:41:19.909 +08:00 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-07-30 17:41:19.910 +08:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-07-30 17:41:19.910 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/platform - 401 0 null 0.456ms
2025-07-30 17:41:21.505 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/auth/login - null null
2025-07-30 17:41:21.505 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:41:21.505 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/auth/login - 204 null null 0.2182ms
2025-07-30 17:41:21.506 +08:00 [INF] Request starting HTTP/1.1 POST http://localhost:5295/api/auth/login - application/json 67
2025-07-30 17:41:21.506 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:41:21.507 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AuthController.Login (CeceLearningPortal.Api)'
2025-07-30 17:41:21.507 +08:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(CeceLearningPortal.Api.DTOs.LoginDto) on controller CeceLearningPortal.Api.Controllers.AuthController (CeceLearningPortal.Api).
2025-07-30 17:41:21.508 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__normalizedEmail_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."NormalizedEmail" = @__normalizedEmail_0
LIMIT 2
2025-07-30 17:41:21.558 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@p1='?', @p2='?', @p0='?' (DbType = DateTime), @p3='?' (DbType = DateTime), @p4='?', @p5='?' (DbType = DateTime), @p6='?', @p7='?' (DbType = DateTime), @p8='?', @p9='?', @p10='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE "AspNetUsers" SET "LastLoginAt" = @p0
WHERE "Id" = @p1 AND "ConcurrencyStamp" = @p2;
INSERT INTO "RefreshTokens" ("CreatedAt", "CreatedByIp", "ExpiresAt", "ReplacedByToken", "RevokedAt", "RevokedByIp", "Token", "UserId")
VALUES (@p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10)
RETURNING "Id";
2025-07-30 17:41:21.559 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.AuthResponseDto'.
2025-07-30 17:41:21.559 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AuthController.Login (CeceLearningPortal.Api) in 52.048ms
2025-07-30 17:41:21.559 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AuthController.Login (CeceLearningPortal.Api)'
2025-07-30 17:41:21.559 +08:00 [INF] Request finished HTTP/1.1 POST http://localhost:5295/api/auth/login - 200 null application/json; charset=utf-8 52.6191ms
2025-07-30 17:41:21.572 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/platform - null null
2025-07-30 17:41:21.572 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:41:21.572 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/platform - 204 null null 0.2618ms
2025-07-30 17:41:21.573 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/courses - null null
2025-07-30 17:41:21.573 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:41:21.573 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/courses - 204 null null 0.1348ms
2025-07-30 17:41:21.574 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/platform - application/json null
2025-07-30 17:41:21.574 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:41:21.574 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses - application/json null
2025-07-30 17:41:21.575 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:41:21.576 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:41:21.576 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-07-30 17:41:21.576 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-07-30 17:41:21.576 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:41:21.576 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/platform - 403 0 null 1.9166ms
2025-07-30 17:41:21.576 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-30 17:41:21.576 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-30 17:41:21.578 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0."Category", c0."CourseType", c0."CreatedAt", c0."Currency", c0."Description", c0."Discount", c0."DripContent", c0."DripScheduleJson", c0."Duration", c0."EnrollmentLimit", c0."EnrollmentType", c0."Features", c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0."InstructorId", c0."IsBestseller", c0."IsPublished", c0."Language", c0."Level", c0."OriginalPrice", c0."PaymentPlanDetailsJson", c0."PreviewUrl", c0."Price", c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0."Status", c0."SubscriptionPeriod", c0."Thumbnail", c0."ThumbnailUrl", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."IsFlagged", r."Rating", r."Status", r."StudentId", e."Id", e."AverageQuizScore", e."CertificateIssued", e."CertificateUrl", e."CompletedAt", e."CompletedLessons", e."CourseId", e."EnrolledAt", e."LastAccessedDate", e."ProgressPercentage", e."QuizCount", e."StudentId", e."TotalTimeSpent"
FROM (
    SELECT c."Id", c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c."Category", c."CourseType", c."CreatedAt", c."Currency", c."Description", c."Discount", c."DripContent", c."DripScheduleJson", c."Duration", c."EnrollmentLimit", c."EnrollmentType", c."Features", c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c."InstructorId", c."IsBestseller", c."IsPublished", c."Language", c."Level", c."OriginalPrice", c."PaymentPlanDetailsJson", c."PreviewUrl", c."Price", c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c."Status", c."SubscriptionPeriod", c."Thumbnail", c."ThumbnailUrl", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-30 17:41:21.580 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-30 17:41:21.580 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 3.8928ms
2025-07-30 17:41:21.580 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-30 17:41:21.580 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses - 200 null application/json; charset=utf-8 5.6823ms
2025-07-30 17:41:21.582 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/users/b9030b04-2da7-449f-94de-d6d4814a8177/instructor-stats - null null
2025-07-30 17:41:21.582 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:41:21.582 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/users/b9030b04-2da7-449f-94de-d6d4814a8177/instructor-stats - 204 null null 0.1768ms
2025-07-30 17:41:21.583 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/users/b9030b04-2da7-449f-94de-d6d4814a8177/instructor-stats - application/json null
2025-07-30 17:41:21.583 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:41:21.584 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:41:21.585 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/users/b9030b04-2da7-449f-94de-d6d4814a8177/instructor-stats - 404 0 null 1.7079ms
2025-07-30 17:41:21.585 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5295/api/users/b9030b04-2da7-449f-94de-d6d4814a8177/instructor-stats, Response status code: 404
2025-07-30 17:41:21.588 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/courses?instructorId=b9030b04-2da7-449f-94de-d6d4814a8177 - null null
2025-07-30 17:41:21.588 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:41:21.588 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/courses?instructorId=b9030b04-2da7-449f-94de-d6d4814a8177 - 204 null null 0.1383ms
2025-07-30 17:41:21.588 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses?instructorId=b9030b04-2da7-449f-94de-d6d4814a8177 - application/json null
2025-07-30 17:41:21.589 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:41:21.590 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:41:21.590 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-30 17:41:21.590 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-30 17:41:21.592 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0."Category", c0."CourseType", c0."CreatedAt", c0."Currency", c0."Description", c0."Discount", c0."DripContent", c0."DripScheduleJson", c0."Duration", c0."EnrollmentLimit", c0."EnrollmentType", c0."Features", c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0."InstructorId", c0."IsBestseller", c0."IsPublished", c0."Language", c0."Level", c0."OriginalPrice", c0."PaymentPlanDetailsJson", c0."PreviewUrl", c0."Price", c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0."Status", c0."SubscriptionPeriod", c0."Thumbnail", c0."ThumbnailUrl", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."IsFlagged", r."Rating", r."Status", r."StudentId", e."Id", e."AverageQuizScore", e."CertificateIssued", e."CertificateUrl", e."CompletedAt", e."CompletedLessons", e."CourseId", e."EnrolledAt", e."LastAccessedDate", e."ProgressPercentage", e."QuizCount", e."StudentId", e."TotalTimeSpent"
FROM (
    SELECT c."Id", c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c."Category", c."CourseType", c."CreatedAt", c."Currency", c."Description", c."Discount", c."DripContent", c."DripScheduleJson", c."Duration", c."EnrollmentLimit", c."EnrollmentType", c."Features", c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c."InstructorId", c."IsBestseller", c."IsPublished", c."Language", c."Level", c."OriginalPrice", c."PaymentPlanDetailsJson", c."PreviewUrl", c."Price", c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c."Status", c."SubscriptionPeriod", c."Thumbnail", c."ThumbnailUrl", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-30 17:41:21.593 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-30 17:41:21.594 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 3.6534ms
2025-07-30 17:41:21.594 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-30 17:41:21.594 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses?instructorId=b9030b04-2da7-449f-94de-d6d4814a8177 - 200 null application/json; charset=utf-8 5.2432ms
2025-07-30 17:41:23.008 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users - null null
2025-07-30 17:41:23.008 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:41:23.008 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/users - 204 null null 0.2288ms
2025-07-30 17:41:23.009 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/users - application/json null
2025-07-30 17:41:23.009 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:41:23.010 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:41:23.010 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-07-30 17:41:23.011 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-07-30 17:41:23.011 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/users - 403 0 null 1.4971ms
2025-07-30 17:41:23.012 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses - application/json null
2025-07-30 17:41:23.012 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:41:23.013 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:41:23.013 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-30 17:41:23.013 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-30 17:41:23.015 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0."Category", c0."CourseType", c0."CreatedAt", c0."Currency", c0."Description", c0."Discount", c0."DripContent", c0."DripScheduleJson", c0."Duration", c0."EnrollmentLimit", c0."EnrollmentType", c0."Features", c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0."InstructorId", c0."IsBestseller", c0."IsPublished", c0."Language", c0."Level", c0."OriginalPrice", c0."PaymentPlanDetailsJson", c0."PreviewUrl", c0."Price", c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0."Status", c0."SubscriptionPeriod", c0."Thumbnail", c0."ThumbnailUrl", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."IsFlagged", r."Rating", r."Status", r."StudentId", e."Id", e."AverageQuizScore", e."CertificateIssued", e."CertificateUrl", e."CompletedAt", e."CompletedLessons", e."CourseId", e."EnrolledAt", e."LastAccessedDate", e."ProgressPercentage", e."QuizCount", e."StudentId", e."TotalTimeSpent"
FROM (
    SELECT c."Id", c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c."Category", c."CourseType", c."CreatedAt", c."Currency", c."Description", c."Discount", c."DripContent", c."DripScheduleJson", c."Duration", c."EnrollmentLimit", c."EnrollmentType", c."Features", c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c."InstructorId", c."IsBestseller", c."IsPublished", c."Language", c."Level", c."OriginalPrice", c."PaymentPlanDetailsJson", c."PreviewUrl", c."Price", c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c."Status", c."SubscriptionPeriod", c."Thumbnail", c."ThumbnailUrl", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-30 17:41:23.016 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-30 17:41:23.016 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 3.5031ms
2025-07-30 17:41:23.017 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-30 17:41:23.017 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses - 200 null application/json; charset=utf-8 4.8392ms
2025-07-30 17:41:23.018 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/platform - application/json null
2025-07-30 17:41:23.018 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:41:23.020 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:41:23.020 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-07-30 17:41:23.020 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-07-30 17:41:23.020 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/platform - 403 0 null 1.8771ms
2025-07-30 17:41:23.022 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/platform - application/json null
2025-07-30 17:41:23.022 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:41:23.022 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/instructor/b9030b04-2da7-449f-94de-d6d4814a8177 - null null
2025-07-30 17:41:23.023 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:41:23.023 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/instructor/b9030b04-2da7-449f-94de-d6d4814a8177 - 204 null null 0.1483ms
2025-07-30 17:41:23.023 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:41:23.023 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/revenue/instructor/b9030b04-2da7-449f-94de-d6d4814a8177 - null null
2025-07-30 17:41:23.023 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-07-30 17:41:23.023 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:41:23.023 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-07-30 17:41:23.024 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/revenue/instructor/b9030b04-2da7-449f-94de-d6d4814a8177 - 204 null null 0.1369ms
2025-07-30 17:41:23.024 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/b9030b04-2da7-449f-94de-d6d4814a8177 - application/json null
2025-07-30 17:41:23.024 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/platform - 403 0 null 1.8305ms
2025-07-30 17:41:23.024 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:41:23.024 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/revenue/instructor/b9030b04-2da7-449f-94de-d6d4814a8177 - application/json null
2025-07-30 17:41:23.024 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:41:23.025 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:41:23.025 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-30 17:41:23.025 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:41:23.025 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-30 17:41:23.025 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-07-30 17:41:23.025 +08:00 [INF] Route matched with {action = "GetInstructorRevenue", controller = "Revenue"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorRevenue(System.String) on controller CeceLearningPortal.Api.Controllers.RevenueController (CeceLearningPortal.Api).
2025-07-30 17:41:23.026 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."Id" = @__p_0
LIMIT 1
2025-07-30 17:41:23.026 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c."Category", c."CourseType", c."CreatedAt", c."Currency", c."Description", c."Discount", c."DripContent", c."DripScheduleJson", c."Duration", c."EnrollmentLimit", c."EnrollmentType", c."Features", c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c."InstructorId", c."IsBestseller", c."IsPublished", c."Language", c."Level", c."OriginalPrice", c."PaymentPlanDetailsJson", c."PreviewUrl", c."Price", c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c."Status", c."SubscriptionPeriod", c."Thumbnail", c."ThumbnailUrl", c."Title", c."UpdatedAt"
FROM "Courses" AS c
WHERE c."InstructorId" = @__instructorId_0
2025-07-30 17:41:23.026 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.InstructorRevenueDto'.
2025-07-30 17:41:23.026 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api) in 1.2485ms
2025-07-30 17:41:23.026 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c."Category", c."CourseType", c."CreatedAt", c."Currency", c."Description", c."Discount", c."DripContent", c."DripScheduleJson", c."Duration", c."EnrollmentLimit", c."EnrollmentType", c."Features", c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c."InstructorId", c."IsBestseller", c."IsPublished", c."Language", c."Level", c."OriginalPrice", c."PaymentPlanDetailsJson", c."PreviewUrl", c."Price", c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c."Status", c."SubscriptionPeriod", c."Thumbnail", c."ThumbnailUrl", c."Title", c."UpdatedAt", s."Id", s."AverageQuizScore", s."CertificateIssued", s."CertificateUrl", s."CompletedAt", s."CompletedLessons", s."CourseId", s."EnrolledAt", s."LastAccessedDate", s."ProgressPercentage", s."QuizCount", s."StudentId", s."TotalTimeSpent", s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."IsFlagged", r."Rating", r."Status", r."StudentId"
FROM "Courses" AS c
LEFT JOIN (
    SELECT e."Id", e."AverageQuizScore", e."CertificateIssued", e."CertificateUrl", e."CompletedAt", e."CompletedLessons", e."CourseId", e."EnrolledAt", e."LastAccessedDate", e."ProgressPercentage", e."QuizCount", e."StudentId", e."TotalTimeSpent", a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM "Enrollments" AS e
    INNER JOIN "AspNetUsers" AS a ON e."StudentId" = a."Id"
) AS s ON c."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c."Id" = r."CourseId"
WHERE c."InstructorId" = @__instructorId_0
ORDER BY c."Id", s."Id", s."Id0"
2025-07-30 17:41:23.026 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-07-30 17:41:23.027 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/revenue/instructor/b9030b04-2da7-449f-94de-d6d4814a8177 - 200 null application/json; charset=utf-8 2.2764ms
2025-07-30 17:41:23.027 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed'
2025-07-30 17:41:23.027 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__twelveMonthsAgo_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Year", s."Month", COALESCE(sum(s."Amount"), 0.0) AS "Revenue"
FROM (
    SELECT p."Amount", date_part('year', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed' AND p."CreatedAt" >= @__twelveMonthsAgo_1
) AS s
GROUP BY s."Year", s."Month"
ORDER BY s."Year", s."Month"
2025-07-30 17:41:23.028 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."EnrolledAt"
FROM (
    SELECT e."EnrolledAt", e."StudentId", c."Title"
    FROM "Enrollments" AS e
    INNER JOIN "Courses" AS c ON e."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY e."EnrolledAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."EnrolledAt" DESC
2025-07-30 17:41:23.029 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."CreatedAt", s."Rating"
FROM (
    SELECT r."CreatedAt", r."Rating", r."StudentId", c."Title"
    FROM "Reviews" AS r
    INNER JOIN "Courses" AS c ON r."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY r."CreatedAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."CreatedAt" DESC
2025-07-30 17:41:23.029 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType18`5[[<>f__AnonymousType19`6[[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 17:41:23.029 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 3.8855ms
2025-07-30 17:41:23.029 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-30 17:41:23.029 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/b9030b04-2da7-449f-94de-d6d4814a8177 - 200 null application/json; charset=utf-8 5.1789ms
2025-07-30 17:41:29.934 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/instructor/b9030b04-2da7-449f-94de-d6d4814a8177 - null null
2025-07-30 17:41:29.934 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:41:29.934 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/instructor/b9030b04-2da7-449f-94de-d6d4814a8177 - 204 null null 0.2856ms
2025-07-30 17:41:29.935 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/b9030b04-2da7-449f-94de-d6d4814a8177 - application/json null
2025-07-30 17:41:29.935 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:41:29.937 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:41:29.937 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-30 17:41:29.938 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-30 17:41:29.939 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c."Category", c."CourseType", c."CreatedAt", c."Currency", c."Description", c."Discount", c."DripContent", c."DripScheduleJson", c."Duration", c."EnrollmentLimit", c."EnrollmentType", c."Features", c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c."InstructorId", c."IsBestseller", c."IsPublished", c."Language", c."Level", c."OriginalPrice", c."PaymentPlanDetailsJson", c."PreviewUrl", c."Price", c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c."Status", c."SubscriptionPeriod", c."Thumbnail", c."ThumbnailUrl", c."Title", c."UpdatedAt", s."Id", s."AverageQuizScore", s."CertificateIssued", s."CertificateUrl", s."CompletedAt", s."CompletedLessons", s."CourseId", s."EnrolledAt", s."LastAccessedDate", s."ProgressPercentage", s."QuizCount", s."StudentId", s."TotalTimeSpent", s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."IsFlagged", r."Rating", r."Status", r."StudentId"
FROM "Courses" AS c
LEFT JOIN (
    SELECT e."Id", e."AverageQuizScore", e."CertificateIssued", e."CertificateUrl", e."CompletedAt", e."CompletedLessons", e."CourseId", e."EnrolledAt", e."LastAccessedDate", e."ProgressPercentage", e."QuizCount", e."StudentId", e."TotalTimeSpent", a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM "Enrollments" AS e
    INNER JOIN "AspNetUsers" AS a ON e."StudentId" = a."Id"
) AS s ON c."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c."Id" = r."CourseId"
WHERE c."InstructorId" = @__instructorId_0
ORDER BY c."Id", s."Id", s."Id0"
2025-07-30 17:41:29.940 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed'
2025-07-30 17:41:29.941 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?', @__twelveMonthsAgo_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Year", s."Month", COALESCE(sum(s."Amount"), 0.0) AS "Revenue"
FROM (
    SELECT p."Amount", date_part('year', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed' AND p."CreatedAt" >= @__twelveMonthsAgo_1
) AS s
GROUP BY s."Year", s."Month"
ORDER BY s."Year", s."Month"
2025-07-30 17:41:29.942 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."EnrolledAt"
FROM (
    SELECT e."EnrolledAt", e."StudentId", c."Title"
    FROM "Enrollments" AS e
    INNER JOIN "Courses" AS c ON e."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY e."EnrolledAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."EnrolledAt" DESC
2025-07-30 17:41:29.943 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."CreatedAt", s."Rating"
FROM (
    SELECT r."CreatedAt", r."Rating", r."StudentId", c."Title"
    FROM "Reviews" AS r
    INNER JOIN "Courses" AS c ON r."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY r."CreatedAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."CreatedAt" DESC
2025-07-30 17:41:29.943 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType18`5[[<>f__AnonymousType19`6[[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 17:41:29.943 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 5.308ms
2025-07-30 17:41:29.943 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-30 17:41:29.943 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/b9030b04-2da7-449f-94de-d6d4814a8177 - 200 null application/json; charset=utf-8 8.0097ms
2025-07-30 17:41:30.964 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/revenue/instructor/b9030b04-2da7-449f-94de-d6d4814a8177 - null null
2025-07-30 17:41:30.964 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:41:30.965 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/revenue/instructor/b9030b04-2da7-449f-94de-d6d4814a8177 - 204 null null 0.2309ms
2025-07-30 17:41:30.965 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/revenue/instructor/b9030b04-2da7-449f-94de-d6d4814a8177 - application/json null
2025-07-30 17:41:30.966 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:41:30.967 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:41:30.967 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-07-30 17:41:30.967 +08:00 [INF] Route matched with {action = "GetInstructorRevenue", controller = "Revenue"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorRevenue(System.String) on controller CeceLearningPortal.Api.Controllers.RevenueController (CeceLearningPortal.Api).
2025-07-30 17:41:30.968 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."Id" = @__p_0
LIMIT 1
2025-07-30 17:41:30.968 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c."Category", c."CourseType", c."CreatedAt", c."Currency", c."Description", c."Discount", c."DripContent", c."DripScheduleJson", c."Duration", c."EnrollmentLimit", c."EnrollmentType", c."Features", c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c."InstructorId", c."IsBestseller", c."IsPublished", c."Language", c."Level", c."OriginalPrice", c."PaymentPlanDetailsJson", c."PreviewUrl", c."Price", c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c."Status", c."SubscriptionPeriod", c."Thumbnail", c."ThumbnailUrl", c."Title", c."UpdatedAt"
FROM "Courses" AS c
WHERE c."InstructorId" = @__instructorId_0
2025-07-30 17:41:30.969 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.InstructorRevenueDto'.
2025-07-30 17:41:30.969 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api) in 1.6018ms
2025-07-30 17:41:30.969 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-07-30 17:41:30.969 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/revenue/instructor/b9030b04-2da7-449f-94de-d6d4814a8177 - 200 null application/json; charset=utf-8 3.2826ms
2025-07-30 17:41:30.970 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/b9030b04-2da7-449f-94de-d6d4814a8177 - application/json null
2025-07-30 17:41:30.970 +08:00 [INF] CORS policy execution successful.
2025-07-30 17:41:30.971 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-30 17:41:30.971 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-30 17:41:30.971 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-30 17:41:30.972 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c."Category", c."CourseType", c."CreatedAt", c."Currency", c."Description", c."Discount", c."DripContent", c."DripScheduleJson", c."Duration", c."EnrollmentLimit", c."EnrollmentType", c."Features", c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c."InstructorId", c."IsBestseller", c."IsPublished", c."Language", c."Level", c."OriginalPrice", c."PaymentPlanDetailsJson", c."PreviewUrl", c."Price", c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c."Status", c."SubscriptionPeriod", c."Thumbnail", c."ThumbnailUrl", c."Title", c."UpdatedAt", s."Id", s."AverageQuizScore", s."CertificateIssued", s."CertificateUrl", s."CompletedAt", s."CompletedLessons", s."CourseId", s."EnrolledAt", s."LastAccessedDate", s."ProgressPercentage", s."QuizCount", s."StudentId", s."TotalTimeSpent", s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."IsFlagged", r."Rating", r."Status", r."StudentId"
FROM "Courses" AS c
LEFT JOIN (
    SELECT e."Id", e."AverageQuizScore", e."CertificateIssued", e."CertificateUrl", e."CompletedAt", e."CompletedLessons", e."CourseId", e."EnrolledAt", e."LastAccessedDate", e."ProgressPercentage", e."QuizCount", e."StudentId", e."TotalTimeSpent", a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM "Enrollments" AS e
    INNER JOIN "AspNetUsers" AS a ON e."StudentId" = a."Id"
) AS s ON c."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c."Id" = r."CourseId"
WHERE c."InstructorId" = @__instructorId_0
ORDER BY c."Id", s."Id", s."Id0"
2025-07-30 17:41:30.973 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed'
2025-07-30 17:41:30.974 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__twelveMonthsAgo_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Year", s."Month", COALESCE(sum(s."Amount"), 0.0) AS "Revenue"
FROM (
    SELECT p."Amount", date_part('year', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed' AND p."CreatedAt" >= @__twelveMonthsAgo_1
) AS s
GROUP BY s."Year", s."Month"
ORDER BY s."Year", s."Month"
2025-07-30 17:41:30.974 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."EnrolledAt"
FROM (
    SELECT e."EnrolledAt", e."StudentId", c."Title"
    FROM "Enrollments" AS e
    INNER JOIN "Courses" AS c ON e."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY e."EnrolledAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."EnrolledAt" DESC
2025-07-30 17:41:30.975 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."CreatedAt", s."Rating"
FROM (
    SELECT r."CreatedAt", r."Rating", r."StudentId", c."Title"
    FROM "Reviews" AS r
    INNER JOIN "Courses" AS c ON r."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY r."CreatedAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."CreatedAt" DESC
2025-07-30 17:41:30.975 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType18`5[[<>f__AnonymousType19`6[[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-30 17:41:30.975 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 3.7433ms
2025-07-30 17:41:30.975 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-30 17:41:30.975 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/b9030b04-2da7-449f-94de-d6d4814a8177 - 200 null application/json; charset=utf-8 4.7832ms
