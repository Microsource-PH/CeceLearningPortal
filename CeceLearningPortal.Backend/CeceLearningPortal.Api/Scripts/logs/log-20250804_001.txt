2025-08-04 11:04:58.855 +08:00 [INF] Checking database connection...
2025-08-04 11:04:59.479 +08:00 [INF] Database connection successful.
2025-08-04 11:04:59.480 +08:00 [INF] Attempting to apply migrations...
2025-08-04 11:04:59.672 +08:00 [INF] Executed DbCommand (11ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-08-04 11:04:59.892 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE IF NOT EXISTS "__EFMigrationsHistory" (
    "MigrationId" character varying(150) NOT NULL,
    "ProductVersion" character varying(32) NOT NULL,
    CONSTRAINT "PK___EFMigrationsHistory" PRIMARY KEY ("MigrationId")
);
2025-08-04 11:04:59.901 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
LOCK TABLE "__EFMigrationsHistory" IN ACCESS EXCLUSIVE MODE
2025-08-04 11:04:59.903 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-08-04 11:04:59.907 +08:00 [INF] No migrations were applied. The database is already up to date.
2025-08-04 11:04:59.913 +08:00 [INF] Migrations applied successfully.
2025-08-04 11:04:59.913 +08:00 [INF] Starting data seeding...
2025-08-04 11:04:59.927 +08:00 [INF] User profile is available. Using 'C:\Users\User\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-08-04 11:05:00.038 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM courses AS c)
2025-08-04 11:05:00.041 +08:00 [INF] Database already contains data. Checking if data cleanup is needed...
2025-08-04 11:05:00.041 +08:00 [INF] Skipping seed as data already exists. Set FORCE_RESEED=true to force reseeding.
2025-08-04 11:05:00.042 +08:00 [INF] Data seeding completed.
2025-08-04 11:05:00.084 +08:00 [ERR] Hosting failed to start
System.IO.IOException: Failed to bind to address http://127.0.0.1:5294: address already in use.
 ---> Microsoft.AspNetCore.Connections.AddressInUseException: Only one usage of each socket address (protocol/network address/port) is normally permitted.
 ---> System.Net.Sockets.SocketException (10048): Only one usage of each socket address (protocol/network address/port) is normally permitted.
   at System.Net.Sockets.Socket.UpdateStatusAfterSocketErrorAndThrowException(SocketError error, Boolean disconnectOnFailure, String callerName)
   at System.Net.Sockets.Socket.DoBind(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Bind(EndPoint localEP)
   at Microsoft.AspNetCore.Server.Kestrel.Transport.Sockets.SocketTransportOptions.CreateDefaultBoundListenSocket(EndPoint endpoint)
   at Microsoft.AspNetCore.Server.Kestrel.Transport.Sockets.SocketConnectionListener.Bind()
   --- End of inner exception stack trace ---
   at Microsoft.AspNetCore.Server.Kestrel.Transport.Sockets.SocketConnectionListener.Bind()
   at Microsoft.AspNetCore.Server.Kestrel.Transport.Sockets.SocketTransportFactory.BindAsync(EndPoint endpoint, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Infrastructure.TransportManager.BindAsync(EndPoint endPoint, ConnectionDelegate connectionDelegate, EndpointConfig endpointConfig, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Core.KestrelServerImpl.<>c__DisplayClass28_0`1.<<StartAsync>g__OnBind|0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.AddressBinder.BindEndpointAsync(ListenOptions endpoint, AddressBindContext context, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.AddressBinder.BindEndpointAsync(ListenOptions endpoint, AddressBindContext context, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Core.LocalhostListenOptions.BindAsync(AddressBindContext context, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.AddressBinder.AddressesStrategy.BindAsync(AddressBindContext context, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Core.KestrelServerImpl.BindAsync(CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Core.KestrelServerImpl.StartAsync[TContext](IHttpApplication`1 application, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Hosting.GenericWebHostService.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.Internal.Host.<StartAsync>b__14_1(IHostedService service, CancellationToken token)
   at Microsoft.Extensions.Hosting.Internal.Host.ForeachService[T](IEnumerable`1 services, CancellationToken token, Boolean concurrent, Boolean abortOnFirstException, List`1 exceptions, Func`3 operation)
2025-08-04 11:05:00.095 +08:00 [FTL] Application start-up failed
System.IO.IOException: Failed to bind to address http://127.0.0.1:5294: address already in use.
 ---> Microsoft.AspNetCore.Connections.AddressInUseException: Only one usage of each socket address (protocol/network address/port) is normally permitted.
 ---> System.Net.Sockets.SocketException (10048): Only one usage of each socket address (protocol/network address/port) is normally permitted.
   at System.Net.Sockets.Socket.UpdateStatusAfterSocketErrorAndThrowException(SocketError error, Boolean disconnectOnFailure, String callerName)
   at System.Net.Sockets.Socket.DoBind(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Bind(EndPoint localEP)
   at Microsoft.AspNetCore.Server.Kestrel.Transport.Sockets.SocketTransportOptions.CreateDefaultBoundListenSocket(EndPoint endpoint)
   at Microsoft.AspNetCore.Server.Kestrel.Transport.Sockets.SocketConnectionListener.Bind()
   --- End of inner exception stack trace ---
   at Microsoft.AspNetCore.Server.Kestrel.Transport.Sockets.SocketConnectionListener.Bind()
   at Microsoft.AspNetCore.Server.Kestrel.Transport.Sockets.SocketTransportFactory.BindAsync(EndPoint endpoint, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Infrastructure.TransportManager.BindAsync(EndPoint endPoint, ConnectionDelegate connectionDelegate, EndpointConfig endpointConfig, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Core.KestrelServerImpl.<>c__DisplayClass28_0`1.<<StartAsync>g__OnBind|0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.AddressBinder.BindEndpointAsync(ListenOptions endpoint, AddressBindContext context, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.AddressBinder.BindEndpointAsync(ListenOptions endpoint, AddressBindContext context, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Core.LocalhostListenOptions.BindAsync(AddressBindContext context, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.AddressBinder.AddressesStrategy.BindAsync(AddressBindContext context, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Core.KestrelServerImpl.BindAsync(CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Core.KestrelServerImpl.StartAsync[TContext](IHttpApplication`1 application, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Hosting.GenericWebHostService.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.Internal.Host.<StartAsync>b__14_1(IHostedService service, CancellationToken token)
   at Microsoft.Extensions.Hosting.Internal.Host.ForeachService[T](IEnumerable`1 services, CancellationToken token, Boolean concurrent, Boolean abortOnFirstException, List`1 exceptions, Func`3 operation)
   at Microsoft.Extensions.Hosting.Internal.Host.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.RunAsync(IHost host, CancellationToken token)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.RunAsync(IHost host, CancellationToken token)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.Run(IHost host)
   at Program.<Main>$(String[] args) in D:\Cece\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Program.cs:line 253
2025-08-04 11:05:51.402 +08:00 [INF] Checking database connection...
2025-08-04 11:05:52.013 +08:00 [INF] Database connection successful.
2025-08-04 11:05:52.014 +08:00 [INF] Attempting to apply migrations...
2025-08-04 11:05:52.095 +08:00 [INF] Executed DbCommand (11ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-08-04 11:05:52.308 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE IF NOT EXISTS "__EFMigrationsHistory" (
    "MigrationId" character varying(150) NOT NULL,
    "ProductVersion" character varying(32) NOT NULL,
    CONSTRAINT "PK___EFMigrationsHistory" PRIMARY KEY ("MigrationId")
);
2025-08-04 11:05:52.317 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
LOCK TABLE "__EFMigrationsHistory" IN ACCESS EXCLUSIVE MODE
2025-08-04 11:05:52.319 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-08-04 11:05:52.323 +08:00 [INF] No migrations were applied. The database is already up to date.
2025-08-04 11:05:52.329 +08:00 [INF] Migrations applied successfully.
2025-08-04 11:05:52.329 +08:00 [INF] Starting data seeding...
2025-08-04 11:05:52.343 +08:00 [INF] User profile is available. Using 'C:\Users\User\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-08-04 11:05:52.450 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM courses AS c)
2025-08-04 11:05:52.453 +08:00 [INF] Database already contains data. Checking if data cleanup is needed...
2025-08-04 11:05:52.454 +08:00 [INF] Skipping seed as data already exists. Set FORCE_RESEED=true to force reseeding.
2025-08-04 11:05:52.454 +08:00 [INF] Data seeding completed.
2025-08-04 11:05:52.496 +08:00 [INF] Now listening on: http://localhost:5294
2025-08-04 11:05:52.497 +08:00 [INF] Application started. Press Ctrl+C to shut down.
2025-08-04 11:05:52.498 +08:00 [INF] Hosting environment: Development
2025-08-04 11:05:52.498 +08:00 [INF] Content root path: D:\Cece\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api
2025-08-04 11:06:14.426 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/analytics/platform - null null
2025-08-04 11:06:14.426 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/courses - null null
2025-08-04 11:06:14.451 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/courses - null null
2025-08-04 11:06:14.456 +08:00 [WRN] Failed to determine the https port for redirect.
2025-08-04 11:06:14.457 +08:00 [INF] CORS policy execution successful.
2025-08-04 11:06:14.457 +08:00 [INF] CORS policy execution successful.
2025-08-04 11:06:14.457 +08:00 [INF] CORS policy execution successful.
2025-08-04 11:06:14.461 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/courses - 204 null null 36.0053ms
2025-08-04 11:06:14.461 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/analytics/platform - 204 null null 36.0082ms
2025-08-04 11:06:14.461 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/courses - 204 null null 9.4248ms
2025-08-04 11:06:14.465 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/analytics/platform - application/json null
2025-08-04 11:06:14.466 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/courses - application/json null
2025-08-04 11:06:14.472 +08:00 [INF] CORS policy execution successful.
2025-08-04 11:06:14.472 +08:00 [INF] CORS policy execution successful.
2025-08-04 11:06:14.495 +08:00 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-08-04 11:06:14.497 +08:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-08-04 11:06:14.498 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/analytics/platform - 401 0 null 33.0296ms
2025-08-04 11:06:14.516 +08:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '8/4/2025 2:44:56 AM', Current time (UTC): '8/4/2025 3:06:14 AM'.
   at Microsoft.IdentityModel.Tokens.ValidatorUtilities.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2025-08-04 11:06:14.525 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '8/4/2025 2:44:56 AM', Current time (UTC): '8/4/2025 3:06:14 AM'.
2025-08-04 11:06:14.526 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '8/4/2025 2:44:56 AM', Current time (UTC): '8/4/2025 3:06:14 AM'.
2025-08-04 11:06:14.586 +08:00 [INF] Executed DbCommand (6ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-04 11:06:14.588 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-08-04 11:06:14.599 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-08-04 11:06:14.715 +08:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2025-08-04 11:06:14.753 +08:00 [INF] Executed DbCommand (6ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-08-04 11:06:14.936 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-08-04 11:06:14.957 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/courses - application/json null
2025-08-04 11:06:14.958 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 355.7755ms
2025-08-04 11:06:14.959 +08:00 [INF] CORS policy execution successful.
2025-08-04 11:06:14.959 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-08-04 11:06:14.961 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-08-04 11:06:14.961 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-08-04 11:06:14.962 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/courses - 200 null application/json; charset=utf-8 496.3827ms
2025-08-04 11:06:14.964 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/users/bee889a2-efca-471d-807c-a7674a945612/instructor-stats - null null
2025-08-04 11:06:14.965 +08:00 [INF] CORS policy execution successful.
2025-08-04 11:06:14.966 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/users/bee889a2-efca-471d-807c-a7674a945612/instructor-stats - 204 null null 1.9029ms
2025-08-04 11:06:14.968 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-08-04 11:06:14.968 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/users/bee889a2-efca-471d-807c-a7674a945612/instructor-stats - application/json null
2025-08-04 11:06:14.972 +08:00 [INF] CORS policy execution successful.
2025-08-04 11:06:14.973 +08:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '8/4/2025 2:44:56 AM', Current time (UTC): '8/4/2025 3:06:14 AM'.
   at Microsoft.IdentityModel.Tokens.ValidatorUtilities.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2025-08-04 11:06:14.974 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-08-04 11:06:14.974 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '8/4/2025 2:44:56 AM', Current time (UTC): '8/4/2025 3:06:14 AM'.
2025-08-04 11:06:14.975 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 12.3689ms
2025-08-04 11:06:14.975 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '8/4/2025 2:44:56 AM', Current time (UTC): '8/4/2025 3:06:14 AM'.
2025-08-04 11:06:14.976 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-08-04 11:06:14.977 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/courses - 200 null application/json; charset=utf-8 19.8082ms
2025-08-04 11:06:14.979 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-04 11:06:14.981 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/users/bee889a2-efca-471d-807c-a7674a945612/instructor-stats - 404 0 null 12.6005ms
2025-08-04 11:06:14.983 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5294/api/users/bee889a2-efca-471d-807c-a7674a945612/instructor-stats, Response status code: 404
2025-08-04 11:06:14.993 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/courses?instructorId=bee889a2-efca-471d-807c-a7674a945612 - null null
2025-08-04 11:06:14.995 +08:00 [INF] CORS policy execution successful.
2025-08-04 11:06:14.996 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/courses?instructorId=bee889a2-efca-471d-807c-a7674a945612 - 204 null null 2.2361ms
2025-08-04 11:06:14.998 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/courses?instructorId=bee889a2-efca-471d-807c-a7674a945612 - application/json null
2025-08-04 11:06:14.999 +08:00 [INF] CORS policy execution successful.
2025-08-04 11:06:15.002 +08:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '8/4/2025 2:44:56 AM', Current time (UTC): '8/4/2025 3:06:15 AM'.
   at Microsoft.IdentityModel.Tokens.ValidatorUtilities.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2025-08-04 11:06:15.003 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '8/4/2025 2:44:56 AM', Current time (UTC): '8/4/2025 3:06:15 AM'.
2025-08-04 11:06:15.004 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '8/4/2025 2:44:56 AM', Current time (UTC): '8/4/2025 3:06:15 AM'.
2025-08-04 11:06:15.006 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-04 11:06:15.007 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-08-04 11:06:15.008 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-08-04 11:06:15.014 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-08-04 11:06:15.020 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-08-04 11:06:15.021 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 12.0888ms
2025-08-04 11:06:15.022 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-08-04 11:06:15.023 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/courses?instructorId=bee889a2-efca-471d-807c-a7674a945612 - 200 null application/json; charset=utf-8 24.8404ms
2025-08-04 11:06:16.477 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/courses - null null
2025-08-04 11:06:16.478 +08:00 [INF] CORS policy execution successful.
2025-08-04 11:06:16.479 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/courses - 204 null null 2.0044ms
2025-08-04 11:06:16.481 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/courses - application/json null
2025-08-04 11:06:16.482 +08:00 [INF] CORS policy execution successful.
2025-08-04 11:06:16.483 +08:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '8/4/2025 2:44:56 AM', Current time (UTC): '8/4/2025 3:06:16 AM'.
   at Microsoft.IdentityModel.Tokens.ValidatorUtilities.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2025-08-04 11:06:16.485 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '8/4/2025 2:44:56 AM', Current time (UTC): '8/4/2025 3:06:16 AM'.
2025-08-04 11:06:16.486 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '8/4/2025 2:44:56 AM', Current time (UTC): '8/4/2025 3:06:16 AM'.
2025-08-04 11:06:16.489 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-04 11:06:16.490 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-08-04 11:06:16.491 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-08-04 11:06:16.495 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-08-04 11:06:16.502 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-08-04 11:06:16.503 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 10.8488ms
2025-08-04 11:06:16.503 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-08-04 11:06:16.504 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/courses - 200 null application/json; charset=utf-8 23.1189ms
2025-08-04 11:06:16.505 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/analytics/platform - null null
2025-08-04 11:06:16.507 +08:00 [INF] CORS policy execution successful.
2025-08-04 11:06:16.507 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/analytics/platform - 204 null null 1.6093ms
2025-08-04 11:06:16.509 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/analytics/platform - application/json null
2025-08-04 11:06:16.510 +08:00 [INF] CORS policy execution successful.
2025-08-04 11:06:16.511 +08:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '8/4/2025 2:44:56 AM', Current time (UTC): '8/4/2025 3:06:16 AM'.
   at Microsoft.IdentityModel.Tokens.ValidatorUtilities.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2025-08-04 11:06:16.512 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '8/4/2025 2:44:56 AM', Current time (UTC): '8/4/2025 3:06:16 AM'.
2025-08-04 11:06:16.513 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '8/4/2025 2:44:56 AM', Current time (UTC): '8/4/2025 3:06:16 AM'.
2025-08-04 11:06:16.515 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-04 11:06:16.517 +08:00 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-08-04 11:06:16.519 +08:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-08-04 11:06:16.519 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/analytics/platform - 401 0 null 10.6758ms
2025-08-04 11:06:16.521 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/analytics/platform - application/json null
2025-08-04 11:06:16.522 +08:00 [INF] CORS policy execution successful.
2025-08-04 11:06:16.523 +08:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '8/4/2025 2:44:56 AM', Current time (UTC): '8/4/2025 3:06:16 AM'.
   at Microsoft.IdentityModel.Tokens.ValidatorUtilities.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2025-08-04 11:06:16.524 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - null null
2025-08-04 11:06:16.524 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - null null
2025-08-04 11:06:16.525 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '8/4/2025 2:44:56 AM', Current time (UTC): '8/4/2025 3:06:16 AM'.
2025-08-04 11:06:16.526 +08:00 [INF] CORS policy execution successful.
2025-08-04 11:06:16.527 +08:00 [INF] CORS policy execution successful.
2025-08-04 11:06:16.528 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '8/4/2025 2:44:56 AM', Current time (UTC): '8/4/2025 3:06:16 AM'.
2025-08-04 11:06:16.528 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - 204 null null 4.7384ms
2025-08-04 11:06:16.529 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - 204 null null 5.1356ms
2025-08-04 11:06:16.531 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - application/json null
2025-08-04 11:06:16.531 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-04 11:06:16.532 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - application/json null
2025-08-04 11:06:16.534 +08:00 [INF] CORS policy execution successful.
2025-08-04 11:06:16.535 +08:00 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-08-04 11:06:16.536 +08:00 [INF] CORS policy execution successful.
2025-08-04 11:06:16.536 +08:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '8/4/2025 2:44:56 AM', Current time (UTC): '8/4/2025 3:06:16 AM'.
   at Microsoft.IdentityModel.Tokens.ValidatorUtilities.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2025-08-04 11:06:16.537 +08:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-08-04 11:06:16.537 +08:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '8/4/2025 2:44:56 AM', Current time (UTC): '8/4/2025 3:06:16 AM'.
   at Microsoft.IdentityModel.Tokens.ValidatorUtilities.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2025-08-04 11:06:16.538 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '8/4/2025 2:44:56 AM', Current time (UTC): '8/4/2025 3:06:16 AM'.
2025-08-04 11:06:16.538 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/analytics/platform - 401 0 null 17.2406ms
2025-08-04 11:06:16.540 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '8/4/2025 2:44:56 AM', Current time (UTC): '8/4/2025 3:06:16 AM'.
2025-08-04 11:06:16.540 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '8/4/2025 2:44:56 AM', Current time (UTC): '8/4/2025 3:06:16 AM'.
2025-08-04 11:06:16.542 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '8/4/2025 2:44:56 AM', Current time (UTC): '8/4/2025 3:06:16 AM'.
2025-08-04 11:06:16.545 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-04 11:06:16.546 +08:00 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
2025-08-04 11:06:16.547 +08:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-08-04 11:06:16.548 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - 401 0 null 16.8479ms
2025-08-04 11:06:16.590 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-04 11:06:16.591 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-08-04 11:06:16.595 +08:00 [INF] Route matched with {action = "GetInstructorRevenue", controller = "Revenue"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorRevenue(System.String) on controller CeceLearningPortal.Api.Controllers.RevenueController (CeceLearningPortal.Api).
2025-08-04 11:06:16.612 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."Id" = @__p_0
LIMIT 1
2025-08-04 11:06:16.623 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
FROM courses AS c
WHERE c.instructor_id = @__instructorId_0
2025-08-04 11:06:16.635 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-04 11:06:16.645 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-04 11:06:16.650 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-04 11:06:16.653 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-04 11:06:16.654 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-04 11:06:16.656 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-04 11:06:16.657 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-04 11:06:16.659 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-04 11:06:16.660 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-04 11:06:16.662 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-04 11:06:16.664 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-04 11:06:16.665 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-04 11:06:16.667 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-04 11:06:16.668 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-04 11:06:16.670 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-04 11:06:16.671 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-04 11:06:16.673 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-04 11:06:16.674 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-04 11:06:16.675 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-04 11:06:16.677 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-04 11:06:16.679 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-04 11:06:16.680 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-04 11:06:16.681 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-04 11:06:16.683 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-04 11:06:16.684 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-04 11:06:16.686 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-04 11:06:16.687 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-04 11:06:16.689 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.InstructorRevenueDto'.
2025-08-04 11:06:16.693 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api) in 97.1315ms
2025-08-04 11:06:16.694 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-08-04 11:06:16.695 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - 200 null application/json; charset=utf-8 162.5368ms
2025-08-04 11:06:19.423 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/courses/33 - null null
2025-08-04 11:06:19.424 +08:00 [INF] CORS policy execution successful.
2025-08-04 11:06:19.425 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/courses/33 - 204 null null 2.3836ms
2025-08-04 11:06:19.426 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/courses/33 - application/json null
2025-08-04 11:06:19.428 +08:00 [INF] CORS policy execution successful.
2025-08-04 11:06:19.429 +08:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '8/4/2025 2:44:56 AM', Current time (UTC): '8/4/2025 3:06:19 AM'.
   at Microsoft.IdentityModel.Tokens.ValidatorUtilities.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2025-08-04 11:06:19.430 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '8/4/2025 2:44:56 AM', Current time (UTC): '8/4/2025 3:06:19 AM'.
2025-08-04 11:06:19.430 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '8/4/2025 2:44:56 AM', Current time (UTC): '8/4/2025 3:06:19 AM'.
2025-08-04 11:06:19.432 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-04 11:06:19.433 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourse (CeceLearningPortal.Api)'
2025-08-04 11:06:19.436 +08:00 [INF] Route matched with {action = "GetCourse", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourse(Int32) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-08-04 11:06:19.450 +08:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2025-08-04 11:06:19.477 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s.id, s."AccessDuration", s."AccessType", s."AutomationAbandonmentSequence", s."AutomationCompletionCertificate", s."AutomationProgressReminders", s."AutomationWelcomeEmail", s.category, s."CourseType", s.created_at, s."Currency", s.description, s.discount, s."DripContent", s."DripScheduleJson", s.duration, s."EnrollmentLimit", s.enrollment_type, s.features, s."HasAssignments", s."HasCertificate", s."HasCommunity", s."HasDownloadableResources", s."HasLiveSessions", s."HasQuizzes", s.instructor_id, s.is_bestseller, s."IsPublished", s."Language", s.level, s.original_price, s."PaymentPlanDetailsJson", s.preview_url, s.price, s."PricingModel", s."PromoVideoUrl", s."PublishedAt", s."ShortDescription", s.status, s."SubscriptionPeriod", s.thumbnail, s.thumbnail_url, s.title, s.updated_at, s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status0", s."TwoFactorEnabled", s."UserName", s0.id, s0.course_id, s0.created_at, s0.description, s0."order", s0.title, s0.updated_at, s0.id0, s0.content, s0.created_at0, s0.duration, s0.module_id, s0.order0, s0.title0, s0.type, s0.updated_at0, s0.video_url, s1.id, s1.approved_at, s1.approved_by, s1.comment, s1.course_id, s1.created_at, s1.is_flagged, s1.rating, s1.status, s1.student_id, s1."Id0", s1."AccessFailedCount", s1."Avatar", s1."ConcurrencyStamp", s1."CreatedAt", s1."Email", s1."EmailConfirmed", s1."FullName", s1."LastLoginAt", s1."LockoutEnabled", s1."LockoutEnd", s1."NormalizedEmail", s1."NormalizedUserName", s1."NotificationPreferences", s1."PasswordHash", s1."PhoneNumber", s1."PhoneNumberConfirmed", s1."RefreshToken", s1."RefreshTokenExpiryTime", s1."Role", s1."SecurityStamp", s1."Status0", s1."TwoFactorEnabled", s1."UserName", e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at, a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status" AS "Status0", a."TwoFactorEnabled", a."UserName"
    FROM courses AS c
    INNER JOIN "AspNetUsers" AS a ON c.instructor_id = a."Id"
    WHERE c.id = @__id_0
    LIMIT 1
) AS s
LEFT JOIN (
    SELECT c0.id, c0.course_id, c0.created_at, c0.description, c0."order", c0.title, c0.updated_at, c1.id AS id0, c1.content, c1.created_at AS created_at0, c1.duration, c1.module_id, c1."order" AS order0, c1.title AS title0, c1.type, c1.updated_at AS updated_at0, c1.video_url
    FROM course_modules AS c0
    LEFT JOIN course_lessons AS c1 ON c0.id = c1.module_id
) AS s0 ON s.id = s0.course_id
LEFT JOIN (
    SELECT c2.id, c2.approved_at, c2.approved_by, c2.comment, c2.course_id, c2.created_at, c2.is_flagged, c2.rating, c2.status, c2.student_id, a0."Id" AS "Id0", a0."AccessFailedCount", a0."Avatar", a0."ConcurrencyStamp", a0."CreatedAt", a0."Email", a0."EmailConfirmed", a0."FullName", a0."LastLoginAt", a0."LockoutEnabled", a0."LockoutEnd", a0."NormalizedEmail", a0."NormalizedUserName", a0."NotificationPreferences", a0."PasswordHash", a0."PhoneNumber", a0."PhoneNumberConfirmed", a0."RefreshToken", a0."RefreshTokenExpiryTime", a0."Role", a0."SecurityStamp", a0."Status" AS "Status0", a0."TwoFactorEnabled", a0."UserName"
    FROM course_reviews AS c2
    INNER JOIN "AspNetUsers" AS a0 ON c2.student_id = a0."Id"
) AS s1 ON s.id = s1.course_id
LEFT JOIN enrollments AS e ON s.id = e.course_id
ORDER BY s.id, s."Id0", s0.id, s0.id0, s1.id, s1."Id0"
2025-08-04 11:06:19.489 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.CourseDetailDto'.
2025-08-04 11:06:19.497 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourse (CeceLearningPortal.Api) in 59.6914ms
2025-08-04 11:06:19.497 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourse (CeceLearningPortal.Api)'
2025-08-04 11:06:19.498 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/courses/33 - 200 null application/json; charset=utf-8 71.4912ms
2025-08-04 11:06:19.499 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/enrollments - null null
2025-08-04 11:06:19.501 +08:00 [INF] CORS policy execution successful.
2025-08-04 11:06:19.501 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/enrollments - 204 null null 1.6212ms
2025-08-04 11:06:19.502 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/enrollments - application/json null
2025-08-04 11:06:19.504 +08:00 [INF] CORS policy execution successful.
2025-08-04 11:06:19.504 +08:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '8/4/2025 2:44:56 AM', Current time (UTC): '8/4/2025 3:06:19 AM'.
   at Microsoft.IdentityModel.Tokens.ValidatorUtilities.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2025-08-04 11:06:19.505 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '8/4/2025 2:44:56 AM', Current time (UTC): '8/4/2025 3:06:19 AM'.
2025-08-04 11:06:19.506 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '8/4/2025 2:44:56 AM', Current time (UTC): '8/4/2025 3:06:19 AM'.
2025-08-04 11:06:19.507 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-04 11:06:19.508 +08:00 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
2025-08-04 11:06:19.509 +08:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-08-04 11:06:19.509 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/enrollments - 401 0 null 6.7552ms
2025-08-04 11:06:40.056 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/auth/logout - null null
2025-08-04 11:06:40.057 +08:00 [INF] CORS policy execution successful.
2025-08-04 11:06:40.058 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/auth/logout - 204 null null 2.0216ms
2025-08-04 11:06:40.059 +08:00 [INF] Request starting HTTP/1.1 POST http://localhost:5294/api/auth/logout - application/json 0
2025-08-04 11:06:40.062 +08:00 [INF] CORS policy execution successful.
2025-08-04 11:06:40.062 +08:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '8/4/2025 2:44:56 AM', Current time (UTC): '8/4/2025 3:06:40 AM'.
   at Microsoft.IdentityModel.Tokens.ValidatorUtilities.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2025-08-04 11:06:40.064 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '8/4/2025 2:44:56 AM', Current time (UTC): '8/4/2025 3:06:40 AM'.
2025-08-04 11:06:40.064 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '8/4/2025 2:44:56 AM', Current time (UTC): '8/4/2025 3:06:40 AM'.
2025-08-04 11:06:40.066 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-04 11:06:40.067 +08:00 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
2025-08-04 11:06:40.068 +08:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-08-04 11:06:40.068 +08:00 [INF] Request finished HTTP/1.1 POST http://localhost:5294/api/auth/logout - 401 0 null 8.8183ms
2025-08-04 11:07:19.267 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/auth/login - null null
2025-08-04 11:07:19.268 +08:00 [INF] CORS policy execution successful.
2025-08-04 11:07:19.269 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/auth/login - 204 null null 2.1437ms
2025-08-04 11:07:19.270 +08:00 [INF] Request starting HTTP/1.1 POST http://localhost:5294/api/auth/login - application/json 61
2025-08-04 11:07:19.272 +08:00 [INF] CORS policy execution successful.
2025-08-04 11:07:19.272 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AuthController.Login (CeceLearningPortal.Api)'
2025-08-04 11:07:19.275 +08:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(CeceLearningPortal.Api.DTOs.LoginDto) on controller CeceLearningPortal.Api.Controllers.AuthController (CeceLearningPortal.Api).
2025-08-04 11:07:19.290 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__normalizedEmail_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."NormalizedEmail" = @__normalizedEmail_0
LIMIT 2
2025-08-04 11:07:19.410 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@p1='?', @p2='?', @p0='?' (DbType = DateTime), @p3='?' (DbType = DateTime), @p4='?', @p5='?' (DbType = DateTime), @p6='?', @p7='?' (DbType = DateTime), @p8='?', @p9='?', @p10='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE "AspNetUsers" SET "LastLoginAt" = @p0
WHERE "Id" = @p1 AND "ConcurrencyStamp" = @p2;
INSERT INTO refresh_tokens (created_at, created_by_ip, expires_at, replaced_by_token, revoked_at, revoked_by_ip, token, user_id)
VALUES (@p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10)
RETURNING id;
2025-08-04 11:07:19.422 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.AuthResponseDto'.
2025-08-04 11:07:19.424 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AuthController.Login (CeceLearningPortal.Api) in 148.2896ms
2025-08-04 11:07:19.424 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AuthController.Login (CeceLearningPortal.Api)'
2025-08-04 11:07:19.425 +08:00 [INF] Request finished HTTP/1.1 POST http://localhost:5294/api/auth/login - 200 null application/json; charset=utf-8 154.4035ms
2025-08-04 11:07:19.440 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/analytics/platform - null null
2025-08-04 11:07:19.440 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/courses - null null
2025-08-04 11:07:19.441 +08:00 [INF] CORS policy execution successful.
2025-08-04 11:07:19.443 +08:00 [INF] CORS policy execution successful.
2025-08-04 11:07:19.443 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/analytics/platform - 204 null null 3.3157ms
2025-08-04 11:07:19.444 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/courses - 204 null null 3.0534ms
2025-08-04 11:07:19.445 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/analytics/platform - application/json null
2025-08-04 11:07:19.447 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/courses - application/json null
2025-08-04 11:07:19.448 +08:00 [INF] CORS policy execution successful.
2025-08-04 11:07:19.449 +08:00 [INF] CORS policy execution successful.
2025-08-04 11:07:19.456 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-04 11:07:19.456 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-04 11:07:19.457 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-08-04 11:07:19.458 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-08-04 11:07:19.458 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-08-04 11:07:19.459 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-08-04 11:07:19.460 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/analytics/platform - 403 0 null 14.578ms
2025-08-04 11:07:19.464 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-08-04 11:07:19.468 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-08-04 11:07:19.469 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 9.1365ms
2025-08-04 11:07:19.469 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-08-04 11:07:19.470 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/courses - 200 null application/json; charset=utf-8 22.9564ms
2025-08-04 11:07:19.471 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/users/bee889a2-efca-471d-807c-a7674a945612/instructor-stats - null null
2025-08-04 11:07:19.472 +08:00 [INF] CORS policy execution successful.
2025-08-04 11:07:19.473 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/users/bee889a2-efca-471d-807c-a7674a945612/instructor-stats - 204 null null 1.4605ms
2025-08-04 11:07:19.474 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/users/bee889a2-efca-471d-807c-a7674a945612/instructor-stats - application/json null
2025-08-04 11:07:19.475 +08:00 [INF] CORS policy execution successful.
2025-08-04 11:07:19.477 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-04 11:07:19.478 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/users/bee889a2-efca-471d-807c-a7674a945612/instructor-stats - 404 0 null 3.8591ms
2025-08-04 11:07:19.479 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5294/api/users/bee889a2-efca-471d-807c-a7674a945612/instructor-stats, Response status code: 404
2025-08-04 11:07:19.488 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/courses?instructorId=bee889a2-efca-471d-807c-a7674a945612 - null null
2025-08-04 11:07:19.489 +08:00 [INF] CORS policy execution successful.
2025-08-04 11:07:19.490 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/courses?instructorId=bee889a2-efca-471d-807c-a7674a945612 - 204 null null 1.8024ms
2025-08-04 11:07:19.492 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/courses?instructorId=bee889a2-efca-471d-807c-a7674a945612 - application/json null
2025-08-04 11:07:19.493 +08:00 [INF] CORS policy execution successful.
2025-08-04 11:07:19.495 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-04 11:07:19.496 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-08-04 11:07:19.497 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-08-04 11:07:19.500 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-08-04 11:07:19.504 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-08-04 11:07:19.505 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 7.3151ms
2025-08-04 11:07:19.506 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-08-04 11:07:19.506 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/courses?instructorId=bee889a2-efca-471d-807c-a7674a945612 - 200 null application/json; charset=utf-8 14.4318ms
2025-08-04 11:07:30.240 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/courses - null null
2025-08-04 11:07:30.241 +08:00 [INF] CORS policy execution successful.
2025-08-04 11:07:30.241 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/courses - 204 null null 1.8488ms
2025-08-04 11:07:30.243 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/courses - application/json null
2025-08-04 11:07:30.244 +08:00 [INF] CORS policy execution successful.
2025-08-04 11:07:30.246 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-04 11:07:30.247 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-08-04 11:07:30.248 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-08-04 11:07:30.251 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-08-04 11:07:30.255 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-08-04 11:07:30.256 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 6.8258ms
2025-08-04 11:07:30.256 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-08-04 11:07:30.257 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/courses - 200 null application/json; charset=utf-8 13.8683ms
2025-08-04 11:07:30.258 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/analytics/platform - null null
2025-08-04 11:07:30.259 +08:00 [INF] CORS policy execution successful.
2025-08-04 11:07:30.260 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/analytics/platform - 204 null null 1.5454ms
2025-08-04 11:07:30.261 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/analytics/platform - application/json null
2025-08-04 11:07:30.262 +08:00 [INF] CORS policy execution successful.
2025-08-04 11:07:30.264 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-04 11:07:30.265 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-08-04 11:07:30.266 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-08-04 11:07:30.266 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/analytics/platform - 403 0 null 4.9128ms
2025-08-04 11:07:30.272 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/analytics/platform - application/json null
2025-08-04 11:07:30.272 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - null null
2025-08-04 11:07:30.272 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - null null
2025-08-04 11:07:30.273 +08:00 [INF] CORS policy execution successful.
2025-08-04 11:07:30.274 +08:00 [INF] CORS policy execution successful.
2025-08-04 11:07:30.275 +08:00 [INF] CORS policy execution successful.
2025-08-04 11:07:30.275 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - 204 null null 3.5948ms
2025-08-04 11:07:30.276 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - 204 null null 3.3158ms
2025-08-04 11:07:30.276 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-04 11:07:30.277 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - application/json null
2025-08-04 11:07:30.278 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - application/json null
2025-08-04 11:07:30.279 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-08-04 11:07:30.280 +08:00 [INF] CORS policy execution successful.
2025-08-04 11:07:30.281 +08:00 [INF] CORS policy execution successful.
2025-08-04 11:07:30.282 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-08-04 11:07:30.283 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/analytics/platform - 403 0 null 11.1628ms
2025-08-04 11:07:30.283 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-04 11:07:30.283 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-04 11:07:30.285 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-08-04 11:07:30.286 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-08-04 11:07:30.286 +08:00 [INF] Route matched with {action = "GetInstructorRevenue", controller = "Revenue"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorRevenue(System.String) on controller CeceLearningPortal.Api.Controllers.RevenueController (CeceLearningPortal.Api).
2025-08-04 11:07:30.289 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-08-04 11:07:30.289 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."Id" = @__p_0
LIMIT 1
2025-08-04 11:07:30.291 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
FROM courses AS c
WHERE c.instructor_id = @__instructorId_0
2025-08-04 11:07:30.293 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-04 11:07:30.294 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-04 11:07:30.296 +08:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2025-08-04 11:07:30.296 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-04 11:07:30.298 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-04 11:07:30.299 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-04 11:07:30.301 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-04 11:07:30.302 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-04 11:07:30.304 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-04 11:07:30.305 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-04 11:07:30.307 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-04 11:07:30.308 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-04 11:07:30.310 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-04 11:07:30.311 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at, s.id, s.average_quiz_score, s.certificate_issued, s.certificate_url, s.completed_at, s.completed_lessons, s.course_id, s.enrolled_at, s.last_accessed_date, s.progress_percentage, s.quiz_count, s.student_id, s.total_time_spent, s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", c0.id, c0.approved_at, c0.approved_by, c0.comment, c0.course_id, c0.created_at, c0.is_flagged, c0.rating, c0.status, c0.student_id
FROM courses AS c
LEFT JOIN (
    SELECT e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent, a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM enrollments AS e
    INNER JOIN "AspNetUsers" AS a ON e.student_id = a."Id"
) AS s ON c.id = s.course_id
LEFT JOIN course_reviews AS c0 ON c.id = c0.course_id
WHERE c.instructor_id = @__instructorId_0
ORDER BY c.id, s.id, s."Id0"
2025-08-04 11:07:30.311 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-04 11:07:30.314 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-04 11:07:30.315 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-04 11:07:30.316 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-04 11:07:30.318 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-04 11:07:30.319 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-04 11:07:30.321 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-04 11:07:30.322 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-04 11:07:30.324 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-04 11:07:30.325 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-04 11:07:30.326 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-04 11:07:30.327 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
LEFT JOIN courses AS c ON t.course_id = c.id
WHERE c.instructor_id = @__instructorId_0 AND t.status = 'Completed'
2025-08-04 11:07:30.327 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-04 11:07:30.329 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-04 11:07:30.330 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-04 11:07:30.332 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-04 11:07:30.333 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.InstructorRevenueDto'.
2025-08-04 11:07:30.333 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api) in 45.805ms
2025-08-04 11:07:30.334 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-08-04 11:07:30.335 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - 200 null application/json; charset=utf-8 57.5277ms
2025-08-04 11:07:30.348 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__instructorId_0='?', @__twelveMonthsAgo_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Year", s."Month", COALESCE(sum(s.amount), 0.0) AS "Revenue"
FROM (
    SELECT t.amount, date_part('year', t.created_at AT TIME ZONE 'UTC')::int AS "Year", date_part('month', t.created_at AT TIME ZONE 'UTC')::int AS "Month"
    FROM transactions AS t
    LEFT JOIN courses AS c ON t.course_id = c.id
    WHERE c.instructor_id = @__instructorId_0 AND t.status = 'Completed' AND t.created_at >= @__twelveMonthsAgo_1
) AS s
GROUP BY s."Year", s."Month"
ORDER BY s."Year", s."Month"
2025-08-04 11:07:30.355 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-04 11:07:30.357 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-04 11:07:30.359 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-04 11:07:30.360 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-04 11:07:30.361 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-04 11:07:30.362 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-04 11:07:30.364 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-04 11:07:30.365 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-04 11:07:30.366 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-04 11:07:30.380 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s.title, s.enrolled_at
FROM (
    SELECT e.enrolled_at, e.student_id, c.title
    FROM enrollments AS e
    INNER JOIN courses AS c ON e.course_id = c.id
    WHERE c.instructor_id = @__instructorId_0
    ORDER BY e.enrolled_at DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s.student_id = a."Id"
ORDER BY s.enrolled_at DESC
2025-08-04 11:07:30.385 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s.title, s.created_at, s.rating
FROM (
    SELECT c.created_at, c.rating, c.student_id, c0.title
    FROM course_reviews AS c
    INNER JOIN courses AS c0 ON c.course_id = c0.id
    WHERE c0.instructor_id = @__instructorId_0
    ORDER BY c.created_at DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s.student_id = a."Id"
ORDER BY s.created_at DESC
2025-08-04 11:07:30.387 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType18`5[[<>f__AnonymousType19`6[[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-04 11:07:30.395 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 105.676ms
2025-08-04 11:07:30.396 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-08-04 11:07:30.396 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - 200 null application/json; charset=utf-8 118.1248ms
2025-08-04 11:07:33.891 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/courses/34 - null null
2025-08-04 11:07:33.892 +08:00 [INF] CORS policy execution successful.
2025-08-04 11:07:33.893 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/courses/34 - 204 null null 1.6576ms
2025-08-04 11:07:33.894 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/courses/34 - application/json null
2025-08-04 11:07:33.895 +08:00 [INF] CORS policy execution successful.
2025-08-04 11:07:33.897 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-04 11:07:33.898 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourse (CeceLearningPortal.Api)'
2025-08-04 11:07:33.899 +08:00 [INF] Route matched with {action = "GetCourse", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourse(Int32) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-08-04 11:07:33.902 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s.id, s."AccessDuration", s."AccessType", s."AutomationAbandonmentSequence", s."AutomationCompletionCertificate", s."AutomationProgressReminders", s."AutomationWelcomeEmail", s.category, s."CourseType", s.created_at, s."Currency", s.description, s.discount, s."DripContent", s."DripScheduleJson", s.duration, s."EnrollmentLimit", s.enrollment_type, s.features, s."HasAssignments", s."HasCertificate", s."HasCommunity", s."HasDownloadableResources", s."HasLiveSessions", s."HasQuizzes", s.instructor_id, s.is_bestseller, s."IsPublished", s."Language", s.level, s.original_price, s."PaymentPlanDetailsJson", s.preview_url, s.price, s."PricingModel", s."PromoVideoUrl", s."PublishedAt", s."ShortDescription", s.status, s."SubscriptionPeriod", s.thumbnail, s.thumbnail_url, s.title, s.updated_at, s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status0", s."TwoFactorEnabled", s."UserName", s0.id, s0.course_id, s0.created_at, s0.description, s0."order", s0.title, s0.updated_at, s0.id0, s0.content, s0.created_at0, s0.duration, s0.module_id, s0.order0, s0.title0, s0.type, s0.updated_at0, s0.video_url, s1.id, s1.approved_at, s1.approved_by, s1.comment, s1.course_id, s1.created_at, s1.is_flagged, s1.rating, s1.status, s1.student_id, s1."Id0", s1."AccessFailedCount", s1."Avatar", s1."ConcurrencyStamp", s1."CreatedAt", s1."Email", s1."EmailConfirmed", s1."FullName", s1."LastLoginAt", s1."LockoutEnabled", s1."LockoutEnd", s1."NormalizedEmail", s1."NormalizedUserName", s1."NotificationPreferences", s1."PasswordHash", s1."PhoneNumber", s1."PhoneNumberConfirmed", s1."RefreshToken", s1."RefreshTokenExpiryTime", s1."Role", s1."SecurityStamp", s1."Status0", s1."TwoFactorEnabled", s1."UserName", e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at, a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status" AS "Status0", a."TwoFactorEnabled", a."UserName"
    FROM courses AS c
    INNER JOIN "AspNetUsers" AS a ON c.instructor_id = a."Id"
    WHERE c.id = @__id_0
    LIMIT 1
) AS s
LEFT JOIN (
    SELECT c0.id, c0.course_id, c0.created_at, c0.description, c0."order", c0.title, c0.updated_at, c1.id AS id0, c1.content, c1.created_at AS created_at0, c1.duration, c1.module_id, c1."order" AS order0, c1.title AS title0, c1.type, c1.updated_at AS updated_at0, c1.video_url
    FROM course_modules AS c0
    LEFT JOIN course_lessons AS c1 ON c0.id = c1.module_id
) AS s0 ON s.id = s0.course_id
LEFT JOIN (
    SELECT c2.id, c2.approved_at, c2.approved_by, c2.comment, c2.course_id, c2.created_at, c2.is_flagged, c2.rating, c2.status, c2.student_id, a0."Id" AS "Id0", a0."AccessFailedCount", a0."Avatar", a0."ConcurrencyStamp", a0."CreatedAt", a0."Email", a0."EmailConfirmed", a0."FullName", a0."LastLoginAt", a0."LockoutEnabled", a0."LockoutEnd", a0."NormalizedEmail", a0."NormalizedUserName", a0."NotificationPreferences", a0."PasswordHash", a0."PhoneNumber", a0."PhoneNumberConfirmed", a0."RefreshToken", a0."RefreshTokenExpiryTime", a0."Role", a0."SecurityStamp", a0."Status" AS "Status0", a0."TwoFactorEnabled", a0."UserName"
    FROM course_reviews AS c2
    INNER JOIN "AspNetUsers" AS a0 ON c2.student_id = a0."Id"
) AS s1 ON s.id = s1.course_id
LEFT JOIN enrollments AS e ON s.id = e.course_id
ORDER BY s.id, s."Id0", s0.id, s0.id0, s1.id, s1."Id0"
2025-08-04 11:07:33.905 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.CourseDetailDto'.
2025-08-04 11:07:33.906 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourse (CeceLearningPortal.Api) in 5.9949ms
2025-08-04 11:07:33.906 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourse (CeceLearningPortal.Api)'
2025-08-04 11:07:33.907 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/courses/34 - 200 null application/json; charset=utf-8 12.3532ms
2025-08-04 11:07:33.908 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/enrollments - null null
2025-08-04 11:07:33.909 +08:00 [INF] CORS policy execution successful.
2025-08-04 11:07:33.910 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/enrollments - 204 null null 1.5492ms
2025-08-04 11:07:33.911 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/enrollments - application/json null
2025-08-04 11:07:33.912 +08:00 [INF] CORS policy execution successful.
2025-08-04 11:07:33.913 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-04 11:07:33.914 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.EnrollmentsController.GetMyEnrollments (CeceLearningPortal.Api)'
2025-08-04 11:07:33.916 +08:00 [INF] Route matched with {action = "GetMyEnrollments", controller = "Enrollments"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMyEnrollments() on controller CeceLearningPortal.Api.Controllers.EnrollmentsController (CeceLearningPortal.Api).
2025-08-04 11:07:33.926 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__studentId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT e.id AS "Id", e.student_id AS "StudentId", a."FullName" AS "StudentName", e.course_id AS "CourseId", c.title AS "CourseTitle", c.thumbnail AS "CourseThumbnail", a0."FullName" AS "InstructorName", e.enrolled_at AS "EnrolledAt", e.completed_at AS "CompletedAt", e.progress_percentage AS "ProgressPercentage", e.certificate_url AS "CertificateUrl"
FROM enrollments AS e
INNER JOIN "AspNetUsers" AS a ON e.student_id = a."Id"
INNER JOIN courses AS c ON e.course_id = c.id
INNER JOIN "AspNetUsers" AS a0 ON c.instructor_id = a0."Id"
WHERE e.student_id = @__studentId_0
2025-08-04 11:07:33.928 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[CeceLearningPortal.Api.DTOs.EnrollmentDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-08-04 11:07:33.932 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.EnrollmentsController.GetMyEnrollments (CeceLearningPortal.Api) in 14.1707ms
2025-08-04 11:07:33.932 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.EnrollmentsController.GetMyEnrollments (CeceLearningPortal.Api)'
2025-08-04 11:07:33.933 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/enrollments - 200 null application/json; charset=utf-8 21.6811ms
2025-08-04 11:07:39.369 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/courses/34 - null null
2025-08-04 11:07:39.371 +08:00 [INF] CORS policy execution successful.
2025-08-04 11:07:39.371 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/courses/34 - 204 null null 1.8146ms
2025-08-04 11:07:39.373 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/courses/34 - application/json null
2025-08-04 11:07:39.374 +08:00 [INF] CORS policy execution successful.
2025-08-04 11:07:39.376 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-04 11:07:39.377 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourse (CeceLearningPortal.Api)'
2025-08-04 11:07:39.377 +08:00 [INF] Route matched with {action = "GetCourse", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourse(Int32) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-08-04 11:07:39.401 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s.id, s."AccessDuration", s."AccessType", s."AutomationAbandonmentSequence", s."AutomationCompletionCertificate", s."AutomationProgressReminders", s."AutomationWelcomeEmail", s.category, s."CourseType", s.created_at, s."Currency", s.description, s.discount, s."DripContent", s."DripScheduleJson", s.duration, s."EnrollmentLimit", s.enrollment_type, s.features, s."HasAssignments", s."HasCertificate", s."HasCommunity", s."HasDownloadableResources", s."HasLiveSessions", s."HasQuizzes", s.instructor_id, s.is_bestseller, s."IsPublished", s."Language", s.level, s.original_price, s."PaymentPlanDetailsJson", s.preview_url, s.price, s."PricingModel", s."PromoVideoUrl", s."PublishedAt", s."ShortDescription", s.status, s."SubscriptionPeriod", s.thumbnail, s.thumbnail_url, s.title, s.updated_at, s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status0", s."TwoFactorEnabled", s."UserName", s0.id, s0.course_id, s0.created_at, s0.description, s0."order", s0.title, s0.updated_at, s0.id0, s0.content, s0.created_at0, s0.duration, s0.module_id, s0.order0, s0.title0, s0.type, s0.updated_at0, s0.video_url, s1.id, s1.approved_at, s1.approved_by, s1.comment, s1.course_id, s1.created_at, s1.is_flagged, s1.rating, s1.status, s1.student_id, s1."Id0", s1."AccessFailedCount", s1."Avatar", s1."ConcurrencyStamp", s1."CreatedAt", s1."Email", s1."EmailConfirmed", s1."FullName", s1."LastLoginAt", s1."LockoutEnabled", s1."LockoutEnd", s1."NormalizedEmail", s1."NormalizedUserName", s1."NotificationPreferences", s1."PasswordHash", s1."PhoneNumber", s1."PhoneNumberConfirmed", s1."RefreshToken", s1."RefreshTokenExpiryTime", s1."Role", s1."SecurityStamp", s1."Status0", s1."TwoFactorEnabled", s1."UserName", e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at, a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status" AS "Status0", a."TwoFactorEnabled", a."UserName"
    FROM courses AS c
    INNER JOIN "AspNetUsers" AS a ON c.instructor_id = a."Id"
    WHERE c.id = @__id_0
    LIMIT 1
) AS s
LEFT JOIN (
    SELECT c0.id, c0.course_id, c0.created_at, c0.description, c0."order", c0.title, c0.updated_at, c1.id AS id0, c1.content, c1.created_at AS created_at0, c1.duration, c1.module_id, c1."order" AS order0, c1.title AS title0, c1.type, c1.updated_at AS updated_at0, c1.video_url
    FROM course_modules AS c0
    LEFT JOIN course_lessons AS c1 ON c0.id = c1.module_id
) AS s0 ON s.id = s0.course_id
LEFT JOIN (
    SELECT c2.id, c2.approved_at, c2.approved_by, c2.comment, c2.course_id, c2.created_at, c2.is_flagged, c2.rating, c2.status, c2.student_id, a0."Id" AS "Id0", a0."AccessFailedCount", a0."Avatar", a0."ConcurrencyStamp", a0."CreatedAt", a0."Email", a0."EmailConfirmed", a0."FullName", a0."LastLoginAt", a0."LockoutEnabled", a0."LockoutEnd", a0."NormalizedEmail", a0."NormalizedUserName", a0."NotificationPreferences", a0."PasswordHash", a0."PhoneNumber", a0."PhoneNumberConfirmed", a0."RefreshToken", a0."RefreshTokenExpiryTime", a0."Role", a0."SecurityStamp", a0."Status" AS "Status0", a0."TwoFactorEnabled", a0."UserName"
    FROM course_reviews AS c2
    INNER JOIN "AspNetUsers" AS a0 ON c2.student_id = a0."Id"
) AS s1 ON s.id = s1.course_id
LEFT JOIN enrollments AS e ON s.id = e.course_id
ORDER BY s.id, s."Id0", s0.id, s0.id0, s1.id, s1."Id0"
2025-08-04 11:07:39.404 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.CourseDetailDto'.
2025-08-04 11:07:39.405 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourse (CeceLearningPortal.Api) in 26.3762ms
2025-08-04 11:07:39.405 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourse (CeceLearningPortal.Api)'
2025-08-04 11:07:39.406 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/courses/34 - 200 null application/json; charset=utf-8 32.6407ms
2025-08-04 11:08:57.257 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/courses/34 - null null
2025-08-04 11:08:57.258 +08:00 [INF] CORS policy execution successful.
2025-08-04 11:08:57.259 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/courses/34 - 204 null null 1.8783ms
2025-08-04 11:08:57.260 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/courses/34 - application/json null
2025-08-04 11:08:57.261 +08:00 [INF] CORS policy execution successful.
2025-08-04 11:08:57.263 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-04 11:08:57.264 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourse (CeceLearningPortal.Api)'
2025-08-04 11:08:57.265 +08:00 [INF] Route matched with {action = "GetCourse", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourse(Int32) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-08-04 11:08:57.268 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s.id, s."AccessDuration", s."AccessType", s."AutomationAbandonmentSequence", s."AutomationCompletionCertificate", s."AutomationProgressReminders", s."AutomationWelcomeEmail", s.category, s."CourseType", s.created_at, s."Currency", s.description, s.discount, s."DripContent", s."DripScheduleJson", s.duration, s."EnrollmentLimit", s.enrollment_type, s.features, s."HasAssignments", s."HasCertificate", s."HasCommunity", s."HasDownloadableResources", s."HasLiveSessions", s."HasQuizzes", s.instructor_id, s.is_bestseller, s."IsPublished", s."Language", s.level, s.original_price, s."PaymentPlanDetailsJson", s.preview_url, s.price, s."PricingModel", s."PromoVideoUrl", s."PublishedAt", s."ShortDescription", s.status, s."SubscriptionPeriod", s.thumbnail, s.thumbnail_url, s.title, s.updated_at, s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status0", s."TwoFactorEnabled", s."UserName", s0.id, s0.course_id, s0.created_at, s0.description, s0."order", s0.title, s0.updated_at, s0.id0, s0.content, s0.created_at0, s0.duration, s0.module_id, s0.order0, s0.title0, s0.type, s0.updated_at0, s0.video_url, s1.id, s1.approved_at, s1.approved_by, s1.comment, s1.course_id, s1.created_at, s1.is_flagged, s1.rating, s1.status, s1.student_id, s1."Id0", s1."AccessFailedCount", s1."Avatar", s1."ConcurrencyStamp", s1."CreatedAt", s1."Email", s1."EmailConfirmed", s1."FullName", s1."LastLoginAt", s1."LockoutEnabled", s1."LockoutEnd", s1."NormalizedEmail", s1."NormalizedUserName", s1."NotificationPreferences", s1."PasswordHash", s1."PhoneNumber", s1."PhoneNumberConfirmed", s1."RefreshToken", s1."RefreshTokenExpiryTime", s1."Role", s1."SecurityStamp", s1."Status0", s1."TwoFactorEnabled", s1."UserName", e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at, a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status" AS "Status0", a."TwoFactorEnabled", a."UserName"
    FROM courses AS c
    INNER JOIN "AspNetUsers" AS a ON c.instructor_id = a."Id"
    WHERE c.id = @__id_0
    LIMIT 1
) AS s
LEFT JOIN (
    SELECT c0.id, c0.course_id, c0.created_at, c0.description, c0."order", c0.title, c0.updated_at, c1.id AS id0, c1.content, c1.created_at AS created_at0, c1.duration, c1.module_id, c1."order" AS order0, c1.title AS title0, c1.type, c1.updated_at AS updated_at0, c1.video_url
    FROM course_modules AS c0
    LEFT JOIN course_lessons AS c1 ON c0.id = c1.module_id
) AS s0 ON s.id = s0.course_id
LEFT JOIN (
    SELECT c2.id, c2.approved_at, c2.approved_by, c2.comment, c2.course_id, c2.created_at, c2.is_flagged, c2.rating, c2.status, c2.student_id, a0."Id" AS "Id0", a0."AccessFailedCount", a0."Avatar", a0."ConcurrencyStamp", a0."CreatedAt", a0."Email", a0."EmailConfirmed", a0."FullName", a0."LastLoginAt", a0."LockoutEnabled", a0."LockoutEnd", a0."NormalizedEmail", a0."NormalizedUserName", a0."NotificationPreferences", a0."PasswordHash", a0."PhoneNumber", a0."PhoneNumberConfirmed", a0."RefreshToken", a0."RefreshTokenExpiryTime", a0."Role", a0."SecurityStamp", a0."Status" AS "Status0", a0."TwoFactorEnabled", a0."UserName"
    FROM course_reviews AS c2
    INNER JOIN "AspNetUsers" AS a0 ON c2.student_id = a0."Id"
) AS s1 ON s.id = s1.course_id
LEFT JOIN enrollments AS e ON s.id = e.course_id
ORDER BY s.id, s."Id0", s0.id, s0.id0, s1.id, s1."Id0"
2025-08-04 11:08:57.272 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.CourseDetailDto'.
2025-08-04 11:08:57.272 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourse (CeceLearningPortal.Api) in 6.4914ms
2025-08-04 11:08:57.273 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourse (CeceLearningPortal.Api)'
2025-08-04 11:08:57.274 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/courses/34 - 200 null application/json; charset=utf-8 13.6141ms
2025-08-04 11:08:57.275 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/enrollments - null null
2025-08-04 11:08:57.276 +08:00 [INF] CORS policy execution successful.
2025-08-04 11:08:57.277 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/enrollments - 204 null null 1.6296ms
2025-08-04 11:08:57.279 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/enrollments - application/json null
2025-08-04 11:08:57.280 +08:00 [INF] CORS policy execution successful.
2025-08-04 11:08:57.281 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-04 11:08:57.282 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.EnrollmentsController.GetMyEnrollments (CeceLearningPortal.Api)'
2025-08-04 11:08:57.283 +08:00 [INF] Route matched with {action = "GetMyEnrollments", controller = "Enrollments"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMyEnrollments() on controller CeceLearningPortal.Api.Controllers.EnrollmentsController (CeceLearningPortal.Api).
2025-08-04 11:08:57.285 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__studentId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT e.id AS "Id", e.student_id AS "StudentId", a."FullName" AS "StudentName", e.course_id AS "CourseId", c.title AS "CourseTitle", c.thumbnail AS "CourseThumbnail", a0."FullName" AS "InstructorName", e.enrolled_at AS "EnrolledAt", e.completed_at AS "CompletedAt", e.progress_percentage AS "ProgressPercentage", e.certificate_url AS "CertificateUrl"
FROM enrollments AS e
INNER JOIN "AspNetUsers" AS a ON e.student_id = a."Id"
INNER JOIN courses AS c ON e.course_id = c.id
INNER JOIN "AspNetUsers" AS a0 ON c.instructor_id = a0."Id"
WHERE e.student_id = @__studentId_0
2025-08-04 11:08:57.287 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[CeceLearningPortal.Api.DTOs.EnrollmentDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-08-04 11:08:57.287 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.EnrollmentsController.GetMyEnrollments (CeceLearningPortal.Api) in 3.9655ms
2025-08-04 11:08:57.288 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.EnrollmentsController.GetMyEnrollments (CeceLearningPortal.Api)'
2025-08-04 11:08:57.289 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/enrollments - 200 null application/json; charset=utf-8 10.2978ms
2025-08-04 11:09:01.366 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/analytics/platform - null null
2025-08-04 11:09:01.366 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/courses - null null
2025-08-04 11:09:01.367 +08:00 [INF] CORS policy execution successful.
2025-08-04 11:09:01.368 +08:00 [INF] CORS policy execution successful.
2025-08-04 11:09:01.369 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/analytics/platform - 204 null null 2.8667ms
2025-08-04 11:09:01.369 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/courses - 204 null null 2.8036ms
2025-08-04 11:09:01.370 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/analytics/platform - application/json null
2025-08-04 11:09:01.372 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/courses - application/json null
2025-08-04 11:09:01.373 +08:00 [INF] CORS policy execution successful.
2025-08-04 11:09:01.374 +08:00 [INF] CORS policy execution successful.
2025-08-04 11:09:01.376 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-04 11:09:01.376 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-04 11:09:01.377 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-08-04 11:09:01.378 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-08-04 11:09:01.378 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-08-04 11:09:01.379 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-08-04 11:09:01.380 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/analytics/platform - 403 0 null 10.0418ms
2025-08-04 11:09:01.382 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-08-04 11:09:01.385 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-08-04 11:09:01.386 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 6.5332ms
2025-08-04 11:09:01.387 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-08-04 11:09:01.388 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/courses - 200 null application/json; charset=utf-8 16.235ms
2025-08-04 11:09:01.390 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/users/bee889a2-efca-471d-807c-a7674a945612/instructor-stats - null null
2025-08-04 11:09:01.391 +08:00 [INF] CORS policy execution successful.
2025-08-04 11:09:01.391 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/users/bee889a2-efca-471d-807c-a7674a945612/instructor-stats - 204 null null 1.4607ms
2025-08-04 11:09:01.393 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/users/bee889a2-efca-471d-807c-a7674a945612/instructor-stats - application/json null
2025-08-04 11:09:01.394 +08:00 [INF] CORS policy execution successful.
2025-08-04 11:09:01.395 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-04 11:09:01.396 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/users/bee889a2-efca-471d-807c-a7674a945612/instructor-stats - 404 0 null 3.5322ms
2025-08-04 11:09:01.398 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5294/api/users/bee889a2-efca-471d-807c-a7674a945612/instructor-stats, Response status code: 404
2025-08-04 11:09:01.407 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/courses?instructorId=bee889a2-efca-471d-807c-a7674a945612 - null null
2025-08-04 11:09:01.408 +08:00 [INF] CORS policy execution successful.
2025-08-04 11:09:01.409 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/courses?instructorId=bee889a2-efca-471d-807c-a7674a945612 - 204 null null 2.1723ms
2025-08-04 11:09:01.411 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/courses?instructorId=bee889a2-efca-471d-807c-a7674a945612 - application/json null
2025-08-04 11:09:01.413 +08:00 [INF] CORS policy execution successful.
2025-08-04 11:09:01.415 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-04 11:09:01.416 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-08-04 11:09:01.417 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-08-04 11:09:01.420 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-08-04 11:09:01.423 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-08-04 11:09:01.424 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 6.5361ms
2025-08-04 11:09:01.425 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-08-04 11:09:01.425 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/courses?instructorId=bee889a2-efca-471d-807c-a7674a945612 - 200 null application/json; charset=utf-8 13.9563ms
2025-08-04 11:12:02.217 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/courses - null null
2025-08-04 11:12:02.218 +08:00 [INF] CORS policy execution successful.
2025-08-04 11:12:02.218 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/courses - 204 null null 1.4947ms
2025-08-04 11:12:02.220 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/courses - application/json null
2025-08-04 11:12:02.221 +08:00 [INF] CORS policy execution successful.
2025-08-04 11:12:02.264 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-04 11:12:02.265 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-08-04 11:12:02.266 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-08-04 11:12:02.273 +08:00 [INF] Executed DbCommand (6ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-08-04 11:12:02.276 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-08-04 11:12:02.277 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 10.0006ms
2025-08-04 11:12:02.277 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-08-04 11:12:02.278 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/courses - 200 null application/json; charset=utf-8 58.2238ms
2025-08-04 11:12:02.279 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/analytics/platform - null null
2025-08-04 11:12:02.280 +08:00 [INF] CORS policy execution successful.
2025-08-04 11:12:02.281 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/analytics/platform - 204 null null 1.422ms
2025-08-04 11:12:02.282 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/analytics/platform - application/json null
2025-08-04 11:12:02.283 +08:00 [INF] CORS policy execution successful.
2025-08-04 11:12:02.285 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-04 11:12:02.286 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-08-04 11:12:02.286 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-08-04 11:12:02.287 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/analytics/platform - 403 0 null 4.4402ms
2025-08-04 11:12:02.292 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/analytics/platform - application/json null
2025-08-04 11:12:02.293 +08:00 [INF] CORS policy execution successful.
2025-08-04 11:12:02.295 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-04 11:12:02.296 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-08-04 11:12:02.296 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-08-04 11:12:02.297 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/analytics/platform - 403 0 null 4.5907ms
2025-08-04 11:12:02.299 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - null null
2025-08-04 11:12:02.299 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - null null
2025-08-04 11:12:02.300 +08:00 [INF] CORS policy execution successful.
2025-08-04 11:12:02.302 +08:00 [INF] CORS policy execution successful.
2025-08-04 11:12:02.302 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - 204 null null 3.1634ms
2025-08-04 11:12:02.302 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - 204 null null 3.1468ms
2025-08-04 11:12:02.304 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - application/json null
2025-08-04 11:12:02.305 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - application/json null
2025-08-04 11:12:02.306 +08:00 [INF] CORS policy execution successful.
2025-08-04 11:12:02.308 +08:00 [INF] CORS policy execution successful.
2025-08-04 11:12:02.309 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-04 11:12:02.310 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-08-04 11:12:02.311 +08:00 [INF] Route matched with {action = "GetInstructorRevenue", controller = "Revenue"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorRevenue(System.String) on controller CeceLearningPortal.Api.Controllers.RevenueController (CeceLearningPortal.Api).
2025-08-04 11:12:02.314 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."Id" = @__p_0
LIMIT 1
2025-08-04 11:12:02.315 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
FROM courses AS c
WHERE c.instructor_id = @__instructorId_0
2025-08-04 11:12:02.317 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-04 11:12:02.320 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-04 11:12:02.321 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-04 11:12:02.323 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-04 11:12:02.325 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-04 11:12:02.326 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-04 11:12:02.327 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-04 11:12:02.329 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-04 11:12:02.330 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-04 11:12:02.331 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-04 11:12:02.332 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-04 11:12:02.334 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-04 11:12:02.335 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-04 11:12:02.336 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-04 11:12:02.337 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-04 11:12:02.338 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-04 11:12:02.339 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-04 11:12:02.341 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-04 11:12:02.342 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-04 11:12:02.343 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-04 11:12:02.344 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-04 11:12:02.346 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-04 11:12:02.347 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-04 11:12:02.348 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-04 11:12:02.349 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-04 11:12:02.350 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-04 11:12:02.352 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-04 11:12:02.353 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.InstructorRevenueDto'.
2025-08-04 11:12:02.353 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api) in 41.2408ms
2025-08-04 11:12:02.354 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-08-04 11:12:02.354 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - 200 null application/json; charset=utf-8 50.2943ms
2025-08-04 11:12:02.453 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-04 11:12:02.454 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-08-04 11:12:02.455 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-08-04 11:12:02.457 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at, s.id, s.average_quiz_score, s.certificate_issued, s.certificate_url, s.completed_at, s.completed_lessons, s.course_id, s.enrolled_at, s.last_accessed_date, s.progress_percentage, s.quiz_count, s.student_id, s.total_time_spent, s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", c0.id, c0.approved_at, c0.approved_by, c0.comment, c0.course_id, c0.created_at, c0.is_flagged, c0.rating, c0.status, c0.student_id
FROM courses AS c
LEFT JOIN (
    SELECT e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent, a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM enrollments AS e
    INNER JOIN "AspNetUsers" AS a ON e.student_id = a."Id"
) AS s ON c.id = s.course_id
LEFT JOIN course_reviews AS c0 ON c.id = c0.course_id
WHERE c.instructor_id = @__instructorId_0
ORDER BY c.id, s.id, s."Id0"
2025-08-04 11:12:02.462 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
LEFT JOIN courses AS c ON t.course_id = c.id
WHERE c.instructor_id = @__instructorId_0 AND t.status = 'Completed'
2025-08-04 11:12:02.464 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?', @__twelveMonthsAgo_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Year", s."Month", COALESCE(sum(s.amount), 0.0) AS "Revenue"
FROM (
    SELECT t.amount, date_part('year', t.created_at AT TIME ZONE 'UTC')::int AS "Year", date_part('month', t.created_at AT TIME ZONE 'UTC')::int AS "Month"
    FROM transactions AS t
    LEFT JOIN courses AS c ON t.course_id = c.id
    WHERE c.instructor_id = @__instructorId_0 AND t.status = 'Completed' AND t.created_at >= @__twelveMonthsAgo_1
) AS s
GROUP BY s."Year", s."Month"
ORDER BY s."Year", s."Month"
2025-08-04 11:12:02.466 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-04 11:12:02.467 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-04 11:12:02.468 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-04 11:12:02.469 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-04 11:12:02.471 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-04 11:12:02.472 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-04 11:12:02.473 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-04 11:12:02.474 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-04 11:12:02.475 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-04 11:12:02.477 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s.title, s.enrolled_at
FROM (
    SELECT e.enrolled_at, e.student_id, c.title
    FROM enrollments AS e
    INNER JOIN courses AS c ON e.course_id = c.id
    WHERE c.instructor_id = @__instructorId_0
    ORDER BY e.enrolled_at DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s.student_id = a."Id"
ORDER BY s.enrolled_at DESC
2025-08-04 11:12:02.480 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s.title, s.created_at, s.rating
FROM (
    SELECT c.created_at, c.rating, c.student_id, c0.title
    FROM course_reviews AS c
    INNER JOIN courses AS c0 ON c.course_id = c0.id
    WHERE c0.instructor_id = @__instructorId_0
    ORDER BY c.created_at DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s.student_id = a."Id"
ORDER BY s.created_at DESC
2025-08-04 11:12:02.481 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType18`5[[<>f__AnonymousType19`6[[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-04 11:12:02.482 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 26.811ms
2025-08-04 11:12:02.483 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-08-04 11:12:02.484 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - 200 null application/json; charset=utf-8 178.2545ms
2025-08-04 11:12:11.554 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/courses/29 - null null
2025-08-04 11:12:11.556 +08:00 [INF] CORS policy execution successful.
2025-08-04 11:12:11.556 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/courses/29 - 204 null null 1.5447ms
2025-08-04 11:12:11.558 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/courses/29 - application/json null
2025-08-04 11:12:11.559 +08:00 [INF] CORS policy execution successful.
2025-08-04 11:12:11.561 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-04 11:12:11.562 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourse (CeceLearningPortal.Api)'
2025-08-04 11:12:11.562 +08:00 [INF] Route matched with {action = "GetCourse", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourse(Int32) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-08-04 11:12:11.567 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s.id, s."AccessDuration", s."AccessType", s."AutomationAbandonmentSequence", s."AutomationCompletionCertificate", s."AutomationProgressReminders", s."AutomationWelcomeEmail", s.category, s."CourseType", s.created_at, s."Currency", s.description, s.discount, s."DripContent", s."DripScheduleJson", s.duration, s."EnrollmentLimit", s.enrollment_type, s.features, s."HasAssignments", s."HasCertificate", s."HasCommunity", s."HasDownloadableResources", s."HasLiveSessions", s."HasQuizzes", s.instructor_id, s.is_bestseller, s."IsPublished", s."Language", s.level, s.original_price, s."PaymentPlanDetailsJson", s.preview_url, s.price, s."PricingModel", s."PromoVideoUrl", s."PublishedAt", s."ShortDescription", s.status, s."SubscriptionPeriod", s.thumbnail, s.thumbnail_url, s.title, s.updated_at, s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status0", s."TwoFactorEnabled", s."UserName", s0.id, s0.course_id, s0.created_at, s0.description, s0."order", s0.title, s0.updated_at, s0.id0, s0.content, s0.created_at0, s0.duration, s0.module_id, s0.order0, s0.title0, s0.type, s0.updated_at0, s0.video_url, s1.id, s1.approved_at, s1.approved_by, s1.comment, s1.course_id, s1.created_at, s1.is_flagged, s1.rating, s1.status, s1.student_id, s1."Id0", s1."AccessFailedCount", s1."Avatar", s1."ConcurrencyStamp", s1."CreatedAt", s1."Email", s1."EmailConfirmed", s1."FullName", s1."LastLoginAt", s1."LockoutEnabled", s1."LockoutEnd", s1."NormalizedEmail", s1."NormalizedUserName", s1."NotificationPreferences", s1."PasswordHash", s1."PhoneNumber", s1."PhoneNumberConfirmed", s1."RefreshToken", s1."RefreshTokenExpiryTime", s1."Role", s1."SecurityStamp", s1."Status0", s1."TwoFactorEnabled", s1."UserName", e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at, a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status" AS "Status0", a."TwoFactorEnabled", a."UserName"
    FROM courses AS c
    INNER JOIN "AspNetUsers" AS a ON c.instructor_id = a."Id"
    WHERE c.id = @__id_0
    LIMIT 1
) AS s
LEFT JOIN (
    SELECT c0.id, c0.course_id, c0.created_at, c0.description, c0."order", c0.title, c0.updated_at, c1.id AS id0, c1.content, c1.created_at AS created_at0, c1.duration, c1.module_id, c1."order" AS order0, c1.title AS title0, c1.type, c1.updated_at AS updated_at0, c1.video_url
    FROM course_modules AS c0
    LEFT JOIN course_lessons AS c1 ON c0.id = c1.module_id
) AS s0 ON s.id = s0.course_id
LEFT JOIN (
    SELECT c2.id, c2.approved_at, c2.approved_by, c2.comment, c2.course_id, c2.created_at, c2.is_flagged, c2.rating, c2.status, c2.student_id, a0."Id" AS "Id0", a0."AccessFailedCount", a0."Avatar", a0."ConcurrencyStamp", a0."CreatedAt", a0."Email", a0."EmailConfirmed", a0."FullName", a0."LastLoginAt", a0."LockoutEnabled", a0."LockoutEnd", a0."NormalizedEmail", a0."NormalizedUserName", a0."NotificationPreferences", a0."PasswordHash", a0."PhoneNumber", a0."PhoneNumberConfirmed", a0."RefreshToken", a0."RefreshTokenExpiryTime", a0."Role", a0."SecurityStamp", a0."Status" AS "Status0", a0."TwoFactorEnabled", a0."UserName"
    FROM course_reviews AS c2
    INNER JOIN "AspNetUsers" AS a0 ON c2.student_id = a0."Id"
) AS s1 ON s.id = s1.course_id
LEFT JOIN enrollments AS e ON s.id = e.course_id
ORDER BY s.id, s."Id0", s0.id, s0.id0, s1.id, s1."Id0"
2025-08-04 11:12:11.569 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.CourseDetailDto'.
2025-08-04 11:12:11.570 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourse (CeceLearningPortal.Api) in 6.9795ms
2025-08-04 11:12:11.571 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourse (CeceLearningPortal.Api)'
2025-08-04 11:12:11.571 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/courses/29 - 200 null application/json; charset=utf-8 13.613ms
2025-08-04 11:12:11.573 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/enrollments - null null
2025-08-04 11:12:11.574 +08:00 [INF] CORS policy execution successful.
2025-08-04 11:12:11.575 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/enrollments - 204 null null 2.0133ms
2025-08-04 11:12:11.576 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/enrollments - application/json null
2025-08-04 11:12:11.577 +08:00 [INF] CORS policy execution successful.
2025-08-04 11:12:11.579 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-04 11:12:11.580 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.EnrollmentsController.GetMyEnrollments (CeceLearningPortal.Api)'
2025-08-04 11:12:11.580 +08:00 [INF] Route matched with {action = "GetMyEnrollments", controller = "Enrollments"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMyEnrollments() on controller CeceLearningPortal.Api.Controllers.EnrollmentsController (CeceLearningPortal.Api).
2025-08-04 11:12:11.582 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__studentId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT e.id AS "Id", e.student_id AS "StudentId", a."FullName" AS "StudentName", e.course_id AS "CourseId", c.title AS "CourseTitle", c.thumbnail AS "CourseThumbnail", a0."FullName" AS "InstructorName", e.enrolled_at AS "EnrolledAt", e.completed_at AS "CompletedAt", e.progress_percentage AS "ProgressPercentage", e.certificate_url AS "CertificateUrl"
FROM enrollments AS e
INNER JOIN "AspNetUsers" AS a ON e.student_id = a."Id"
INNER JOIN courses AS c ON e.course_id = c.id
INNER JOIN "AspNetUsers" AS a0 ON c.instructor_id = a0."Id"
WHERE e.student_id = @__studentId_0
2025-08-04 11:12:11.583 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[CeceLearningPortal.Api.DTOs.EnrollmentDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-08-04 11:12:11.584 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.EnrollmentsController.GetMyEnrollments (CeceLearningPortal.Api) in 3.356ms
2025-08-04 11:12:11.585 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.EnrollmentsController.GetMyEnrollments (CeceLearningPortal.Api)'
2025-08-04 11:12:11.585 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/enrollments - 200 null application/json; charset=utf-8 9.1512ms
2025-08-04 11:12:15.015 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/courses - null null
2025-08-04 11:12:15.017 +08:00 [INF] CORS policy execution successful.
2025-08-04 11:12:15.017 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/courses - 204 null null 1.6845ms
2025-08-04 11:12:15.018 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/courses - application/json null
2025-08-04 11:12:15.019 +08:00 [INF] CORS policy execution successful.
2025-08-04 11:12:15.021 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-04 11:12:15.022 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-08-04 11:12:15.022 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-08-04 11:12:15.026 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-08-04 11:12:15.029 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-08-04 11:12:15.030 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 6.6047ms
2025-08-04 11:12:15.030 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-08-04 11:12:15.031 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/courses - 200 null application/json; charset=utf-8 12.3933ms
2025-08-04 11:12:15.032 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/analytics/platform - null null
2025-08-04 11:12:15.033 +08:00 [INF] CORS policy execution successful.
2025-08-04 11:12:15.034 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/analytics/platform - 204 null null 1.3461ms
2025-08-04 11:12:15.035 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/analytics/platform - application/json null
2025-08-04 11:12:15.036 +08:00 [INF] CORS policy execution successful.
2025-08-04 11:12:15.037 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-04 11:12:15.038 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-08-04 11:12:15.038 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-08-04 11:12:15.039 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/analytics/platform - 403 0 null 4.1474ms
2025-08-04 11:12:15.045 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/analytics/platform - application/json null
2025-08-04 11:12:15.046 +08:00 [INF] CORS policy execution successful.
2025-08-04 11:12:15.048 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-04 11:12:15.049 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-08-04 11:12:15.049 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-08-04 11:12:15.049 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/analytics/platform - 403 0 null 4.4541ms
2025-08-04 11:12:15.056 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/courses/29 - application/json null
2025-08-04 11:12:15.057 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - null null
2025-08-04 11:12:15.057 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - null null
2025-08-04 11:12:15.058 +08:00 [INF] CORS policy execution successful.
2025-08-04 11:12:15.059 +08:00 [INF] CORS policy execution successful.
2025-08-04 11:12:15.060 +08:00 [INF] CORS policy execution successful.
2025-08-04 11:12:15.061 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - 204 null null 4.2086ms
2025-08-04 11:12:15.061 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - 204 null null 3.9736ms
2025-08-04 11:12:15.062 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-04 11:12:15.063 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - application/json null
2025-08-04 11:12:15.064 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - application/json null
2025-08-04 11:12:15.065 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourse (CeceLearningPortal.Api)'
2025-08-04 11:12:15.066 +08:00 [INF] CORS policy execution successful.
2025-08-04 11:12:15.067 +08:00 [INF] CORS policy execution successful.
2025-08-04 11:12:15.068 +08:00 [INF] Route matched with {action = "GetCourse", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourse(Int32) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-08-04 11:12:15.069 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-04 11:12:15.069 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-04 11:12:15.070 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-08-04 11:12:15.071 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-08-04 11:12:15.071 +08:00 [INF] Route matched with {action = "GetInstructorRevenue", controller = "Revenue"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorRevenue(System.String) on controller CeceLearningPortal.Api.Controllers.RevenueController (CeceLearningPortal.Api).
2025-08-04 11:12:15.072 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-08-04 11:12:15.073 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."Id" = @__p_0
LIMIT 1
2025-08-04 11:12:15.075 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at, s.id, s.average_quiz_score, s.certificate_issued, s.certificate_url, s.completed_at, s.completed_lessons, s.course_id, s.enrolled_at, s.last_accessed_date, s.progress_percentage, s.quiz_count, s.student_id, s.total_time_spent, s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", c0.id, c0.approved_at, c0.approved_by, c0.comment, c0.course_id, c0.created_at, c0.is_flagged, c0.rating, c0.status, c0.student_id
FROM courses AS c
LEFT JOIN (
    SELECT e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent, a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM enrollments AS e
    INNER JOIN "AspNetUsers" AS a ON e.student_id = a."Id"
) AS s ON c.id = s.course_id
LEFT JOIN course_reviews AS c0 ON c.id = c0.course_id
WHERE c.instructor_id = @__instructorId_0
ORDER BY c.id, s.id, s."Id0"
2025-08-04 11:12:15.076 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
FROM courses AS c
WHERE c.instructor_id = @__instructorId_0
2025-08-04 11:12:15.078 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
LEFT JOIN courses AS c ON t.course_id = c.id
WHERE c.instructor_id = @__instructorId_0 AND t.status = 'Completed'
2025-08-04 11:12:15.079 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-04 11:12:15.080 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__twelveMonthsAgo_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Year", s."Month", COALESCE(sum(s.amount), 0.0) AS "Revenue"
FROM (
    SELECT t.amount, date_part('year', t.created_at AT TIME ZONE 'UTC')::int AS "Year", date_part('month', t.created_at AT TIME ZONE 'UTC')::int AS "Month"
    FROM transactions AS t
    LEFT JOIN courses AS c ON t.course_id = c.id
    WHERE c.instructor_id = @__instructorId_0 AND t.status = 'Completed' AND t.created_at >= @__twelveMonthsAgo_1
) AS s
GROUP BY s."Year", s."Month"
ORDER BY s."Year", s."Month"
2025-08-04 11:12:15.081 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-04 11:12:15.082 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-04 11:12:15.083 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-04 11:12:15.084 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-04 11:12:15.085 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-04 11:12:15.086 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-04 11:12:15.087 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-04 11:12:15.088 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-04 11:12:15.089 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-04 11:12:15.090 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-04 11:12:15.091 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-04 11:12:15.092 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-04 11:12:15.093 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-04 11:12:15.094 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-04 11:12:15.095 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-04 11:12:15.096 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-04 11:12:15.097 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-04 11:12:15.098 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-04 11:12:15.099 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-04 11:12:15.100 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s.title, s.enrolled_at
FROM (
    SELECT e.enrolled_at, e.student_id, c.title
    FROM enrollments AS e
    INNER JOIN courses AS c ON e.course_id = c.id
    WHERE c.instructor_id = @__instructorId_0
    ORDER BY e.enrolled_at DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s.student_id = a."Id"
ORDER BY s.enrolled_at DESC
2025-08-04 11:12:15.100 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-04 11:12:15.102 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s.title, s.created_at, s.rating
FROM (
    SELECT c.created_at, c.rating, c.student_id, c0.title
    FROM course_reviews AS c
    INNER JOIN courses AS c0 ON c.course_id = c0.id
    WHERE c0.instructor_id = @__instructorId_0
    ORDER BY c.created_at DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s.student_id = a."Id"
ORDER BY s.created_at DESC
2025-08-04 11:12:15.102 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-04 11:12:15.103 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType18`5[[<>f__AnonymousType19`6[[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-04 11:12:15.104 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-04 11:12:15.105 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 31.3044ms
2025-08-04 11:12:15.106 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-04 11:12:15.107 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-08-04 11:12:15.108 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-04 11:12:15.108 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - 200 null application/json; charset=utf-8 44.2664ms
2025-08-04 11:12:15.110 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-04 11:12:15.112 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-04 11:12:15.114 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-04 11:12:15.115 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-04 11:12:15.116 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-04 11:12:15.118 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-04 11:12:15.118 +08:00 [INF] Executed DbCommand (6ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s.id, s."AccessDuration", s."AccessType", s."AutomationAbandonmentSequence", s."AutomationCompletionCertificate", s."AutomationProgressReminders", s."AutomationWelcomeEmail", s.category, s."CourseType", s.created_at, s."Currency", s.description, s.discount, s."DripContent", s."DripScheduleJson", s.duration, s."EnrollmentLimit", s.enrollment_type, s.features, s."HasAssignments", s."HasCertificate", s."HasCommunity", s."HasDownloadableResources", s."HasLiveSessions", s."HasQuizzes", s.instructor_id, s.is_bestseller, s."IsPublished", s."Language", s.level, s.original_price, s."PaymentPlanDetailsJson", s.preview_url, s.price, s."PricingModel", s."PromoVideoUrl", s."PublishedAt", s."ShortDescription", s.status, s."SubscriptionPeriod", s.thumbnail, s.thumbnail_url, s.title, s.updated_at, s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status0", s."TwoFactorEnabled", s."UserName", s0.id, s0.course_id, s0.created_at, s0.description, s0."order", s0.title, s0.updated_at, s0.id0, s0.content, s0.created_at0, s0.duration, s0.module_id, s0.order0, s0.title0, s0.type, s0.updated_at0, s0.video_url, s1.id, s1.approved_at, s1.approved_by, s1.comment, s1.course_id, s1.created_at, s1.is_flagged, s1.rating, s1.status, s1.student_id, s1."Id0", s1."AccessFailedCount", s1."Avatar", s1."ConcurrencyStamp", s1."CreatedAt", s1."Email", s1."EmailConfirmed", s1."FullName", s1."LastLoginAt", s1."LockoutEnabled", s1."LockoutEnd", s1."NormalizedEmail", s1."NormalizedUserName", s1."NotificationPreferences", s1."PasswordHash", s1."PhoneNumber", s1."PhoneNumberConfirmed", s1."RefreshToken", s1."RefreshTokenExpiryTime", s1."Role", s1."SecurityStamp", s1."Status0", s1."TwoFactorEnabled", s1."UserName", e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at, a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status" AS "Status0", a."TwoFactorEnabled", a."UserName"
    FROM courses AS c
    INNER JOIN "AspNetUsers" AS a ON c.instructor_id = a."Id"
    WHERE c.id = @__id_0
    LIMIT 1
) AS s
LEFT JOIN (
    SELECT c0.id, c0.course_id, c0.created_at, c0.description, c0."order", c0.title, c0.updated_at, c1.id AS id0, c1.content, c1.created_at AS created_at0, c1.duration, c1.module_id, c1."order" AS order0, c1.title AS title0, c1.type, c1.updated_at AS updated_at0, c1.video_url
    FROM course_modules AS c0
    LEFT JOIN course_lessons AS c1 ON c0.id = c1.module_id
) AS s0 ON s.id = s0.course_id
LEFT JOIN (
    SELECT c2.id, c2.approved_at, c2.approved_by, c2.comment, c2.course_id, c2.created_at, c2.is_flagged, c2.rating, c2.status, c2.student_id, a0."Id" AS "Id0", a0."AccessFailedCount", a0."Avatar", a0."ConcurrencyStamp", a0."CreatedAt", a0."Email", a0."EmailConfirmed", a0."FullName", a0."LastLoginAt", a0."LockoutEnabled", a0."LockoutEnd", a0."NormalizedEmail", a0."NormalizedUserName", a0."NotificationPreferences", a0."PasswordHash", a0."PhoneNumber", a0."PhoneNumberConfirmed", a0."RefreshToken", a0."RefreshTokenExpiryTime", a0."Role", a0."SecurityStamp", a0."Status" AS "Status0", a0."TwoFactorEnabled", a0."UserName"
    FROM course_reviews AS c2
    INNER JOIN "AspNetUsers" AS a0 ON c2.student_id = a0."Id"
) AS s1 ON s.id = s1.course_id
LEFT JOIN enrollments AS e ON s.id = e.course_id
ORDER BY s.id, s."Id0", s0.id, s0.id0, s1.id, s1."Id0"
2025-08-04 11:12:15.119 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-04 11:12:15.121 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.CourseDetailDto'.
2025-08-04 11:12:15.122 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-04 11:12:15.122 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourse (CeceLearningPortal.Api) in 53.2787ms
2025-08-04 11:12:15.124 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-04 11:12:15.124 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourse (CeceLearningPortal.Api)'
2025-08-04 11:12:15.125 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-04 11:12:15.125 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/courses/29 - 200 null application/json; charset=utf-8 69.293ms
2025-08-04 11:12:15.127 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-04 11:12:15.129 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.InstructorRevenueDto'.
2025-08-04 11:12:15.129 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api) in 56.8949ms
2025-08-04 11:12:15.130 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-08-04 11:12:15.131 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - 200 null application/json; charset=utf-8 67.8782ms
2025-08-04 11:12:45.015 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/courses - null null
2025-08-04 11:12:45.016 +08:00 [INF] CORS policy execution successful.
2025-08-04 11:12:45.017 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/courses - 204 null null 1.5213ms
2025-08-04 11:12:45.018 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/courses - application/json null
2025-08-04 11:12:45.019 +08:00 [INF] CORS policy execution successful.
2025-08-04 11:12:45.022 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-04 11:12:45.023 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-08-04 11:12:45.023 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-08-04 11:12:45.027 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-08-04 11:12:45.029 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-08-04 11:12:45.030 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 5.9117ms
2025-08-04 11:12:45.031 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-08-04 11:12:45.031 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/courses - 200 null application/json; charset=utf-8 13.1821ms
2025-08-04 11:12:45.033 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/analytics/platform - null null
2025-08-04 11:12:45.034 +08:00 [INF] CORS policy execution successful.
2025-08-04 11:12:45.034 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/analytics/platform - 204 null null 1.431ms
2025-08-04 11:12:45.035 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/analytics/platform - application/json null
2025-08-04 11:12:45.036 +08:00 [INF] CORS policy execution successful.
2025-08-04 11:12:45.038 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-04 11:12:45.039 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-08-04 11:12:45.039 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-08-04 11:12:45.040 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/analytics/platform - 403 0 null 4.1593ms
2025-08-04 11:12:45.041 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - null null
2025-08-04 11:12:45.041 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/analytics/platform - application/json null
2025-08-04 11:12:45.041 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - null null
2025-08-04 11:12:45.042 +08:00 [INF] CORS policy execution successful.
2025-08-04 11:12:45.043 +08:00 [INF] CORS policy execution successful.
2025-08-04 11:12:45.044 +08:00 [INF] CORS policy execution successful.
2025-08-04 11:12:45.045 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - 204 null null 3.5665ms
2025-08-04 11:12:45.045 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - 204 null null 4.1161ms
2025-08-04 11:12:45.046 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-04 11:12:45.047 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - application/json null
2025-08-04 11:12:45.048 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - application/json null
2025-08-04 11:12:45.049 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-08-04 11:12:45.050 +08:00 [INF] CORS policy execution successful.
2025-08-04 11:12:45.051 +08:00 [INF] CORS policy execution successful.
2025-08-04 11:12:45.051 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-08-04 11:12:45.052 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-04 11:12:45.053 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/analytics/platform - 403 0 null 11.4181ms
2025-08-04 11:12:45.053 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-04 11:12:45.054 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-08-04 11:12:45.056 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-08-04 11:12:45.056 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-08-04 11:12:45.057 +08:00 [INF] Route matched with {action = "GetInstructorRevenue", controller = "Revenue"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorRevenue(System.String) on controller CeceLearningPortal.Api.Controllers.RevenueController (CeceLearningPortal.Api).
2025-08-04 11:12:45.059 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."Id" = @__p_0
LIMIT 1
2025-08-04 11:12:45.059 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at, s.id, s.average_quiz_score, s.certificate_issued, s.certificate_url, s.completed_at, s.completed_lessons, s.course_id, s.enrolled_at, s.last_accessed_date, s.progress_percentage, s.quiz_count, s.student_id, s.total_time_spent, s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", c0.id, c0.approved_at, c0.approved_by, c0.comment, c0.course_id, c0.created_at, c0.is_flagged, c0.rating, c0.status, c0.student_id
FROM courses AS c
LEFT JOIN (
    SELECT e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent, a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM enrollments AS e
    INNER JOIN "AspNetUsers" AS a ON e.student_id = a."Id"
) AS s ON c.id = s.course_id
LEFT JOIN course_reviews AS c0 ON c.id = c0.course_id
WHERE c.instructor_id = @__instructorId_0
ORDER BY c.id, s.id, s."Id0"
2025-08-04 11:12:45.060 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
FROM courses AS c
WHERE c.instructor_id = @__instructorId_0
2025-08-04 11:12:45.062 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
LEFT JOIN courses AS c ON t.course_id = c.id
WHERE c.instructor_id = @__instructorId_0 AND t.status = 'Completed'
2025-08-04 11:12:45.063 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-04 11:12:45.064 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__twelveMonthsAgo_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Year", s."Month", COALESCE(sum(s.amount), 0.0) AS "Revenue"
FROM (
    SELECT t.amount, date_part('year', t.created_at AT TIME ZONE 'UTC')::int AS "Year", date_part('month', t.created_at AT TIME ZONE 'UTC')::int AS "Month"
    FROM transactions AS t
    LEFT JOIN courses AS c ON t.course_id = c.id
    WHERE c.instructor_id = @__instructorId_0 AND t.status = 'Completed' AND t.created_at >= @__twelveMonthsAgo_1
) AS s
GROUP BY s."Year", s."Month"
ORDER BY s."Year", s."Month"
2025-08-04 11:12:45.064 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-04 11:12:45.066 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-04 11:12:45.066 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-04 11:12:45.067 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-04 11:12:45.068 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-04 11:12:45.069 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-04 11:12:45.070 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-04 11:12:45.071 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-04 11:12:45.072 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-04 11:12:45.073 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-04 11:12:45.074 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-04 11:12:45.075 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-04 11:12:45.076 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-04 11:12:45.076 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-04 11:12:45.077 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-04 11:12:45.078 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-04 11:12:45.079 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-04 11:12:45.080 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-04 11:12:45.081 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-04 11:12:45.082 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s.title, s.enrolled_at
FROM (
    SELECT e.enrolled_at, e.student_id, c.title
    FROM enrollments AS e
    INNER JOIN courses AS c ON e.course_id = c.id
    WHERE c.instructor_id = @__instructorId_0
    ORDER BY e.enrolled_at DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s.student_id = a."Id"
ORDER BY s.enrolled_at DESC
2025-08-04 11:12:45.083 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-04 11:12:45.084 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s.title, s.created_at, s.rating
FROM (
    SELECT c.created_at, c.rating, c.student_id, c0.title
    FROM course_reviews AS c
    INNER JOIN courses AS c0 ON c.course_id = c0.id
    WHERE c0.instructor_id = @__instructorId_0
    ORDER BY c.created_at DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s.student_id = a."Id"
ORDER BY s.created_at DESC
2025-08-04 11:12:45.084 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-04 11:12:45.085 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType18`5[[<>f__AnonymousType19`6[[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-04 11:12:45.086 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-04 11:12:45.087 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 29.3386ms
2025-08-04 11:12:45.088 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-04 11:12:45.088 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-08-04 11:12:45.089 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-04 11:12:45.090 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - 200 null application/json; charset=utf-8 42.8362ms
2025-08-04 11:12:45.091 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-04 11:12:45.093 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-04 11:12:45.094 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-04 11:12:45.095 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-04 11:12:45.097 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-04 11:12:45.098 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-04 11:12:45.099 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-04 11:12:45.100 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-04 11:12:45.101 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-04 11:12:45.102 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-04 11:12:45.104 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-04 11:12:45.104 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.InstructorRevenueDto'.
2025-08-04 11:12:45.105 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api) in 46.7217ms
2025-08-04 11:12:45.106 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-08-04 11:12:45.106 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - 200 null application/json; charset=utf-8 58.163ms
2025-08-04 11:13:15.019 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/courses - null null
2025-08-04 11:13:15.020 +08:00 [INF] CORS policy execution successful.
2025-08-04 11:13:15.020 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/courses - 204 null null 1.5154ms
2025-08-04 11:13:15.021 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/courses - application/json null
2025-08-04 11:13:15.022 +08:00 [INF] CORS policy execution successful.
2025-08-04 11:13:15.024 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-04 11:13:15.025 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-08-04 11:13:15.026 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-08-04 11:13:15.029 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-08-04 11:13:15.031 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-08-04 11:13:15.032 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 5.5923ms
2025-08-04 11:13:15.033 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-08-04 11:13:15.033 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/courses - 200 null application/json; charset=utf-8 11.84ms
2025-08-04 11:13:15.035 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/analytics/platform - null null
2025-08-04 11:13:15.036 +08:00 [INF] CORS policy execution successful.
2025-08-04 11:13:15.036 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/analytics/platform - 204 null null 1.3478ms
2025-08-04 11:13:15.037 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/analytics/platform - application/json null
2025-08-04 11:13:15.038 +08:00 [INF] CORS policy execution successful.
2025-08-04 11:13:15.040 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-04 11:13:15.040 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-08-04 11:13:15.041 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-08-04 11:13:15.042 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/analytics/platform - 403 0 null 4.2344ms
2025-08-04 11:13:15.043 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - null null
2025-08-04 11:13:15.044 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/analytics/platform - application/json null
2025-08-04 11:13:15.044 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - null null
2025-08-04 11:13:15.045 +08:00 [INF] CORS policy execution successful.
2025-08-04 11:13:15.046 +08:00 [INF] CORS policy execution successful.
2025-08-04 11:13:15.047 +08:00 [INF] CORS policy execution successful.
2025-08-04 11:13:15.048 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - 204 null null 4.2464ms
2025-08-04 11:13:15.048 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - 204 null null 4.4706ms
2025-08-04 11:13:15.049 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-04 11:13:15.050 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - application/json null
2025-08-04 11:13:15.051 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - application/json null
2025-08-04 11:13:15.052 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-08-04 11:13:15.053 +08:00 [INF] CORS policy execution successful.
2025-08-04 11:13:15.054 +08:00 [INF] CORS policy execution successful.
2025-08-04 11:13:15.054 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-08-04 11:13:15.055 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-04 11:13:15.055 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/analytics/platform - 403 0 null 11.5861ms
2025-08-04 11:13:15.055 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-04 11:13:15.056 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-08-04 11:13:15.058 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-08-04 11:13:15.059 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-08-04 11:13:15.059 +08:00 [INF] Route matched with {action = "GetInstructorRevenue", controller = "Revenue"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorRevenue(System.String) on controller CeceLearningPortal.Api.Controllers.RevenueController (CeceLearningPortal.Api).
2025-08-04 11:13:15.062 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at, s.id, s.average_quiz_score, s.certificate_issued, s.certificate_url, s.completed_at, s.completed_lessons, s.course_id, s.enrolled_at, s.last_accessed_date, s.progress_percentage, s.quiz_count, s.student_id, s.total_time_spent, s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", c0.id, c0.approved_at, c0.approved_by, c0.comment, c0.course_id, c0.created_at, c0.is_flagged, c0.rating, c0.status, c0.student_id
FROM courses AS c
LEFT JOIN (
    SELECT e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent, a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM enrollments AS e
    INNER JOIN "AspNetUsers" AS a ON e.student_id = a."Id"
) AS s ON c.id = s.course_id
LEFT JOIN course_reviews AS c0 ON c.id = c0.course_id
WHERE c.instructor_id = @__instructorId_0
ORDER BY c.id, s.id, s."Id0"
2025-08-04 11:13:15.062 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."Id" = @__p_0
LIMIT 1
2025-08-04 11:13:15.064 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
LEFT JOIN courses AS c ON t.course_id = c.id
WHERE c.instructor_id = @__instructorId_0 AND t.status = 'Completed'
2025-08-04 11:13:15.064 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
FROM courses AS c
WHERE c.instructor_id = @__instructorId_0
2025-08-04 11:13:15.066 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__twelveMonthsAgo_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Year", s."Month", COALESCE(sum(s.amount), 0.0) AS "Revenue"
FROM (
    SELECT t.amount, date_part('year', t.created_at AT TIME ZONE 'UTC')::int AS "Year", date_part('month', t.created_at AT TIME ZONE 'UTC')::int AS "Month"
    FROM transactions AS t
    LEFT JOIN courses AS c ON t.course_id = c.id
    WHERE c.instructor_id = @__instructorId_0 AND t.status = 'Completed' AND t.created_at >= @__twelveMonthsAgo_1
) AS s
GROUP BY s."Year", s."Month"
ORDER BY s."Year", s."Month"
2025-08-04 11:13:15.067 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-04 11:13:15.067 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-04 11:13:15.068 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-04 11:13:15.069 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-04 11:13:15.071 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-04 11:13:15.071 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-04 11:13:15.072 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-04 11:13:15.073 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-04 11:13:15.074 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-04 11:13:15.075 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-04 11:13:15.076 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-04 11:13:15.077 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-04 11:13:15.078 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-04 11:13:15.079 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-04 11:13:15.079 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-04 11:13:15.080 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-04 11:13:15.081 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-04 11:13:15.082 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-04 11:13:15.083 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-04 11:13:15.084 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s.title, s.enrolled_at
FROM (
    SELECT e.enrolled_at, e.student_id, c.title
    FROM enrollments AS e
    INNER JOIN courses AS c ON e.course_id = c.id
    WHERE c.instructor_id = @__instructorId_0
    ORDER BY e.enrolled_at DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s.student_id = a."Id"
ORDER BY s.enrolled_at DESC
2025-08-04 11:13:15.085 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-04 11:13:15.086 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s.title, s.created_at, s.rating
FROM (
    SELECT c.created_at, c.rating, c.student_id, c0.title
    FROM course_reviews AS c
    INNER JOIN courses AS c0 ON c.course_id = c0.id
    WHERE c0.instructor_id = @__instructorId_0
    ORDER BY c.created_at DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s.student_id = a."Id"
ORDER BY s.created_at DESC
2025-08-04 11:13:15.087 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-04 11:13:15.087 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType18`5[[<>f__AnonymousType19`6[[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-04 11:13:15.088 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-04 11:13:15.089 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 29.116ms
2025-08-04 11:13:15.090 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-04 11:13:15.091 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-08-04 11:13:15.092 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-04 11:13:15.092 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - 200 null application/json; charset=utf-8 41.9171ms
2025-08-04 11:13:15.093 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-04 11:13:15.095 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-04 11:13:15.096 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-04 11:13:15.097 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-04 11:13:15.099 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-04 11:13:15.100 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-04 11:13:15.101 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-04 11:13:15.102 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-04 11:13:15.103 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-04 11:13:15.104 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-04 11:13:15.106 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-04 11:13:15.107 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-04 11:13:15.108 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.InstructorRevenueDto'.
2025-08-04 11:13:15.109 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api) in 47.6654ms
2025-08-04 11:13:15.109 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-08-04 11:13:15.110 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - 200 null application/json; charset=utf-8 58.6933ms
2025-08-04 11:13:28.956 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/courses - null null
2025-08-04 11:13:28.958 +08:00 [INF] CORS policy execution successful.
2025-08-04 11:13:28.958 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/courses - 204 null null 2.0871ms
2025-08-04 11:13:28.960 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/courses - application/json null
2025-08-04 11:13:28.961 +08:00 [INF] CORS policy execution successful.
2025-08-04 11:13:28.962 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-04 11:13:28.963 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-08-04 11:13:28.963 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-08-04 11:13:28.967 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-08-04 11:13:28.969 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-08-04 11:13:28.970 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 5.4241ms
2025-08-04 11:13:28.970 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-08-04 11:13:28.971 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/courses - 200 null application/json; charset=utf-8 11.3943ms
2025-08-04 11:13:28.972 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/analytics/platform - null null
2025-08-04 11:13:28.973 +08:00 [INF] CORS policy execution successful.
2025-08-04 11:13:28.974 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/analytics/platform - 204 null null 1.359ms
2025-08-04 11:13:28.975 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/analytics/platform - application/json null
2025-08-04 11:13:28.976 +08:00 [INF] CORS policy execution successful.
2025-08-04 11:13:28.978 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-04 11:13:28.979 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-08-04 11:13:28.979 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-08-04 11:13:28.980 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/analytics/platform - 403 0 null 4.5148ms
2025-08-04 11:13:28.981 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - null null
2025-08-04 11:13:28.981 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - null null
2025-08-04 11:13:28.981 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/analytics/platform - application/json null
2025-08-04 11:13:28.982 +08:00 [INF] CORS policy execution successful.
2025-08-04 11:13:28.983 +08:00 [INF] CORS policy execution successful.
2025-08-04 11:13:28.984 +08:00 [INF] CORS policy execution successful.
2025-08-04 11:13:28.985 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - 204 null null 3.364ms
2025-08-04 11:13:28.985 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - 204 null null 3.5924ms
2025-08-04 11:13:28.986 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-04 11:13:28.987 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - application/json null
2025-08-04 11:13:28.988 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - application/json null
2025-08-04 11:13:28.989 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-08-04 11:13:28.990 +08:00 [INF] CORS policy execution successful.
2025-08-04 11:13:28.991 +08:00 [INF] CORS policy execution successful.
2025-08-04 11:13:28.991 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-08-04 11:13:28.992 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-04 11:13:28.992 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/analytics/platform - 403 0 null 10.87ms
2025-08-04 11:13:28.992 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-04 11:13:28.993 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-08-04 11:13:28.995 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-08-04 11:13:28.996 +08:00 [INF] Route matched with {action = "GetInstructorRevenue", controller = "Revenue"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorRevenue(System.String) on controller CeceLearningPortal.Api.Controllers.RevenueController (CeceLearningPortal.Api).
2025-08-04 11:13:28.996 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-08-04 11:13:28.998 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."Id" = @__p_0
LIMIT 1
2025-08-04 11:13:28.999 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at, s.id, s.average_quiz_score, s.certificate_issued, s.certificate_url, s.completed_at, s.completed_lessons, s.course_id, s.enrolled_at, s.last_accessed_date, s.progress_percentage, s.quiz_count, s.student_id, s.total_time_spent, s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", c0.id, c0.approved_at, c0.approved_by, c0.comment, c0.course_id, c0.created_at, c0.is_flagged, c0.rating, c0.status, c0.student_id
FROM courses AS c
LEFT JOIN (
    SELECT e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent, a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM enrollments AS e
    INNER JOIN "AspNetUsers" AS a ON e.student_id = a."Id"
) AS s ON c.id = s.course_id
LEFT JOIN course_reviews AS c0 ON c.id = c0.course_id
WHERE c.instructor_id = @__instructorId_0
ORDER BY c.id, s.id, s."Id0"
2025-08-04 11:13:29.000 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
FROM courses AS c
WHERE c.instructor_id = @__instructorId_0
2025-08-04 11:13:29.001 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
LEFT JOIN courses AS c ON t.course_id = c.id
WHERE c.instructor_id = @__instructorId_0 AND t.status = 'Completed'
2025-08-04 11:13:29.002 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-04 11:13:29.003 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?', @__twelveMonthsAgo_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Year", s."Month", COALESCE(sum(s.amount), 0.0) AS "Revenue"
FROM (
    SELECT t.amount, date_part('year', t.created_at AT TIME ZONE 'UTC')::int AS "Year", date_part('month', t.created_at AT TIME ZONE 'UTC')::int AS "Month"
    FROM transactions AS t
    LEFT JOIN courses AS c ON t.course_id = c.id
    WHERE c.instructor_id = @__instructorId_0 AND t.status = 'Completed' AND t.created_at >= @__twelveMonthsAgo_1
) AS s
GROUP BY s."Year", s."Month"
ORDER BY s."Year", s."Month"
2025-08-04 11:13:29.004 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-04 11:13:29.005 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-04 11:13:29.006 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-04 11:13:29.007 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-04 11:13:29.008 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-04 11:13:29.008 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-04 11:13:29.009 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-04 11:13:29.010 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-04 11:13:29.011 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-04 11:13:29.012 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-04 11:13:29.013 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-04 11:13:29.014 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-04 11:13:29.015 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-04 11:13:29.016 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-04 11:13:29.017 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-04 11:13:29.017 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-04 11:13:29.018 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-04 11:13:29.019 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-04 11:13:29.020 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-04 11:13:29.021 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s.title, s.enrolled_at
FROM (
    SELECT e.enrolled_at, e.student_id, c.title
    FROM enrollments AS e
    INNER JOIN courses AS c ON e.course_id = c.id
    WHERE c.instructor_id = @__instructorId_0
    ORDER BY e.enrolled_at DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s.student_id = a."Id"
ORDER BY s.enrolled_at DESC
2025-08-04 11:13:29.022 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-04 11:13:29.023 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s.title, s.created_at, s.rating
FROM (
    SELECT c.created_at, c.rating, c.student_id, c0.title
    FROM course_reviews AS c
    INNER JOIN courses AS c0 ON c.course_id = c0.id
    WHERE c0.instructor_id = @__instructorId_0
    ORDER BY c.created_at DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s.student_id = a."Id"
ORDER BY s.created_at DESC
2025-08-04 11:13:29.024 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-04 11:13:29.026 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType18`5[[<>f__AnonymousType19`6[[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-04 11:13:29.027 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-04 11:13:29.028 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 30.2621ms
2025-08-04 11:13:29.030 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-04 11:13:29.030 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-08-04 11:13:29.032 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-04 11:13:29.032 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - 200 null application/json; charset=utf-8 44.3056ms
2025-08-04 11:13:29.034 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-04 11:13:29.037 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-04 11:13:29.038 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-04 11:13:29.039 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-04 11:13:29.041 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-04 11:13:29.043 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-04 11:13:29.044 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-04 11:13:29.046 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-04 11:13:29.047 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-04 11:13:29.049 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-04 11:13:29.050 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-04 11:13:29.052 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.InstructorRevenueDto'.
2025-08-04 11:13:29.052 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api) in 55.2784ms
2025-08-04 11:13:29.053 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-08-04 11:13:29.054 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - 200 null application/json; charset=utf-8 67.207ms
2025-08-04 11:56:26.933 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/courses - null null
2025-08-04 11:56:26.934 +08:00 [INF] CORS policy execution successful.
2025-08-04 11:56:26.934 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/courses - 204 null null 1.8691ms
2025-08-04 11:56:26.936 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/courses - application/json null
2025-08-04 11:56:26.938 +08:00 [INF] CORS policy execution successful.
2025-08-04 11:56:26.987 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-04 11:56:26.988 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-08-04 11:56:26.988 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-08-04 11:56:26.997 +08:00 [INF] Executed DbCommand (7ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-08-04 11:56:27.000 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-08-04 11:56:27.001 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 11.6109ms
2025-08-04 11:56:27.002 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-08-04 11:56:27.002 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/courses - application/json null
2025-08-04 11:56:27.003 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/courses - 200 null application/json; charset=utf-8 66.212ms
2025-08-04 11:56:27.004 +08:00 [INF] CORS policy execution successful.
2025-08-04 11:56:27.006 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/analytics/platform - null null
2025-08-04 11:56:27.007 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-04 11:56:27.007 +08:00 [INF] CORS policy execution successful.
2025-08-04 11:56:27.009 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-08-04 11:56:27.009 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/analytics/platform - 204 null null 3.0773ms
2025-08-04 11:56:27.010 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-08-04 11:56:27.012 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/analytics/platform - application/json null
2025-08-04 11:56:27.014 +08:00 [INF] CORS policy execution successful.
2025-08-04 11:56:27.016 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-08-04 11:56:27.019 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-08-04 11:56:27.020 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 7.414ms
2025-08-04 11:56:27.021 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-08-04 11:56:27.022 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/courses - 200 null application/json; charset=utf-8 19.6221ms
2025-08-04 11:56:27.062 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-04 11:56:27.063 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-08-04 11:56:27.063 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-08-04 11:56:27.064 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/analytics/platform - 403 0 null 51.9233ms
2025-08-04 11:56:27.065 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - null null
2025-08-04 11:56:27.065 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/analytics/platform - application/json null
2025-08-04 11:56:27.066 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - null null
2025-08-04 11:56:27.066 +08:00 [INF] CORS policy execution successful.
2025-08-04 11:56:27.067 +08:00 [INF] CORS policy execution successful.
2025-08-04 11:56:27.068 +08:00 [INF] CORS policy execution successful.
2025-08-04 11:56:27.069 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - 204 null null 3.4323ms
2025-08-04 11:56:27.069 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - 204 null null 3.733ms
2025-08-04 11:56:27.070 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-04 11:56:27.071 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - application/json null
2025-08-04 11:56:27.072 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - application/json null
2025-08-04 11:56:27.073 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-08-04 11:56:27.074 +08:00 [INF] CORS policy execution successful.
2025-08-04 11:56:27.075 +08:00 [INF] CORS policy execution successful.
2025-08-04 11:56:27.076 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-08-04 11:56:27.077 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-04 11:56:27.077 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-04 11:56:27.077 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/analytics/platform - 403 0 null 11.7504ms
2025-08-04 11:56:27.078 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-08-04 11:56:27.079 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-08-04 11:56:27.081 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/analytics/platform - application/json null
2025-08-04 11:56:27.081 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-08-04 11:56:27.082 +08:00 [INF] Route matched with {action = "GetInstructorRevenue", controller = "Revenue"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorRevenue(System.String) on controller CeceLearningPortal.Api.Controllers.RevenueController (CeceLearningPortal.Api).
2025-08-04 11:56:27.083 +08:00 [INF] CORS policy execution successful.
2025-08-04 11:56:27.085 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."Id" = @__p_0
LIMIT 1
2025-08-04 11:56:27.087 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
FROM courses AS c
WHERE c.instructor_id = @__instructorId_0
2025-08-04 11:56:27.088 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-04 11:56:27.089 +08:00 [INF] Executed DbCommand (5ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at, s.id, s.average_quiz_score, s.certificate_issued, s.certificate_url, s.completed_at, s.completed_lessons, s.course_id, s.enrolled_at, s.last_accessed_date, s.progress_percentage, s.quiz_count, s.student_id, s.total_time_spent, s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", c0.id, c0.approved_at, c0.approved_by, c0.comment, c0.course_id, c0.created_at, c0.is_flagged, c0.rating, c0.status, c0.student_id
FROM courses AS c
LEFT JOIN (
    SELECT e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent, a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM enrollments AS e
    INNER JOIN "AspNetUsers" AS a ON e.student_id = a."Id"
) AS s ON c.id = s.course_id
LEFT JOIN course_reviews AS c0 ON c.id = c0.course_id
WHERE c.instructor_id = @__instructorId_0
ORDER BY c.id, s.id, s."Id0"
2025-08-04 11:56:27.091 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-04 11:56:27.093 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-04 11:56:27.093 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
LEFT JOIN courses AS c ON t.course_id = c.id
WHERE c.instructor_id = @__instructorId_0 AND t.status = 'Completed'
2025-08-04 11:56:27.094 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-04 11:56:27.095 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?', @__twelveMonthsAgo_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Year", s."Month", COALESCE(sum(s.amount), 0.0) AS "Revenue"
FROM (
    SELECT t.amount, date_part('year', t.created_at AT TIME ZONE 'UTC')::int AS "Year", date_part('month', t.created_at AT TIME ZONE 'UTC')::int AS "Month"
    FROM transactions AS t
    LEFT JOIN courses AS c ON t.course_id = c.id
    WHERE c.instructor_id = @__instructorId_0 AND t.status = 'Completed' AND t.created_at >= @__twelveMonthsAgo_1
) AS s
GROUP BY s."Year", s."Month"
ORDER BY s."Year", s."Month"
2025-08-04 11:56:27.096 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-04 11:56:27.098 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-04 11:56:27.099 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-04 11:56:27.100 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-04 11:56:27.101 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-04 11:56:27.103 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-04 11:56:27.104 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-04 11:56:27.105 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-04 11:56:27.106 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-04 11:56:27.107 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-04 11:56:27.108 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-04 11:56:27.109 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-04 11:56:27.110 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-04 11:56:27.111 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-04 11:56:27.112 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-04 11:56:27.113 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-04 11:56:27.114 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-04 11:56:27.115 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-04 11:56:27.116 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-04 11:56:27.117 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s.title, s.enrolled_at
FROM (
    SELECT e.enrolled_at, e.student_id, c.title
    FROM enrollments AS e
    INNER JOIN courses AS c ON e.course_id = c.id
    WHERE c.instructor_id = @__instructorId_0
    ORDER BY e.enrolled_at DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s.student_id = a."Id"
ORDER BY s.enrolled_at DESC
2025-08-04 11:56:27.118 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-04 11:56:27.119 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s.title, s.created_at, s.rating
FROM (
    SELECT c.created_at, c.rating, c.student_id, c0.title
    FROM course_reviews AS c
    INNER JOIN courses AS c0 ON c.course_id = c0.id
    WHERE c0.instructor_id = @__instructorId_0
    ORDER BY c.created_at DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s.student_id = a."Id"
ORDER BY s.created_at DESC
2025-08-04 11:56:27.120 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-04 11:56:27.121 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType18`5[[<>f__AnonymousType19`6[[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-04 11:56:27.123 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 39.7505ms
2025-08-04 11:56:27.123 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-04 11:56:27.124 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-08-04 11:56:27.126 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-04 11:56:27.126 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - 200 null application/json; charset=utf-8 55.1934ms
2025-08-04 11:56:27.128 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-04 11:56:27.130 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-04 11:56:27.132 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-04 11:56:27.133 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-04 11:56:27.134 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-04 11:56:27.135 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-04 11:56:27.137 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-04 11:56:27.138 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-04 11:56:27.140 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-04 11:56:27.141 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.InstructorRevenueDto'.
2025-08-04 11:56:27.141 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api) in 57.019ms
2025-08-04 11:56:27.142 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-08-04 11:56:27.143 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - 200 null application/json; charset=utf-8 70.5461ms
2025-08-04 11:56:27.225 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-04 11:56:27.226 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-08-04 11:56:27.226 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-08-04 11:56:27.227 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/analytics/platform - 403 0 null 146.2984ms
2025-08-04 11:56:27.229 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/analytics/platform - application/json null
2025-08-04 11:56:27.229 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - application/json null
2025-08-04 11:56:27.229 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - application/json null
2025-08-04 11:56:27.230 +08:00 [INF] CORS policy execution successful.
2025-08-04 11:56:27.231 +08:00 [INF] CORS policy execution successful.
2025-08-04 11:56:27.232 +08:00 [INF] CORS policy execution successful.
2025-08-04 11:56:27.233 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-04 11:56:27.233 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-04 11:56:27.234 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-04 11:56:27.234 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-08-04 11:56:27.235 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-08-04 11:56:27.236 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-08-04 11:56:27.236 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-08-04 11:56:27.237 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-08-04 11:56:27.237 +08:00 [INF] Route matched with {action = "GetInstructorRevenue", controller = "Revenue"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorRevenue(System.String) on controller CeceLearningPortal.Api.Controllers.RevenueController (CeceLearningPortal.Api).
2025-08-04 11:56:27.238 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/analytics/platform - 403 0 null 9.1411ms
2025-08-04 11:56:27.240 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."Id" = @__p_0
LIMIT 1
2025-08-04 11:56:27.240 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at, s.id, s.average_quiz_score, s.certificate_issued, s.certificate_url, s.completed_at, s.completed_lessons, s.course_id, s.enrolled_at, s.last_accessed_date, s.progress_percentage, s.quiz_count, s.student_id, s.total_time_spent, s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", c0.id, c0.approved_at, c0.approved_by, c0.comment, c0.course_id, c0.created_at, c0.is_flagged, c0.rating, c0.status, c0.student_id
FROM courses AS c
LEFT JOIN (
    SELECT e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent, a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM enrollments AS e
    INNER JOIN "AspNetUsers" AS a ON e.student_id = a."Id"
) AS s ON c.id = s.course_id
LEFT JOIN course_reviews AS c0 ON c.id = c0.course_id
WHERE c.instructor_id = @__instructorId_0
ORDER BY c.id, s.id, s."Id0"
2025-08-04 11:56:27.243 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
FROM courses AS c
WHERE c.instructor_id = @__instructorId_0
2025-08-04 11:56:27.245 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
LEFT JOIN courses AS c ON t.course_id = c.id
WHERE c.instructor_id = @__instructorId_0 AND t.status = 'Completed'
2025-08-04 11:56:27.245 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-04 11:56:27.247 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-04 11:56:27.247 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__instructorId_0='?', @__twelveMonthsAgo_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Year", s."Month", COALESCE(sum(s.amount), 0.0) AS "Revenue"
FROM (
    SELECT t.amount, date_part('year', t.created_at AT TIME ZONE 'UTC')::int AS "Year", date_part('month', t.created_at AT TIME ZONE 'UTC')::int AS "Month"
    FROM transactions AS t
    LEFT JOIN courses AS c ON t.course_id = c.id
    WHERE c.instructor_id = @__instructorId_0 AND t.status = 'Completed' AND t.created_at >= @__twelveMonthsAgo_1
) AS s
GROUP BY s."Year", s."Month"
ORDER BY s."Year", s."Month"
2025-08-04 11:56:27.249 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-04 11:56:27.250 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-04 11:56:27.251 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-04 11:56:27.252 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-04 11:56:27.252 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-04 11:56:27.253 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-04 11:56:27.254 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-04 11:56:27.255 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-04 11:56:27.256 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-04 11:56:27.257 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-04 11:56:27.258 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-04 11:56:27.259 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-04 11:56:27.260 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-04 11:56:27.261 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-04 11:56:27.262 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-04 11:56:27.263 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-04 11:56:27.264 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-04 11:56:27.265 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-04 11:56:27.266 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-04 11:56:27.267 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s.title, s.enrolled_at
FROM (
    SELECT e.enrolled_at, e.student_id, c.title
    FROM enrollments AS e
    INNER JOIN courses AS c ON e.course_id = c.id
    WHERE c.instructor_id = @__instructorId_0
    ORDER BY e.enrolled_at DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s.student_id = a."Id"
ORDER BY s.enrolled_at DESC
2025-08-04 11:56:27.267 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-04 11:56:27.269 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s.title, s.created_at, s.rating
FROM (
    SELECT c.created_at, c.rating, c.student_id, c0.title
    FROM course_reviews AS c
    INNER JOIN courses AS c0 ON c.course_id = c0.id
    WHERE c0.instructor_id = @__instructorId_0
    ORDER BY c.created_at DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s.student_id = a."Id"
ORDER BY s.created_at DESC
2025-08-04 11:56:27.269 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-04 11:56:27.270 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType18`5[[<>f__AnonymousType19`6[[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-04 11:56:27.272 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 33.5837ms
2025-08-04 11:56:27.273 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-04 11:56:27.273 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-08-04 11:56:27.275 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-04 11:56:27.275 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - 200 null application/json; charset=utf-8 45.9255ms
2025-08-04 11:56:27.278 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-04 11:56:27.280 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-04 11:56:27.282 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-04 11:56:27.283 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-04 11:56:27.285 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-04 11:56:27.287 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-04 11:56:27.289 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-04 11:56:27.291 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-04 11:56:27.293 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-04 11:56:27.294 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-04 11:56:27.296 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-04 11:56:27.297 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.InstructorRevenueDto'.
2025-08-04 11:56:27.298 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api) in 58.4098ms
2025-08-04 11:56:27.299 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-08-04 11:56:27.299 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - 200 null application/json; charset=utf-8 69.9583ms
2025-08-04 11:56:32.674 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/courses/34 - null null
2025-08-04 11:56:32.675 +08:00 [INF] CORS policy execution successful.
2025-08-04 11:56:32.676 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/courses/34 - 204 null null 2.0746ms
2025-08-04 11:56:32.678 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/courses/34 - application/json null
2025-08-04 11:56:32.679 +08:00 [INF] CORS policy execution successful.
2025-08-04 11:56:32.680 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-04 11:56:32.682 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourse (CeceLearningPortal.Api)'
2025-08-04 11:56:32.683 +08:00 [INF] Route matched with {action = "GetCourse", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourse(Int32) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-08-04 11:56:32.687 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s.id, s."AccessDuration", s."AccessType", s."AutomationAbandonmentSequence", s."AutomationCompletionCertificate", s."AutomationProgressReminders", s."AutomationWelcomeEmail", s.category, s."CourseType", s.created_at, s."Currency", s.description, s.discount, s."DripContent", s."DripScheduleJson", s.duration, s."EnrollmentLimit", s.enrollment_type, s.features, s."HasAssignments", s."HasCertificate", s."HasCommunity", s."HasDownloadableResources", s."HasLiveSessions", s."HasQuizzes", s.instructor_id, s.is_bestseller, s."IsPublished", s."Language", s.level, s.original_price, s."PaymentPlanDetailsJson", s.preview_url, s.price, s."PricingModel", s."PromoVideoUrl", s."PublishedAt", s."ShortDescription", s.status, s."SubscriptionPeriod", s.thumbnail, s.thumbnail_url, s.title, s.updated_at, s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status0", s."TwoFactorEnabled", s."UserName", s0.id, s0.course_id, s0.created_at, s0.description, s0."order", s0.title, s0.updated_at, s0.id0, s0.content, s0.created_at0, s0.duration, s0.module_id, s0.order0, s0.title0, s0.type, s0.updated_at0, s0.video_url, s1.id, s1.approved_at, s1.approved_by, s1.comment, s1.course_id, s1.created_at, s1.is_flagged, s1.rating, s1.status, s1.student_id, s1."Id0", s1."AccessFailedCount", s1."Avatar", s1."ConcurrencyStamp", s1."CreatedAt", s1."Email", s1."EmailConfirmed", s1."FullName", s1."LastLoginAt", s1."LockoutEnabled", s1."LockoutEnd", s1."NormalizedEmail", s1."NormalizedUserName", s1."NotificationPreferences", s1."PasswordHash", s1."PhoneNumber", s1."PhoneNumberConfirmed", s1."RefreshToken", s1."RefreshTokenExpiryTime", s1."Role", s1."SecurityStamp", s1."Status0", s1."TwoFactorEnabled", s1."UserName", e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at, a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status" AS "Status0", a."TwoFactorEnabled", a."UserName"
    FROM courses AS c
    INNER JOIN "AspNetUsers" AS a ON c.instructor_id = a."Id"
    WHERE c.id = @__id_0
    LIMIT 1
) AS s
LEFT JOIN (
    SELECT c0.id, c0.course_id, c0.created_at, c0.description, c0."order", c0.title, c0.updated_at, c1.id AS id0, c1.content, c1.created_at AS created_at0, c1.duration, c1.module_id, c1."order" AS order0, c1.title AS title0, c1.type, c1.updated_at AS updated_at0, c1.video_url
    FROM course_modules AS c0
    LEFT JOIN course_lessons AS c1 ON c0.id = c1.module_id
) AS s0 ON s.id = s0.course_id
LEFT JOIN (
    SELECT c2.id, c2.approved_at, c2.approved_by, c2.comment, c2.course_id, c2.created_at, c2.is_flagged, c2.rating, c2.status, c2.student_id, a0."Id" AS "Id0", a0."AccessFailedCount", a0."Avatar", a0."ConcurrencyStamp", a0."CreatedAt", a0."Email", a0."EmailConfirmed", a0."FullName", a0."LastLoginAt", a0."LockoutEnabled", a0."LockoutEnd", a0."NormalizedEmail", a0."NormalizedUserName", a0."NotificationPreferences", a0."PasswordHash", a0."PhoneNumber", a0."PhoneNumberConfirmed", a0."RefreshToken", a0."RefreshTokenExpiryTime", a0."Role", a0."SecurityStamp", a0."Status" AS "Status0", a0."TwoFactorEnabled", a0."UserName"
    FROM course_reviews AS c2
    INNER JOIN "AspNetUsers" AS a0 ON c2.student_id = a0."Id"
) AS s1 ON s.id = s1.course_id
LEFT JOIN enrollments AS e ON s.id = e.course_id
ORDER BY s.id, s."Id0", s0.id, s0.id0, s1.id, s1."Id0"
2025-08-04 11:56:32.690 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.CourseDetailDto'.
2025-08-04 11:56:32.691 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourse (CeceLearningPortal.Api) in 7.1122ms
2025-08-04 11:56:32.691 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourse (CeceLearningPortal.Api)'
2025-08-04 11:56:32.692 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/courses/34 - 200 null application/json; charset=utf-8 14.187ms
2025-08-04 11:56:32.693 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/enrollments - null null
2025-08-04 11:56:32.695 +08:00 [INF] CORS policy execution successful.
2025-08-04 11:56:32.695 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/enrollments - 204 null null 1.545ms
2025-08-04 11:56:32.696 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/enrollments - application/json null
2025-08-04 11:56:32.697 +08:00 [INF] CORS policy execution successful.
2025-08-04 11:56:32.699 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-04 11:56:32.700 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.EnrollmentsController.GetMyEnrollments (CeceLearningPortal.Api)'
2025-08-04 11:56:32.700 +08:00 [INF] Route matched with {action = "GetMyEnrollments", controller = "Enrollments"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMyEnrollments() on controller CeceLearningPortal.Api.Controllers.EnrollmentsController (CeceLearningPortal.Api).
2025-08-04 11:56:32.702 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__studentId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT e.id AS "Id", e.student_id AS "StudentId", a."FullName" AS "StudentName", e.course_id AS "CourseId", c.title AS "CourseTitle", c.thumbnail AS "CourseThumbnail", a0."FullName" AS "InstructorName", e.enrolled_at AS "EnrolledAt", e.completed_at AS "CompletedAt", e.progress_percentage AS "ProgressPercentage", e.certificate_url AS "CertificateUrl"
FROM enrollments AS e
INNER JOIN "AspNetUsers" AS a ON e.student_id = a."Id"
INNER JOIN courses AS c ON e.course_id = c.id
INNER JOIN "AspNetUsers" AS a0 ON c.instructor_id = a0."Id"
WHERE e.student_id = @__studentId_0
2025-08-04 11:56:32.704 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[CeceLearningPortal.Api.DTOs.EnrollmentDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-08-04 11:56:32.705 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.EnrollmentsController.GetMyEnrollments (CeceLearningPortal.Api) in 3.3322ms
2025-08-04 11:56:32.705 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.EnrollmentsController.GetMyEnrollments (CeceLearningPortal.Api)'
2025-08-04 11:56:32.706 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/enrollments - 200 null application/json; charset=utf-8 9.553ms
2025-08-04 11:56:36.565 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/auth/logout - null null
2025-08-04 11:56:36.566 +08:00 [INF] CORS policy execution successful.
2025-08-04 11:56:36.567 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/auth/logout - 204 null null 1.4933ms
2025-08-04 11:56:36.568 +08:00 [INF] Request starting HTTP/1.1 POST http://localhost:5294/api/auth/logout - application/json 0
2025-08-04 11:56:36.569 +08:00 [INF] CORS policy execution successful.
2025-08-04 11:56:36.570 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-04 11:56:36.572 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AuthController.Logout (CeceLearningPortal.Api)'
2025-08-04 11:56:36.574 +08:00 [INF] Route matched with {action = "Logout", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Logout() on controller CeceLearningPortal.Api.Controllers.AuthController (CeceLearningPortal.Api).
2025-08-04 11:56:36.586 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a0."Id", a0."AccessFailedCount", a0."Avatar", a0."ConcurrencyStamp", a0."CreatedAt", a0."Email", a0."EmailConfirmed", a0."FullName", a0."LastLoginAt", a0."LockoutEnabled", a0."LockoutEnd", a0."NormalizedEmail", a0."NormalizedUserName", a0."NotificationPreferences", a0."PasswordHash", a0."PhoneNumber", a0."PhoneNumberConfirmed", a0."RefreshToken", a0."RefreshTokenExpiryTime", a0."Role", a0."SecurityStamp", a0."Status", a0."TwoFactorEnabled", a0."UserName", r.id, r.created_at, r.created_by_ip, r.expires_at, r.replaced_by_token, r.revoked_at, r.revoked_by_ip, r.token, r.user_id
FROM (
    SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM "AspNetUsers" AS a
    WHERE a."Id" = @__userId_0
    LIMIT 1
) AS a0
LEFT JOIN refresh_tokens AS r ON a0."Id" = r.user_id
ORDER BY a0."Id"
2025-08-04 11:56:36.592 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@p1='?' (DbType = Int32), @p0='?' (DbType = DateTime), @p3='?' (DbType = Int32), @p2='?' (DbType = DateTime), @p5='?' (DbType = Int32), @p4='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
UPDATE refresh_tokens SET revoked_at = @p0
WHERE id = @p1;
UPDATE refresh_tokens SET revoked_at = @p2
WHERE id = @p3;
UPDATE refresh_tokens SET revoked_at = @p4
WHERE id = @p5;
2025-08-04 11:56:36.603 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType0`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-04 11:56:36.604 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AuthController.Logout (CeceLearningPortal.Api) in 29.9172ms
2025-08-04 11:56:36.605 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AuthController.Logout (CeceLearningPortal.Api)'
2025-08-04 11:56:36.606 +08:00 [INF] Request finished HTTP/1.1 POST http://localhost:5294/api/auth/logout - 200 null application/json; charset=utf-8 37.648ms
2025-08-04 11:56:38.754 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/auth/login - null null
2025-08-04 11:56:38.756 +08:00 [INF] CORS policy execution successful.
2025-08-04 11:56:38.756 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/auth/login - 204 null null 1.868ms
2025-08-04 11:56:38.757 +08:00 [INF] Request starting HTTP/1.1 POST http://localhost:5294/api/auth/login - application/json 51
2025-08-04 11:56:38.758 +08:00 [INF] CORS policy execution successful.
2025-08-04 11:56:38.759 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AuthController.Login (CeceLearningPortal.Api)'
2025-08-04 11:56:38.759 +08:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(CeceLearningPortal.Api.DTOs.LoginDto) on controller CeceLearningPortal.Api.Controllers.AuthController (CeceLearningPortal.Api).
2025-08-04 11:56:38.768 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__normalizedEmail_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."NormalizedEmail" = @__normalizedEmail_0
LIMIT 2
2025-08-04 11:56:38.816 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@p1='?', @p2='?', @p0='?' (DbType = DateTime), @p3='?' (DbType = DateTime), @p4='?', @p5='?' (DbType = DateTime), @p6='?', @p7='?' (DbType = DateTime), @p8='?', @p9='?', @p10='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE "AspNetUsers" SET "LastLoginAt" = @p0
WHERE "Id" = @p1 AND "ConcurrencyStamp" = @p2;
INSERT INTO refresh_tokens (created_at, created_by_ip, expires_at, replaced_by_token, revoked_at, revoked_by_ip, token, user_id)
VALUES (@p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10)
RETURNING id;
2025-08-04 11:56:38.818 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.AuthResponseDto'.
2025-08-04 11:56:38.818 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AuthController.Login (CeceLearningPortal.Api) in 58.4316ms
2025-08-04 11:56:38.819 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AuthController.Login (CeceLearningPortal.Api)'
2025-08-04 11:56:38.820 +08:00 [INF] Request finished HTTP/1.1 POST http://localhost:5294/api/auth/login - 200 null application/json; charset=utf-8 62.5631ms
2025-08-04 11:56:38.835 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/courses - null null
2025-08-04 11:56:38.835 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/analytics/platform - null null
2025-08-04 11:56:38.836 +08:00 [INF] CORS policy execution successful.
2025-08-04 11:56:38.837 +08:00 [INF] CORS policy execution successful.
2025-08-04 11:56:38.838 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/courses - 204 null null 3.1608ms
2025-08-04 11:56:38.838 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/analytics/platform - 204 null null 3.4344ms
2025-08-04 11:56:38.840 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/analytics/platform - application/json null
2025-08-04 11:56:38.842 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/courses - application/json null
2025-08-04 11:56:38.843 +08:00 [INF] CORS policy execution successful.
2025-08-04 11:56:38.844 +08:00 [INF] CORS policy execution successful.
2025-08-04 11:56:38.846 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-04 11:56:38.846 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-04 11:56:38.847 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-08-04 11:56:38.848 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-08-04 11:56:38.849 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-08-04 11:56:38.850 +08:00 [INF] Route matched with {action = "GetPlatformAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPlatformAnalytics() on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-08-04 11:56:38.855 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
2025-08-04 11:56:38.855 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-08-04 11:56:38.858 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM courses AS c
2025-08-04 11:56:38.858 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-08-04 11:56:38.859 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 8.9491ms
2025-08-04 11:56:38.860 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-08-04 11:56:38.860 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.status = 'Completed'
2025-08-04 11:56:38.861 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/courses - 200 null application/json; charset=utf-8 18.8486ms
2025-08-04 11:56:38.864 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
2025-08-04 11:56:38.879 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id" AS "instructorId", a."FullName" AS "instructorName", (
    SELECT count(*)::int
    FROM courses AS c0
    WHERE c0.instructor_id = a."Id") AS "totalCourses", (
    SELECT count(*)::int
    FROM enrollments AS e
    INNER JOIN courses AS c1 ON e.course_id = c1.id
    WHERE c1.instructor_id = a."Id") AS "totalStudents", (
    SELECT COALESCE(sum(t0.amount), 0.0)
    FROM transactions AS t0
    LEFT JOIN courses AS c2 ON t0.course_id = c2.id
    WHERE c2.instructor_id = a."Id" AND t0.status = 'Completed') AS "totalRevenue", COALESCE((
    SELECT avg(c3.rating::double precision)
    FROM course_reviews AS c3
    INNER JOIN courses AS c4 ON c3.course_id = c4.id
    WHERE c4.instructor_id = a."Id"), 0.0) AS "averageRating"
FROM "AspNetUsers" AS a
WHERE a."Role" = 'Instructor'
ORDER BY (
    SELECT COALESCE(sum(t.amount), 0.0)
    FROM transactions AS t
    LEFT JOIN courses AS c ON t.course_id = c.id
    WHERE c.instructor_id = a."Id" AND t.status = 'Completed') DESC
LIMIT @__p_0
2025-08-04 11:56:38.888 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT c.category, count(*)::int AS "courseCount", COALESCE(sum((
    SELECT count(*)::int
    FROM enrollments AS e
    WHERE c.id = e.course_id)), 0)::int AS "enrollmentCount", (
    SELECT COALESCE(sum(t.amount), 0.0)
    FROM transactions AS t
    LEFT JOIN courses AS c0 ON t.course_id = c0.id
    WHERE c0.category = c.category AND t.status = 'Completed') AS revenue
FROM courses AS c
GROUP BY c.category
ORDER BY COALESCE(sum((
    SELECT count(*)::int
    FROM enrollments AS e
    WHERE c.id = e.course_id)), 0)::int DESC
2025-08-04 11:56:38.893 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT t0."Year", t0."Month", COALESCE(sum(t0.amount), 0.0) AS "Revenue", count(*)::int AS "TransactionCount"
FROM (
    SELECT t.amount, date_part('year', t.created_at AT TIME ZONE 'UTC')::int AS "Year", date_part('month', t.created_at AT TIME ZONE 'UTC')::int AS "Month"
    FROM transactions AS t
    WHERE t.status = 'Completed' AND t.created_at >= @__sixMonthsAgo_0
) AS t0
GROUP BY t0."Year", t0."Month"
2025-08-04 11:56:38.899 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT a0."Year", a0."Month", count(*)::int AS "NewUsers"
FROM (
    SELECT date_part('year', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "AspNetUsers" AS a
    WHERE a."CreatedAt" >= @__sixMonthsAgo_0
) AS a0
GROUP BY a0."Year", a0."Month"
2025-08-04 11:56:38.903 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM subscriptions AS s
WHERE s.status = 'Active'
2025-08-04 11:56:38.907 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s.plan_name AS plan, count(*)::int AS count, COALESCE(sum(s.price), 0.0) AS "monthlyRevenue"
FROM subscriptions AS s
WHERE s.status = 'Active'
GROUP BY s.plan_name
2025-08-04 11:56:38.909 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType20`6[[<>f__AnonymousType21`5[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-04 11:56:38.916 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api) in 64.5607ms
2025-08-04 11:56:38.917 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-08-04 11:56:38.917 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/analytics/platform - 200 null application/json; charset=utf-8 77.0246ms
2025-08-04 11:56:41.866 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/analytics/platform - application/json null
2025-08-04 11:56:41.867 +08:00 [INF] CORS policy execution successful.
2025-08-04 11:56:41.869 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-04 11:56:41.870 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-08-04 11:56:41.870 +08:00 [INF] Route matched with {action = "GetPlatformAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPlatformAnalytics() on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-08-04 11:56:41.872 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
2025-08-04 11:56:41.873 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM courses AS c
2025-08-04 11:56:41.874 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.status = 'Completed'
2025-08-04 11:56:41.875 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
2025-08-04 11:56:41.878 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id" AS "instructorId", a."FullName" AS "instructorName", (
    SELECT count(*)::int
    FROM courses AS c0
    WHERE c0.instructor_id = a."Id") AS "totalCourses", (
    SELECT count(*)::int
    FROM enrollments AS e
    INNER JOIN courses AS c1 ON e.course_id = c1.id
    WHERE c1.instructor_id = a."Id") AS "totalStudents", (
    SELECT COALESCE(sum(t0.amount), 0.0)
    FROM transactions AS t0
    LEFT JOIN courses AS c2 ON t0.course_id = c2.id
    WHERE c2.instructor_id = a."Id" AND t0.status = 'Completed') AS "totalRevenue", COALESCE((
    SELECT avg(c3.rating::double precision)
    FROM course_reviews AS c3
    INNER JOIN courses AS c4 ON c3.course_id = c4.id
    WHERE c4.instructor_id = a."Id"), 0.0) AS "averageRating"
FROM "AspNetUsers" AS a
WHERE a."Role" = 'Instructor'
ORDER BY (
    SELECT COALESCE(sum(t.amount), 0.0)
    FROM transactions AS t
    LEFT JOIN courses AS c ON t.course_id = c.id
    WHERE c.instructor_id = a."Id" AND t.status = 'Completed') DESC
LIMIT @__p_0
2025-08-04 11:56:41.881 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT c.category, count(*)::int AS "courseCount", COALESCE(sum((
    SELECT count(*)::int
    FROM enrollments AS e
    WHERE c.id = e.course_id)), 0)::int AS "enrollmentCount", (
    SELECT COALESCE(sum(t.amount), 0.0)
    FROM transactions AS t
    LEFT JOIN courses AS c0 ON t.course_id = c0.id
    WHERE c0.category = c.category AND t.status = 'Completed') AS revenue
FROM courses AS c
GROUP BY c.category
ORDER BY COALESCE(sum((
    SELECT count(*)::int
    FROM enrollments AS e
    WHERE c.id = e.course_id)), 0)::int DESC
2025-08-04 11:56:41.882 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT t0."Year", t0."Month", COALESCE(sum(t0.amount), 0.0) AS "Revenue", count(*)::int AS "TransactionCount"
FROM (
    SELECT t.amount, date_part('year', t.created_at AT TIME ZONE 'UTC')::int AS "Year", date_part('month', t.created_at AT TIME ZONE 'UTC')::int AS "Month"
    FROM transactions AS t
    WHERE t.status = 'Completed' AND t.created_at >= @__sixMonthsAgo_0
) AS t0
GROUP BY t0."Year", t0."Month"
2025-08-04 11:56:41.884 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT a0."Year", a0."Month", count(*)::int AS "NewUsers"
FROM (
    SELECT date_part('year', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "AspNetUsers" AS a
    WHERE a."CreatedAt" >= @__sixMonthsAgo_0
) AS a0
GROUP BY a0."Year", a0."Month"
2025-08-04 11:56:41.885 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM subscriptions AS s
WHERE s.status = 'Active'
2025-08-04 11:56:41.886 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s.plan_name AS plan, count(*)::int AS count, COALESCE(sum(s.price), 0.0) AS "monthlyRevenue"
FROM subscriptions AS s
WHERE s.status = 'Active'
GROUP BY s.plan_name
2025-08-04 11:56:41.887 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType20`6[[<>f__AnonymousType21`5[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-04 11:56:41.888 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api) in 16.8287ms
2025-08-04 11:56:41.889 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-08-04 11:56:41.889 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/analytics/platform - 200 null application/json; charset=utf-8 22.7988ms
2025-08-04 11:56:41.891 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/admin/course-completions - null null
2025-08-04 11:56:41.892 +08:00 [INF] CORS policy execution successful.
2025-08-04 11:56:41.892 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/admin/course-completions - 204 null null 1.485ms
2025-08-04 11:56:41.893 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/admin/course-completions - application/json null
2025-08-04 11:56:41.896 +08:00 [INF] CORS policy execution successful.
2025-08-04 11:56:41.897 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-04 11:56:41.898 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetCourseCompletions (CeceLearningPortal.Api)'
2025-08-04 11:56:41.901 +08:00 [INF] Route matched with {action = "GetCourseCompletions", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourseCompletions(Int32) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-08-04 11:56:41.909 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT e0.id, a."FullName", a."Avatar", a."Email", c.title, e0.course_id::text, e0.completed_at, COALESCE(e0.average_quiz_score, 0.0), e0.certificate_issued, e0.certificate_url
FROM (
    SELECT e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.course_id, e.student_id
    FROM enrollments AS e
    WHERE e.completed_at IS NOT NULL
    ORDER BY e.completed_at DESC
    LIMIT @__p_0
) AS e0
INNER JOIN "AspNetUsers" AS a ON e0.student_id = a."Id"
INNER JOIN courses AS c ON e0.course_id = c.id
ORDER BY e0.completed_at DESC
2025-08-04 11:56:41.910 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType9`10[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-08-04 11:56:41.911 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetCourseCompletions (CeceLearningPortal.Api) in 9.5765ms
2025-08-04 11:56:41.912 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetCourseCompletions (CeceLearningPortal.Api)'
2025-08-04 11:56:41.912 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/admin/course-completions - 200 null application/json; charset=utf-8 18.8116ms
2025-08-04 11:56:43.133 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/users/718ad447-829b-4170-973a-87a1da659b51/profile - null null
2025-08-04 11:56:43.134 +08:00 [INF] CORS policy execution successful.
2025-08-04 11:56:43.135 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/users/718ad447-829b-4170-973a-87a1da659b51/profile - 204 null null 1.7407ms
2025-08-04 11:56:43.136 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/users/718ad447-829b-4170-973a-87a1da659b51/profile - application/json null
2025-08-04 11:56:43.137 +08:00 [INF] CORS policy execution successful.
2025-08-04 11:56:43.139 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-04 11:56:43.140 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/users/718ad447-829b-4170-973a-87a1da659b51/profile - 404 0 null 3.6042ms
2025-08-04 11:56:43.141 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5294/api/users/718ad447-829b-4170-973a-87a1da659b51/profile, Response status code: 404
2025-08-04 11:56:43.142 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/users/718ad447-829b-4170-973a-87a1da659b51 - null null
2025-08-04 11:56:43.143 +08:00 [INF] CORS policy execution successful.
2025-08-04 11:56:43.143 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/users/718ad447-829b-4170-973a-87a1da659b51 - 204 null null 1.3095ms
2025-08-04 11:56:43.145 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/users/718ad447-829b-4170-973a-87a1da659b51 - application/json null
2025-08-04 11:56:43.146 +08:00 [INF] CORS policy execution successful.
2025-08-04 11:56:43.147 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-04 11:56:43.148 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.UsersController.GetUser (CeceLearningPortal.Api)'
2025-08-04 11:56:43.150 +08:00 [INF] Route matched with {action = "GetUser", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUser(System.String) on controller CeceLearningPortal.Api.Controllers.UsersController (CeceLearningPortal.Api).
2025-08-04 11:56:43.153 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."Id" = @__p_0
LIMIT 1
2025-08-04 11:56:43.154 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.UserDto'.
2025-08-04 11:56:43.156 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.UsersController.GetUser (CeceLearningPortal.Api) in 4.5538ms
2025-08-04 11:56:43.156 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.UsersController.GetUser (CeceLearningPortal.Api)'
2025-08-04 11:56:43.157 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/users/718ad447-829b-4170-973a-87a1da659b51 - 200 null application/json; charset=utf-8 12.1934ms
2025-08-04 11:56:43.158 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/users/718ad447-829b-4170-973a-87a1da659b51/stats - null null
2025-08-04 11:56:43.159 +08:00 [INF] CORS policy execution successful.
2025-08-04 11:56:43.160 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/users/718ad447-829b-4170-973a-87a1da659b51/stats - 204 null null 1.3168ms
2025-08-04 11:56:43.161 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/users/718ad447-829b-4170-973a-87a1da659b51/stats - application/json null
2025-08-04 11:56:43.162 +08:00 [INF] CORS policy execution successful.
2025-08-04 11:56:43.163 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-04 11:56:43.164 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.UsersController.GetUserStats (CeceLearningPortal.Api)'
2025-08-04 11:56:43.166 +08:00 [INF] Route matched with {action = "GetUserStats", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserStats(System.String) on controller CeceLearningPortal.Api.Controllers.UsersController (CeceLearningPortal.Api).
2025-08-04 11:56:43.173 +08:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2025-08-04 11:56:43.187 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a0."Id", a0."AccessFailedCount", a0."Avatar", a0."ConcurrencyStamp", a0."CreatedAt", a0."Email", a0."EmailConfirmed", a0."FullName", a0."LastLoginAt", a0."LockoutEnabled", a0."LockoutEnd", a0."NormalizedEmail", a0."NormalizedUserName", a0."NotificationPreferences", a0."PasswordHash", a0."PhoneNumber", a0."PhoneNumberConfirmed", a0."RefreshToken", a0."RefreshTokenExpiryTime", a0."Role", a0."SecurityStamp", a0."Status", a0."TwoFactorEnabled", a0."UserName", s.id, s."AccessDuration", s."AccessType", s."AutomationAbandonmentSequence", s."AutomationCompletionCertificate", s."AutomationProgressReminders", s."AutomationWelcomeEmail", s.category, s."CourseType", s.created_at, s."Currency", s.description, s.discount, s."DripContent", s."DripScheduleJson", s.duration, s."EnrollmentLimit", s.enrollment_type, s.features, s."HasAssignments", s."HasCertificate", s."HasCommunity", s."HasDownloadableResources", s."HasLiveSessions", s."HasQuizzes", s.instructor_id, s.is_bestseller, s."IsPublished", s."Language", s.level, s.original_price, s."PaymentPlanDetailsJson", s.preview_url, s.price, s."PricingModel", s."PromoVideoUrl", s."PublishedAt", s."ShortDescription", s.status, s."SubscriptionPeriod", s.thumbnail, s.thumbnail_url, s.title, s.updated_at, s.id0, s.average_quiz_score, s.certificate_issued, s.certificate_url, s.completed_at, s.completed_lessons, s.course_id, s.enrolled_at, s.last_accessed_date, s.progress_percentage, s.quiz_count, s.student_id, s.total_time_spent, s.id1, s.approved_at, s.approved_by, s.comment, s.course_id0, s.created_at0, s.is_flagged, s.rating, s.status0, s.student_id0
FROM (
    SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM "AspNetUsers" AS a
    WHERE a."Id" = @__userId_0
    LIMIT 1
) AS a0
LEFT JOIN (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at, e.id AS id0, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent, c0.id AS id1, c0.approved_at, c0.approved_by, c0.comment, c0.course_id AS course_id0, c0.created_at AS created_at0, c0.is_flagged, c0.rating, c0.status AS status0, c0.student_id AS student_id0
    FROM courses AS c
    LEFT JOIN enrollments AS e ON c.id = e.course_id
    LEFT JOIN course_reviews AS c0 ON c.id = c0.course_id
) AS s ON a0."Id" = s.instructor_id
ORDER BY a0."Id", s.id, s.id0
2025-08-04 11:56:43.193 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.UserStatsDto'.
2025-08-04 11:56:43.197 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.UsersController.GetUserStats (CeceLearningPortal.Api) in 29.8643ms
2025-08-04 11:56:43.198 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.UsersController.GetUserStats (CeceLearningPortal.Api)'
2025-08-04 11:56:43.198 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/users/718ad447-829b-4170-973a-87a1da659b51/stats - 200 null application/json; charset=utf-8 37.1341ms
2025-08-04 11:56:43.200 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/users/718ad447-829b-4170-973a-87a1da659b51/certificates - null null
2025-08-04 11:56:43.201 +08:00 [INF] CORS policy execution successful.
2025-08-04 11:56:43.201 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/users/718ad447-829b-4170-973a-87a1da659b51/certificates - 204 null null 1.4049ms
2025-08-04 11:56:43.202 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/users/718ad447-829b-4170-973a-87a1da659b51/certificates - application/json null
2025-08-04 11:56:43.203 +08:00 [INF] CORS policy execution successful.
2025-08-04 11:56:43.205 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-04 11:56:43.205 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/users/718ad447-829b-4170-973a-87a1da659b51/certificates - 404 0 null 3.1181ms
2025-08-04 11:56:43.207 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5294/api/users/718ad447-829b-4170-973a-87a1da659b51/certificates, Response status code: 404
2025-08-04 11:56:43.208 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/users/718ad447-829b-4170-973a-87a1da659b51/activity - null null
2025-08-04 11:56:43.209 +08:00 [INF] CORS policy execution successful.
2025-08-04 11:56:43.209 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/users/718ad447-829b-4170-973a-87a1da659b51/activity - 204 null null 1.3405ms
2025-08-04 11:56:43.210 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/users/718ad447-829b-4170-973a-87a1da659b51/activity - application/json null
2025-08-04 11:56:43.211 +08:00 [INF] CORS policy execution successful.
2025-08-04 11:56:43.212 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-04 11:56:43.213 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/users/718ad447-829b-4170-973a-87a1da659b51/activity - 404 0 null 3.04ms
2025-08-04 11:56:43.215 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5294/api/users/718ad447-829b-4170-973a-87a1da659b51/activity, Response status code: 404
2025-08-04 11:56:43.216 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/admin/stats - null null
2025-08-04 11:56:43.217 +08:00 [INF] CORS policy execution successful.
2025-08-04 11:56:43.217 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/admin/stats - 204 null null 1.4315ms
2025-08-04 11:56:43.218 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/admin/stats - application/json null
2025-08-04 11:56:43.219 +08:00 [INF] CORS policy execution successful.
2025-08-04 11:56:43.220 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-04 11:56:43.221 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetAdminStats (CeceLearningPortal.Api)'
2025-08-04 11:56:43.224 +08:00 [INF] Route matched with {action = "GetAdminStats", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAdminStats() on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-08-04 11:56:43.227 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
2025-08-04 11:56:43.230 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
WHERE date_trunc('day', a."CreatedAt", 'UTC') = date_trunc('day', now(), 'UTC')
2025-08-04 11:56:43.233 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM courses AS c
WHERE c.status = 'Active'
2025-08-04 11:56:43.235 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM courses AS c
WHERE c.status = 'Draft'
2025-08-04 11:56:43.236 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.status = 'Completed'
2025-08-04 11:56:43.239 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
WHERE a."LastLoginAt" > now() + INTERVAL '-30 mins'
2025-08-04 11:56:43.240 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType7`7[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[<>f__AnonymousType8`4[[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-08-04 11:56:43.242 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetAdminStats (CeceLearningPortal.Api) in 17.6969ms
2025-08-04 11:56:43.243 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetAdminStats (CeceLearningPortal.Api)'
2025-08-04 11:56:43.243 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/admin/stats - 200 null application/json; charset=utf-8 25.0025ms
2025-08-04 11:56:44.060 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/analytics/platform - null null
2025-08-04 11:56:44.061 +08:00 [INF] CORS policy execution successful.
2025-08-04 11:56:44.061 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/analytics/platform - 204 null null 1.6173ms
2025-08-04 11:56:44.063 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/analytics/platform - application/json null
2025-08-04 11:56:44.064 +08:00 [INF] CORS policy execution successful.
2025-08-04 11:56:44.065 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-04 11:56:44.066 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-08-04 11:56:44.066 +08:00 [INF] Route matched with {action = "GetPlatformAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPlatformAnalytics() on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-08-04 11:56:44.068 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
2025-08-04 11:56:44.069 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM courses AS c
2025-08-04 11:56:44.070 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.status = 'Completed'
2025-08-04 11:56:44.071 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
2025-08-04 11:56:44.074 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id" AS "instructorId", a."FullName" AS "instructorName", (
    SELECT count(*)::int
    FROM courses AS c0
    WHERE c0.instructor_id = a."Id") AS "totalCourses", (
    SELECT count(*)::int
    FROM enrollments AS e
    INNER JOIN courses AS c1 ON e.course_id = c1.id
    WHERE c1.instructor_id = a."Id") AS "totalStudents", (
    SELECT COALESCE(sum(t0.amount), 0.0)
    FROM transactions AS t0
    LEFT JOIN courses AS c2 ON t0.course_id = c2.id
    WHERE c2.instructor_id = a."Id" AND t0.status = 'Completed') AS "totalRevenue", COALESCE((
    SELECT avg(c3.rating::double precision)
    FROM course_reviews AS c3
    INNER JOIN courses AS c4 ON c3.course_id = c4.id
    WHERE c4.instructor_id = a."Id"), 0.0) AS "averageRating"
FROM "AspNetUsers" AS a
WHERE a."Role" = 'Instructor'
ORDER BY (
    SELECT COALESCE(sum(t.amount), 0.0)
    FROM transactions AS t
    LEFT JOIN courses AS c ON t.course_id = c.id
    WHERE c.instructor_id = a."Id" AND t.status = 'Completed') DESC
LIMIT @__p_0
2025-08-04 11:56:44.076 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT c.category, count(*)::int AS "courseCount", COALESCE(sum((
    SELECT count(*)::int
    FROM enrollments AS e
    WHERE c.id = e.course_id)), 0)::int AS "enrollmentCount", (
    SELECT COALESCE(sum(t.amount), 0.0)
    FROM transactions AS t
    LEFT JOIN courses AS c0 ON t.course_id = c0.id
    WHERE c0.category = c.category AND t.status = 'Completed') AS revenue
FROM courses AS c
GROUP BY c.category
ORDER BY COALESCE(sum((
    SELECT count(*)::int
    FROM enrollments AS e
    WHERE c.id = e.course_id)), 0)::int DESC
2025-08-04 11:56:44.077 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT t0."Year", t0."Month", COALESCE(sum(t0.amount), 0.0) AS "Revenue", count(*)::int AS "TransactionCount"
FROM (
    SELECT t.amount, date_part('year', t.created_at AT TIME ZONE 'UTC')::int AS "Year", date_part('month', t.created_at AT TIME ZONE 'UTC')::int AS "Month"
    FROM transactions AS t
    WHERE t.status = 'Completed' AND t.created_at >= @__sixMonthsAgo_0
) AS t0
GROUP BY t0."Year", t0."Month"
2025-08-04 11:56:44.079 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT a0."Year", a0."Month", count(*)::int AS "NewUsers"
FROM (
    SELECT date_part('year', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "AspNetUsers" AS a
    WHERE a."CreatedAt" >= @__sixMonthsAgo_0
) AS a0
GROUP BY a0."Year", a0."Month"
2025-08-04 11:56:44.080 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM subscriptions AS s
WHERE s.status = 'Active'
2025-08-04 11:56:44.081 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s.plan_name AS plan, count(*)::int AS count, COALESCE(sum(s.price), 0.0) AS "monthlyRevenue"
FROM subscriptions AS s
WHERE s.status = 'Active'
GROUP BY s.plan_name
2025-08-04 11:56:44.082 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType20`6[[<>f__AnonymousType21`5[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-04 11:56:44.083 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api) in 15.6327ms
2025-08-04 11:56:44.084 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-08-04 11:56:44.084 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/analytics/platform - 200 null application/json; charset=utf-8 21.6406ms
2025-08-04 11:56:44.086 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/admin/course-completions - application/json null
2025-08-04 11:56:44.086 +08:00 [INF] CORS policy execution successful.
2025-08-04 11:56:44.088 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-04 11:56:44.089 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetCourseCompletions (CeceLearningPortal.Api)'
2025-08-04 11:56:44.089 +08:00 [INF] Route matched with {action = "GetCourseCompletions", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourseCompletions(Int32) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-08-04 11:56:44.093 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT e0.id, a."FullName", a."Avatar", a."Email", c.title, e0.course_id::text, e0.completed_at, COALESCE(e0.average_quiz_score, 0.0), e0.certificate_issued, e0.certificate_url
FROM (
    SELECT e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.course_id, e.student_id
    FROM enrollments AS e
    WHERE e.completed_at IS NOT NULL
    ORDER BY e.completed_at DESC
    LIMIT @__p_0
) AS e0
INNER JOIN "AspNetUsers" AS a ON e0.student_id = a."Id"
INNER JOIN courses AS c ON e0.course_id = c.id
ORDER BY e0.completed_at DESC
2025-08-04 11:56:44.094 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType9`10[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-08-04 11:56:44.095 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetCourseCompletions (CeceLearningPortal.Api) in 4.695ms
2025-08-04 11:56:44.095 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetCourseCompletions (CeceLearningPortal.Api)'
2025-08-04 11:56:44.096 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/admin/course-completions - 200 null application/json; charset=utf-8 10.3244ms
2025-08-04 11:56:45.464 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/admin/users - null null
2025-08-04 11:56:45.464 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/admin/subscription-plans - null null
2025-08-04 11:56:45.465 +08:00 [INF] CORS policy execution successful.
2025-08-04 11:56:45.466 +08:00 [INF] CORS policy execution successful.
2025-08-04 11:56:45.467 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/admin/users - 204 null null 2.7141ms
2025-08-04 11:56:45.467 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/admin/subscription-plans - 204 null null 2.9008ms
2025-08-04 11:56:45.468 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/admin/subscription-plans - application/json null
2025-08-04 11:56:45.469 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/admin/users - application/json null
2025-08-04 11:56:45.471 +08:00 [INF] CORS policy execution successful.
2025-08-04 11:56:45.472 +08:00 [INF] CORS policy execution successful.
2025-08-04 11:56:45.473 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-04 11:56:45.473 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-04 11:56:45.474 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetSubscriptionPlans (CeceLearningPortal.Api)'
2025-08-04 11:56:45.475 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUsers (CeceLearningPortal.Api)'
2025-08-04 11:56:45.477 +08:00 [INF] Route matched with {action = "GetSubscriptionPlans", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetSubscriptionPlans() on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-08-04 11:56:45.479 +08:00 [INF] Route matched with {action = "GetUsers", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUsers(CeceLearningPortal.Api.DTOs.UserManagementFilterDto) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-08-04 11:56:45.483 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
2025-08-04 11:56:45.486 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."UserName", a."Email", a."FullName", a."Role", a."Status", a."CreatedAt", a."LastLoginAt", a."EmailConfirmed"
FROM "AspNetUsers" AS a
ORDER BY a."CreatedAt" DESC
LIMIT @__p_1 OFFSET @__p_0
2025-08-04 11:56:45.488 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[CeceLearningPortal.Api.DTOs.UserManagementDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-08-04 11:56:45.489 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s.id, s.created_at, s.description, s.display_order, s.features, s.has_analytics, s.has_priority_support, s.has_unlimited_access, s.is_active, s.is_recommended, s.max_course_access, s.max_courses_can_create, s.max_students_per_course, s.monthly_price, s.name, s.plan_type, s.transaction_fee_percentage, s.updated_at, s.yearly_price, s0.id, s0.billing_cycle, s0.created_at, s0.end_date, s0.next_billing_date, s0.plan_name, s0.price, s0.start_date, s0.status, s0.stripe_subscription_id, s0.subscription_plan_id, s0.updated_at, s0.user_id
FROM subscription_plans AS s
LEFT JOIN subscriptions AS s0 ON s.id = s0.subscription_plan_id
ORDER BY s.id
2025-08-04 11:56:45.497 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUsers (CeceLearningPortal.Api) in 17.0569ms
2025-08-04 11:56:45.497 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUsers (CeceLearningPortal.Api)'
2025-08-04 11:56:45.498 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/admin/users - 200 null application/json; charset=utf-8 28.3699ms
2025-08-04 11:56:45.499 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/admin/users/76ea62e5-6edd-486d-9d56-88a15c6afe35/subscription - null null
2025-08-04 11:56:45.500 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/admin/users/a5dba4a2-d846-4a95-82f1-b9f091105e9c/subscription - null null
2025-08-04 11:56:45.501 +08:00 [INF] CORS policy execution successful.
2025-08-04 11:56:45.501 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/admin/users/d36872cc-db57-4b86-bd3a-3909b0add07c/subscription - null null
2025-08-04 11:56:45.501 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/admin/users/bee889a2-efca-471d-807c-a7674a945612/subscription - null null
2025-08-04 11:56:45.501 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/admin/users/718ad447-829b-4170-973a-87a1da659b51/subscription - null null
2025-08-04 11:56:45.502 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/admin/users/76ea62e5-6edd-486d-9d56-88a15c6afe35/subscription - 204 null null 2.6676ms
2025-08-04 11:56:45.502 +08:00 [INF] CORS policy execution successful.
2025-08-04 11:56:45.503 +08:00 [INF] CORS policy execution successful.
2025-08-04 11:56:45.505 +08:00 [INF] CORS policy execution successful.
2025-08-04 11:56:45.506 +08:00 [INF] CORS policy execution successful.
2025-08-04 11:56:45.507 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/admin/users/487ad21a-a9df-4213-b283-02743691de26/subscription - null null
2025-08-04 11:56:45.507 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/admin/users/a5dba4a2-d846-4a95-82f1-b9f091105e9c/subscription - 204 null null 7.0917ms
2025-08-04 11:56:45.508 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/admin/users/d36872cc-db57-4b86-bd3a-3909b0add07c/subscription - 204 null null 6.5482ms
2025-08-04 11:56:45.508 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/admin/users/bee889a2-efca-471d-807c-a7674a945612/subscription - 204 null null 7.2836ms
2025-08-04 11:56:45.509 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/admin/users/718ad447-829b-4170-973a-87a1da659b51/subscription - 204 null null 7.4894ms
2025-08-04 11:56:45.509 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[CeceLearningPortal.Api.DTOs.SubscriptionPlanDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-08-04 11:56:45.510 +08:00 [INF] CORS policy execution successful.
2025-08-04 11:56:45.511 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/admin/users/344cd19a-f718-4633-97cc-d97c5abfbb59/subscription - null null
2025-08-04 11:56:45.512 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/admin/users/a09e41e8-d894-484f-ba01-4b0eae749b75/subscription - null null
2025-08-04 11:56:45.513 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/admin/users/7a5fc61f-d006-4ad3-b2c8-944101b5053f/subscription - null null
2025-08-04 11:56:45.514 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/admin/users/8bf0f167-d003-46e4-9f15-936b4d1e9de3/subscription - null null
2025-08-04 11:56:45.515 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/admin/users/487ad21a-a9df-4213-b283-02743691de26/subscription - 204 null null 8.5611ms
2025-08-04 11:56:45.516 +08:00 [INF] CORS policy execution successful.
2025-08-04 11:56:45.517 +08:00 [INF] CORS policy execution successful.
2025-08-04 11:56:45.518 +08:00 [INF] CORS policy execution successful.
2025-08-04 11:56:45.518 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetSubscriptionPlans (CeceLearningPortal.Api) in 40.6946ms
2025-08-04 11:56:45.520 +08:00 [INF] CORS policy execution successful.
2025-08-04 11:56:45.521 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/admin/users/cf22237a-5df9-40db-83ad-878d2ee157a0/subscription - null null
2025-08-04 11:56:45.521 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/admin/users/344cd19a-f718-4633-97cc-d97c5abfbb59/subscription - 204 null null 10.4787ms
2025-08-04 11:56:45.522 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/admin/users/a09e41e8-d894-484f-ba01-4b0eae749b75/subscription - 204 null null 9.6534ms
2025-08-04 11:56:45.522 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/admin/users/7a5fc61f-d006-4ad3-b2c8-944101b5053f/subscription - 204 null null 8.8604ms
2025-08-04 11:56:45.523 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetSubscriptionPlans (CeceLearningPortal.Api)'
2025-08-04 11:56:45.523 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/admin/users/8bf0f167-d003-46e4-9f15-936b4d1e9de3/subscription - 204 null null 8.7319ms
2025-08-04 11:56:45.524 +08:00 [INF] CORS policy execution successful.
2025-08-04 11:56:45.525 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/admin/users/76ea62e5-6edd-486d-9d56-88a15c6afe35/subscription - application/json null
2025-08-04 11:56:45.527 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/admin/users/a5dba4a2-d846-4a95-82f1-b9f091105e9c/subscription - application/json null
2025-08-04 11:56:45.528 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/admin/users/d36872cc-db57-4b86-bd3a-3909b0add07c/subscription - application/json null
2025-08-04 11:56:45.528 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/admin/subscription-plans - 200 null application/json; charset=utf-8 60.178ms
2025-08-04 11:56:45.530 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/admin/users/bee889a2-efca-471d-807c-a7674a945612/subscription - application/json null
2025-08-04 11:56:45.530 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/admin/users/cf22237a-5df9-40db-83ad-878d2ee157a0/subscription - 204 null null 9.1451ms
2025-08-04 11:56:45.531 +08:00 [INF] CORS policy execution successful.
2025-08-04 11:56:45.532 +08:00 [INF] CORS policy execution successful.
2025-08-04 11:56:45.533 +08:00 [INF] CORS policy execution successful.
2025-08-04 11:56:45.534 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/admin/users/718ad447-829b-4170-973a-87a1da659b51/subscription - application/json null
2025-08-04 11:56:45.535 +08:00 [INF] CORS policy execution successful.
2025-08-04 11:56:45.537 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/admin/users/487ad21a-a9df-4213-b283-02743691de26/subscription - application/json null
2025-08-04 11:56:45.538 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-04 11:56:45.538 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-04 11:56:45.538 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-04 11:56:45.539 +08:00 [INF] CORS policy execution successful.
2025-08-04 11:56:45.540 +08:00 [INF] CORS policy execution successful.
2025-08-04 11:56:45.541 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-08-04 11:56:45.542 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-08-04 11:56:45.543 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-08-04 11:56:45.544 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-04 11:56:45.545 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-04 11:56:45.546 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-08-04 11:56:45.546 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-08-04 11:56:45.547 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-08-04 11:56:45.547 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-08-04 11:56:45.547 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-08-04 11:56:45.549 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-08-04 11:56:45.551 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-08-04 11:56:45.558 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s.id, s.billing_cycle, s.created_at, s.end_date, s.next_billing_date, s.plan_name, s.price, s.start_date, s.status, s.stripe_subscription_id, s.subscription_plan_id, s.updated_at, s.user_id, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM subscriptions AS s
INNER JOIN "AspNetUsers" AS a ON s.user_id = a."Id"
WHERE s.user_id = @__userId_0 AND s.status = 'Active'
ORDER BY s.created_at DESC
LIMIT 1
2025-08-04 11:56:45.558 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s.id, s.billing_cycle, s.created_at, s.end_date, s.next_billing_date, s.plan_name, s.price, s.start_date, s.status, s.stripe_subscription_id, s.subscription_plan_id, s.updated_at, s.user_id, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM subscriptions AS s
INNER JOIN "AspNetUsers" AS a ON s.user_id = a."Id"
WHERE s.user_id = @__userId_0 AND s.status = 'Active'
ORDER BY s.created_at DESC
LIMIT 1
2025-08-04 11:56:45.558 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s.id, s.billing_cycle, s.created_at, s.end_date, s.next_billing_date, s.plan_name, s.price, s.start_date, s.status, s.stripe_subscription_id, s.subscription_plan_id, s.updated_at, s.user_id, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM subscriptions AS s
INNER JOIN "AspNetUsers" AS a ON s.user_id = a."Id"
WHERE s.user_id = @__userId_0 AND s.status = 'Active'
ORDER BY s.created_at DESC
LIMIT 1
2025-08-04 11:56:45.560 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType95`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-04 11:56:45.561 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType95`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-04 11:56:45.562 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType95`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-04 11:56:45.563 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 13.8418ms
2025-08-04 11:56:45.563 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 13.0021ms
2025-08-04 11:56:45.564 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 15.6094ms
2025-08-04 11:56:45.565 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-08-04 11:56:45.565 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-08-04 11:56:45.566 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-08-04 11:56:45.567 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/admin/users/a5dba4a2-d846-4a95-82f1-b9f091105e9c/subscription - 200 null application/json; charset=utf-8 40.1602ms
2025-08-04 11:56:45.568 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/admin/users/d36872cc-db57-4b86-bd3a-3909b0add07c/subscription - 200 null application/json; charset=utf-8 39.4875ms
2025-08-04 11:56:45.568 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/admin/users/76ea62e5-6edd-486d-9d56-88a15c6afe35/subscription - 200 null application/json; charset=utf-8 42.7329ms
2025-08-04 11:56:45.570 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/admin/users/344cd19a-f718-4633-97cc-d97c5abfbb59/subscription - application/json null
2025-08-04 11:56:45.572 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/admin/users/a09e41e8-d894-484f-ba01-4b0eae749b75/subscription - application/json null
2025-08-04 11:56:45.574 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/admin/users/7a5fc61f-d006-4ad3-b2c8-944101b5053f/subscription - application/json null
2025-08-04 11:56:45.575 +08:00 [INF] CORS policy execution successful.
2025-08-04 11:56:45.576 +08:00 [INF] CORS policy execution successful.
2025-08-04 11:56:45.578 +08:00 [INF] CORS policy execution successful.
2025-08-04 11:56:45.588 +08:00 [INF] Executed DbCommand (9ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-04 11:56:45.588 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-04 11:56:45.588 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-04 11:56:45.589 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-08-04 11:56:45.590 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-08-04 11:56:45.591 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-08-04 11:56:45.592 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-08-04 11:56:45.592 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-08-04 11:56:45.593 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-08-04 11:56:45.593 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-04 11:56:45.594 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s.id, s.billing_cycle, s.created_at, s.end_date, s.next_billing_date, s.plan_name, s.price, s.start_date, s.status, s.stripe_subscription_id, s.subscription_plan_id, s.updated_at, s.user_id, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM subscriptions AS s
INNER JOIN "AspNetUsers" AS a ON s.user_id = a."Id"
WHERE s.user_id = @__userId_0 AND s.status = 'Active'
ORDER BY s.created_at DESC
LIMIT 1
2025-08-04 11:56:45.595 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s.id, s.billing_cycle, s.created_at, s.end_date, s.next_billing_date, s.plan_name, s.price, s.start_date, s.status, s.stripe_subscription_id, s.subscription_plan_id, s.updated_at, s.user_id, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM subscriptions AS s
INNER JOIN "AspNetUsers" AS a ON s.user_id = a."Id"
WHERE s.user_id = @__userId_0 AND s.status = 'Active'
ORDER BY s.created_at DESC
LIMIT 1
2025-08-04 11:56:45.596 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s.id, s.billing_cycle, s.created_at, s.end_date, s.next_billing_date, s.plan_name, s.price, s.start_date, s.status, s.stripe_subscription_id, s.subscription_plan_id, s.updated_at, s.user_id, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM subscriptions AS s
INNER JOIN "AspNetUsers" AS a ON s.user_id = a."Id"
WHERE s.user_id = @__userId_0 AND s.status = 'Active'
ORDER BY s.created_at DESC
LIMIT 1
2025-08-04 11:56:45.596 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-08-04 11:56:45.597 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType95`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-04 11:56:45.598 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType95`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-04 11:56:45.599 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType95`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-04 11:56:45.600 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-08-04 11:56:45.600 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 6.996ms
2025-08-04 11:56:45.601 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 6.7618ms
2025-08-04 11:56:45.602 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 6.5917ms
2025-08-04 11:56:45.603 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-08-04 11:56:45.603 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s.id, s.billing_cycle, s.created_at, s.end_date, s.next_billing_date, s.plan_name, s.price, s.start_date, s.status, s.stripe_subscription_id, s.subscription_plan_id, s.updated_at, s.user_id, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM subscriptions AS s
INNER JOIN "AspNetUsers" AS a ON s.user_id = a."Id"
WHERE s.user_id = @__userId_0 AND s.status = 'Active'
ORDER BY s.created_at DESC
LIMIT 1
2025-08-04 11:56:45.604 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-08-04 11:56:45.605 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-08-04 11:56:45.605 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s.id, s.billing_cycle, s.created_at, s.end_date, s.next_billing_date, s.plan_name, s.price, s.start_date, s.status, s.stripe_subscription_id, s.subscription_plan_id, s.updated_at, s.user_id, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM subscriptions AS s
INNER JOIN "AspNetUsers" AS a ON s.user_id = a."Id"
WHERE s.user_id = @__userId_0 AND s.status = 'Active'
ORDER BY s.created_at DESC
LIMIT 1
2025-08-04 11:56:45.605 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/admin/users/344cd19a-f718-4633-97cc-d97c5abfbb59/subscription - 200 null application/json; charset=utf-8 35.1425ms
2025-08-04 11:56:45.606 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType95`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-04 11:56:45.607 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/admin/users/a09e41e8-d894-484f-ba01-4b0eae749b75/subscription - 200 null application/json; charset=utf-8 34.6081ms
2025-08-04 11:56:45.607 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/admin/users/7a5fc61f-d006-4ad3-b2c8-944101b5053f/subscription - 200 null application/json; charset=utf-8 33.6089ms
2025-08-04 11:56:45.609 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType95`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-04 11:56:45.609 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s.id, s.billing_cycle, s.created_at, s.end_date, s.next_billing_date, s.plan_name, s.price, s.start_date, s.status, s.stripe_subscription_id, s.subscription_plan_id, s.updated_at, s.user_id, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM subscriptions AS s
INNER JOIN "AspNetUsers" AS a ON s.user_id = a."Id"
WHERE s.user_id = @__userId_0 AND s.status = 'Active'
ORDER BY s.created_at DESC
LIMIT 1
2025-08-04 11:56:45.610 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/admin/users/8bf0f167-d003-46e4-9f15-936b4d1e9de3/subscription - application/json null
2025-08-04 11:56:45.610 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 57.1799ms
2025-08-04 11:56:45.612 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/admin/users/cf22237a-5df9-40db-83ad-878d2ee157a0/subscription - application/json null
2025-08-04 11:56:45.613 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 10.8838ms
2025-08-04 11:56:45.615 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType95`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-04 11:56:45.616 +08:00 [INF] CORS policy execution successful.
2025-08-04 11:56:45.616 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-08-04 11:56:45.617 +08:00 [INF] CORS policy execution successful.
2025-08-04 11:56:45.617 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-08-04 11:56:45.618 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 66.0088ms
2025-08-04 11:56:45.619 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/admin/users/487ad21a-a9df-4213-b283-02743691de26/subscription - 200 null application/json; charset=utf-8 82.2062ms
2025-08-04 11:56:45.619 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-04 11:56:45.620 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/admin/users/bee889a2-efca-471d-807c-a7674a945612/subscription - 200 null application/json; charset=utf-8 89.8853ms
2025-08-04 11:56:45.620 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-04 11:56:45.620 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-08-04 11:56:45.623 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-08-04 11:56:45.625 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-08-04 11:56:45.625 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/admin/users/718ad447-829b-4170-973a-87a1da659b51/subscription - 200 null application/json; charset=utf-8 90.7431ms
2025-08-04 11:56:45.626 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-08-04 11:56:45.626 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-08-04 11:56:45.629 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s.id, s.billing_cycle, s.created_at, s.end_date, s.next_billing_date, s.plan_name, s.price, s.start_date, s.status, s.stripe_subscription_id, s.subscription_plan_id, s.updated_at, s.user_id, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM subscriptions AS s
INNER JOIN "AspNetUsers" AS a ON s.user_id = a."Id"
WHERE s.user_id = @__userId_0 AND s.status = 'Active'
ORDER BY s.created_at DESC
LIMIT 1
2025-08-04 11:56:45.630 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s.id, s.billing_cycle, s.created_at, s.end_date, s.next_billing_date, s.plan_name, s.price, s.start_date, s.status, s.stripe_subscription_id, s.subscription_plan_id, s.updated_at, s.user_id, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM subscriptions AS s
INNER JOIN "AspNetUsers" AS a ON s.user_id = a."Id"
WHERE s.user_id = @__userId_0 AND s.status = 'Active'
ORDER BY s.created_at DESC
LIMIT 1
2025-08-04 11:56:45.630 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType95`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-04 11:56:45.631 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType95`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-04 11:56:45.632 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 3.6629ms
2025-08-04 11:56:45.632 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 3.3944ms
2025-08-04 11:56:45.633 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-08-04 11:56:45.633 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-08-04 11:56:45.634 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/admin/users/8bf0f167-d003-46e4-9f15-936b4d1e9de3/subscription - 200 null application/json; charset=utf-8 23.9435ms
2025-08-04 11:56:45.634 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/admin/users/cf22237a-5df9-40db-83ad-878d2ee157a0/subscription - 200 null application/json; charset=utf-8 22.5434ms
2025-08-04 11:59:01.891 +08:00 [INF] Request starting HTTP/1.1 POST http://localhost:5294/api/auth/login - application/json 51
2025-08-04 11:59:01.893 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AuthController.Login (CeceLearningPortal.Api)'
2025-08-04 11:59:01.893 +08:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(CeceLearningPortal.Api.DTOs.LoginDto) on controller CeceLearningPortal.Api.Controllers.AuthController (CeceLearningPortal.Api).
2025-08-04 11:59:01.896 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__normalizedEmail_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."NormalizedEmail" = @__normalizedEmail_0
LIMIT 2
2025-08-04 11:59:01.944 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@p1='?', @p2='?', @p0='?' (DbType = DateTime), @p3='?' (DbType = DateTime), @p4='?', @p5='?' (DbType = DateTime), @p6='?', @p7='?' (DbType = DateTime), @p8='?', @p9='?', @p10='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE "AspNetUsers" SET "LastLoginAt" = @p0
WHERE "Id" = @p1 AND "ConcurrencyStamp" = @p2;
INSERT INTO refresh_tokens (created_at, created_by_ip, expires_at, replaced_by_token, revoked_at, revoked_by_ip, token, user_id)
VALUES (@p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10)
RETURNING id;
2025-08-04 11:59:01.946 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.AuthResponseDto'.
2025-08-04 11:59:01.947 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AuthController.Login (CeceLearningPortal.Api) in 52.5935ms
2025-08-04 11:59:01.947 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AuthController.Login (CeceLearningPortal.Api)'
2025-08-04 11:59:01.948 +08:00 [INF] Request finished HTTP/1.1 POST http://localhost:5294/api/auth/login - 200 null application/json; charset=utf-8 56.4371ms
2025-08-04 11:59:07.190 +08:00 [INF] Request starting HTTP/1.1 POST http://localhost:5294/api/auth/login - application/json 51
2025-08-04 11:59:07.191 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AuthController.Login (CeceLearningPortal.Api)'
2025-08-04 11:59:07.192 +08:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(CeceLearningPortal.Api.DTOs.LoginDto) on controller CeceLearningPortal.Api.Controllers.AuthController (CeceLearningPortal.Api).
2025-08-04 11:59:07.194 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__normalizedEmail_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."NormalizedEmail" = @__normalizedEmail_0
LIMIT 2
2025-08-04 11:59:07.242 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@p1='?', @p2='?', @p0='?' (DbType = DateTime), @p3='?' (DbType = DateTime), @p4='?', @p5='?' (DbType = DateTime), @p6='?', @p7='?' (DbType = DateTime), @p8='?', @p9='?', @p10='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE "AspNetUsers" SET "LastLoginAt" = @p0
WHERE "Id" = @p1 AND "ConcurrencyStamp" = @p2;
INSERT INTO refresh_tokens (created_at, created_by_ip, expires_at, replaced_by_token, revoked_at, revoked_by_ip, token, user_id)
VALUES (@p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10)
RETURNING id;
2025-08-04 11:59:07.253 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.AuthResponseDto'.
2025-08-04 11:59:07.253 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AuthController.Login (CeceLearningPortal.Api) in 60.6695ms
2025-08-04 11:59:07.254 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AuthController.Login (CeceLearningPortal.Api)'
2025-08-04 11:59:07.255 +08:00 [INF] Request finished HTTP/1.1 POST http://localhost:5294/api/auth/login - 200 null application/json; charset=utf-8 64.8709ms
2025-08-04 11:59:18.487 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/admin/subscribers - null null
2025-08-04 11:59:18.491 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-04 11:59:18.492 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetSubscribers (CeceLearningPortal.Api)'
2025-08-04 11:59:18.496 +08:00 [INF] Route matched with {action = "GetSubscribers", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetSubscribers(CeceLearningPortal.Api.DTOs.SubscriberFilterDto) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-08-04 11:59:18.507 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s0.user_id AS "UserId", a."UserName", a."Email", a."FullName", a."Role", s0.id AS "SubscriptionId", s1.name AS "PlanName", s1.plan_type AS "PlanType", s0.price AS "Price", s0.billing_cycle AS "BillingCycle", s0.status AS "Status", s0.start_date AS "StartDate", s0.end_date AS "EndDate", s0.next_billing_date AS "NextBillingDate", (
    SELECT COALESCE(sum(t.amount), 0.0)
    FROM transactions AS t
    WHERE t.subscription_id = s0.id AND t.status = 'Completed') AS "TotalPaid"
FROM (
    SELECT s.id, s.billing_cycle, s.end_date, s.next_billing_date, s.price, s.start_date, s.status, s.subscription_plan_id, s.user_id
    FROM subscriptions AS s
    ORDER BY s.start_date DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS s0
INNER JOIN "AspNetUsers" AS a ON s0.user_id = a."Id"
INNER JOIN subscription_plans AS s1 ON s0.subscription_plan_id = s1.id
ORDER BY s0.start_date DESC
2025-08-04 11:59:18.509 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[CeceLearningPortal.Api.DTOs.SubscriberManagementDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-08-04 11:59:18.515 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetSubscribers (CeceLearningPortal.Api) in 18.7818ms
2025-08-04 11:59:18.516 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetSubscribers (CeceLearningPortal.Api)'
2025-08-04 11:59:18.517 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/admin/subscribers - 200 null application/json; charset=utf-8 29.4326ms
2025-08-04 11:59:31.019 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/admin/subscriptions/statistics - null null
2025-08-04 11:59:31.022 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-04 11:59:31.023 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetSubscriptionStatistics (CeceLearningPortal.Api)'
2025-08-04 11:59:31.026 +08:00 [INF] Route matched with {action = "GetSubscriptionStatistics", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetSubscriptionStatistics() on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-08-04 11:59:31.039 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s.id, s.billing_cycle, s.created_at, s.end_date, s.next_billing_date, s.plan_name, s.price, s.start_date, s.status, s.stripe_subscription_id, s.subscription_plan_id, s.updated_at, s.user_id, s0.id, s0.created_at, s0.description, s0.display_order, s0.features, s0.has_analytics, s0.has_priority_support, s0.has_unlimited_access, s0.is_active, s0.is_recommended, s0.max_course_access, s0.max_courses_can_create, s0.max_students_per_course, s0.monthly_price, s0.name, s0.plan_type, s0.transaction_fee_percentage, s0.updated_at, s0.yearly_price
FROM subscriptions AS s
INNER JOIN subscription_plans AS s0 ON s.subscription_plan_id = s0.id
WHERE s.status = 'Active'
2025-08-04 11:59:31.045 +08:00 [ERR] Failed executing DbCommand (1ms) [Parameters=[@__8__locals1_month_0='?' (DbType = DateTime), @__nextMonth_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM subscriptions AS s
WHERE s.start_date >= @__8__locals1_month_0 AND s.start_date < @__nextMonth_1
2025-08-04 11:59:31.058 +08:00 [ERR] An exception occurred while iterating over the results of a query for context type 'CeceLearningPortal.Api.Data.ApplicationDbContext'.
System.ArgumentException: Cannot write DateTime with Kind=Unspecified to PostgreSQL type 'timestamp with time zone', only UTC is supported. Note that it's not possible to mix DateTimes with different Kinds in an array, range, or multirange. (Parameter 'value')
   at Npgsql.Internal.Converters.DateTimeConverterResolver`1.Get(DateTime value, Nullable`1 expectedPgTypeId, Boolean validateOnly)
   at Npgsql.Internal.Converters.DateTimeConverterResolver.<>c.<CreateResolver>b__0_0(DateTimeConverterResolver`1 resolver, DateTime value, Nullable`1 expectedPgTypeId)
   at Npgsql.Internal.Converters.DateTimeConverterResolver`1.Get(T value, Nullable`1 expectedPgTypeId)
   at Npgsql.Internal.PgConverterResolver`1.GetAsObjectInternal(PgTypeInfo typeInfo, Object value, Nullable`1 expectedPgTypeId)
   at Npgsql.NpgsqlParameterCollection.ProcessParameters(PgSerializerOptions options, Boolean validateValues, CommandType commandType)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
System.ArgumentException: Cannot write DateTime with Kind=Unspecified to PostgreSQL type 'timestamp with time zone', only UTC is supported. Note that it's not possible to mix DateTimes with different Kinds in an array, range, or multirange. (Parameter 'value')
   at Npgsql.Internal.Converters.DateTimeConverterResolver`1.Get(DateTime value, Nullable`1 expectedPgTypeId, Boolean validateOnly)
   at Npgsql.Internal.Converters.DateTimeConverterResolver.<>c.<CreateResolver>b__0_0(DateTimeConverterResolver`1 resolver, DateTime value, Nullable`1 expectedPgTypeId)
   at Npgsql.Internal.Converters.DateTimeConverterResolver`1.Get(T value, Nullable`1 expectedPgTypeId)
   at Npgsql.Internal.PgConverterResolver`1.GetAsObjectInternal(PgTypeInfo typeInfo, Object value, Nullable`1 expectedPgTypeId)
   at Npgsql.NpgsqlParameterCollection.ProcessParameters(PgSerializerOptions options, Boolean validateValues, CommandType commandType)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
2025-08-04 11:59:31.061 +08:00 [ERR] Error retrieving subscription statistics
System.ArgumentException: Cannot write DateTime with Kind=Unspecified to PostgreSQL type 'timestamp with time zone', only UTC is supported. Note that it's not possible to mix DateTimes with different Kinds in an array, range, or multirange. (Parameter 'value')
   at Npgsql.Internal.Converters.DateTimeConverterResolver`1.Get(DateTime value, Nullable`1 expectedPgTypeId, Boolean validateOnly)
   at Npgsql.Internal.Converters.DateTimeConverterResolver.<>c.<CreateResolver>b__0_0(DateTimeConverterResolver`1 resolver, DateTime value, Nullable`1 expectedPgTypeId)
   at Npgsql.Internal.Converters.DateTimeConverterResolver`1.Get(T value, Nullable`1 expectedPgTypeId)
   at Npgsql.Internal.PgConverterResolver`1.GetAsObjectInternal(PgTypeInfo typeInfo, Object value, Nullable`1 expectedPgTypeId)
   at Npgsql.NpgsqlParameterCollection.ProcessParameters(PgSerializerOptions options, Boolean validateValues, CommandType commandType)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)
   at CeceLearningPortal.Api.Services.SubscriptionManagementService.GetSubscriptionStatisticsAsync() in D:\Cece\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Services\SubscriptionManagementService.cs:line 410
   at CeceLearningPortal.Api.Controllers.AdminController.GetSubscriptionStatistics() in D:\Cece\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Controllers\AdminController.cs:line 416
2025-08-04 11:59:31.068 +08:00 [INF] Executing ObjectResult, writing value of type '<>f__AnonymousType1`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-04 11:59:31.070 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetSubscriptionStatistics (CeceLearningPortal.Api) in 42.7869ms
2025-08-04 11:59:31.070 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetSubscriptionStatistics (CeceLearningPortal.Api)'
2025-08-04 11:59:31.071 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/admin/subscriptions/statistics - 500 null application/json; charset=utf-8 52.7261ms
2025-08-04 14:05:52.466 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/analytics/platform - null null
2025-08-04 14:05:52.467 +08:00 [INF] CORS policy execution successful.
2025-08-04 14:05:52.467 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/analytics/platform - 204 null null 1.8729ms
2025-08-04 14:05:52.469 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/analytics/platform - application/json null
2025-08-04 14:05:52.470 +08:00 [INF] CORS policy execution successful.
2025-08-04 14:05:52.471 +08:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '8/4/2025 4:56:38 AM', Current time (UTC): '8/4/2025 6:05:52 AM'.
   at Microsoft.IdentityModel.Tokens.ValidatorUtilities.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2025-08-04 14:05:52.472 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '8/4/2025 4:56:38 AM', Current time (UTC): '8/4/2025 6:05:52 AM'.
2025-08-04 14:05:52.473 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '8/4/2025 4:56:38 AM', Current time (UTC): '8/4/2025 6:05:52 AM'.
2025-08-04 14:05:52.622 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-04 14:05:52.623 +08:00 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-08-04 14:05:52.624 +08:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-08-04 14:05:52.624 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/analytics/platform - 401 0 null 155.1569ms
2025-08-04 14:05:52.735 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/admin/course-completions - null null
2025-08-04 14:05:52.736 +08:00 [INF] CORS policy execution successful.
2025-08-04 14:05:52.737 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/admin/course-completions - 204 null null 1.6825ms
2025-08-04 14:05:52.738 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/admin/course-completions - application/json null
2025-08-04 14:05:52.739 +08:00 [INF] CORS policy execution successful.
2025-08-04 14:05:52.739 +08:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '8/4/2025 4:56:38 AM', Current time (UTC): '8/4/2025 6:05:52 AM'.
   at Microsoft.IdentityModel.Tokens.ValidatorUtilities.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2025-08-04 14:05:52.740 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '8/4/2025 4:56:38 AM', Current time (UTC): '8/4/2025 6:05:52 AM'.
2025-08-04 14:05:52.741 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '8/4/2025 4:56:38 AM', Current time (UTC): '8/4/2025 6:05:52 AM'.
2025-08-04 14:05:52.742 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-04 14:05:52.743 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-08-04 14:05:52.744 +08:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-08-04 14:05:52.744 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/admin/course-completions - 401 0 null 6.1437ms
2025-08-04 14:05:54.442 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/auth/login - null null
2025-08-04 14:05:54.443 +08:00 [INF] CORS policy execution successful.
2025-08-04 14:05:54.444 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/auth/login - 204 null null 1.5712ms
2025-08-04 14:05:54.445 +08:00 [INF] Request starting HTTP/1.1 POST http://localhost:5294/api/auth/login - application/json 51
2025-08-04 14:05:54.446 +08:00 [INF] CORS policy execution successful.
2025-08-04 14:05:54.446 +08:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '8/4/2025 4:56:38 AM', Current time (UTC): '8/4/2025 6:05:54 AM'.
   at Microsoft.IdentityModel.Tokens.ValidatorUtilities.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2025-08-04 14:05:54.447 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '8/4/2025 4:56:38 AM', Current time (UTC): '8/4/2025 6:05:54 AM'.
2025-08-04 14:05:54.448 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '8/4/2025 4:56:38 AM', Current time (UTC): '8/4/2025 6:05:54 AM'.
2025-08-04 14:05:54.449 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-04 14:05:54.450 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AuthController.Login (CeceLearningPortal.Api)'
2025-08-04 14:05:54.450 +08:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(CeceLearningPortal.Api.DTOs.LoginDto) on controller CeceLearningPortal.Api.Controllers.AuthController (CeceLearningPortal.Api).
2025-08-04 14:05:54.453 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__normalizedEmail_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."NormalizedEmail" = @__normalizedEmail_0
LIMIT 2
2025-08-04 14:05:54.500 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@p1='?', @p2='?', @p0='?' (DbType = DateTime), @p3='?' (DbType = DateTime), @p4='?', @p5='?' (DbType = DateTime), @p6='?', @p7='?' (DbType = DateTime), @p8='?', @p9='?', @p10='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE "AspNetUsers" SET "LastLoginAt" = @p0
WHERE "Id" = @p1 AND "ConcurrencyStamp" = @p2;
INSERT INTO refresh_tokens (created_at, created_by_ip, expires_at, replaced_by_token, revoked_at, revoked_by_ip, token, user_id)
VALUES (@p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10)
RETURNING id;
2025-08-04 14:05:54.502 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.AuthResponseDto'.
2025-08-04 14:05:54.503 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AuthController.Login (CeceLearningPortal.Api) in 51.5138ms
2025-08-04 14:05:54.503 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AuthController.Login (CeceLearningPortal.Api)'
2025-08-04 14:05:54.504 +08:00 [INF] Request finished HTTP/1.1 POST http://localhost:5294/api/auth/login - 200 null application/json; charset=utf-8 58.9366ms
2025-08-04 14:05:54.526 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/courses - null null
2025-08-04 14:05:54.528 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/analytics/platform - application/json null
2025-08-04 14:05:54.528 +08:00 [INF] CORS policy execution successful.
2025-08-04 14:05:54.529 +08:00 [INF] CORS policy execution successful.
2025-08-04 14:05:54.530 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/courses - 204 null null 3.6231ms
2025-08-04 14:05:54.531 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-04 14:05:54.532 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/courses - application/json null
2025-08-04 14:05:54.533 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-08-04 14:05:54.535 +08:00 [INF] CORS policy execution successful.
2025-08-04 14:05:54.535 +08:00 [INF] Route matched with {action = "GetPlatformAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPlatformAnalytics() on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-08-04 14:05:54.536 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-04 14:05:54.538 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-08-04 14:05:54.539 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-08-04 14:05:54.547 +08:00 [INF] Executed DbCommand (6ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-08-04 14:05:54.550 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-08-04 14:05:54.551 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 11.4361ms
2025-08-04 14:05:54.552 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-08-04 14:05:54.553 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/courses - 200 null application/json; charset=utf-8 20.8133ms
2025-08-04 14:05:54.582 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
2025-08-04 14:05:54.584 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM courses AS c
2025-08-04 14:05:54.586 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.status = 'Completed'
2025-08-04 14:05:54.587 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
2025-08-04 14:05:54.592 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id" AS "instructorId", a."FullName" AS "instructorName", (
    SELECT count(*)::int
    FROM courses AS c0
    WHERE c0.instructor_id = a."Id") AS "totalCourses", (
    SELECT count(*)::int
    FROM enrollments AS e
    INNER JOIN courses AS c1 ON e.course_id = c1.id
    WHERE c1.instructor_id = a."Id") AS "totalStudents", (
    SELECT COALESCE(sum(t0.amount), 0.0)
    FROM transactions AS t0
    LEFT JOIN courses AS c2 ON t0.course_id = c2.id
    WHERE c2.instructor_id = a."Id" AND t0.status = 'Completed') AS "totalRevenue", COALESCE((
    SELECT avg(c3.rating::double precision)
    FROM course_reviews AS c3
    INNER JOIN courses AS c4 ON c3.course_id = c4.id
    WHERE c4.instructor_id = a."Id"), 0.0) AS "averageRating"
FROM "AspNetUsers" AS a
WHERE a."Role" = 'Instructor'
ORDER BY (
    SELECT COALESCE(sum(t.amount), 0.0)
    FROM transactions AS t
    LEFT JOIN courses AS c ON t.course_id = c.id
    WHERE c.instructor_id = a."Id" AND t.status = 'Completed') DESC
LIMIT @__p_0
2025-08-04 14:05:54.595 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT c.category, count(*)::int AS "courseCount", COALESCE(sum((
    SELECT count(*)::int
    FROM enrollments AS e
    WHERE c.id = e.course_id)), 0)::int AS "enrollmentCount", (
    SELECT COALESCE(sum(t.amount), 0.0)
    FROM transactions AS t
    LEFT JOIN courses AS c0 ON t.course_id = c0.id
    WHERE c0.category = c.category AND t.status = 'Completed') AS revenue
FROM courses AS c
GROUP BY c.category
ORDER BY COALESCE(sum((
    SELECT count(*)::int
    FROM enrollments AS e
    WHERE c.id = e.course_id)), 0)::int DESC
2025-08-04 14:05:54.597 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT t0."Year", t0."Month", COALESCE(sum(t0.amount), 0.0) AS "Revenue", count(*)::int AS "TransactionCount"
FROM (
    SELECT t.amount, date_part('year', t.created_at AT TIME ZONE 'UTC')::int AS "Year", date_part('month', t.created_at AT TIME ZONE 'UTC')::int AS "Month"
    FROM transactions AS t
    WHERE t.status = 'Completed' AND t.created_at >= @__sixMonthsAgo_0
) AS t0
GROUP BY t0."Year", t0."Month"
2025-08-04 14:05:54.598 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT a0."Year", a0."Month", count(*)::int AS "NewUsers"
FROM (
    SELECT date_part('year', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "AspNetUsers" AS a
    WHERE a."CreatedAt" >= @__sixMonthsAgo_0
) AS a0
GROUP BY a0."Year", a0."Month"
2025-08-04 14:05:54.600 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM subscriptions AS s
WHERE s.status = 'Active'
2025-08-04 14:05:54.602 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s.plan_name AS plan, count(*)::int AS count, COALESCE(sum(s.price), 0.0) AS "monthlyRevenue"
FROM subscriptions AS s
WHERE s.status = 'Active'
GROUP BY s.plan_name
2025-08-04 14:05:54.602 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType20`6[[<>f__AnonymousType21`5[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-04 14:05:54.603 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api) in 66.4398ms
2025-08-04 14:05:54.604 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-08-04 14:05:54.604 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/analytics/platform - 200 null application/json; charset=utf-8 76.9494ms
2025-08-04 14:06:02.798 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/analytics/platform - null null
2025-08-04 14:06:02.799 +08:00 [INF] CORS policy execution successful.
2025-08-04 14:06:02.800 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/analytics/platform - 204 null null 1.6196ms
2025-08-04 14:06:02.801 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/analytics/platform - application/json null
2025-08-04 14:06:02.802 +08:00 [INF] CORS policy execution successful.
2025-08-04 14:06:02.804 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-04 14:06:02.806 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-08-04 14:06:02.806 +08:00 [INF] Route matched with {action = "GetPlatformAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPlatformAnalytics() on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-08-04 14:06:02.808 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
2025-08-04 14:06:02.809 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM courses AS c
2025-08-04 14:06:02.810 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.status = 'Completed'
2025-08-04 14:06:02.811 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
2025-08-04 14:06:02.814 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id" AS "instructorId", a."FullName" AS "instructorName", (
    SELECT count(*)::int
    FROM courses AS c0
    WHERE c0.instructor_id = a."Id") AS "totalCourses", (
    SELECT count(*)::int
    FROM enrollments AS e
    INNER JOIN courses AS c1 ON e.course_id = c1.id
    WHERE c1.instructor_id = a."Id") AS "totalStudents", (
    SELECT COALESCE(sum(t0.amount), 0.0)
    FROM transactions AS t0
    LEFT JOIN courses AS c2 ON t0.course_id = c2.id
    WHERE c2.instructor_id = a."Id" AND t0.status = 'Completed') AS "totalRevenue", COALESCE((
    SELECT avg(c3.rating::double precision)
    FROM course_reviews AS c3
    INNER JOIN courses AS c4 ON c3.course_id = c4.id
    WHERE c4.instructor_id = a."Id"), 0.0) AS "averageRating"
FROM "AspNetUsers" AS a
WHERE a."Role" = 'Instructor'
ORDER BY (
    SELECT COALESCE(sum(t.amount), 0.0)
    FROM transactions AS t
    LEFT JOIN courses AS c ON t.course_id = c.id
    WHERE c.instructor_id = a."Id" AND t.status = 'Completed') DESC
LIMIT @__p_0
2025-08-04 14:06:02.816 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT c.category, count(*)::int AS "courseCount", COALESCE(sum((
    SELECT count(*)::int
    FROM enrollments AS e
    WHERE c.id = e.course_id)), 0)::int AS "enrollmentCount", (
    SELECT COALESCE(sum(t.amount), 0.0)
    FROM transactions AS t
    LEFT JOIN courses AS c0 ON t.course_id = c0.id
    WHERE c0.category = c.category AND t.status = 'Completed') AS revenue
FROM courses AS c
GROUP BY c.category
ORDER BY COALESCE(sum((
    SELECT count(*)::int
    FROM enrollments AS e
    WHERE c.id = e.course_id)), 0)::int DESC
2025-08-04 14:06:02.818 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT t0."Year", t0."Month", COALESCE(sum(t0.amount), 0.0) AS "Revenue", count(*)::int AS "TransactionCount"
FROM (
    SELECT t.amount, date_part('year', t.created_at AT TIME ZONE 'UTC')::int AS "Year", date_part('month', t.created_at AT TIME ZONE 'UTC')::int AS "Month"
    FROM transactions AS t
    WHERE t.status = 'Completed' AND t.created_at >= @__sixMonthsAgo_0
) AS t0
GROUP BY t0."Year", t0."Month"
2025-08-04 14:06:02.819 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT a0."Year", a0."Month", count(*)::int AS "NewUsers"
FROM (
    SELECT date_part('year', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "AspNetUsers" AS a
    WHERE a."CreatedAt" >= @__sixMonthsAgo_0
) AS a0
GROUP BY a0."Year", a0."Month"
2025-08-04 14:06:02.820 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM subscriptions AS s
WHERE s.status = 'Active'
2025-08-04 14:06:02.821 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s.plan_name AS plan, count(*)::int AS count, COALESCE(sum(s.price), 0.0) AS "monthlyRevenue"
FROM subscriptions AS s
WHERE s.status = 'Active'
GROUP BY s.plan_name
2025-08-04 14:06:02.822 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType20`6[[<>f__AnonymousType21`5[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-04 14:06:02.823 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api) in 16.3289ms
2025-08-04 14:06:02.824 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-08-04 14:06:02.824 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/analytics/platform - 200 null application/json; charset=utf-8 23.3346ms
2025-08-04 14:06:02.826 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/admin/course-completions - null null
2025-08-04 14:06:02.827 +08:00 [INF] CORS policy execution successful.
2025-08-04 14:06:02.827 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/admin/course-completions - 204 null null 1.4617ms
2025-08-04 14:06:02.829 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/admin/course-completions - application/json null
2025-08-04 14:06:02.830 +08:00 [INF] CORS policy execution successful.
2025-08-04 14:06:02.831 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-04 14:06:02.832 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetCourseCompletions (CeceLearningPortal.Api)'
2025-08-04 14:06:02.832 +08:00 [INF] Route matched with {action = "GetCourseCompletions", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourseCompletions(Int32) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-08-04 14:06:02.835 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT e0.id, a."FullName", a."Avatar", a."Email", c.title, e0.course_id::text, e0.completed_at, COALESCE(e0.average_quiz_score, 0.0), e0.certificate_issued, e0.certificate_url
FROM (
    SELECT e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.course_id, e.student_id
    FROM enrollments AS e
    WHERE e.completed_at IS NOT NULL
    ORDER BY e.completed_at DESC
    LIMIT @__p_0
) AS e0
INNER JOIN "AspNetUsers" AS a ON e0.student_id = a."Id"
INNER JOIN courses AS c ON e0.course_id = c.id
ORDER BY e0.completed_at DESC
2025-08-04 14:06:02.836 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType9`10[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-08-04 14:06:02.836 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetCourseCompletions (CeceLearningPortal.Api) in 3.2501ms
2025-08-04 14:06:02.837 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetCourseCompletions (CeceLearningPortal.Api)'
2025-08-04 14:06:02.838 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/admin/course-completions - 200 null application/json; charset=utf-8 8.9992ms
2025-08-04 14:06:04.048 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/admin/users - null null
2025-08-04 14:06:04.048 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/admin/subscription-plans - null null
2025-08-04 14:06:04.049 +08:00 [INF] CORS policy execution successful.
2025-08-04 14:06:04.050 +08:00 [INF] CORS policy execution successful.
2025-08-04 14:06:04.050 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/admin/users - 204 null null 2.2709ms
2025-08-04 14:06:04.051 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/admin/subscription-plans - 204 null null 2.4077ms
2025-08-04 14:06:04.052 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/admin/subscription-plans - application/json null
2025-08-04 14:06:04.053 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/admin/users - application/json null
2025-08-04 14:06:04.054 +08:00 [INF] CORS policy execution successful.
2025-08-04 14:06:04.055 +08:00 [INF] CORS policy execution successful.
2025-08-04 14:06:04.056 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-04 14:06:04.056 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-04 14:06:04.057 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetSubscriptionPlans (CeceLearningPortal.Api)'
2025-08-04 14:06:04.058 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUsers (CeceLearningPortal.Api)'
2025-08-04 14:06:04.059 +08:00 [INF] Route matched with {action = "GetSubscriptionPlans", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetSubscriptionPlans() on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-08-04 14:06:04.059 +08:00 [INF] Route matched with {action = "GetUsers", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUsers(CeceLearningPortal.Api.DTOs.UserManagementFilterDto) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-08-04 14:06:04.061 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s.id, s.created_at, s.description, s.display_order, s.features, s.has_analytics, s.has_priority_support, s.has_unlimited_access, s.is_active, s.is_recommended, s.max_course_access, s.max_courses_can_create, s.max_students_per_course, s.monthly_price, s.name, s.plan_type, s.transaction_fee_percentage, s.updated_at, s.yearly_price, s0.id, s0.billing_cycle, s0.created_at, s0.end_date, s0.next_billing_date, s0.plan_name, s0.price, s0.start_date, s0.status, s0.stripe_subscription_id, s0.subscription_plan_id, s0.updated_at, s0.user_id
FROM subscription_plans AS s
LEFT JOIN subscriptions AS s0 ON s.id = s0.subscription_plan_id
ORDER BY s.id
2025-08-04 14:06:04.061 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
2025-08-04 14:06:04.062 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[CeceLearningPortal.Api.DTOs.SubscriptionPlanDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-08-04 14:06:04.063 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."UserName", a."Email", a."FullName", a."Role", a."Status", a."CreatedAt", a."LastLoginAt", a."EmailConfirmed"
FROM "AspNetUsers" AS a
ORDER BY a."CreatedAt" DESC
LIMIT @__p_1 OFFSET @__p_0
2025-08-04 14:06:04.063 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetSubscriptionPlans (CeceLearningPortal.Api) in 3.616ms
2025-08-04 14:06:04.064 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[CeceLearningPortal.Api.DTOs.UserManagementDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-08-04 14:06:04.065 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetSubscriptionPlans (CeceLearningPortal.Api)'
2025-08-04 14:06:04.065 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUsers (CeceLearningPortal.Api) in 4.8352ms
2025-08-04 14:06:04.066 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/admin/subscription-plans - 200 null application/json; charset=utf-8 14.077ms
2025-08-04 14:06:04.067 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUsers (CeceLearningPortal.Api)'
2025-08-04 14:06:04.068 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/admin/users - 200 null application/json; charset=utf-8 15.1428ms
2025-08-04 14:06:04.070 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/admin/users/76ea62e5-6edd-486d-9d56-88a15c6afe35/subscription - null null
2025-08-04 14:06:04.071 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/admin/users/a5dba4a2-d846-4a95-82f1-b9f091105e9c/subscription - null null
2025-08-04 14:06:04.071 +08:00 [INF] CORS policy execution successful.
2025-08-04 14:06:04.072 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/admin/users/d36872cc-db57-4b86-bd3a-3909b0add07c/subscription - null null
2025-08-04 14:06:04.072 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/admin/users/bee889a2-efca-471d-807c-a7674a945612/subscription - null null
2025-08-04 14:06:04.072 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/admin/users/718ad447-829b-4170-973a-87a1da659b51/subscription - null null
2025-08-04 14:06:04.073 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/admin/users/487ad21a-a9df-4213-b283-02743691de26/subscription - null null
2025-08-04 14:06:04.073 +08:00 [INF] CORS policy execution successful.
2025-08-04 14:06:04.073 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/admin/users/76ea62e5-6edd-486d-9d56-88a15c6afe35/subscription - 204 null null 3.4773ms
2025-08-04 14:06:04.074 +08:00 [INF] CORS policy execution successful.
2025-08-04 14:06:04.075 +08:00 [INF] CORS policy execution successful.
2025-08-04 14:06:04.076 +08:00 [INF] CORS policy execution successful.
2025-08-04 14:06:04.077 +08:00 [INF] CORS policy execution successful.
2025-08-04 14:06:04.078 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/admin/users/a5dba4a2-d846-4a95-82f1-b9f091105e9c/subscription - 204 null null 7.0432ms
2025-08-04 14:06:04.079 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/admin/users/344cd19a-f718-4633-97cc-d97c5abfbb59/subscription - null null
2025-08-04 14:06:04.079 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/admin/users/d36872cc-db57-4b86-bd3a-3909b0add07c/subscription - 204 null null 7.5815ms
2025-08-04 14:06:04.080 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/admin/users/bee889a2-efca-471d-807c-a7674a945612/subscription - 204 null null 7.4648ms
2025-08-04 14:06:04.080 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/admin/users/718ad447-829b-4170-973a-87a1da659b51/subscription - 204 null null 7.5715ms
2025-08-04 14:06:04.080 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/admin/users/487ad21a-a9df-4213-b283-02743691de26/subscription - 204 null null 7.7732ms
2025-08-04 14:06:04.082 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/admin/users/a09e41e8-d894-484f-ba01-4b0eae749b75/subscription - null null
2025-08-04 14:06:04.083 +08:00 [INF] CORS policy execution successful.
2025-08-04 14:06:04.084 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/admin/users/7a5fc61f-d006-4ad3-b2c8-944101b5053f/subscription - null null
2025-08-04 14:06:04.085 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/admin/users/8bf0f167-d003-46e4-9f15-936b4d1e9de3/subscription - null null
2025-08-04 14:06:04.086 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/admin/users/cf22237a-5df9-40db-83ad-878d2ee157a0/subscription - null null
2025-08-04 14:06:04.087 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/admin/users/76ea62e5-6edd-486d-9d56-88a15c6afe35/subscription - application/json null
2025-08-04 14:06:04.088 +08:00 [INF] CORS policy execution successful.
2025-08-04 14:06:04.088 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/admin/users/344cd19a-f718-4633-97cc-d97c5abfbb59/subscription - 204 null null 9.5539ms
2025-08-04 14:06:04.090 +08:00 [INF] CORS policy execution successful.
2025-08-04 14:06:04.091 +08:00 [INF] CORS policy execution successful.
2025-08-04 14:06:04.092 +08:00 [INF] CORS policy execution successful.
2025-08-04 14:06:04.093 +08:00 [INF] CORS policy execution successful.
2025-08-04 14:06:04.093 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/admin/users/a09e41e8-d894-484f-ba01-4b0eae749b75/subscription - 204 null null 11.5674ms
2025-08-04 14:06:04.094 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/admin/users/a5dba4a2-d846-4a95-82f1-b9f091105e9c/subscription - application/json null
2025-08-04 14:06:04.095 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/admin/users/7a5fc61f-d006-4ad3-b2c8-944101b5053f/subscription - 204 null null 11.1659ms
2025-08-04 14:06:04.095 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/admin/users/8bf0f167-d003-46e4-9f15-936b4d1e9de3/subscription - 204 null null 10.4258ms
2025-08-04 14:06:04.096 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/admin/users/cf22237a-5df9-40db-83ad-878d2ee157a0/subscription - 204 null null 9.5595ms
2025-08-04 14:06:04.097 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-04 14:06:04.097 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/admin/users/d36872cc-db57-4b86-bd3a-3909b0add07c/subscription - application/json null
2025-08-04 14:06:04.098 +08:00 [INF] CORS policy execution successful.
2025-08-04 14:06:04.099 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/admin/users/bee889a2-efca-471d-807c-a7674a945612/subscription - application/json null
2025-08-04 14:06:04.100 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/admin/users/718ad447-829b-4170-973a-87a1da659b51/subscription - application/json null
2025-08-04 14:06:04.101 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/admin/users/487ad21a-a9df-4213-b283-02743691de26/subscription - application/json null
2025-08-04 14:06:04.103 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-08-04 14:06:04.104 +08:00 [INF] CORS policy execution successful.
2025-08-04 14:06:04.104 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-04 14:06:04.105 +08:00 [INF] CORS policy execution successful.
2025-08-04 14:06:04.106 +08:00 [INF] CORS policy execution successful.
2025-08-04 14:06:04.107 +08:00 [INF] CORS policy execution successful.
2025-08-04 14:06:04.107 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-08-04 14:06:04.108 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-04 14:06:04.109 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-08-04 14:06:04.109 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-04 14:06:04.112 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-08-04 14:06:04.112 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-08-04 14:06:04.113 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-08-04 14:06:04.114 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-08-04 14:06:04.115 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-08-04 14:06:04.115 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s.id, s.billing_cycle, s.created_at, s.end_date, s.next_billing_date, s.plan_name, s.price, s.start_date, s.status, s.stripe_subscription_id, s.subscription_plan_id, s.updated_at, s.user_id, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM subscriptions AS s
INNER JOIN "AspNetUsers" AS a ON s.user_id = a."Id"
WHERE s.user_id = @__userId_0 AND s.status = 'Active'
ORDER BY s.created_at DESC
LIMIT 1
2025-08-04 14:06:04.116 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s.id, s.billing_cycle, s.created_at, s.end_date, s.next_billing_date, s.plan_name, s.price, s.start_date, s.status, s.stripe_subscription_id, s.subscription_plan_id, s.updated_at, s.user_id, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM subscriptions AS s
INNER JOIN "AspNetUsers" AS a ON s.user_id = a."Id"
WHERE s.user_id = @__userId_0 AND s.status = 'Active'
ORDER BY s.created_at DESC
LIMIT 1
2025-08-04 14:06:04.118 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType95`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-04 14:06:04.119 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType95`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-04 14:06:04.120 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 5.5311ms
2025-08-04 14:06:04.121 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 4.9454ms
2025-08-04 14:06:04.122 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-08-04 14:06:04.122 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-08-04 14:06:04.123 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/admin/users/a5dba4a2-d846-4a95-82f1-b9f091105e9c/subscription - 200 null application/json; charset=utf-8 28.5932ms
2025-08-04 14:06:04.124 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/admin/users/d36872cc-db57-4b86-bd3a-3909b0add07c/subscription - 200 null application/json; charset=utf-8 26.662ms
2025-08-04 14:06:04.126 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/admin/users/344cd19a-f718-4633-97cc-d97c5abfbb59/subscription - application/json null
2025-08-04 14:06:04.128 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/admin/users/a09e41e8-d894-484f-ba01-4b0eae749b75/subscription - application/json null
2025-08-04 14:06:04.129 +08:00 [INF] CORS policy execution successful.
2025-08-04 14:06:04.131 +08:00 [INF] CORS policy execution successful.
2025-08-04 14:06:04.132 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-04 14:06:04.133 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-04 14:06:04.134 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-08-04 14:06:04.135 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-08-04 14:06:04.136 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-08-04 14:06:04.136 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-08-04 14:06:04.138 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s.id, s.billing_cycle, s.created_at, s.end_date, s.next_billing_date, s.plan_name, s.price, s.start_date, s.status, s.stripe_subscription_id, s.subscription_plan_id, s.updated_at, s.user_id, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM subscriptions AS s
INNER JOIN "AspNetUsers" AS a ON s.user_id = a."Id"
WHERE s.user_id = @__userId_0 AND s.status = 'Active'
ORDER BY s.created_at DESC
LIMIT 1
2025-08-04 14:06:04.139 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s.id, s.billing_cycle, s.created_at, s.end_date, s.next_billing_date, s.plan_name, s.price, s.start_date, s.status, s.stripe_subscription_id, s.subscription_plan_id, s.updated_at, s.user_id, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM subscriptions AS s
INNER JOIN "AspNetUsers" AS a ON s.user_id = a."Id"
WHERE s.user_id = @__userId_0 AND s.status = 'Active'
ORDER BY s.created_at DESC
LIMIT 1
2025-08-04 14:06:04.140 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType95`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-04 14:06:04.142 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType95`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-04 14:06:04.142 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 4.8092ms
2025-08-04 14:06:04.143 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 4.5618ms
2025-08-04 14:06:04.144 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-08-04 14:06:04.144 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-08-04 14:06:04.145 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/admin/users/344cd19a-f718-4633-97cc-d97c5abfbb59/subscription - 200 null application/json; charset=utf-8 19.0154ms
2025-08-04 14:06:04.146 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/admin/users/a09e41e8-d894-484f-ba01-4b0eae749b75/subscription - 200 null application/json; charset=utf-8 17.7419ms
2025-08-04 14:06:04.147 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/admin/users/7a5fc61f-d006-4ad3-b2c8-944101b5053f/subscription - application/json null
2025-08-04 14:06:04.148 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/admin/users/8bf0f167-d003-46e4-9f15-936b4d1e9de3/subscription - application/json null
2025-08-04 14:06:04.150 +08:00 [INF] CORS policy execution successful.
2025-08-04 14:06:04.151 +08:00 [INF] CORS policy execution successful.
2025-08-04 14:06:04.152 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-04 14:06:04.152 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-04 14:06:04.153 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-08-04 14:06:04.154 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-08-04 14:06:04.154 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-08-04 14:06:04.155 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-08-04 14:06:04.157 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s.id, s.billing_cycle, s.created_at, s.end_date, s.next_billing_date, s.plan_name, s.price, s.start_date, s.status, s.stripe_subscription_id, s.subscription_plan_id, s.updated_at, s.user_id, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM subscriptions AS s
INNER JOIN "AspNetUsers" AS a ON s.user_id = a."Id"
WHERE s.user_id = @__userId_0 AND s.status = 'Active'
ORDER BY s.created_at DESC
LIMIT 1
2025-08-04 14:06:04.158 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s.id, s.billing_cycle, s.created_at, s.end_date, s.next_billing_date, s.plan_name, s.price, s.start_date, s.status, s.stripe_subscription_id, s.subscription_plan_id, s.updated_at, s.user_id, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM subscriptions AS s
INNER JOIN "AspNetUsers" AS a ON s.user_id = a."Id"
WHERE s.user_id = @__userId_0 AND s.status = 'Active'
ORDER BY s.created_at DESC
LIMIT 1
2025-08-04 14:06:04.158 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-04 14:06:04.158 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType95`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-04 14:06:04.160 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType95`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-04 14:06:04.161 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-08-04 14:06:04.161 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 5.257ms
2025-08-04 14:06:04.161 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-04 14:06:04.162 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 4.6816ms
2025-08-04 14:06:04.162 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-08-04 14:06:04.163 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-08-04 14:06:04.164 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-08-04 14:06:04.164 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-08-04 14:06:04.166 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/admin/users/7a5fc61f-d006-4ad3-b2c8-944101b5053f/subscription - 200 null application/json; charset=utf-8 18.7768ms
2025-08-04 14:06:04.166 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s.id, s.billing_cycle, s.created_at, s.end_date, s.next_billing_date, s.plan_name, s.price, s.start_date, s.status, s.stripe_subscription_id, s.subscription_plan_id, s.updated_at, s.user_id, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM subscriptions AS s
INNER JOIN "AspNetUsers" AS a ON s.user_id = a."Id"
WHERE s.user_id = @__userId_0 AND s.status = 'Active'
ORDER BY s.created_at DESC
LIMIT 1
2025-08-04 14:06:04.166 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-08-04 14:06:04.167 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/admin/users/8bf0f167-d003-46e4-9f15-936b4d1e9de3/subscription - 200 null application/json; charset=utf-8 18.5161ms
2025-08-04 14:06:04.168 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/admin/users/cf22237a-5df9-40db-83ad-878d2ee157a0/subscription - application/json null
2025-08-04 14:06:04.169 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType95`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-04 14:06:04.170 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s.id, s.billing_cycle, s.created_at, s.end_date, s.next_billing_date, s.plan_name, s.price, s.start_date, s.status, s.stripe_subscription_id, s.subscription_plan_id, s.updated_at, s.user_id, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM subscriptions AS s
INNER JOIN "AspNetUsers" AS a ON s.user_id = a."Id"
WHERE s.user_id = @__userId_0 AND s.status = 'Active'
ORDER BY s.created_at DESC
LIMIT 1
2025-08-04 14:06:04.171 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s.id, s.billing_cycle, s.created_at, s.end_date, s.next_billing_date, s.plan_name, s.price, s.start_date, s.status, s.stripe_subscription_id, s.subscription_plan_id, s.updated_at, s.user_id, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM subscriptions AS s
INNER JOIN "AspNetUsers" AS a ON s.user_id = a."Id"
WHERE s.user_id = @__userId_0 AND s.status = 'Active'
ORDER BY s.created_at DESC
LIMIT 1
2025-08-04 14:06:04.172 +08:00 [INF] CORS policy execution successful.
2025-08-04 14:06:04.173 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 7.5992ms
2025-08-04 14:06:04.174 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType95`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-04 14:06:04.175 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType95`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-04 14:06:04.176 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-08-04 14:06:04.176 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-04 14:06:04.177 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 59.9712ms
2025-08-04 14:06:04.177 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 7.2731ms
2025-08-04 14:06:04.178 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/admin/users/718ad447-829b-4170-973a-87a1da659b51/subscription - 200 null application/json; charset=utf-8 77.4126ms
2025-08-04 14:06:04.179 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-08-04 14:06:04.179 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-08-04 14:06:04.180 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-08-04 14:06:04.181 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-08-04 14:06:04.182 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/admin/users/bee889a2-efca-471d-807c-a7674a945612/subscription - 200 null application/json; charset=utf-8 82.4332ms
2025-08-04 14:06:04.182 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/admin/users/487ad21a-a9df-4213-b283-02743691de26/subscription - 200 null application/json; charset=utf-8 80.7152ms
2025-08-04 14:06:04.185 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s.id, s.billing_cycle, s.created_at, s.end_date, s.next_billing_date, s.plan_name, s.price, s.start_date, s.status, s.stripe_subscription_id, s.subscription_plan_id, s.updated_at, s.user_id, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM subscriptions AS s
INNER JOIN "AspNetUsers" AS a ON s.user_id = a."Id"
WHERE s.user_id = @__userId_0 AND s.status = 'Active'
ORDER BY s.created_at DESC
LIMIT 1
2025-08-04 14:06:04.186 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType95`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-04 14:06:04.187 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 3.9906ms
2025-08-04 14:06:04.188 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-08-04 14:06:04.188 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/admin/users/cf22237a-5df9-40db-83ad-878d2ee157a0/subscription - 200 null application/json; charset=utf-8 19.8316ms
2025-08-04 14:06:04.270 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s.id, s.billing_cycle, s.created_at, s.end_date, s.next_billing_date, s.plan_name, s.price, s.start_date, s.status, s.stripe_subscription_id, s.subscription_plan_id, s.updated_at, s.user_id, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM subscriptions AS s
INNER JOIN "AspNetUsers" AS a ON s.user_id = a."Id"
WHERE s.user_id = @__userId_0 AND s.status = 'Active'
ORDER BY s.created_at DESC
LIMIT 1
2025-08-04 14:06:04.271 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType95`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-04 14:06:04.272 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 161.087ms
2025-08-04 14:06:04.273 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-08-04 14:06:04.273 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/admin/users/76ea62e5-6edd-486d-9d56-88a15c6afe35/subscription - 200 null application/json; charset=utf-8 185.9662ms
